/*! Copyright (C) 2024 WhiteSpider Dev. All rights reserved. Source: https://whitespider.dev/ !*/
"use strict"; / Created by WhiteSpider Dev. DO NOT remove this comment!!! This will break integrity checks! /;
/*! For license information please see out.js.LICENSE.txt */
(()=>{"use strict";var e={602:(e,t)=>{function s(e,t){if(null==e)return{};var s,i,n={},r=Object.keys(e);for(i=0;i<r.length;i++)s=r[i],t.indexOf(s)>=0||(n[s]=e[s]);return n}class i{constructor(e,t,s){this.line=void 0,this.column=void 0,this.index=void 0,this.line=e,this.column=t,this.index=s}}class n{constructor(e,t){this.start=void 0,this.end=void 0,this.filename=void 0,this.identifierName=void 0,this.start=e,this.end=t}}function r(e,t){const{line:s,column:n,index:r}=e;return new i(s,n+t,r+t)}const a="BABEL_PARSER_SOURCETYPE_MODULE_REQUIRED";var o={ImportMetaOutsideModule:{message:"import.meta may appear only with 'sourceType: \"module\"'",code:a},ImportOutsideModule:{message:"'import' and 'export' may appear only with 'sourceType: \"module\"'",code:a}};const c={ArrayPattern:"array destructuring pattern",AssignmentExpression:"assignment expression",AssignmentPattern:"assignment expression",ArrowFunctionExpression:"arrow function expression",ConditionalExpression:"conditional expression",CatchClause:"catch clause",ForOfStatement:"for-of statement",ForInStatement:"for-in statement",ForStatement:"for-loop",FormalParameters:"function parameter list",Identifier:"identifier",ImportSpecifier:"import specifier",ImportDefaultSpecifier:"import default specifier",ImportNamespaceSpecifier:"import namespace specifier",ObjectPattern:"object destructuring pattern",ParenthesizedExpression:"parenthesized expression",RestElement:"rest element",UpdateExpression:{true:"prefix operation",false:"postfix operation"},VariableDeclarator:"variable declaration",YieldExpression:"yield expression"},h=e=>"UpdateExpression"===e.type?c.UpdateExpression[`${e.prefix}`]:c[e.type];var l={AccessorIsGenerator:({kind:e})=>`A ${e}ter cannot be a generator.`,ArgumentsInClass:"'arguments' is only allowed in functions and class methods.",AsyncFunctionInSingleStatementContext:"Async functions can only be declared at the top level or inside a block.",AwaitBindingIdentifier:"Can not use 'await' as identifier inside an async function.",AwaitBindingIdentifierInStaticBlock:"Can not use 'await' as identifier inside a static block.",AwaitExpressionFormalParameter:"'await' is not allowed in async function parameters.",AwaitUsingNotInAsyncContext:"'await using' is only allowed within async functions and at the top levels of modules.",AwaitNotInAsyncContext:"'await' is only allowed within async functions and at the top levels of modules.",AwaitNotInAsyncFunction:"'await' is only allowed within async functions.",BadGetterArity:"A 'get' accessor must not have any formal parameters.",BadSetterArity:"A 'set' accessor must have exactly one formal parameter.",BadSetterRestParameter:"A 'set' accessor function argument must not be a rest parameter.",ConstructorClassField:"Classes may not have a field named 'constructor'.",ConstructorClassPrivateField:"Classes may not have a private field named '#constructor'.",ConstructorIsAccessor:"Class constructor may not be an accessor.",ConstructorIsAsync:"Constructor can't be an async function.",ConstructorIsGenerator:"Constructor can't be a generator.",DeclarationMissingInitializer:({kind:e})=>`Missing initializer in ${e} declaration.`,DecoratorArgumentsOutsideParentheses:"Decorator arguments must be moved inside parentheses: use '@(decorator(args))' instead of '@(decorator)(args)'.",DecoratorBeforeExport:"Decorators must be placed *before* the 'export' keyword. Remove the 'decoratorsBeforeExport: true' option to use the 'export @decorator class {}' syntax.",DecoratorsBeforeAfterExport:"Decorators can be placed *either* before or after the 'export' keyword, but not in both locations at the same time.",DecoratorConstructor:"Decorators can't be used with a constructor. Did you mean '@dec class { ... }'?",DecoratorExportClass:"Decorators must be placed *after* the 'export' keyword. Remove the 'decoratorsBeforeExport: false' option to use the '@decorator export class {}' syntax.",DecoratorSemicolon:"Decorators must not be followed by a semicolon.",DecoratorStaticBlock:"Decorators can't be used with a static block.",DeferImportRequiresNamespace:'Only `import defer * as x from "./module"` is valid.',DeletePrivateField:"Deleting a private field is not allowed.",DestructureNamedImport:"ES2015 named imports do not destructure. Use another statement for destructuring after the import.",DuplicateConstructor:"Duplicate constructor in the same class.",DuplicateDefaultExport:"Only one default export allowed per module.",DuplicateExport:({exportName:e})=>`\`${e}\` has already been exported. Exported identifiers must be unique.`,DuplicateProto:"Redefinition of __proto__ property.",DuplicateRegExpFlags:"Duplicate regular expression flag.",DynamicImportPhaseRequiresImportExpressions:({phase:e})=>`'import.${e}(...)' can only be parsed when using the 'createImportExpressions' option.`,ElementAfterRest:"Rest element must be last element.",EscapedCharNotAnIdentifier:"Invalid Unicode escape.",ExportBindingIsString:({localName:e,exportName:t})=>`A string literal cannot be used as an exported binding without \`from\`.\n- Did you mean \`export { '${e}' as '${t}' } from 'some-module'\`?`,ExportDefaultFromAsIdentifier:"'from' is not allowed as an identifier after 'export default'.",ForInOfLoopInitializer:({type:e})=>`'${"ForInStatement"===e?"for-in":"for-of"}' loop variable declaration may not have an initializer.`,ForInUsing:"For-in loop may not start with 'using' declaration.",ForOfAsync:"The left-hand side of a for-of loop may not be 'async'.",ForOfLet:"The left-hand side of a for-of loop may not start with 'let'.",GeneratorInSingleStatementContext:"Generators can only be declared at the top level or inside a block.",IllegalBreakContinue:({type:e})=>`Unsyntactic ${"BreakStatement"===e?"break":"continue"}.`,IllegalLanguageModeDirective:"Illegal 'use strict' directive in function with non-simple parameter list.",IllegalReturn:"'return' outside of function.",ImportAttributesUseAssert:"The `assert` keyword in import attributes is deprecated and it has been replaced by the `with` keyword. You can enable the `deprecatedAssertSyntax: true` option in the import attributes plugin to suppress this error.",ImportBindingIsString:({importName:e})=>`A string literal cannot be used as an imported binding.\n- Did you mean \`import { "${e}" as foo }\`?`,ImportCallArgumentTrailingComma:"Trailing comma is disallowed inside import(...) arguments.",ImportCallArity:({maxArgumentCount:e})=>`\`import()\` requires exactly ${1===e?"one argument":"one or two arguments"}.`,ImportCallNotNewExpression:"Cannot use new with import(...).",ImportCallSpreadArgument:"`...` is not allowed in `import()`.",ImportJSONBindingNotDefault:"A JSON module can only be imported with `default`.",ImportReflectionHasAssertion:"`import module x` cannot have assertions.",ImportReflectionNotBinding:'Only `import module x from "./module"` is valid.',IncompatibleRegExpUVFlags:"The 'u' and 'v' regular expression flags cannot be enabled at the same time.",InvalidBigIntLiteral:"Invalid BigIntLiteral.",InvalidCodePoint:"Code point out of bounds.",InvalidCoverInitializedName:"Invalid shorthand property initializer.",InvalidDecimal:"Invalid decimal.",InvalidDigit:({radix:e})=>`Expected number in radix ${e}.`,InvalidEscapeSequence:"Bad character escape sequence.",InvalidEscapeSequenceTemplate:"Invalid escape sequence in template.",InvalidEscapedReservedWord:({reservedWord:e})=>`Escape sequence in keyword ${e}.`,InvalidIdentifier:({identifierName:e})=>`Invalid identifier ${e}.`,InvalidLhs:({ancestor:e})=>`Invalid left-hand side in ${h(e)}.`,InvalidLhsBinding:({ancestor:e})=>`Binding invalid left-hand side in ${h(e)}.`,InvalidLhsOptionalChaining:({ancestor:e})=>`Invalid optional chaining in the left-hand side of ${h(e)}.`,InvalidNumber:"Invalid number.",InvalidOrMissingExponent:"Floating-point numbers require a valid exponent after the 'e'.",InvalidOrUnexpectedToken:({unexpected:e})=>`Unexpected character '${e}'.`,InvalidParenthesizedAssignment:"Invalid parenthesized assignment pattern.",InvalidPrivateFieldResolution:({identifierName:e})=>`Private name #${e} is not defined.`,InvalidPropertyBindingPattern:"Binding member expression.",InvalidRecordProperty:"Only properties and spread elements are allowed in record definitions.",InvalidRestAssignmentPattern:"Invalid rest operator's argument.",LabelRedeclaration:({labelName:e})=>`Label '${e}' is already declared.`,LetInLexicalBinding:"'let' is disallowed as a lexically bound name.",LineTerminatorBeforeArrow:"No line break is allowed before '=>'.",MalformedRegExpFlags:"Invalid regular expression flag.",MissingClassName:"A class name is required.",MissingEqInAssignment:"Only '=' operator can be used for specifying default value.",MissingSemicolon:"Missing semicolon.",MissingPlugin:({missingPlugin:e})=>`This experimental syntax requires enabling the parser plugin: ${e.map((e=>JSON.stringify(e))).join(", ")}.`,MissingOneOfPlugins:({missingPlugin:e})=>`This experimental syntax requires enabling one of the following parser plugin(s): ${e.map((e=>JSON.stringify(e))).join(", ")}.`,MissingUnicodeEscape:"Expecting Unicode escape sequence \\uXXXX.",MixingCoalesceWithLogical:"Nullish coalescing operator(??) requires parens when mixing with logical operators.",ModuleAttributeDifferentFromType:"The only accepted module attribute is `type`.",ModuleAttributeInvalidValue:"Only string literals are allowed as module attribute values.",ModuleAttributesWithDuplicateKeys:({key:e})=>`Duplicate key "${e}" is not allowed in module attributes.`,ModuleExportNameHasLoneSurrogate:({surrogateCharCode:e})=>`An export name cannot include a lone surrogate, found '\\u${e.toString(16)}'.`,ModuleExportUndefined:({localName:e})=>`Export '${e}' is not defined.`,MultipleDefaultsInSwitch:"Multiple default clauses.",NewlineAfterThrow:"Illegal newline after throw.",NoCatchOrFinally:"Missing catch or finally clause.",NumberIdentifier:"Identifier directly after number.",NumericSeparatorInEscapeSequence:"Numeric separators are not allowed inside unicode escape sequences or hex escape sequences.",ObsoleteAwaitStar:"'await*' has been removed from the async functions proposal. Use Promise.all() instead.",OptionalChainingNoNew:"Constructors in/after an Optional Chain are not allowed.",OptionalChainingNoTemplate:"Tagged Template Literals are not allowed in optionalChain.",OverrideOnConstructor:"'override' modifier cannot appear on a constructor declaration.",ParamDupe:"Argument name clash.",PatternHasAccessor:"Object pattern can't contain getter or setter.",PatternHasMethod:"Object pattern can't contain methods.",PrivateInExpectedIn:({identifierName:e})=>`Private names are only allowed in property accesses (\`obj.#${e}\`) or in \`in\` expressions (\`#${e} in obj\`).`,PrivateNameRedeclaration:({identifierName:e})=>`Duplicate private name #${e}.`,RecordExpressionBarIncorrectEndSyntaxType:"Record expressions ending with '|}' are only allowed when the 'syntaxType' option of the 'recordAndTuple' plugin is set to 'bar'.",RecordExpressionBarIncorrectStartSyntaxType:"Record expressions starting with '{|' are only allowed when the 'syntaxType' option of the 'recordAndTuple' plugin is set to 'bar'.",RecordExpressionHashIncorrectStartSyntaxType:"Record expressions starting with '#{' are only allowed when the 'syntaxType' option of the 'recordAndTuple' plugin is set to 'hash'.",RecordNoProto:"'__proto__' is not allowed in Record expressions.",RestTrailingComma:"Unexpected trailing comma after rest element.",SloppyFunction:"In non-strict mode code, functions can only be declared at top level or inside a block.",SloppyFunctionAnnexB:"In non-strict mode code, functions can only be declared at top level, inside a block, or as the body of an if statement.",SourcePhaseImportRequiresDefault:'Only `import source x from "./module"` is valid.',StaticPrototype:"Classes may not have static property named prototype.",SuperNotAllowed:"`super()` is only valid inside a class constructor of a subclass. Maybe a typo in the method name ('constructor') or not extending another class?",SuperPrivateField:"Private fields can't be accessed on super.",TrailingDecorator:"Decorators must be attached to a class element.",TupleExpressionBarIncorrectEndSyntaxType:"Tuple expressions ending with '|]' are only allowed when the 'syntaxType' option of the 'recordAndTuple' plugin is set to 'bar'.",TupleExpressionBarIncorrectStartSyntaxType:"Tuple expressions starting with '[|' are only allowed when the 'syntaxType' option of the 'recordAndTuple' plugin is set to 'bar'.",TupleExpressionHashIncorrectStartSyntaxType:"Tuple expressions starting with '#[' are only allowed when the 'syntaxType' option of the 'recordAndTuple' plugin is set to 'hash'.",UnexpectedArgumentPlaceholder:"Unexpected argument placeholder.",UnexpectedAwaitAfterPipelineBody:'Unexpected "await" after pipeline body; await must have parentheses in minimal proposal.',UnexpectedDigitAfterHash:"Unexpected digit after hash token.",UnexpectedImportExport:"'import' and 'export' may only appear at the top level.",UnexpectedKeyword:({keyword:e})=>`Unexpected keyword '${e}'.`,UnexpectedLeadingDecorator:"Leading decorators must be attached to a class declaration.",UnexpectedLexicalDeclaration:"Lexical declaration cannot appear in a single-statement context.",UnexpectedNewTarget:"`new.target` can only be used in functions or class properties.",UnexpectedNumericSeparator:"A numeric separator is only allowed between two digits.",UnexpectedPrivateField:"Unexpected private name.",UnexpectedReservedWord:({reservedWord:e})=>`Unexpected reserved word '${e}'.`,UnexpectedSuper:"'super' is only allowed in object methods and classes.",UnexpectedToken:({expected:e,unexpected:t})=>`Unexpected token${t?` '${t}'.`:""}${e?`, expected "${e}"`:""}`,UnexpectedTokenUnaryExponentiation:"Illegal expression. Wrap left hand side or entire exponentiation in parentheses.",UnexpectedUsingDeclaration:"Using declaration cannot appear in the top level when source type is `script`.",UnsupportedBind:"Binding should be performed on object property.",UnsupportedDecoratorExport:"A decorated export must export a class declaration.",UnsupportedDefaultExport:"Only expressions, functions or classes are allowed as the `default` export.",UnsupportedImport:"`import` can only be used in `import()` or `import.meta`.",UnsupportedMetaProperty:({target:e,onlyValidPropertyName:t})=>`The only valid meta property for ${e} is ${e}.${t}.`,UnsupportedParameterDecorator:"Decorators cannot be used to decorate parameters.",UnsupportedPropertyDecorator:"Decorators cannot be used to decorate object literal properties.",UnsupportedSuper:"'super' can only be used with function calls (i.e. super()) or in property accesses (i.e. super.prop or super[prop]).",UnterminatedComment:"Unterminated comment.",UnterminatedRegExp:"Unterminated regular expression.",UnterminatedString:"Unterminated string constant.",UnterminatedTemplate:"Unterminated template.",UsingDeclarationExport:"Using declaration cannot be exported.",UsingDeclarationHasBindingPattern:"Using declaration cannot have destructuring patterns.",VarRedeclaration:({identifierName:e})=>`Identifier '${e}' has already been declared.`,YieldBindingIdentifier:"Can not use 'yield' as identifier inside a generator.",YieldInParameter:"Yield expression is not allowed in formal parameters.",ZeroDigitNumericSeparator:"Numeric separator can not be used after leading 0."};const p=new Set(["ArrowFunctionExpression","AssignmentExpression","ConditionalExpression","YieldExpression"]);var u={PipeBodyIsTighter:"Unexpected yield after pipeline body; any yield expression acting as Hack-style pipe body must be parenthesized due to its loose operator precedence.",PipeTopicRequiresHackPipes:'Topic reference is used, but the pipelineOperator plugin was not passed a "proposal": "hack" or "smart" option.',PipeTopicUnbound:"Topic reference is unbound; it must be inside a pipe body.",PipeTopicUnconfiguredToken:({token:e})=>`Invalid topic token ${e}. In order to use ${e} as a topic reference, the pipelineOperator plugin must be configured with { "proposal": "hack", "topicToken": "${e}" }.`,PipeTopicUnused:"Hack-style pipe body does not contain a topic reference; Hack-style pipes must use topic at least once.",PipeUnparenthesizedBody:({type:e})=>`Hack-style pipe body cannot be an unparenthesized ${h({type:e})}; please wrap it in parentheses.`,PipelineBodyNoArrow:'Unexpected arrow "=>" after pipeline body; arrow function in pipeline body must be parenthesized.',PipelineBodySequenceExpression:"Pipeline body may not be a comma-separated sequence expression.",PipelineHeadSequenceExpression:"Pipeline head should not be a comma-separated sequence expression.",PipelineTopicUnused:"Pipeline is in topic style but does not use topic reference.",PrimaryTopicNotAllowed:"Topic reference was used in a lexical context without topic binding.",PrimaryTopicRequiresSmartPipeline:'Topic reference is used, but the pipelineOperator plugin was not passed a "proposal": "hack" or "smart" option.'};const d=["toMessage"],f=["message"];function m(e,t,s){Object.defineProperty(e,t,{enumerable:!1,configurable:!0,value:s})}function y(e){let{toMessage:t}=e,n=s(e,d);return function e(s,r){const a=new SyntaxError;return Object.assign(a,n,{loc:s,pos:s.index}),"missingPlugin"in r&&Object.assign(a,{missingPlugin:r.missingPlugin}),m(a,"clone",(function(t={}){var n;const{line:a,column:o,index:c}=null!=(n=t.loc)?n:s;return e(new i(a,o,c),Object.assign({},r,t.details))})),m(a,"details",r),Object.defineProperty(a,"message",{configurable:!0,get(){const e=`${t(r)} (${s.line}:${s.column})`;return this.message=e,e},set(e){Object.defineProperty(this,"message",{value:e,writable:!0})}}),a}}function g(e,t){if(Array.isArray(e))return t=>g(t,e[0]);const i={};for(const n of Object.keys(e)){const r=e[n],a="string"==typeof r?{message:()=>r}:"function"==typeof r?{message:r}:r,{message:o}=a,c=s(a,f),h="string"==typeof o?()=>o:o;i[n]=y(Object.assign({code:"BABEL_PARSER_SYNTAX_ERROR",reasonCode:n,toMessage:h},t?{syntaxPlugin:t}:{},c))}return i}const b=Object.assign({},g(o),g(l),g({StrictDelete:"Deleting local variable in strict mode.",StrictEvalArguments:({referenceName:e})=>`Assigning to '${e}' in strict mode.`,StrictEvalArgumentsBinding:({bindingName:e})=>`Binding '${e}' in strict mode.`,StrictFunction:"In strict mode code, functions can only be declared at top level or inside a block.",StrictNumericEscape:"The only valid numeric escape in strict mode is '\\0'.",StrictOctalLiteral:"Legacy octal literals are not allowed in strict mode.",StrictWith:"'with' in strict mode."}),g`pipelineOperator`(u)),{defineProperty:w}=Object,_=(e,t)=>w(e,t,{enumerable:!1,value:e[t]});function x(e){return e.loc.start&&_(e.loc.start,"index"),e.loc.end&&_(e.loc.end,"index"),e}class v{constructor(e,t){this.token=void 0,this.preserveSpace=void 0,this.token=e,this.preserveSpace=!!t}}const T={brace:new v("{"),j_oTag:new v("<tag"),j_cTag:new v("</tag"),j_expr:new v("<tag>...</tag>",!0)};T.template=new v("`",!0);const P=!0,k=!0,C=!0,E=!0,A=!0;class S{constructor(e,t={}){this.label=void 0,this.keyword=void 0,this.beforeExpr=void 0,this.startsExpr=void 0,this.rightAssociative=void 0,this.isLoop=void 0,this.isAssign=void 0,this.prefix=void 0,this.postfix=void 0,this.binop=void 0,this.label=e,this.keyword=t.keyword,this.beforeExpr=!!t.beforeExpr,this.startsExpr=!!t.startsExpr,this.rightAssociative=!!t.rightAssociative,this.isLoop=!!t.isLoop,this.isAssign=!!t.isAssign,this.prefix=!!t.prefix,this.postfix=!!t.postfix,this.binop=null!=t.binop?t.binop:null,this.updateContext=null}}const I=new Map;function N(e,t={}){t.keyword=e;const s=U(e,t);return I.set(e,s),s}function L(e,t){return U(e,{beforeExpr:P,binop:t})}let D=-1;const O=[],M=[],R=[],F=[],B=[],j=[];function U(e,t={}){var s,i,n,r;return++D,M.push(e),R.push(null!=(s=t.binop)?s:-1),F.push(null!=(i=t.beforeExpr)&&i),B.push(null!=(n=t.startsExpr)&&n),j.push(null!=(r=t.prefix)&&r),O.push(new S(e,t)),D}function z(e,t={}){var s,i,n,r;return++D,I.set(e,D),M.push(e),R.push(null!=(s=t.binop)?s:-1),F.push(null!=(i=t.beforeExpr)&&i),B.push(null!=(n=t.startsExpr)&&n),j.push(null!=(r=t.prefix)&&r),O.push(new S("name",t)),D}const q={bracketL:U("[",{beforeExpr:P,startsExpr:k}),bracketHashL:U("#[",{beforeExpr:P,startsExpr:k}),bracketBarL:U("[|",{beforeExpr:P,startsExpr:k}),bracketR:U("]"),bracketBarR:U("|]"),braceL:U("{",{beforeExpr:P,startsExpr:k}),braceBarL:U("{|",{beforeExpr:P,startsExpr:k}),braceHashL:U("#{",{beforeExpr:P,startsExpr:k}),braceR:U("}"),braceBarR:U("|}"),parenL:U("(",{beforeExpr:P,startsExpr:k}),parenR:U(")"),comma:U(",",{beforeExpr:P}),semi:U(";",{beforeExpr:P}),colon:U(":",{beforeExpr:P}),doubleColon:U("::",{beforeExpr:P}),dot:U("."),question:U("?",{beforeExpr:P}),questionDot:U("?."),arrow:U("=>",{beforeExpr:P}),template:U("template"),ellipsis:U("...",{beforeExpr:P}),backQuote:U("`",{startsExpr:k}),dollarBraceL:U("${",{beforeExpr:P,startsExpr:k}),templateTail:U("...`",{startsExpr:k}),templateNonTail:U("...${",{beforeExpr:P,startsExpr:k}),at:U("@"),hash:U("#",{startsExpr:k}),interpreterDirective:U("#!..."),eq:U("=",{beforeExpr:P,isAssign:E}),assign:U("_=",{beforeExpr:P,isAssign:E}),slashAssign:U("_=",{beforeExpr:P,isAssign:E}),xorAssign:U("_=",{beforeExpr:P,isAssign:E}),moduloAssign:U("_=",{beforeExpr:P,isAssign:E}),incDec:U("++/--",{prefix:A,postfix:!0,startsExpr:k}),bang:U("!",{beforeExpr:P,prefix:A,startsExpr:k}),tilde:U("~",{beforeExpr:P,prefix:A,startsExpr:k}),doubleCaret:U("^^",{startsExpr:k}),doubleAt:U("@@",{startsExpr:k}),pipeline:L("|>",0),nullishCoalescing:L("??",1),logicalOR:L("||",1),logicalAND:L("&&",2),bitwiseOR:L("|",3),bitwiseXOR:L("^",4),bitwiseAND:L("&",5),equality:L("==/!=/===/!==",6),lt:L("</>/<=/>=",7),gt:L("</>/<=/>=",7),relational:L("</>/<=/>=",7),bitShift:L("<</>>/>>>",8),bitShiftL:L("<</>>/>>>",8),bitShiftR:L("<</>>/>>>",8),plusMin:U("+/-",{beforeExpr:P,binop:9,prefix:A,startsExpr:k}),modulo:U("%",{binop:10,startsExpr:k}),star:U("*",{binop:10}),slash:L("/",10),exponent:U("**",{beforeExpr:P,binop:11,rightAssociative:!0}),_in:N("in",{beforeExpr:P,binop:7}),_instanceof:N("instanceof",{beforeExpr:P,binop:7}),_break:N("break"),_case:N("case",{beforeExpr:P}),_catch:N("catch"),_continue:N("continue"),_debugger:N("debugger"),_default:N("default",{beforeExpr:P}),_else:N("else",{beforeExpr:P}),_finally:N("finally"),_function:N("function",{startsExpr:k}),_if:N("if"),_return:N("return",{beforeExpr:P}),_switch:N("switch"),_throw:N("throw",{beforeExpr:P,prefix:A,startsExpr:k}),_try:N("try"),_var:N("var"),_const:N("const"),_with:N("with"),_new:N("new",{beforeExpr:P,startsExpr:k}),_this:N("this",{startsExpr:k}),_super:N("super",{startsExpr:k}),_class:N("class",{startsExpr:k}),_extends:N("extends",{beforeExpr:P}),_export:N("export"),_import:N("import",{startsExpr:k}),_null:N("null",{startsExpr:k}),_true:N("true",{startsExpr:k}),_false:N("false",{startsExpr:k}),_typeof:N("typeof",{beforeExpr:P,prefix:A,startsExpr:k}),_void:N("void",{beforeExpr:P,prefix:A,startsExpr:k}),_delete:N("delete",{beforeExpr:P,prefix:A,startsExpr:k}),_do:N("do",{isLoop:C,beforeExpr:P}),_for:N("for",{isLoop:C}),_while:N("while",{isLoop:C}),_as:z("as",{startsExpr:k}),_assert:z("assert",{startsExpr:k}),_async:z("async",{startsExpr:k}),_await:z("await",{startsExpr:k}),_defer:z("defer",{startsExpr:k}),_from:z("from",{startsExpr:k}),_get:z("get",{startsExpr:k}),_let:z("let",{startsExpr:k}),_meta:z("meta",{startsExpr:k}),_of:z("of",{startsExpr:k}),_sent:z("sent",{startsExpr:k}),_set:z("set",{startsExpr:k}),_source:z("source",{startsExpr:k}),_static:z("static",{startsExpr:k}),_using:z("using",{startsExpr:k}),_yield:z("yield",{startsExpr:k}),_asserts:z("asserts",{startsExpr:k}),_checks:z("checks",{startsExpr:k}),_exports:z("exports",{startsExpr:k}),_global:z("global",{startsExpr:k}),_implements:z("implements",{startsExpr:k}),_intrinsic:z("intrinsic",{startsExpr:k}),_infer:z("infer",{startsExpr:k}),_is:z("is",{startsExpr:k}),_mixins:z("mixins",{startsExpr:k}),_proto:z("proto",{startsExpr:k}),_require:z("require",{startsExpr:k}),_satisfies:z("satisfies",{startsExpr:k}),_keyof:z("keyof",{startsExpr:k}),_readonly:z("readonly",{startsExpr:k}),_unique:z("unique",{startsExpr:k}),_abstract:z("abstract",{startsExpr:k}),_declare:z("declare",{startsExpr:k}),_enum:z("enum",{startsExpr:k}),_module:z("module",{startsExpr:k}),_namespace:z("namespace",{startsExpr:k}),_interface:z("interface",{startsExpr:k}),_type:z("type",{startsExpr:k}),_opaque:z("opaque",{startsExpr:k}),name:U("name",{startsExpr:k}),string:U("string",{startsExpr:k}),num:U("num",{startsExpr:k}),bigint:U("bigint",{startsExpr:k}),decimal:U("decimal",{startsExpr:k}),regexp:U("regexp",{startsExpr:k}),privateName:U("#name",{startsExpr:k}),eof:U("eof"),jsxName:U("jsxName"),jsxText:U("jsxText",{beforeExpr:!0}),jsxTagStart:U("jsxTagStart",{startsExpr:!0}),jsxTagEnd:U("jsxTagEnd"),placeholder:U("%%",{startsExpr:!0})};function H(e){return e>=93&&e<=132}function V(e){return e>=58&&e<=132}function $(e){return e>=58&&e<=136}function W(e){return B[e]}function K(e){return e>=129&&e<=131}function G(e){return e>=58&&e<=92}function Y(e){return M[e]}function J(e){return R[e]}function X(e){return e>=24&&e<=25}function Z(e){return O[e]}O[8].updateContext=e=>{e.pop()},O[5].updateContext=O[7].updateContext=O[23].updateContext=e=>{e.push(T.brace)},O[22].updateContext=e=>{e[e.length-1]===T.template?e.pop():e.push(T.template)},O[142].updateContext=e=>{e.push(T.j_expr,T.j_oTag)};let Q="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙՠ-ֈא-תׯ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࡠ-ࡪࡰ-ࢇࢉ-ࢎࢠ-ࣉऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱৼਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౝౠౡಀಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೝೞೠೡೱೲഄ-ഌഎ-ഐഒ-ഺഽൎൔ-ൖൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄຆ-ຊຌ-ຣລວ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛸᜀ-ᜑᜟ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡸᢀ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭌᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᲀ-ᲈᲐ-ᲺᲽ-Ჿᳩ-ᳬᳮ-ᳳᳵᳶᳺᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕ℘-ℝℤΩℨK-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞ々-〇〡-〩〱-〵〸-〼ぁ-ゖ゛-ゟァ-ヺー-ヿㄅ-ㄯㄱ-ㆎㆠ-ㆿㇰ-ㇿ㐀-䶿一-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꟊꟐꟑꟓꟕ-ꟙꟲ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꣾꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭩꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",ee="‌‍·̀-ͯ·҃-֑҇-ׇֽֿׁׂׅׄؐ-ًؚ-٩ٰۖ-ۜ۟-۪ۤۧۨ-ۭ۰-۹ܑܰ-݊ަ-ް߀-߉߫-߽߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛࢘-࢟࣊-ࣣ࣡-ःऺ-़ा-ॏ॑-ॗॢॣ०-९ঁ-ঃ়া-ৄেৈো-্ৗৢৣ০-৯৾ਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢૣ૦-૯ૺ-૿ଁ-ଃ଼ା-ୄେୈୋ-୍୕-ୗୢୣ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఀ-ఄ఼ా-ౄె-ైొ-్ౕౖౢౣ౦-౯ಁ-ಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢೣ೦-೯ೳഀ-ഃ഻഼ാ-ൄെ-ൈൊ-്ൗൢൣ൦-൯ඁ-ඃ්ා-ුූෘ-ෟ෦-෯ෲෳัิ-ฺ็-๎๐-๙ັິ-ຼ່-໎໐-໙༘༙༠-༩༹༵༷༾༿ཱ-྄྆྇ྍ-ྗྙ-ྼ࿆ါ-ှ၀-၉ၖ-ၙၞ-ၠၢ-ၤၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟፩-፱ᜒ-᜕ᜲ-᜴ᝒᝓᝲᝳ឴-៓៝០-៩᠋-᠍᠏-᠙ᢩᤠ-ᤫᤰ-᤻᥆-᥏᧐-᧚ᨗ-ᨛᩕ-ᩞ᩠-᩿᩼-᪉᪐-᪙᪰-᪽ᪿ-ᫎᬀ-ᬄ᬴-᭄᭐-᭙᭫-᭳ᮀ-ᮂᮡ-ᮭ᮰-᮹᯦-᯳ᰤ-᰷᱀-᱉᱐-᱙᳐-᳔᳒-᳨᳭᳴᳷-᳹᷀-᷿‌‍‿⁀⁔⃐-⃥⃜⃡-⃰⳯-⵿⳱ⷠ-〪ⷿ-゙゚〯・꘠-꘩꙯ꙴ-꙽ꚞꚟ꛰꛱ꠂ꠆ꠋꠣ-ꠧ꠬ꢀꢁꢴ-ꣅ꣐-꣙꣠-꣱ꣿ-꤉ꤦ-꤭ꥇ-꥓ꦀ-ꦃ꦳-꧀꧐-꧙ꧥ꧰-꧹ꨩ-ꨶꩃꩌꩍ꩐-꩙ꩻ-ꩽꪰꪲ-ꪴꪷꪸꪾ꪿꫁ꫫ-ꫯꫵ꫶ꯣ-ꯪ꯬꯭꯰-꯹ﬞ︀-️︠-︯︳︴﹍-﹏０-９＿･";const te=new RegExp("["+Q+"]"),se=new RegExp("["+Q+ee+"]");Q=ee=null;const ie=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,13,10,2,14,2,6,2,1,2,10,2,14,2,6,2,1,68,310,10,21,11,7,25,5,2,41,2,8,70,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,349,41,7,1,79,28,11,0,9,21,43,17,47,20,28,22,13,52,58,1,3,0,14,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,20,1,64,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,38,6,186,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,19,72,264,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,16,0,2,12,2,33,125,0,80,921,103,110,18,195,2637,96,16,1071,18,5,4026,582,8634,568,8,30,18,78,18,29,19,47,17,3,32,20,6,18,689,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,43,8,8936,3,2,6,2,1,2,290,16,0,30,2,3,0,15,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,1845,30,7,5,262,61,147,44,11,6,17,0,322,29,19,43,485,27,757,6,2,3,2,1,2,14,2,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42719,33,4153,7,221,3,5761,15,7472,16,621,2467,541,1507,4938,6,4191],ne=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,370,1,81,2,71,10,50,3,123,2,54,14,32,10,3,1,11,3,46,10,8,0,46,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,3,0,158,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,406,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,10,1,2,0,49,6,4,4,14,9,5351,0,7,14,13835,9,87,9,39,4,60,6,26,9,1014,0,2,54,8,3,82,0,12,1,19628,1,4706,45,3,22,543,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,101,0,161,6,10,9,357,0,62,13,499,13,983,6,110,6,6,9,4759,9,787719,239];function re(e,t){let s=65536;for(let i=0,n=t.length;i<n;i+=2){if(s+=t[i],s>e)return!1;if(s+=t[i+1],s>=e)return!0}return!1}function ae(e){return e<65?36===e:e<=90||(e<97?95===e:e<=122||(e<=65535?e>=170&&te.test(String.fromCharCode(e)):re(e,ie)))}function oe(e){return e<48?36===e:e<58||!(e<65)&&(e<=90||(e<97?95===e:e<=122||(e<=65535?e>=170&&se.test(String.fromCharCode(e)):re(e,ie)||re(e,ne))))}const ce=new Set(["break","case","catch","continue","debugger","default","do","else","finally","for","function","if","return","switch","throw","try","var","const","while","with","new","this","super","class","extends","export","import","null","true","false","in","instanceof","typeof","void","delete"]),he=new Set(["implements","interface","let","package","private","protected","public","static","yield"]),le=new Set(["eval","arguments"]);function pe(e,t){return t&&"await"===e||"enum"===e}function ue(e,t){return pe(e,t)||he.has(e)}function de(e){return le.has(e)}function fe(e,t){return ue(e,t)||de(e)}const me=new Set(["break","case","catch","continue","debugger","default","do","else","finally","for","function","if","return","switch","throw","try","var","const","while","with","new","this","super","class","extends","export","import","null","true","false","in","instanceof","typeof","void","delete","implements","interface","let","package","private","protected","public","static","yield","eval","arguments","enum","await"]);class ye{constructor(e){this.flags=0,this.names=new Map,this.firstLexicalName="",this.flags=e}}class ge{constructor(e,t){this.parser=void 0,this.scopeStack=[],this.inModule=void 0,this.undefinedExports=new Map,this.parser=e,this.inModule=t}get inTopLevel(){return(1&this.currentScope().flags)>0}get inFunction(){return(2&this.currentVarScopeFlags())>0}get allowSuper(){return(16&this.currentThisScopeFlags())>0}get allowDirectSuper(){return(32&this.currentThisScopeFlags())>0}get inClass(){return(64&this.currentThisScopeFlags())>0}get inClassAndNotInNonArrowFunction(){const e=this.currentThisScopeFlags();return(64&e)>0&&0==(2&e)}get inStaticBlock(){for(let e=this.scopeStack.length-1;;e--){const{flags:t}=this.scopeStack[e];if(128&t)return!0;if(451&t)return!1}}get inNonArrowFunction(){return(2&this.currentThisScopeFlags())>0}get treatFunctionsAsVar(){return this.treatFunctionsAsVarInScope(this.currentScope())}createScope(e){return new ye(e)}enter(e){this.scopeStack.push(this.createScope(e))}exit(){return this.scopeStack.pop().flags}treatFunctionsAsVarInScope(e){return!!(130&e.flags||!this.parser.inModule&&1&e.flags)}declareName(e,t,s){let i=this.currentScope();if(8&t||16&t){this.checkRedeclarationInScope(i,e,t,s);let n=i.names.get(e)||0;16&t?n|=4:(i.firstLexicalName||(i.firstLexicalName=e),n|=2),i.names.set(e,n),8&t&&this.maybeExportDefined(i,e)}else if(4&t)for(let n=this.scopeStack.length-1;n>=0&&(i=this.scopeStack[n],this.checkRedeclarationInScope(i,e,t,s),i.names.set(e,1|(i.names.get(e)||0)),this.maybeExportDefined(i,e),!(387&i.flags));--n);this.parser.inModule&&1&i.flags&&this.undefinedExports.delete(e)}maybeExportDefined(e,t){this.parser.inModule&&1&e.flags&&this.undefinedExports.delete(t)}checkRedeclarationInScope(e,t,s,i){this.isRedeclaredInScope(e,t,s)&&this.parser.raise(b.VarRedeclaration,i,{identifierName:t})}isRedeclaredInScope(e,t,s){if(!(1&s))return!1;if(8&s)return e.names.has(t);const i=e.names.get(t);return 16&s?(2&i)>0||!this.treatFunctionsAsVarInScope(e)&&(1&i)>0:(2&i)>0&&!(8&e.flags&&e.firstLexicalName===t)||!this.treatFunctionsAsVarInScope(e)&&(4&i)>0}checkLocalExport(e){const{name:t}=e;this.scopeStack[0].names.has(t)||this.undefinedExports.set(t,e.loc.start)}currentScope(){return this.scopeStack[this.scopeStack.length-1]}currentVarScopeFlags(){for(let e=this.scopeStack.length-1;;e--){const{flags:t}=this.scopeStack[e];if(387&t)return t}}currentThisScopeFlags(){for(let e=this.scopeStack.length-1;;e--){const{flags:t}=this.scopeStack[e];if(451&t&&!(4&t))return t}}}class be extends ye{constructor(...e){super(...e),this.declareFunctions=new Set}}class we extends ge{createScope(e){return new be(e)}declareName(e,t,s){const i=this.currentScope();if(2048&t)return this.checkRedeclarationInScope(i,e,t,s),this.maybeExportDefined(i,e),void i.declareFunctions.add(e);super.declareName(e,t,s)}isRedeclaredInScope(e,t,s){if(super.isRedeclaredInScope(e,t,s))return!0;if(2048&s&&!e.declareFunctions.has(t)){const s=e.names.get(t);return(4&s)>0||(2&s)>0}return!1}checkLocalExport(e){this.scopeStack[0].declareFunctions.has(e.name)||super.checkLocalExport(e)}}class _e{constructor(){this.sawUnambiguousESM=!1,this.ambiguousScriptDifferentAst=!1}hasPlugin(e){if("string"==typeof e)return this.plugins.has(e);{const[t,s]=e;if(!this.hasPlugin(t))return!1;const i=this.plugins.get(t);for(const e of Object.keys(s))if((null==i?void 0:i[e])!==s[e])return!1;return!0}}getPluginOption(e,t){var s;return null==(s=this.plugins.get(e))?void 0:s[t]}}function xe(e,t){void 0===e.trailingComments?e.trailingComments=t:e.trailingComments.unshift(...t)}function ve(e,t){void 0===e.innerComments?e.innerComments=t:e.innerComments.unshift(...t)}function Te(e,t,s){let i=null,n=t.length;for(;null===i&&n>0;)i=t[--n];null===i||i.start>s.start?ve(e,s.comments):xe(i,s.comments)}class Pe extends _e{addComment(e){this.filename&&(e.loc.filename=this.filename);const{commentsLen:t}=this.state;this.comments.length!==t&&(this.comments.length=t),this.comments.push(e),this.state.commentsLen++}processComment(e){const{commentStack:t}=this.state,s=t.length;if(0===s)return;let i=s-1;const n=t[i];n.start===e.end&&(n.leadingNode=e,i--);const{start:r}=e;for(;i>=0;i--){const s=t[i],n=s.end;if(!(n>r)){n===r&&(s.trailingNode=e);break}s.containingNode=e,this.finalizeComment(s),t.splice(i,1)}}finalizeComment(e){const{comments:t}=e;if(null!==e.leadingNode||null!==e.trailingNode)null!==e.leadingNode&&xe(e.leadingNode,t),null!==e.trailingNode&&function(e,t){void 0===e.leadingComments?e.leadingComments=t:e.leadingComments.unshift(...t)}(e.trailingNode,t);else{const{containingNode:s,start:i}=e;if(44===this.input.charCodeAt(i-1))switch(s.type){case"ObjectExpression":case"ObjectPattern":case"RecordExpression":Te(s,s.properties,e);break;case"CallExpression":case"OptionalCallExpression":Te(s,s.arguments,e);break;case"FunctionDeclaration":case"FunctionExpression":case"ArrowFunctionExpression":case"ObjectMethod":case"ClassMethod":case"ClassPrivateMethod":Te(s,s.params,e);break;case"ArrayExpression":case"ArrayPattern":case"TupleExpression":Te(s,s.elements,e);break;case"ExportNamedDeclaration":case"ImportDeclaration":Te(s,s.specifiers,e);break;default:ve(s,t)}else ve(s,t)}}finalizeRemainingComments(){const{commentStack:e}=this.state;for(let t=e.length-1;t>=0;t--)this.finalizeComment(e[t]);this.state.commentStack=[]}resetPreviousNodeTrailingComments(e){const{commentStack:t}=this.state,{length:s}=t;if(0===s)return;const i=t[s-1];i.leadingNode===e&&(i.leadingNode=null)}resetPreviousIdentifierLeadingComments(e){const{commentStack:t}=this.state,{length:s}=t;0!==s&&(t[s-1].trailingNode===e?t[s-1].trailingNode=null:s>=2&&t[s-2].trailingNode===e&&(t[s-2].trailingNode=null))}takeSurroundingComments(e,t,s){const{commentStack:i}=this.state,n=i.length;if(0===n)return;let r=n-1;for(;r>=0;r--){const n=i[r],a=n.end;if(n.start===s)n.leadingNode=e;else if(a===t)n.trailingNode=e;else if(a<t)break}}}const ke=/\r\n?|[\n\u2028\u2029]/,Ce=new RegExp(ke.source,"g");function Ee(e){switch(e){case 10:case 13:case 8232:case 8233:return!0;default:return!1}}const Ae=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,Se=/(?:[^\S\n\r\u2028\u2029]|\/\/.*|\/\*.*?\*\/)*/g,Ie=new RegExp("(?=("+Se.source+"))\\1"+/(?=[\n\r\u2028\u2029]|\/\*(?!.*?\*\/)|$)/.source,"y");function Ne(e){switch(e){case 9:case 11:case 12:case 32:case 160:case 5760:case 8192:case 8193:case 8194:case 8195:case 8196:case 8197:case 8198:case 8199:case 8200:case 8201:case 8202:case 8239:case 8287:case 12288:case 65279:return!0;default:return!1}}class Le{constructor(){this.flags=1024,this.curLine=void 0,this.lineStart=void 0,this.startLoc=void 0,this.endLoc=void 0,this.errors=[],this.potentialArrowAt=-1,this.noArrowAt=[],this.noArrowParamsConversionAt=[],this.topicContext={maxNumOfResolvableTopics:0,maxTopicIndex:null},this.labels=[],this.commentsLen=0,this.commentStack=[],this.pos=0,this.type=139,this.value=null,this.start=0,this.end=0,this.lastTokEndLoc=null,this.lastTokStartLoc=null,this.context=[T.brace],this.firstInvalidTemplateEscapePos=null,this.strictErrors=new Map,this.tokensLength=0}get strict(){return(1&this.flags)>0}set strict(e){e?this.flags|=1:this.flags&=-2}init({strictMode:e,sourceType:t,startLine:s,startColumn:n}){this.strict=!1!==e&&(!0===e||"module"===t),this.curLine=s,this.lineStart=-n,this.startLoc=this.endLoc=new i(s,n,0)}get maybeInArrowParameters(){return(2&this.flags)>0}set maybeInArrowParameters(e){e?this.flags|=2:this.flags&=-3}get inType(){return(4&this.flags)>0}set inType(e){e?this.flags|=4:this.flags&=-5}get noAnonFunctionType(){return(8&this.flags)>0}set noAnonFunctionType(e){e?this.flags|=8:this.flags&=-9}get hasFlowComment(){return(16&this.flags)>0}set hasFlowComment(e){e?this.flags|=16:this.flags&=-17}get isAmbientContext(){return(32&this.flags)>0}set isAmbientContext(e){e?this.flags|=32:this.flags&=-33}get inAbstractClass(){return(64&this.flags)>0}set inAbstractClass(e){e?this.flags|=64:this.flags&=-65}get inDisallowConditionalTypesContext(){return(128&this.flags)>0}set inDisallowConditionalTypesContext(e){e?this.flags|=128:this.flags&=-129}get soloAwait(){return(256&this.flags)>0}set soloAwait(e){e?this.flags|=256:this.flags&=-257}get inFSharpPipelineDirectBody(){return(512&this.flags)>0}set inFSharpPipelineDirectBody(e){e?this.flags|=512:this.flags&=-513}get canStartJSXElement(){return(1024&this.flags)>0}set canStartJSXElement(e){e?this.flags|=1024:this.flags&=-1025}get containsEsc(){return(2048&this.flags)>0}set containsEsc(e){e?this.flags|=2048:this.flags&=-2049}curPosition(){return new i(this.curLine,this.pos-this.lineStart,this.pos)}clone(){const e=new Le;return e.flags=this.flags,e.curLine=this.curLine,e.lineStart=this.lineStart,e.startLoc=this.startLoc,e.endLoc=this.endLoc,e.errors=this.errors.slice(),e.potentialArrowAt=this.potentialArrowAt,e.noArrowAt=this.noArrowAt.slice(),e.noArrowParamsConversionAt=this.noArrowParamsConversionAt.slice(),e.topicContext=this.topicContext,e.labels=this.labels.slice(),e.commentsLen=this.commentsLen,e.commentStack=this.commentStack.slice(),e.pos=this.pos,e.type=this.type,e.value=this.value,e.start=this.start,e.end=this.end,e.lastTokEndLoc=this.lastTokEndLoc,e.lastTokStartLoc=this.lastTokStartLoc,e.context=this.context.slice(),e.firstInvalidTemplateEscapePos=this.firstInvalidTemplateEscapePos,e.strictErrors=this.strictErrors,e.tokensLength=this.tokensLength,e}}var De=function(e){return e>=48&&e<=57};const Oe={decBinOct:new Set([46,66,69,79,95,98,101,111]),hex:new Set([46,88,95,120])},Me={bin:e=>48===e||49===e,oct:e=>e>=48&&e<=55,dec:e=>e>=48&&e<=57,hex:e=>e>=48&&e<=57||e>=65&&e<=70||e>=97&&e<=102};function Re(e,t,s,i,n,r){const a=s,o=i,c=n;let h="",l=null,p=s;const{length:u}=t;for(;;){if(s>=u){r.unterminated(a,o,c),h+=t.slice(p,s);break}const d=t.charCodeAt(s);if(Fe(e,d,t,s)){h+=t.slice(p,s);break}if(92===d){h+=t.slice(p,s);const a=Be(t,s,i,n,"template"===e,r);null!==a.ch||l?h+=a.ch:l={pos:s,lineStart:i,curLine:n},({pos:s,lineStart:i,curLine:n}=a),p=s}else 8232===d||8233===d?(++n,i=++s):10===d||13===d?"template"===e?(h+=t.slice(p,s)+"\n",++s,13===d&&10===t.charCodeAt(s)&&++s,++n,p=i=s):r.unterminated(a,o,c):++s}return{pos:s,str:h,firstInvalidLoc:l,lineStart:i,curLine:n,containsInvalid:!!l}}function Fe(e,t,s,i){return"template"===e?96===t||36===t&&123===s.charCodeAt(i+1):t===("double"===e?34:39)}function Be(e,t,s,i,n,r){const a=!n;t++;const o=e=>({pos:t,ch:e,lineStart:s,curLine:i}),c=e.charCodeAt(t++);switch(c){case 110:return o("\n");case 114:return o("\r");case 120:{let n;return({code:n,pos:t}=je(e,t,s,i,2,!1,a,r)),o(null===n?null:String.fromCharCode(n))}case 117:{let n;return({code:n,pos:t}=ze(e,t,s,i,a,r)),o(null===n?null:String.fromCodePoint(n))}case 116:return o("\t");case 98:return o("\b");case 118:return o("\v");case 102:return o("\f");case 13:10===e.charCodeAt(t)&&++t;case 10:s=t,++i;case 8232:case 8233:return o("");case 56:case 57:if(n)return o(null);r.strictNumericEscape(t-1,s,i);default:if(c>=48&&c<=55){const a=t-1;let c=e.slice(a,t+2).match(/^[0-7]+/)[0],h=parseInt(c,8);h>255&&(c=c.slice(0,-1),h=parseInt(c,8)),t+=c.length-1;const l=e.charCodeAt(t);if("0"!==c||56===l||57===l){if(n)return o(null);r.strictNumericEscape(a,s,i)}return o(String.fromCharCode(h))}return o(String.fromCharCode(c))}}function je(e,t,s,i,n,r,a,o){const c=t;let h;return({n:h,pos:t}=Ue(e,t,s,i,16,n,r,!1,o,!a)),null===h&&(a?o.invalidEscapeSequence(c,s,i):t=c-1),{code:h,pos:t}}function Ue(e,t,s,i,n,r,a,o,c,h){const l=t,p=16===n?Oe.hex:Oe.decBinOct,u=16===n?Me.hex:10===n?Me.dec:8===n?Me.oct:Me.bin;let d=!1,f=0;for(let l=0,m=null==r?1/0:r;l<m;++l){const r=e.charCodeAt(t);let l;if(95!==r||"bail"===o){if(l=r>=97?r-97+10:r>=65?r-65+10:De(r)?r-48:1/0,l>=n){if(l<=9&&h)return{n:null,pos:t};if(l<=9&&c.invalidDigit(t,s,i,n))l=0;else{if(!a)break;l=0,d=!0}}++t,f=f*n+l}else{const n=e.charCodeAt(t-1),r=e.charCodeAt(t+1);if(o){if(Number.isNaN(r)||!u(r)||p.has(n)||p.has(r)){if(h)return{n:null,pos:t};c.unexpectedNumericSeparator(t,s,i)}}else{if(h)return{n:null,pos:t};c.numericSeparatorInEscapeSequence(t,s,i)}++t}}return t===l||null!=r&&t-l!==r||d?{n:null,pos:t}:{n:f,pos:t}}function ze(e,t,s,i,n,r){let a;if(123===e.charCodeAt(t)){if(++t,({code:a,pos:t}=je(e,t,s,i,e.indexOf("}",t)-t,!0,n,r)),++t,null!==a&&a>1114111){if(!n)return{code:null,pos:t};r.invalidCodePoint(t,s,i)}}else({code:a,pos:t}=je(e,t,s,i,4,!1,n,r));return{code:a,pos:t}}function qe(e,t,s){return new i(s,e-t,e)}const He=new Set([103,109,115,105,121,117,100,118]);class Ve{constructor(e){this.type=e.type,this.value=e.value,this.start=e.start,this.end=e.end,this.loc=new n(e.startLoc,e.endLoc)}}class $e extends Pe{constructor(e,t){super(),this.isLookahead=void 0,this.tokens=[],this.errorHandlers_readInt={invalidDigit:(e,t,s,i)=>!!this.options.errorRecovery&&(this.raise(b.InvalidDigit,qe(e,t,s),{radix:i}),!0),numericSeparatorInEscapeSequence:this.errorBuilder(b.NumericSeparatorInEscapeSequence),unexpectedNumericSeparator:this.errorBuilder(b.UnexpectedNumericSeparator)},this.errorHandlers_readCodePoint=Object.assign({},this.errorHandlers_readInt,{invalidEscapeSequence:this.errorBuilder(b.InvalidEscapeSequence),invalidCodePoint:this.errorBuilder(b.InvalidCodePoint)}),this.errorHandlers_readStringContents_string=Object.assign({},this.errorHandlers_readCodePoint,{strictNumericEscape:(e,t,s)=>{this.recordStrictModeErrors(b.StrictNumericEscape,qe(e,t,s))},unterminated:(e,t,s)=>{throw this.raise(b.UnterminatedString,qe(e-1,t,s))}}),this.errorHandlers_readStringContents_template=Object.assign({},this.errorHandlers_readCodePoint,{strictNumericEscape:this.errorBuilder(b.StrictNumericEscape),unterminated:(e,t,s)=>{throw this.raise(b.UnterminatedTemplate,qe(e,t,s))}}),this.state=new Le,this.state.init(e),this.input=t,this.length=t.length,this.comments=[],this.isLookahead=!1}pushToken(e){this.tokens.length=this.state.tokensLength,this.tokens.push(e),++this.state.tokensLength}next(){this.checkKeywordEscapes(),this.options.tokens&&this.pushToken(new Ve(this.state)),this.state.lastTokEndLoc=this.state.endLoc,this.state.lastTokStartLoc=this.state.startLoc,this.nextToken()}eat(e){return!!this.match(e)&&(this.next(),!0)}match(e){return this.state.type===e}createLookaheadState(e){return{pos:e.pos,value:null,type:e.type,start:e.start,end:e.end,context:[this.curContext()],inType:e.inType,startLoc:e.startLoc,lastTokEndLoc:e.lastTokEndLoc,curLine:e.curLine,lineStart:e.lineStart,curPosition:e.curPosition}}lookahead(){const e=this.state;this.state=this.createLookaheadState(e),this.isLookahead=!0,this.nextToken(),this.isLookahead=!1;const t=this.state;return this.state=e,t}nextTokenStart(){return this.nextTokenStartSince(this.state.pos)}nextTokenStartSince(e){return Ae.lastIndex=e,Ae.test(this.input)?Ae.lastIndex:e}lookaheadCharCode(){return this.input.charCodeAt(this.nextTokenStart())}nextTokenInLineStart(){return this.nextTokenInLineStartSince(this.state.pos)}nextTokenInLineStartSince(e){return Se.lastIndex=e,Se.test(this.input)?Se.lastIndex:e}lookaheadInLineCharCode(){return this.input.charCodeAt(this.nextTokenInLineStart())}codePointAtPos(e){let t=this.input.charCodeAt(e);if(55296==(64512&t)&&++e<this.input.length){const s=this.input.charCodeAt(e);56320==(64512&s)&&(t=65536+((1023&t)<<10)+(1023&s))}return t}setStrict(e){this.state.strict=e,e&&(this.state.strictErrors.forEach((([e,t])=>this.raise(e,t))),this.state.strictErrors.clear())}curContext(){return this.state.context[this.state.context.length-1]}nextToken(){this.skipSpace(),this.state.start=this.state.pos,this.isLookahead||(this.state.startLoc=this.state.curPosition()),this.state.pos>=this.length?this.finishToken(139):this.getTokenFromCode(this.codePointAtPos(this.state.pos))}skipBlockComment(e){let t;this.isLookahead||(t=this.state.curPosition());const s=this.state.pos,i=this.input.indexOf(e,s+2);if(-1===i)throw this.raise(b.UnterminatedComment,this.state.curPosition());for(this.state.pos=i+e.length,Ce.lastIndex=s+2;Ce.test(this.input)&&Ce.lastIndex<=i;)++this.state.curLine,this.state.lineStart=Ce.lastIndex;if(this.isLookahead)return;const r={type:"CommentBlock",value:this.input.slice(s+2,i),start:s,end:i+e.length,loc:new n(t,this.state.curPosition())};return this.options.tokens&&this.pushToken(r),r}skipLineComment(e){const t=this.state.pos;let s;this.isLookahead||(s=this.state.curPosition());let i=this.input.charCodeAt(this.state.pos+=e);if(this.state.pos<this.length)for(;!Ee(i)&&++this.state.pos<this.length;)i=this.input.charCodeAt(this.state.pos);if(this.isLookahead)return;const r=this.state.pos,a={type:"CommentLine",value:this.input.slice(t+e,r),start:t,end:r,loc:new n(s,this.state.curPosition())};return this.options.tokens&&this.pushToken(a),a}skipSpace(){const e=this.state.pos,t=[];e:for(;this.state.pos<this.length;){const s=this.input.charCodeAt(this.state.pos);switch(s){case 32:case 160:case 9:++this.state.pos;break;case 13:10===this.input.charCodeAt(this.state.pos+1)&&++this.state.pos;case 10:case 8232:case 8233:++this.state.pos,++this.state.curLine,this.state.lineStart=this.state.pos;break;case 47:switch(this.input.charCodeAt(this.state.pos+1)){case 42:{const e=this.skipBlockComment("*/");void 0!==e&&(this.addComment(e),this.options.attachComment&&t.push(e));break}case 47:{const e=this.skipLineComment(2);void 0!==e&&(this.addComment(e),this.options.attachComment&&t.push(e));break}default:break e}break;default:if(Ne(s))++this.state.pos;else if(45===s&&!this.inModule&&this.options.annexB){const s=this.state.pos;if(45!==this.input.charCodeAt(s+1)||62!==this.input.charCodeAt(s+2)||!(0===e||this.state.lineStart>e))break e;{const e=this.skipLineComment(3);void 0!==e&&(this.addComment(e),this.options.attachComment&&t.push(e))}}else{if(60!==s||this.inModule||!this.options.annexB)break e;{const e=this.state.pos;if(33!==this.input.charCodeAt(e+1)||45!==this.input.charCodeAt(e+2)||45!==this.input.charCodeAt(e+3))break e;{const e=this.skipLineComment(4);void 0!==e&&(this.addComment(e),this.options.attachComment&&t.push(e))}}}}}if(t.length>0){const s={start:e,end:this.state.pos,comments:t,leadingNode:null,trailingNode:null,containingNode:null};this.state.commentStack.push(s)}}finishToken(e,t){this.state.end=this.state.pos,this.state.endLoc=this.state.curPosition();const s=this.state.type;this.state.type=e,this.state.value=t,this.isLookahead||this.updateContext(s)}replaceToken(e){this.state.type=e,this.updateContext()}readToken_numberSign(){if(0===this.state.pos&&this.readToken_interpreter())return;const e=this.state.pos+1,t=this.codePointAtPos(e);if(t>=48&&t<=57)throw this.raise(b.UnexpectedDigitAfterHash,this.state.curPosition());if(123===t||91===t&&this.hasPlugin("recordAndTuple")){if(this.expectPlugin("recordAndTuple"),"bar"===this.getPluginOption("recordAndTuple","syntaxType"))throw this.raise(123===t?b.RecordExpressionHashIncorrectStartSyntaxType:b.TupleExpressionHashIncorrectStartSyntaxType,this.state.curPosition());this.state.pos+=2,123===t?this.finishToken(7):this.finishToken(1)}else ae(t)?(++this.state.pos,this.finishToken(138,this.readWord1(t))):92===t?(++this.state.pos,this.finishToken(138,this.readWord1())):this.finishOp(27,1)}readToken_dot(){const e=this.input.charCodeAt(this.state.pos+1);e>=48&&e<=57?this.readNumber(!0):46===e&&46===this.input.charCodeAt(this.state.pos+2)?(this.state.pos+=3,this.finishToken(21)):(++this.state.pos,this.finishToken(16))}readToken_slash(){61===this.input.charCodeAt(this.state.pos+1)?this.finishOp(31,2):this.finishOp(56,1)}readToken_interpreter(){if(0!==this.state.pos||this.length<2)return!1;let e=this.input.charCodeAt(this.state.pos+1);if(33!==e)return!1;const t=this.state.pos;for(this.state.pos+=1;!Ee(e)&&++this.state.pos<this.length;)e=this.input.charCodeAt(this.state.pos);const s=this.input.slice(t+2,this.state.pos);return this.finishToken(28,s),!0}readToken_mult_modulo(e){let t=42===e?55:54,s=1,i=this.input.charCodeAt(this.state.pos+1);42===e&&42===i&&(s++,i=this.input.charCodeAt(this.state.pos+2),t=57),61!==i||this.state.inType||(s++,t=37===e?33:30),this.finishOp(t,s)}readToken_pipe_amp(e){const t=this.input.charCodeAt(this.state.pos+1);if(t!==e){if(124===e){if(62===t)return void this.finishOp(39,2);if(this.hasPlugin("recordAndTuple")&&125===t){if("bar"!==this.getPluginOption("recordAndTuple","syntaxType"))throw this.raise(b.RecordExpressionBarIncorrectEndSyntaxType,this.state.curPosition());return this.state.pos+=2,void this.finishToken(9)}if(this.hasPlugin("recordAndTuple")&&93===t){if("bar"!==this.getPluginOption("recordAndTuple","syntaxType"))throw this.raise(b.TupleExpressionBarIncorrectEndSyntaxType,this.state.curPosition());return this.state.pos+=2,void this.finishToken(4)}}61!==t?this.finishOp(124===e?43:45,1):this.finishOp(30,2)}else 61===this.input.charCodeAt(this.state.pos+2)?this.finishOp(30,3):this.finishOp(124===e?41:42,2)}readToken_caret(){const e=this.input.charCodeAt(this.state.pos+1);61!==e||this.state.inType?94===e&&this.hasPlugin(["pipelineOperator",{proposal:"hack",topicToken:"^^"}])?(this.finishOp(37,2),94===this.input.codePointAt(this.state.pos)&&this.unexpected()):this.finishOp(44,1):this.finishOp(32,2)}readToken_atSign(){64===this.input.charCodeAt(this.state.pos+1)&&this.hasPlugin(["pipelineOperator",{proposal:"hack",topicToken:"@@"}])?this.finishOp(38,2):this.finishOp(26,1)}readToken_plus_min(e){const t=this.input.charCodeAt(this.state.pos+1);t!==e?61===t?this.finishOp(30,2):this.finishOp(53,1):this.finishOp(34,2)}readToken_lt(){const{pos:e}=this.state,t=this.input.charCodeAt(e+1);if(60===t)return 61===this.input.charCodeAt(e+2)?void this.finishOp(30,3):void this.finishOp(51,2);61!==t?this.finishOp(47,1):this.finishOp(49,2)}readToken_gt(){const{pos:e}=this.state,t=this.input.charCodeAt(e+1);if(62===t){const t=62===this.input.charCodeAt(e+2)?3:2;return 61===this.input.charCodeAt(e+t)?void this.finishOp(30,t+1):void this.finishOp(52,t)}61!==t?this.finishOp(48,1):this.finishOp(49,2)}readToken_eq_excl(e){const t=this.input.charCodeAt(this.state.pos+1);if(61!==t)return 61===e&&62===t?(this.state.pos+=2,void this.finishToken(19)):void this.finishOp(61===e?29:35,1);this.finishOp(46,61===this.input.charCodeAt(this.state.pos+2)?3:2)}readToken_question(){const e=this.input.charCodeAt(this.state.pos+1),t=this.input.charCodeAt(this.state.pos+2);63===e?61===t?this.finishOp(30,3):this.finishOp(40,2):46!==e||t>=48&&t<=57?(++this.state.pos,this.finishToken(17)):(this.state.pos+=2,this.finishToken(18))}getTokenFromCode(e){switch(e){case 46:return void this.readToken_dot();case 40:return++this.state.pos,void this.finishToken(10);case 41:return++this.state.pos,void this.finishToken(11);case 59:return++this.state.pos,void this.finishToken(13);case 44:return++this.state.pos,void this.finishToken(12);case 91:if(this.hasPlugin("recordAndTuple")&&124===this.input.charCodeAt(this.state.pos+1)){if("bar"!==this.getPluginOption("recordAndTuple","syntaxType"))throw this.raise(b.TupleExpressionBarIncorrectStartSyntaxType,this.state.curPosition());this.state.pos+=2,this.finishToken(2)}else++this.state.pos,this.finishToken(0);return;case 93:return++this.state.pos,void this.finishToken(3);case 123:if(this.hasPlugin("recordAndTuple")&&124===this.input.charCodeAt(this.state.pos+1)){if("bar"!==this.getPluginOption("recordAndTuple","syntaxType"))throw this.raise(b.RecordExpressionBarIncorrectStartSyntaxType,this.state.curPosition());this.state.pos+=2,this.finishToken(6)}else++this.state.pos,this.finishToken(5);return;case 125:return++this.state.pos,void this.finishToken(8);case 58:return void(this.hasPlugin("functionBind")&&58===this.input.charCodeAt(this.state.pos+1)?this.finishOp(15,2):(++this.state.pos,this.finishToken(14)));case 63:return void this.readToken_question();case 96:return void this.readTemplateToken();case 48:{const e=this.input.charCodeAt(this.state.pos+1);if(120===e||88===e)return void this.readRadixNumber(16);if(111===e||79===e)return void this.readRadixNumber(8);if(98===e||66===e)return void this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return void this.readNumber(!1);case 34:case 39:return void this.readString(e);case 47:return void this.readToken_slash();case 37:case 42:return void this.readToken_mult_modulo(e);case 124:case 38:return void this.readToken_pipe_amp(e);case 94:return void this.readToken_caret();case 43:case 45:return void this.readToken_plus_min(e);case 60:return void this.readToken_lt();case 62:return void this.readToken_gt();case 61:case 33:return void this.readToken_eq_excl(e);case 126:return void this.finishOp(36,1);case 64:return void this.readToken_atSign();case 35:return void this.readToken_numberSign();case 92:return void this.readWord();default:if(ae(e))return void this.readWord(e)}throw this.raise(b.InvalidOrUnexpectedToken,this.state.curPosition(),{unexpected:String.fromCodePoint(e)})}finishOp(e,t){const s=this.input.slice(this.state.pos,this.state.pos+t);this.state.pos+=t,this.finishToken(e,s)}readRegexp(){const e=this.state.startLoc,t=this.state.start+1;let s,i,{pos:n}=this.state;for(;;++n){if(n>=this.length)throw this.raise(b.UnterminatedRegExp,r(e,1));const t=this.input.charCodeAt(n);if(Ee(t))throw this.raise(b.UnterminatedRegExp,r(e,1));if(s)s=!1;else{if(91===t)i=!0;else if(93===t&&i)i=!1;else if(47===t&&!i)break;s=92===t}}const a=this.input.slice(t,n);++n;let o="";const c=()=>r(e,n+2-t);for(;n<this.length;){const e=this.codePointAtPos(n),t=String.fromCharCode(e);if(He.has(e))118===e?o.includes("u")&&this.raise(b.IncompatibleRegExpUVFlags,c()):117===e&&o.includes("v")&&this.raise(b.IncompatibleRegExpUVFlags,c()),o.includes(t)&&this.raise(b.DuplicateRegExpFlags,c());else{if(!oe(e)&&92!==e)break;this.raise(b.MalformedRegExpFlags,c())}++n,o+=t}this.state.pos=n,this.finishToken(137,{pattern:a,flags:o})}readInt(e,t,s=!1,i=!0){const{n,pos:r}=Ue(this.input,this.state.pos,this.state.lineStart,this.state.curLine,e,t,s,i,this.errorHandlers_readInt,!1);return this.state.pos=r,n}readRadixNumber(e){const t=this.state.curPosition();let s=!1;this.state.pos+=2;const i=this.readInt(e);null==i&&this.raise(b.InvalidDigit,r(t,2),{radix:e});const n=this.input.charCodeAt(this.state.pos);if(110===n)++this.state.pos,s=!0;else if(109===n)throw this.raise(b.InvalidDecimal,t);if(ae(this.codePointAtPos(this.state.pos)))throw this.raise(b.NumberIdentifier,this.state.curPosition());if(s){const e=this.input.slice(t.index,this.state.pos).replace(/[_n]/g,"");this.finishToken(135,e)}else this.finishToken(134,i)}readNumber(e){const t=this.state.pos,s=this.state.curPosition();let i=!1,n=!1,a=!1,o=!1,c=!1;e||null!==this.readInt(10)||this.raise(b.InvalidNumber,this.state.curPosition());const h=this.state.pos-t>=2&&48===this.input.charCodeAt(t);if(h){const e=this.input.slice(t,this.state.pos);if(this.recordStrictModeErrors(b.StrictOctalLiteral,s),!this.state.strict){const t=e.indexOf("_");t>0&&this.raise(b.ZeroDigitNumericSeparator,r(s,t))}c=h&&!/[89]/.test(e)}let l=this.input.charCodeAt(this.state.pos);if(46!==l||c||(++this.state.pos,this.readInt(10),i=!0,l=this.input.charCodeAt(this.state.pos)),69!==l&&101!==l||c||(l=this.input.charCodeAt(++this.state.pos),43!==l&&45!==l||++this.state.pos,null===this.readInt(10)&&this.raise(b.InvalidOrMissingExponent,s),i=!0,o=!0,l=this.input.charCodeAt(this.state.pos)),110===l&&((i||h)&&this.raise(b.InvalidBigIntLiteral,s),++this.state.pos,n=!0),109===l&&(this.expectPlugin("decimal",this.state.curPosition()),(o||h)&&this.raise(b.InvalidDecimal,s),++this.state.pos,a=!0),ae(this.codePointAtPos(this.state.pos)))throw this.raise(b.NumberIdentifier,this.state.curPosition());const p=this.input.slice(t,this.state.pos).replace(/[_mn]/g,"");if(n)return void this.finishToken(135,p);if(a)return void this.finishToken(136,p);const u=c?parseInt(p,8):parseFloat(p);this.finishToken(134,u)}readCodePoint(e){const{code:t,pos:s}=ze(this.input,this.state.pos,this.state.lineStart,this.state.curLine,e,this.errorHandlers_readCodePoint);return this.state.pos=s,t}readString(e){const{str:t,pos:s,curLine:i,lineStart:n}=Re(34===e?"double":"single",this.input,this.state.pos+1,this.state.lineStart,this.state.curLine,this.errorHandlers_readStringContents_string);this.state.pos=s+1,this.state.lineStart=n,this.state.curLine=i,this.finishToken(133,t)}readTemplateContinuation(){this.match(8)||this.unexpected(null,8),this.state.pos--,this.readTemplateToken()}readTemplateToken(){const e=this.input[this.state.pos],{str:t,firstInvalidLoc:s,pos:n,curLine:r,lineStart:a}=Re("template",this.input,this.state.pos+1,this.state.lineStart,this.state.curLine,this.errorHandlers_readStringContents_template);this.state.pos=n+1,this.state.lineStart=a,this.state.curLine=r,s&&(this.state.firstInvalidTemplateEscapePos=new i(s.curLine,s.pos-s.lineStart,s.pos)),96===this.input.codePointAt(n)?this.finishToken(24,s?null:e+t+"`"):(this.state.pos++,this.finishToken(25,s?null:e+t+"${"))}recordStrictModeErrors(e,t){const s=t.index;this.state.strict&&!this.state.strictErrors.has(s)?this.raise(e,t):this.state.strictErrors.set(s,[e,t])}readWord1(e){this.state.containsEsc=!1;let t="";const s=this.state.pos;let i=this.state.pos;for(void 0!==e&&(this.state.pos+=e<=65535?1:2);this.state.pos<this.length;){const e=this.codePointAtPos(this.state.pos);if(oe(e))this.state.pos+=e<=65535?1:2;else{if(92!==e)break;{this.state.containsEsc=!0,t+=this.input.slice(i,this.state.pos);const e=this.state.curPosition(),n=this.state.pos===s?ae:oe;if(117!==this.input.charCodeAt(++this.state.pos)){this.raise(b.MissingUnicodeEscape,this.state.curPosition()),i=this.state.pos-1;continue}++this.state.pos;const r=this.readCodePoint(!0);null!==r&&(n(r)||this.raise(b.EscapedCharNotAnIdentifier,e),t+=String.fromCodePoint(r)),i=this.state.pos}}}return t+this.input.slice(i,this.state.pos)}readWord(e){const t=this.readWord1(e),s=I.get(t);void 0!==s?this.finishToken(s,Y(s)):this.finishToken(132,t)}checkKeywordEscapes(){const{type:e}=this.state;G(e)&&this.state.containsEsc&&this.raise(b.InvalidEscapedReservedWord,this.state.startLoc,{reservedWord:Y(e)})}raise(e,t,s={}){const n=e(t instanceof i?t:t.loc.start,s);if(!this.options.errorRecovery)throw n;return this.isLookahead||this.state.errors.push(n),n}raiseOverwrite(e,t,s={}){const n=t instanceof i?t:t.loc.start,r=n.index,a=this.state.errors;for(let t=a.length-1;t>=0;t--){const i=a[t];if(i.loc.index===r)return a[t]=e(n,s);if(i.loc.index<r)break}return this.raise(e,t,s)}updateContext(e){}unexpected(e,t){throw this.raise(b.UnexpectedToken,null!=e?e:this.state.startLoc,{expected:t?Y(t):null})}expectPlugin(e,t){if(this.hasPlugin(e))return!0;throw this.raise(b.MissingPlugin,null!=t?t:this.state.startLoc,{missingPlugin:[e]})}expectOnePlugin(e){if(!e.some((e=>this.hasPlugin(e))))throw this.raise(b.MissingOneOfPlugins,this.state.startLoc,{missingPlugin:e})}errorBuilder(e){return(t,s,i)=>{this.raise(e,qe(t,s,i))}}}class We{constructor(){this.privateNames=new Set,this.loneAccessors=new Map,this.undefinedPrivateNames=new Map}}class Ke{constructor(e){this.parser=void 0,this.stack=[],this.undefinedPrivateNames=new Map,this.parser=e}current(){return this.stack[this.stack.length-1]}enter(){this.stack.push(new We)}exit(){const e=this.stack.pop(),t=this.current();for(const[s,i]of Array.from(e.undefinedPrivateNames))t?t.undefinedPrivateNames.has(s)||t.undefinedPrivateNames.set(s,i):this.parser.raise(b.InvalidPrivateFieldResolution,i,{identifierName:s})}declarePrivateName(e,t,s){const{privateNames:i,loneAccessors:n,undefinedPrivateNames:r}=this.current();let a=i.has(e);if(3&t){const s=a&&n.get(e);s?(a=(3&s)==(3&t)||(4&s)!=(4&t),a||n.delete(e)):a||n.set(e,t)}a&&this.parser.raise(b.PrivateNameRedeclaration,s,{identifierName:e}),i.add(e),r.delete(e)}usePrivateName(e,t){let s;for(s of this.stack)if(s.privateNames.has(e))return;s?s.undefinedPrivateNames.set(e,t):this.parser.raise(b.InvalidPrivateFieldResolution,t,{identifierName:e})}}class Ge{constructor(e=0){this.type=e}canBeArrowParameterDeclaration(){return 2===this.type||1===this.type}isCertainlyParameterDeclaration(){return 3===this.type}}class Ye extends Ge{constructor(e){super(e),this.declarationErrors=new Map}recordDeclarationError(e,t){const s=t.index;this.declarationErrors.set(s,[e,t])}clearDeclarationError(e){this.declarationErrors.delete(e)}iterateErrors(e){this.declarationErrors.forEach(e)}}class Je{constructor(e){this.parser=void 0,this.stack=[new Ge],this.parser=e}enter(e){this.stack.push(e)}exit(){this.stack.pop()}recordParameterInitializerError(e,t){const s=t.loc.start,{stack:i}=this;let n=i.length-1,r=i[n];for(;!r.isCertainlyParameterDeclaration();){if(!r.canBeArrowParameterDeclaration())return;r.recordDeclarationError(e,s),r=i[--n]}this.parser.raise(e,s)}recordArrowParameterBindingError(e,t){const{stack:s}=this,i=s[s.length-1],n=t.loc.start;if(i.isCertainlyParameterDeclaration())this.parser.raise(e,n);else{if(!i.canBeArrowParameterDeclaration())return;i.recordDeclarationError(e,n)}}recordAsyncArrowParametersError(e){const{stack:t}=this;let s=t.length-1,i=t[s];for(;i.canBeArrowParameterDeclaration();)2===i.type&&i.recordDeclarationError(b.AwaitBindingIdentifier,e),i=t[--s]}validateAsPattern(){const{stack:e}=this,t=e[e.length-1];t.canBeArrowParameterDeclaration()&&t.iterateErrors((([t,s])=>{this.parser.raise(t,s);let i=e.length-2,n=e[i];for(;n.canBeArrowParameterDeclaration();)n.clearDeclarationError(s.index),n=e[--i]}))}}function Xe(){return new Ge}class Ze{constructor(){this.stacks=[]}enter(e){this.stacks.push(e)}exit(){this.stacks.pop()}currentFlags(){return this.stacks[this.stacks.length-1]}get hasAwait(){return(2&this.currentFlags())>0}get hasYield(){return(1&this.currentFlags())>0}get hasReturn(){return(4&this.currentFlags())>0}get hasIn(){return(8&this.currentFlags())>0}}function Qe(e,t){return(e?2:0)|(t?1:0)}class et extends $e{addExtra(e,t,s,i=!0){if(!e)return;const n=e.extra=e.extra||{};i?n[t]=s:Object.defineProperty(n,t,{enumerable:i,value:s})}isContextual(e){return this.state.type===e&&!this.state.containsEsc}isUnparsedContextual(e,t){const s=e+t.length;if(this.input.slice(e,s)===t){const e=this.input.charCodeAt(s);return!(oe(e)||55296==(64512&e))}return!1}isLookaheadContextual(e){const t=this.nextTokenStart();return this.isUnparsedContextual(t,e)}eatContextual(e){return!!this.isContextual(e)&&(this.next(),!0)}expectContextual(e,t){if(!this.eatContextual(e)){if(null!=t)throw this.raise(t,this.state.startLoc);this.unexpected(null,e)}}canInsertSemicolon(){return this.match(139)||this.match(8)||this.hasPrecedingLineBreak()}hasPrecedingLineBreak(){return ke.test(this.input.slice(this.state.lastTokEndLoc.index,this.state.start))}hasFollowingLineBreak(){return Ie.lastIndex=this.state.end,Ie.test(this.input)}isLineTerminator(){return this.eat(13)||this.canInsertSemicolon()}semicolon(e=!0){(e?this.isLineTerminator():this.eat(13))||this.raise(b.MissingSemicolon,this.state.lastTokEndLoc)}expect(e,t){this.eat(e)||this.unexpected(t,e)}tryParse(e,t=this.state.clone()){const s={node:null};try{const i=e(((e=null)=>{throw s.node=e,s}));if(this.state.errors.length>t.errors.length){const e=this.state;return this.state=t,this.state.tokensLength=e.tokensLength,{node:i,error:e.errors[t.errors.length],thrown:!1,aborted:!1,failState:e}}return{node:i,error:null,thrown:!1,aborted:!1,failState:null}}catch(e){const i=this.state;if(this.state=t,e instanceof SyntaxError)return{node:null,error:e,thrown:!0,aborted:!1,failState:i};if(e===s)return{node:s.node,error:null,thrown:!1,aborted:!0,failState:i};throw e}}checkExpressionErrors(e,t){if(!e)return!1;const{shorthandAssignLoc:s,doubleProtoLoc:i,privateKeyLoc:n,optionalParametersLoc:r}=e;if(!t)return!!(s||i||r||n);null!=s&&this.raise(b.InvalidCoverInitializedName,s),null!=i&&this.raise(b.DuplicateProto,i),null!=n&&this.raise(b.UnexpectedPrivateField,n),null!=r&&this.unexpected(r)}isLiteralPropertyName(){return $(this.state.type)}isPrivateName(e){return"PrivateName"===e.type}getPrivateNameSV(e){return e.id.name}hasPropertyAsPrivateName(e){return("MemberExpression"===e.type||"OptionalMemberExpression"===e.type)&&this.isPrivateName(e.property)}isObjectProperty(e){return"ObjectProperty"===e.type}isObjectMethod(e){return"ObjectMethod"===e.type}initializeScopes(e="module"===this.options.sourceType){const t=this.state.labels;this.state.labels=[];const s=this.exportedIdentifiers;this.exportedIdentifiers=new Set;const i=this.inModule;this.inModule=e;const n=this.scope,r=this.getScopeHandler();this.scope=new r(this,e);const a=this.prodParam;this.prodParam=new Ze;const o=this.classScope;this.classScope=new Ke(this);const c=this.expressionScope;return this.expressionScope=new Je(this),()=>{this.state.labels=t,this.exportedIdentifiers=s,this.inModule=i,this.scope=n,this.prodParam=a,this.classScope=o,this.expressionScope=c}}enterInitialScopes(){let e=0;this.inModule&&(e|=2),this.scope.enter(1),this.prodParam.enter(e)}checkDestructuringPrivate(e){const{privateKeyLoc:t}=e;null!==t&&this.expectPlugin("destructuringPrivate",t)}}class tt{constructor(){this.shorthandAssignLoc=null,this.doubleProtoLoc=null,this.privateKeyLoc=null,this.optionalParametersLoc=null}}class st{constructor(e,t,s){this.type="",this.start=t,this.end=0,this.loc=new n(s),null!=e&&e.options.ranges&&(this.range=[t,0]),null!=e&&e.filename&&(this.loc.filename=e.filename)}}const it=st.prototype;function nt(e){const{type:t,start:s,end:i,loc:n,range:r,extra:a,name:o}=e,c=Object.create(it);return c.type=t,c.start=s,c.end=i,c.loc=n,c.range=r,c.extra=a,c.name=o,"Placeholder"===t&&(c.expectedNode=e.expectedNode),c}it.__clone=function(){const e=new st(void 0,this.start,this.loc.start),t=Object.keys(this);for(let s=0,i=t.length;s<i;s++){const i=t[s];"leadingComments"!==i&&"trailingComments"!==i&&"innerComments"!==i&&(e[i]=this[i])}return e};class rt extends et{startNode(){const e=this.state.startLoc;return new st(this,e.index,e)}startNodeAt(e){return new st(this,e.index,e)}startNodeAtNode(e){return this.startNodeAt(e.loc.start)}finishNode(e,t){return this.finishNodeAt(e,t,this.state.lastTokEndLoc)}finishNodeAt(e,t,s){return e.type=t,e.end=s.index,e.loc.end=s,this.options.ranges&&(e.range[1]=s.index),this.options.attachComment&&this.processComment(e),e}resetStartLocation(e,t){e.start=t.index,e.loc.start=t,this.options.ranges&&(e.range[0]=t.index)}resetEndLocation(e,t=this.state.lastTokEndLoc){e.end=t.index,e.loc.end=t,this.options.ranges&&(e.range[1]=t.index)}resetStartLocationFromNode(e,t){this.resetStartLocation(e,t.loc.start)}}const at=new Set(["_","any","bool","boolean","empty","extends","false","interface","mixed","null","number","static","string","true","typeof","void"]),ot=g`flow`({AmbiguousConditionalArrow:"Ambiguous expression: wrap the arrow functions in parentheses to disambiguate.",AmbiguousDeclareModuleKind:"Found both `declare module.exports` and `declare export` in the same module. Modules can only have 1 since they are either an ES module or they are a CommonJS module.",AssignReservedType:({reservedType:e})=>`Cannot overwrite reserved type ${e}.`,DeclareClassElement:"The `declare` modifier can only appear on class fields.",DeclareClassFieldInitializer:"Initializers are not allowed in fields with the `declare` modifier.",DuplicateDeclareModuleExports:"Duplicate `declare module.exports` statement.",EnumBooleanMemberNotInitialized:({memberName:e,enumName:t})=>`Boolean enum members need to be initialized. Use either \`${e} = true,\` or \`${e} = false,\` in enum \`${t}\`.`,EnumDuplicateMemberName:({memberName:e,enumName:t})=>`Enum member names need to be unique, but the name \`${e}\` has already been used before in enum \`${t}\`.`,EnumInconsistentMemberValues:({enumName:e})=>`Enum \`${e}\` has inconsistent member initializers. Either use no initializers, or consistently use literals (either booleans, numbers, or strings) for all member initializers.`,EnumInvalidExplicitType:({invalidEnumType:e,enumName:t})=>`Enum type \`${e}\` is not valid. Use one of \`boolean\`, \`number\`, \`string\`, or \`symbol\` in enum \`${t}\`.`,EnumInvalidExplicitTypeUnknownSupplied:({enumName:e})=>`Supplied enum type is not valid. Use one of \`boolean\`, \`number\`, \`string\`, or \`symbol\` in enum \`${e}\`.`,EnumInvalidMemberInitializerPrimaryType:({enumName:e,memberName:t,explicitType:s})=>`Enum \`${e}\` has type \`${s}\`, so the initializer of \`${t}\` needs to be a ${s} literal.`,EnumInvalidMemberInitializerSymbolType:({enumName:e,memberName:t})=>`Symbol enum members cannot be initialized. Use \`${t},\` in enum \`${e}\`.`,EnumInvalidMemberInitializerUnknownType:({enumName:e,memberName:t})=>`The enum member initializer for \`${t}\` needs to be a literal (either a boolean, number, or string) in enum \`${e}\`.`,EnumInvalidMemberName:({enumName:e,memberName:t,suggestion:s})=>`Enum member names cannot start with lowercase 'a' through 'z'. Instead of using \`${t}\`, consider using \`${s}\`, in enum \`${e}\`.`,EnumNumberMemberNotInitialized:({enumName:e,memberName:t})=>`Number enum members need to be initialized, e.g. \`${t} = 1\` in enum \`${e}\`.`,EnumStringMemberInconsistentlyInitialized:({enumName:e})=>`String enum members need to consistently either all use initializers, or use no initializers, in enum \`${e}\`.`,GetterMayNotHaveThisParam:"A getter cannot have a `this` parameter.",ImportReflectionHasImportType:"An `import module` declaration can not use `type` or `typeof` keyword.",ImportTypeShorthandOnlyInPureImport:"The `type` and `typeof` keywords on named imports can only be used on regular `import` statements. It cannot be used with `import type` or `import typeof` statements.",InexactInsideExact:"Explicit inexact syntax cannot appear inside an explicit exact object type.",InexactInsideNonObject:"Explicit inexact syntax cannot appear in class or interface definitions.",InexactVariance:"Explicit inexact syntax cannot have variance.",InvalidNonTypeImportInDeclareModule:"Imports within a `declare module` body must always be `import type` or `import typeof`.",MissingTypeParamDefault:"Type parameter declaration needs a default, since a preceding type parameter declaration has a default.",NestedDeclareModule:"`declare module` cannot be used inside another `declare module`.",NestedFlowComment:"Cannot have a flow comment inside another flow comment.",PatternIsOptional:Object.assign({message:"A binding pattern parameter cannot be optional in an implementation signature."},{reasonCode:"OptionalBindingPattern"}),SetterMayNotHaveThisParam:"A setter cannot have a `this` parameter.",SpreadVariance:"Spread properties cannot have variance.",ThisParamAnnotationRequired:"A type annotation is required for the `this` parameter.",ThisParamBannedInConstructor:"Constructors cannot have a `this` parameter; constructors don't bind `this` like other functions.",ThisParamMayNotBeOptional:"The `this` parameter cannot be optional.",ThisParamMustBeFirst:"The `this` parameter must be the first function parameter.",ThisParamNoDefault:"The `this` parameter may not have a default value.",TypeBeforeInitializer:"Type annotations must come before default assignments, e.g. instead of `age = 25: number` use `age: number = 25`.",TypeCastInPattern:"The type cast expression is expected to be wrapped with parenthesis.",UnexpectedExplicitInexactInObject:"Explicit inexact syntax must appear at the end of an inexact object.",UnexpectedReservedType:({reservedType:e})=>`Unexpected reserved type ${e}.`,UnexpectedReservedUnderscore:"`_` is only allowed as a type argument to call or new.",UnexpectedSpaceBetweenModuloChecks:"Spaces between `%` and `checks` are not allowed here.",UnexpectedSpreadType:"Spread operator cannot appear in class or interface definitions.",UnexpectedSubtractionOperand:'Unexpected token, expected "number" or "bigint".',UnexpectedTokenAfterTypeParameter:"Expected an arrow function after this type parameter declaration.",UnexpectedTypeParameterBeforeAsyncArrowFunction:"Type parameters must come after the async keyword, e.g. instead of `<T> async () => {}`, use `async <T>() => {}`.",UnsupportedDeclareExportKind:({unsupportedExportKind:e,suggestion:t})=>`\`declare export ${e}\` is not supported. Use \`${t}\` instead.`,UnsupportedStatementInDeclareModule:"Only declares and type imports are allowed inside declare module.",UnterminatedFlowComment:"Unterminated flow-comment."});function ct(e){return"type"===e.importKind||"typeof"===e.importKind}const ht={const:"declare export var",let:"declare export var",type:"export type",interface:"export interface"},lt=/\*?\s*@((?:no)?flow)\b/,pt={__proto__:null,quot:'"',amp:"&",apos:"'",lt:"<",gt:">",nbsp:" ",iexcl:"¡",cent:"¢",pound:"£",curren:"¤",yen:"¥",brvbar:"¦",sect:"§",uml:"¨",copy:"©",ordf:"ª",laquo:"«",not:"¬",shy:"­",reg:"®",macr:"¯",deg:"°",plusmn:"±",sup2:"²",sup3:"³",acute:"´",micro:"µ",para:"¶",middot:"·",cedil:"¸",sup1:"¹",ordm:"º",raquo:"»",frac14:"¼",frac12:"½",frac34:"¾",iquest:"¿",Agrave:"À",Aacute:"Á",Acirc:"Â",Atilde:"Ã",Auml:"Ä",Aring:"Å",AElig:"Æ",Ccedil:"Ç",Egrave:"È",Eacute:"É",Ecirc:"Ê",Euml:"Ë",Igrave:"Ì",Iacute:"Í",Icirc:"Î",Iuml:"Ï",ETH:"Ð",Ntilde:"Ñ",Ograve:"Ò",Oacute:"Ó",Ocirc:"Ô",Otilde:"Õ",Ouml:"Ö",times:"×",Oslash:"Ø",Ugrave:"Ù",Uacute:"Ú",Ucirc:"Û",Uuml:"Ü",Yacute:"Ý",THORN:"Þ",szlig:"ß",agrave:"à",aacute:"á",acirc:"â",atilde:"ã",auml:"ä",aring:"å",aelig:"æ",ccedil:"ç",egrave:"è",eacute:"é",ecirc:"ê",euml:"ë",igrave:"ì",iacute:"í",icirc:"î",iuml:"ï",eth:"ð",ntilde:"ñ",ograve:"ò",oacute:"ó",ocirc:"ô",otilde:"õ",ouml:"ö",divide:"÷",oslash:"ø",ugrave:"ù",uacute:"ú",ucirc:"û",uuml:"ü",yacute:"ý",thorn:"þ",yuml:"ÿ",OElig:"Œ",oelig:"œ",Scaron:"Š",scaron:"š",Yuml:"Ÿ",fnof:"ƒ",circ:"ˆ",tilde:"˜",Alpha:"Α",Beta:"Β",Gamma:"Γ",Delta:"Δ",Epsilon:"Ε",Zeta:"Ζ",Eta:"Η",Theta:"Θ",Iota:"Ι",Kappa:"Κ",Lambda:"Λ",Mu:"Μ",Nu:"Ν",Xi:"Ξ",Omicron:"Ο",Pi:"Π",Rho:"Ρ",Sigma:"Σ",Tau:"Τ",Upsilon:"Υ",Phi:"Φ",Chi:"Χ",Psi:"Ψ",Omega:"Ω",alpha:"α",beta:"β",gamma:"γ",delta:"δ",epsilon:"ε",zeta:"ζ",eta:"η",theta:"θ",iota:"ι",kappa:"κ",lambda:"λ",mu:"μ",nu:"ν",xi:"ξ",omicron:"ο",pi:"π",rho:"ρ",sigmaf:"ς",sigma:"σ",tau:"τ",upsilon:"υ",phi:"φ",chi:"χ",psi:"ψ",omega:"ω",thetasym:"ϑ",upsih:"ϒ",piv:"ϖ",ensp:" ",emsp:" ",thinsp:" ",zwnj:"‌",zwj:"‍",lrm:"‎",rlm:"‏",ndash:"–",mdash:"—",lsquo:"‘",rsquo:"’",sbquo:"‚",ldquo:"“",rdquo:"”",bdquo:"„",dagger:"†",Dagger:"‡",bull:"•",hellip:"…",permil:"‰",prime:"′",Prime:"″",lsaquo:"‹",rsaquo:"›",oline:"‾",frasl:"⁄",euro:"€",image:"ℑ",weierp:"℘",real:"ℜ",trade:"™",alefsym:"ℵ",larr:"←",uarr:"↑",rarr:"→",darr:"↓",harr:"↔",crarr:"↵",lArr:"⇐",uArr:"⇑",rArr:"⇒",dArr:"⇓",hArr:"⇔",forall:"∀",part:"∂",exist:"∃",empty:"∅",nabla:"∇",isin:"∈",notin:"∉",ni:"∋",prod:"∏",sum:"∑",minus:"−",lowast:"∗",radic:"√",prop:"∝",infin:"∞",ang:"∠",and:"∧",or:"∨",cap:"∩",cup:"∪",int:"∫",there4:"∴",sim:"∼",cong:"≅",asymp:"≈",ne:"≠",equiv:"≡",le:"≤",ge:"≥",sub:"⊂",sup:"⊃",nsub:"⊄",sube:"⊆",supe:"⊇",oplus:"⊕",otimes:"⊗",perp:"⊥",sdot:"⋅",lceil:"⌈",rceil:"⌉",lfloor:"⌊",rfloor:"⌋",lang:"〈",rang:"〉",loz:"◊",spades:"♠",clubs:"♣",hearts:"♥",diams:"♦"},ut=g`jsx`({AttributeIsEmpty:"JSX attributes must only be assigned a non-empty expression.",MissingClosingTagElement:({openingTagName:e})=>`Expected corresponding JSX closing tag for <${e}>.`,MissingClosingTagFragment:"Expected corresponding JSX closing tag for <>.",UnexpectedSequenceExpression:"Sequence expressions cannot be directly nested inside JSX. Did you mean to wrap it in parentheses (...)?",UnexpectedToken:({unexpected:e,HTMLEntity:t})=>`Unexpected token \`${e}\`. Did you mean \`${t}\` or \`{'${e}'}\`?`,UnsupportedJsxValue:"JSX value should be either an expression or a quoted JSX text.",UnterminatedJsxContent:"Unterminated JSX contents.",UnwrappedAdjacentJSXElements:"Adjacent JSX elements must be wrapped in an enclosing tag. Did you want a JSX fragment <>...</>?"});function dt(e){return!!e&&("JSXOpeningFragment"===e.type||"JSXClosingFragment"===e.type)}function ft(e){if("JSXIdentifier"===e.type)return e.name;if("JSXNamespacedName"===e.type)return e.namespace.name+":"+e.name.name;if("JSXMemberExpression"===e.type)return ft(e.object)+"."+ft(e.property);throw new Error("Node had unexpected type: "+e.type)}class mt extends ye{constructor(...e){super(...e),this.tsNames=new Map}}class yt extends ge{constructor(...e){super(...e),this.importsStack=[]}createScope(e){return this.importsStack.push(new Set),new mt(e)}enter(e){256===e&&this.importsStack.push(new Set),super.enter(e)}exit(){const e=super.exit();return 256===e&&this.importsStack.pop(),e}hasImport(e,t){const s=this.importsStack.length;if(this.importsStack[s-1].has(e))return!0;if(!t&&s>1)for(let t=0;t<s-1;t++)if(this.importsStack[t].has(e))return!0;return!1}declareName(e,t,s){if(4096&t)return this.hasImport(e,!0)&&this.parser.raise(b.VarRedeclaration,s,{identifierName:e}),void this.importsStack[this.importsStack.length-1].add(e);const i=this.currentScope();let n=i.tsNames.get(e)||0;if(1024&t)return this.maybeExportDefined(i,e),void i.tsNames.set(e,16|n);super.declareName(e,t,s),2&t&&(1&t||(this.checkRedeclarationInScope(i,e,t,s),this.maybeExportDefined(i,e)),n|=1),256&t&&(n|=2),512&t&&(n|=4),128&t&&(n|=8),n&&i.tsNames.set(e,n)}isRedeclaredInScope(e,t,s){const i=e.tsNames.get(t);return(2&i)>0?!(256&s)||!!(512&s)!=(4&i)>0:128&s&&(8&i)>0?!!(2&e.names.get(t))&&!!(1&s):!!(2&s&&(1&i)>0)||super.isRedeclaredInScope(e,t,s)}checkLocalExport(e){const{name:t}=e;if(!this.hasImport(t)){for(let e=this.scopeStack.length-1;e>=0;e--){const s=this.scopeStack[e].tsNames.get(t);if((1&s)>0||(16&s)>0)return}super.checkLocalExport(e)}}}const gt=e=>"ParenthesizedExpression"===e.type?gt(e.expression):e;class bt extends rt{toAssignable(e,t=!1){var s,i;let n;switch(("ParenthesizedExpression"===e.type||null!=(s=e.extra)&&s.parenthesized)&&(n=gt(e),t?"Identifier"===n.type?this.expressionScope.recordArrowParameterBindingError(b.InvalidParenthesizedAssignment,e):"MemberExpression"===n.type||this.isOptionalMemberExpression(n)||this.raise(b.InvalidParenthesizedAssignment,e):this.raise(b.InvalidParenthesizedAssignment,e)),e.type){case"Identifier":case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":break;case"ObjectExpression":e.type="ObjectPattern";for(let s=0,i=e.properties.length,n=i-1;s<i;s++){var r;const i=e.properties[s],a=s===n;this.toAssignableObjectExpressionProp(i,a,t),a&&"RestElement"===i.type&&null!=(r=e.extra)&&r.trailingCommaLoc&&this.raise(b.RestTrailingComma,e.extra.trailingCommaLoc)}break;case"ObjectProperty":{const{key:s,value:i}=e;this.isPrivateName(s)&&this.classScope.usePrivateName(this.getPrivateNameSV(s),s.loc.start),this.toAssignable(i,t);break}case"SpreadElement":throw new Error("Internal @babel/parser error (this is a bug, please report it). SpreadElement should be converted by .toAssignable's caller.");case"ArrayExpression":e.type="ArrayPattern",this.toAssignableList(e.elements,null==(i=e.extra)?void 0:i.trailingCommaLoc,t);break;case"AssignmentExpression":"="!==e.operator&&this.raise(b.MissingEqInAssignment,e.left.loc.end),e.type="AssignmentPattern",delete e.operator,this.toAssignable(e.left,t);break;case"ParenthesizedExpression":this.toAssignable(n,t)}}toAssignableObjectExpressionProp(e,t,s){if("ObjectMethod"===e.type)this.raise("get"===e.kind||"set"===e.kind?b.PatternHasAccessor:b.PatternHasMethod,e.key);else if("SpreadElement"===e.type){e.type="RestElement";const i=e.argument;this.checkToRestConversion(i,!1),this.toAssignable(i,s),t||this.raise(b.RestTrailingComma,e)}else this.toAssignable(e,s)}toAssignableList(e,t,s){const i=e.length-1;for(let n=0;n<=i;n++){const r=e[n];if(r){if("SpreadElement"===r.type){r.type="RestElement";const e=r.argument;this.checkToRestConversion(e,!0),this.toAssignable(e,s)}else this.toAssignable(r,s);"RestElement"===r.type&&(n<i?this.raise(b.RestTrailingComma,r):t&&this.raise(b.RestTrailingComma,t))}}}isAssignable(e,t){switch(e.type){case"Identifier":case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":return!0;case"ObjectExpression":{const t=e.properties.length-1;return e.properties.every(((e,s)=>"ObjectMethod"!==e.type&&(s===t||"SpreadElement"!==e.type)&&this.isAssignable(e)))}case"ObjectProperty":return this.isAssignable(e.value);case"SpreadElement":return this.isAssignable(e.argument);case"ArrayExpression":return e.elements.every((e=>null===e||this.isAssignable(e)));case"AssignmentExpression":return"="===e.operator;case"ParenthesizedExpression":return this.isAssignable(e.expression);case"MemberExpression":case"OptionalMemberExpression":return!t;default:return!1}}toReferencedList(e,t){return e}toReferencedListDeep(e,t){this.toReferencedList(e,t);for(const t of e)"ArrayExpression"===(null==t?void 0:t.type)&&this.toReferencedListDeep(t.elements)}parseSpread(e){const t=this.startNode();return this.next(),t.argument=this.parseMaybeAssignAllowIn(e,void 0),this.finishNode(t,"SpreadElement")}parseRestBinding(){const e=this.startNode();return this.next(),e.argument=this.parseBindingAtom(),this.finishNode(e,"RestElement")}parseBindingAtom(){switch(this.state.type){case 0:{const e=this.startNode();return this.next(),e.elements=this.parseBindingList(3,93,1),this.finishNode(e,"ArrayPattern")}case 5:return this.parseObjectLike(8,!0)}return this.parseIdentifier()}parseBindingList(e,t,s){const i=1&s,n=[];let r=!0;for(;!this.eat(e);)if(r?r=!1:this.expect(12),i&&this.match(12))n.push(null);else{if(this.eat(e))break;if(this.match(21)){if(n.push(this.parseAssignableListItemTypes(this.parseRestBinding(),s)),!this.checkCommaAfterRest(t)){this.expect(e);break}}else{const e=[];for(this.match(26)&&this.hasPlugin("decorators")&&this.raise(b.UnsupportedParameterDecorator,this.state.startLoc);this.match(26);)e.push(this.parseDecorator());n.push(this.parseAssignableListItem(s,e))}}return n}parseBindingRestProperty(e){return this.next(),e.argument=this.parseIdentifier(),this.checkCommaAfterRest(125),this.finishNode(e,"RestElement")}parseBindingProperty(){const{type:e,startLoc:t}=this.state;if(21===e)return this.parseBindingRestProperty(this.startNode());const s=this.startNode();return 138===e?(this.expectPlugin("destructuringPrivate",t),this.classScope.usePrivateName(this.state.value,t),s.key=this.parsePrivateName()):this.parsePropertyName(s),s.method=!1,this.parseObjPropValue(s,t,!1,!1,!0,!1)}parseAssignableListItem(e,t){const s=this.parseMaybeDefault();this.parseAssignableListItemTypes(s,e);const i=this.parseMaybeDefault(s.loc.start,s);return t.length&&(s.decorators=t),i}parseAssignableListItemTypes(e,t){return e}parseMaybeDefault(e,t){var s;if(null!=e||(e=this.state.startLoc),t=null!=(s=t)?s:this.parseBindingAtom(),!this.eat(29))return t;const i=this.startNodeAt(e);return i.left=t,i.right=this.parseMaybeAssignAllowIn(),this.finishNode(i,"AssignmentPattern")}isValidLVal(e,t,s){return i={AssignmentPattern:"left",RestElement:"argument",ObjectProperty:"value",ParenthesizedExpression:"expression",ArrayPattern:"elements",ObjectPattern:"properties"},n=e,hasOwnProperty.call(i,n)&&i[n];var i,n}isOptionalMemberExpression(e){return"OptionalMemberExpression"===e.type}checkLVal(e,{in:t,binding:s=64,checkClashes:i=!1,strictModeChanged:n=!1,hasParenthesizedAncestor:r=!1}){var a;const o=e.type;if(this.isObjectMethod(e))return;const c=this.isOptionalMemberExpression(e);if(c||"MemberExpression"===o)return c&&(this.expectPlugin("optionalChainingAssign",e.loc.start),"AssignmentExpression"!==t.type&&this.raise(b.InvalidLhsOptionalChaining,e,{ancestor:t})),void(64!==s&&this.raise(b.InvalidPropertyBindingPattern,e));if("Identifier"===o){this.checkIdentifier(e,s,n);const{name:t}=e;return void(i&&(i.has(t)?this.raise(b.ParamDupe,e):i.add(t)))}const h=this.isValidLVal(o,!(r||null!=(a=e.extra)&&a.parenthesized)&&"AssignmentExpression"===t.type,s);if(!0===h)return;if(!1===h){const i=64===s?b.InvalidLhs:b.InvalidLhsBinding;return void this.raise(i,e,{ancestor:t})}const[l,p]=Array.isArray(h)?h:[h,"ParenthesizedExpression"===o],u="ArrayPattern"===o||"ObjectPattern"===o?{type:o}:t;for(const t of[].concat(e[l]))t&&this.checkLVal(t,{in:u,binding:s,checkClashes:i,strictModeChanged:n,hasParenthesizedAncestor:p})}checkIdentifier(e,t,s=!1){this.state.strict&&(s?fe(e.name,this.inModule):de(e.name))&&(64===t?this.raise(b.StrictEvalArguments,e,{referenceName:e.name}):this.raise(b.StrictEvalArgumentsBinding,e,{bindingName:e.name})),8192&t&&"let"===e.name&&this.raise(b.LetInLexicalBinding,e),64&t||this.declareNameFromIdentifier(e,t)}declareNameFromIdentifier(e,t){this.scope.declareName(e.name,t,e.loc.start)}checkToRestConversion(e,t){switch(e.type){case"ParenthesizedExpression":this.checkToRestConversion(e.expression,t);break;case"Identifier":case"MemberExpression":break;case"ArrayExpression":case"ObjectExpression":if(t)break;default:this.raise(b.InvalidRestAssignmentPattern,e)}}checkCommaAfterRest(e){return!!this.match(12)&&(this.raise(this.lookaheadCharCode()===e?b.RestTrailingComma:b.ElementAfterRest,this.state.startLoc),!0)}}function wt(e){if(!e)throw new Error("Assert fail")}const _t=g`typescript`({AbstractMethodHasImplementation:({methodName:e})=>`Method '${e}' cannot have an implementation because it is marked abstract.`,AbstractPropertyHasInitializer:({propertyName:e})=>`Property '${e}' cannot have an initializer because it is marked abstract.`,AccesorCannotDeclareThisParameter:"'get' and 'set' accessors cannot declare 'this' parameters.",AccesorCannotHaveTypeParameters:"An accessor cannot have type parameters.",AccessorCannotBeOptional:"An 'accessor' property cannot be declared optional.",ClassMethodHasDeclare:"Class methods cannot have the 'declare' modifier.",ClassMethodHasReadonly:"Class methods cannot have the 'readonly' modifier.",ConstInitiailizerMustBeStringOrNumericLiteralOrLiteralEnumReference:"A 'const' initializer in an ambient context must be a string or numeric literal or literal enum reference.",ConstructorHasTypeParameters:"Type parameters cannot appear on a constructor declaration.",DeclareAccessor:({kind:e})=>`'declare' is not allowed in ${e}ters.`,DeclareClassFieldHasInitializer:"Initializers are not allowed in ambient contexts.",DeclareFunctionHasImplementation:"An implementation cannot be declared in ambient contexts.",DuplicateAccessibilityModifier:({modifier:e})=>"Accessibility modifier already seen.",DuplicateModifier:({modifier:e})=>`Duplicate modifier: '${e}'.`,EmptyHeritageClauseType:({token:e})=>`'${e}' list cannot be empty.`,EmptyTypeArguments:"Type argument list cannot be empty.",EmptyTypeParameters:"Type parameter list cannot be empty.",ExpectedAmbientAfterExportDeclare:"'export declare' must be followed by an ambient declaration.",ImportAliasHasImportType:"An import alias can not use 'import type'.",ImportReflectionHasImportType:"An `import module` declaration can not use `type` modifier",IncompatibleModifiers:({modifiers:e})=>`'${e[0]}' modifier cannot be used with '${e[1]}' modifier.`,IndexSignatureHasAbstract:"Index signatures cannot have the 'abstract' modifier.",IndexSignatureHasAccessibility:({modifier:e})=>`Index signatures cannot have an accessibility modifier ('${e}').`,IndexSignatureHasDeclare:"Index signatures cannot have the 'declare' modifier.",IndexSignatureHasOverride:"'override' modifier cannot appear on an index signature.",IndexSignatureHasStatic:"Index signatures cannot have the 'static' modifier.",InitializerNotAllowedInAmbientContext:"Initializers are not allowed in ambient contexts.",InvalidModifierOnTypeMember:({modifier:e})=>`'${e}' modifier cannot appear on a type member.`,InvalidModifierOnTypeParameter:({modifier:e})=>`'${e}' modifier cannot appear on a type parameter.`,InvalidModifierOnTypeParameterPositions:({modifier:e})=>`'${e}' modifier can only appear on a type parameter of a class, interface or type alias.`,InvalidModifiersOrder:({orderedModifiers:e})=>`'${e[0]}' modifier must precede '${e[1]}' modifier.`,InvalidPropertyAccessAfterInstantiationExpression:"Invalid property access after an instantiation expression. You can either wrap the instantiation expression in parentheses, or delete the type arguments.",InvalidTupleMemberLabel:"Tuple members must be labeled with a simple identifier.",MissingInterfaceName:"'interface' declarations must be followed by an identifier.",NonAbstractClassHasAbstractMethod:"Abstract methods can only appear within an abstract class.",NonClassMethodPropertyHasAbstractModifer:"'abstract' modifier can only appear on a class, method, or property declaration.",OptionalTypeBeforeRequired:"A required element cannot follow an optional element.",OverrideNotInSubClass:"This member cannot have an 'override' modifier because its containing class does not extend another class.",PatternIsOptional:"A binding pattern parameter cannot be optional in an implementation signature.",PrivateElementHasAbstract:"Private elements cannot have the 'abstract' modifier.",PrivateElementHasAccessibility:({modifier:e})=>`Private elements cannot have an accessibility modifier ('${e}').`,ReadonlyForMethodSignature:"'readonly' modifier can only appear on a property declaration or index signature.",ReservedArrowTypeParam:"This syntax is reserved in files with the .mts or .cts extension. Add a trailing comma, as in `<T,>() => ...`.",ReservedTypeAssertion:"This syntax is reserved in files with the .mts or .cts extension. Use an `as` expression instead.",SetAccesorCannotHaveOptionalParameter:"A 'set' accessor cannot have an optional parameter.",SetAccesorCannotHaveRestParameter:"A 'set' accessor cannot have rest parameter.",SetAccesorCannotHaveReturnType:"A 'set' accessor cannot have a return type annotation.",SingleTypeParameterWithoutTrailingComma:({typeParameterName:e})=>`Single type parameter ${e} should have a trailing comma. Example usage: <${e},>.`,StaticBlockCannotHaveModifier:"Static class blocks cannot have any modifier.",TupleOptionalAfterType:"A labeled tuple optional element must be declared using a question mark after the name and before the colon (`name?: type`), rather than after the type (`name: type?`).",TypeAnnotationAfterAssign:"Type annotations must come before default assignments, e.g. instead of `age = 25: number` use `age: number = 25`.",TypeImportCannotSpecifyDefaultAndNamed:"A type-only import can specify a default import or named bindings, but not both.",TypeModifierIsUsedInTypeExports:"The 'type' modifier cannot be used on a named export when 'export type' is used on its export statement.",TypeModifierIsUsedInTypeImports:"The 'type' modifier cannot be used on a named import when 'import type' is used on its import statement.",UnexpectedParameterModifier:"A parameter property is only allowed in a constructor implementation.",UnexpectedReadonly:"'readonly' type modifier is only permitted on array and tuple literal types.",UnexpectedTypeAnnotation:"Did not expect a type annotation here.",UnexpectedTypeCastInParameter:"Unexpected type cast in parameter position.",UnsupportedImportTypeArgument:"Argument in a type import must be a string literal.",UnsupportedParameterPropertyKind:"A parameter property may not be declared using a binding pattern.",UnsupportedSignatureParameterKind:({type:e})=>`Name in a signature must be an Identifier, ObjectPattern or ArrayPattern, instead got ${e}.`});function xt(e){return"private"===e||"public"===e||"protected"===e}function vt(e){return"in"===e||"out"===e}function Tt(e){if("MemberExpression"!==e.type)return!1;const{computed:t,property:s}=e;return(!t||"StringLiteral"===s.type||!("TemplateLiteral"!==s.type||s.expressions.length>0))&&Ct(e.object)}function Pt(e,t){var s;const{type:i}=e;if(null!=(s=e.extra)&&s.parenthesized)return!1;if(t){if("Literal"===i){const{value:t}=e;if("string"==typeof t||"boolean"==typeof t)return!0}}else if("StringLiteral"===i||"BooleanLiteral"===i)return!0;return!(!kt(e,t)&&!function(e,t){if("UnaryExpression"===e.type){const{operator:s,argument:i}=e;if("-"===s&&kt(i,t))return!0}return!1}(e,t))||"TemplateLiteral"===i&&0===e.expressions.length||!!Tt(e)}function kt(e,t){return t?"Literal"===e.type&&("number"==typeof e.value||"bigint"in e):"NumericLiteral"===e.type||"BigIntLiteral"===e.type}function Ct(e){return"Identifier"===e.type||"MemberExpression"===e.type&&!e.computed&&Ct(e.object)}const Et=g`placeholders`({ClassNameIsRequired:"A class name is required.",UnexpectedSpace:"Unexpected space in placeholder."});function At(e,t){const[s,i]="string"==typeof t?[t,{}]:t,n=Object.keys(i),r=0===n.length;return e.some((e=>{if("string"==typeof e)return r&&e===s;{const[t,r]=e;if(t!==s)return!1;for(const e of n)if(r[e]!==i[e])return!1;return!0}}))}function St(e,t,s){const i=e.find((e=>Array.isArray(e)?e[0]===t:e===t));return i&&Array.isArray(i)&&i.length>1?i[1][s]:null}const It=["minimal","fsharp","hack","smart"],Nt=["^^","@@","^","%","#"],Lt=["hash","bar"],Dt={estree:e=>class extends e{parse(){const e=x(super.parse());return this.options.tokens&&(e.tokens=e.tokens.map(x)),e}parseRegExpLiteral({pattern:e,flags:t}){let s=null;try{s=new RegExp(e,t)}catch(e){}const i=this.estreeParseLiteral(s);return i.regex={pattern:e,flags:t},i}parseBigIntLiteral(e){let t;try{t=BigInt(e)}catch(e){t=null}const s=this.estreeParseLiteral(t);return s.bigint=String(s.value||e),s}parseDecimalLiteral(e){const t=this.estreeParseLiteral(null);return t.decimal=String(t.value||e),t}estreeParseLiteral(e){return this.parseLiteral(e,"Literal")}parseStringLiteral(e){return this.estreeParseLiteral(e)}parseNumericLiteral(e){return this.estreeParseLiteral(e)}parseNullLiteral(){return this.estreeParseLiteral(null)}parseBooleanLiteral(e){return this.estreeParseLiteral(e)}directiveToStmt(e){const t=e.value;delete e.value,t.type="Literal",t.raw=t.extra.raw,t.value=t.extra.expressionValue;const s=e;return s.type="ExpressionStatement",s.expression=t,s.directive=t.extra.rawValue,delete t.extra,s}initFunction(e,t){super.initFunction(e,t),e.expression=!1}checkDeclaration(e){null!=e&&this.isObjectProperty(e)?this.checkDeclaration(e.value):super.checkDeclaration(e)}getObjectOrClassMethodParams(e){return e.value.params}isValidDirective(e){var t;return"ExpressionStatement"===e.type&&"Literal"===e.expression.type&&"string"==typeof e.expression.value&&!(null!=(t=e.expression.extra)&&t.parenthesized)}parseBlockBody(e,t,s,i,n){super.parseBlockBody(e,t,s,i,n);const r=e.directives.map((e=>this.directiveToStmt(e)));e.body=r.concat(e.body),delete e.directives}pushClassMethod(e,t,s,i,n,r){this.parseMethod(t,s,i,n,r,"ClassMethod",!0),t.typeParameters&&(t.value.typeParameters=t.typeParameters,delete t.typeParameters),e.body.push(t)}parsePrivateName(){const e=super.parsePrivateName();return this.getPluginOption("estree","classFeatures")?this.convertPrivateNameToPrivateIdentifier(e):e}convertPrivateNameToPrivateIdentifier(e){const t=super.getPrivateNameSV(e);return delete e.id,e.name=t,e.type="PrivateIdentifier",e}isPrivateName(e){return this.getPluginOption("estree","classFeatures")?"PrivateIdentifier"===e.type:super.isPrivateName(e)}getPrivateNameSV(e){return this.getPluginOption("estree","classFeatures")?e.name:super.getPrivateNameSV(e)}parseLiteral(e,t){const s=super.parseLiteral(e,t);return s.raw=s.extra.raw,delete s.extra,s}parseFunctionBody(e,t,s=!1){super.parseFunctionBody(e,t,s),e.expression="BlockStatement"!==e.body.type}parseMethod(e,t,s,i,n,r,a=!1){let o=this.startNode();return o.kind=e.kind,o=super.parseMethod(o,t,s,i,n,r,a),o.type="FunctionExpression",delete o.kind,e.value=o,"ClassPrivateMethod"===r&&(e.computed=!1),this.finishNode(e,"MethodDefinition")}nameIsConstructor(e){return"Literal"===e.type?"constructor"===e.value:super.nameIsConstructor(e)}parseClassProperty(...e){const t=super.parseClassProperty(...e);return this.getPluginOption("estree","classFeatures")?(t.type="PropertyDefinition",t):t}parseClassPrivateProperty(...e){const t=super.parseClassPrivateProperty(...e);return this.getPluginOption("estree","classFeatures")?(t.type="PropertyDefinition",t.computed=!1,t):t}parseObjectMethod(e,t,s,i,n){const r=super.parseObjectMethod(e,t,s,i,n);return r&&(r.type="Property","method"===r.kind&&(r.kind="init"),r.shorthand=!1),r}parseObjectProperty(e,t,s,i){const n=super.parseObjectProperty(e,t,s,i);return n&&(n.kind="init",n.type="Property"),n}isValidLVal(e,t,s){return"Property"===e?"value":super.isValidLVal(e,t,s)}isAssignable(e,t){return null!=e&&this.isObjectProperty(e)?this.isAssignable(e.value,t):super.isAssignable(e,t)}toAssignable(e,t=!1){if(null!=e&&this.isObjectProperty(e)){const{key:s,value:i}=e;this.isPrivateName(s)&&this.classScope.usePrivateName(this.getPrivateNameSV(s),s.loc.start),this.toAssignable(i,t)}else super.toAssignable(e,t)}toAssignableObjectExpressionProp(e,t,s){"Property"!==e.type||"get"!==e.kind&&"set"!==e.kind?"Property"===e.type&&e.method?this.raise(b.PatternHasMethod,e.key):super.toAssignableObjectExpressionProp(e,t,s):this.raise(b.PatternHasAccessor,e.key)}finishCallExpression(e,t){const s=super.finishCallExpression(e,t);var i,n;"Import"===s.callee.type&&(s.type="ImportExpression",s.source=s.arguments[0],(this.hasPlugin("importAttributes")||this.hasPlugin("importAssertions"))&&(s.options=null!=(i=s.arguments[1])?i:null,s.attributes=null!=(n=s.arguments[1])?n:null),delete s.arguments,delete s.callee);return s}toReferencedArguments(e){"ImportExpression"!==e.type&&super.toReferencedArguments(e)}parseExport(e,t){const s=this.state.lastTokStartLoc,i=super.parseExport(e,t);switch(i.type){case"ExportAllDeclaration":i.exported=null;break;case"ExportNamedDeclaration":1===i.specifiers.length&&"ExportNamespaceSpecifier"===i.specifiers[0].type&&(i.type="ExportAllDeclaration",i.exported=i.specifiers[0].exported,delete i.specifiers);case"ExportDefaultDeclaration":{var n;const{declaration:e}=i;"ClassDeclaration"===(null==e?void 0:e.type)&&(null==(n=e.decorators)?void 0:n.length)>0&&e.start===i.start&&this.resetStartLocation(i,s)}}return i}parseSubscript(e,t,s,i){const n=super.parseSubscript(e,t,s,i);if(i.optionalChainMember){if("OptionalMemberExpression"!==n.type&&"OptionalCallExpression"!==n.type||(n.type=n.type.substring(8)),i.stop){const e=this.startNodeAtNode(n);return e.expression=n,this.finishNode(e,"ChainExpression")}}else"MemberExpression"!==n.type&&"CallExpression"!==n.type||(n.optional=!1);return n}isOptionalMemberExpression(e){return"ChainExpression"===e.type?"MemberExpression"===e.expression.type:super.isOptionalMemberExpression(e)}hasPropertyAsPrivateName(e){return"ChainExpression"===e.type&&(e=e.expression),super.hasPropertyAsPrivateName(e)}isObjectProperty(e){return"Property"===e.type&&"init"===e.kind&&!e.method}isObjectMethod(e){return"Property"===e.type&&(e.method||"get"===e.kind||"set"===e.kind)}finishNodeAt(e,t,s){return x(super.finishNodeAt(e,t,s))}resetStartLocation(e,t){super.resetStartLocation(e,t),x(e)}resetEndLocation(e,t=this.state.lastTokEndLoc){super.resetEndLocation(e,t),x(e)}},jsx:e=>class extends e{jsxReadToken(){let e="",t=this.state.pos;for(;;){if(this.state.pos>=this.length)throw this.raise(ut.UnterminatedJsxContent,this.state.startLoc);const s=this.input.charCodeAt(this.state.pos);switch(s){case 60:case 123:return this.state.pos===this.state.start?void(60===s&&this.state.canStartJSXElement?(++this.state.pos,this.finishToken(142)):super.getTokenFromCode(s)):(e+=this.input.slice(t,this.state.pos),void this.finishToken(141,e));case 38:e+=this.input.slice(t,this.state.pos),e+=this.jsxReadEntity(),t=this.state.pos;break;default:Ee(s)?(e+=this.input.slice(t,this.state.pos),e+=this.jsxReadNewLine(!0),t=this.state.pos):++this.state.pos}}}jsxReadNewLine(e){const t=this.input.charCodeAt(this.state.pos);let s;return++this.state.pos,13===t&&10===this.input.charCodeAt(this.state.pos)?(++this.state.pos,s=e?"\n":"\r\n"):s=String.fromCharCode(t),++this.state.curLine,this.state.lineStart=this.state.pos,s}jsxReadString(e){let t="",s=++this.state.pos;for(;;){if(this.state.pos>=this.length)throw this.raise(b.UnterminatedString,this.state.startLoc);const i=this.input.charCodeAt(this.state.pos);if(i===e)break;38===i?(t+=this.input.slice(s,this.state.pos),t+=this.jsxReadEntity(),s=this.state.pos):Ee(i)?(t+=this.input.slice(s,this.state.pos),t+=this.jsxReadNewLine(!1),s=this.state.pos):++this.state.pos}t+=this.input.slice(s,this.state.pos++),this.finishToken(133,t)}jsxReadEntity(){const e=++this.state.pos;if(35===this.codePointAtPos(this.state.pos)){++this.state.pos;let e=10;120===this.codePointAtPos(this.state.pos)&&(e=16,++this.state.pos);const t=this.readInt(e,void 0,!1,"bail");if(null!==t&&59===this.codePointAtPos(this.state.pos))return++this.state.pos,String.fromCodePoint(t)}else{let t=0,s=!1;for(;t++<10&&this.state.pos<this.length&&!(s=59===this.codePointAtPos(this.state.pos));)++this.state.pos;if(s){const t=this.input.slice(e,this.state.pos),s=pt[t];if(++this.state.pos,s)return s}}return this.state.pos=e,"&"}jsxReadWord(){let e;const t=this.state.pos;do{e=this.input.charCodeAt(++this.state.pos)}while(oe(e)||45===e);this.finishToken(140,this.input.slice(t,this.state.pos))}jsxParseIdentifier(){const e=this.startNode();return this.match(140)?e.name=this.state.value:G(this.state.type)?e.name=Y(this.state.type):this.unexpected(),this.next(),this.finishNode(e,"JSXIdentifier")}jsxParseNamespacedName(){const e=this.state.startLoc,t=this.jsxParseIdentifier();if(!this.eat(14))return t;const s=this.startNodeAt(e);return s.namespace=t,s.name=this.jsxParseIdentifier(),this.finishNode(s,"JSXNamespacedName")}jsxParseElementName(){const e=this.state.startLoc;let t=this.jsxParseNamespacedName();if("JSXNamespacedName"===t.type)return t;for(;this.eat(16);){const s=this.startNodeAt(e);s.object=t,s.property=this.jsxParseIdentifier(),t=this.finishNode(s,"JSXMemberExpression")}return t}jsxParseAttributeValue(){let e;switch(this.state.type){case 5:return e=this.startNode(),this.setContext(T.brace),this.next(),e=this.jsxParseExpressionContainer(e,T.j_oTag),"JSXEmptyExpression"===e.expression.type&&this.raise(ut.AttributeIsEmpty,e),e;case 142:case 133:return this.parseExprAtom();default:throw this.raise(ut.UnsupportedJsxValue,this.state.startLoc)}}jsxParseEmptyExpression(){const e=this.startNodeAt(this.state.lastTokEndLoc);return this.finishNodeAt(e,"JSXEmptyExpression",this.state.startLoc)}jsxParseSpreadChild(e){return this.next(),e.expression=this.parseExpression(),this.setContext(T.j_expr),this.state.canStartJSXElement=!0,this.expect(8),this.finishNode(e,"JSXSpreadChild")}jsxParseExpressionContainer(e,t){if(this.match(8))e.expression=this.jsxParseEmptyExpression();else{const t=this.parseExpression();e.expression=t}return this.setContext(t),this.state.canStartJSXElement=!0,this.expect(8),this.finishNode(e,"JSXExpressionContainer")}jsxParseAttribute(){const e=this.startNode();return this.match(5)?(this.setContext(T.brace),this.next(),this.expect(21),e.argument=this.parseMaybeAssignAllowIn(),this.setContext(T.j_oTag),this.state.canStartJSXElement=!0,this.expect(8),this.finishNode(e,"JSXSpreadAttribute")):(e.name=this.jsxParseNamespacedName(),e.value=this.eat(29)?this.jsxParseAttributeValue():null,this.finishNode(e,"JSXAttribute"))}jsxParseOpeningElementAt(e){const t=this.startNodeAt(e);return this.eat(143)?this.finishNode(t,"JSXOpeningFragment"):(t.name=this.jsxParseElementName(),this.jsxParseOpeningElementAfterName(t))}jsxParseOpeningElementAfterName(e){const t=[];for(;!this.match(56)&&!this.match(143);)t.push(this.jsxParseAttribute());return e.attributes=t,e.selfClosing=this.eat(56),this.expect(143),this.finishNode(e,"JSXOpeningElement")}jsxParseClosingElementAt(e){const t=this.startNodeAt(e);return this.eat(143)?this.finishNode(t,"JSXClosingFragment"):(t.name=this.jsxParseElementName(),this.expect(143),this.finishNode(t,"JSXClosingElement"))}jsxParseElementAt(e){const t=this.startNodeAt(e),s=[],i=this.jsxParseOpeningElementAt(e);let n=null;if(!i.selfClosing){e:for(;;)switch(this.state.type){case 142:if(e=this.state.startLoc,this.next(),this.eat(56)){n=this.jsxParseClosingElementAt(e);break e}s.push(this.jsxParseElementAt(e));break;case 141:s.push(this.parseLiteral(this.state.value,"JSXText"));break;case 5:{const e=this.startNode();this.setContext(T.brace),this.next(),this.match(21)?s.push(this.jsxParseSpreadChild(e)):s.push(this.jsxParseExpressionContainer(e,T.j_expr));break}default:this.unexpected()}dt(i)&&!dt(n)&&null!==n?this.raise(ut.MissingClosingTagFragment,n):!dt(i)&&dt(n)?this.raise(ut.MissingClosingTagElement,n,{openingTagName:ft(i.name)}):dt(i)||dt(n)||ft(n.name)!==ft(i.name)&&this.raise(ut.MissingClosingTagElement,n,{openingTagName:ft(i.name)})}if(dt(i)?(t.openingFragment=i,t.closingFragment=n):(t.openingElement=i,t.closingElement=n),t.children=s,this.match(47))throw this.raise(ut.UnwrappedAdjacentJSXElements,this.state.startLoc);return dt(i)?this.finishNode(t,"JSXFragment"):this.finishNode(t,"JSXElement")}jsxParseElement(){const e=this.state.startLoc;return this.next(),this.jsxParseElementAt(e)}setContext(e){const{context:t}=this.state;t[t.length-1]=e}parseExprAtom(e){return this.match(142)?this.jsxParseElement():this.match(47)&&33!==this.input.charCodeAt(this.state.pos)?(this.replaceToken(142),this.jsxParseElement()):super.parseExprAtom(e)}skipSpace(){this.curContext().preserveSpace||super.skipSpace()}getTokenFromCode(e){const t=this.curContext();if(t!==T.j_expr){if(t===T.j_oTag||t===T.j_cTag){if(ae(e))return void this.jsxReadWord();if(62===e)return++this.state.pos,void this.finishToken(143);if((34===e||39===e)&&t===T.j_oTag)return void this.jsxReadString(e)}if(60===e&&this.state.canStartJSXElement&&33!==this.input.charCodeAt(this.state.pos+1))return++this.state.pos,void this.finishToken(142);super.getTokenFromCode(e)}else this.jsxReadToken()}updateContext(e){const{context:t,type:s}=this.state;if(56===s&&142===e)t.splice(-2,2,T.j_cTag),this.state.canStartJSXElement=!1;else if(142===s)t.push(T.j_oTag);else if(143===s){const s=t[t.length-1];s===T.j_oTag&&56===e||s===T.j_cTag?(t.pop(),this.state.canStartJSXElement=t[t.length-1]===T.j_expr):(this.setContext(T.j_expr),this.state.canStartJSXElement=!0)}else this.state.canStartJSXElement=F[s]}},flow:e=>class extends e{constructor(...e){super(...e),this.flowPragma=void 0}getScopeHandler(){return we}shouldParseTypes(){return this.getPluginOption("flow","all")||"flow"===this.flowPragma}shouldParseEnums(){return!!this.getPluginOption("flow","enums")}finishToken(e,t){133!==e&&13!==e&&28!==e&&void 0===this.flowPragma&&(this.flowPragma=null),super.finishToken(e,t)}addComment(e){if(void 0===this.flowPragma){const t=lt.exec(e.value);if(t)if("flow"===t[1])this.flowPragma="flow";else{if("noflow"!==t[1])throw new Error("Unexpected flow pragma");this.flowPragma="noflow"}}super.addComment(e)}flowParseTypeInitialiser(e){const t=this.state.inType;this.state.inType=!0,this.expect(e||14);const s=this.flowParseType();return this.state.inType=t,s}flowParsePredicate(){const e=this.startNode(),t=this.state.startLoc;return this.next(),this.expectContextual(110),this.state.lastTokStartLoc.index>t.index+1&&this.raise(ot.UnexpectedSpaceBetweenModuloChecks,t),this.eat(10)?(e.value=super.parseExpression(),this.expect(11),this.finishNode(e,"DeclaredPredicate")):this.finishNode(e,"InferredPredicate")}flowParseTypeAndPredicateInitialiser(){const e=this.state.inType;this.state.inType=!0,this.expect(14);let t=null,s=null;return this.match(54)?(this.state.inType=e,s=this.flowParsePredicate()):(t=this.flowParseType(),this.state.inType=e,this.match(54)&&(s=this.flowParsePredicate())),[t,s]}flowParseDeclareClass(e){return this.next(),this.flowParseInterfaceish(e,!0),this.finishNode(e,"DeclareClass")}flowParseDeclareFunction(e){this.next();const t=e.id=this.parseIdentifier(),s=this.startNode(),i=this.startNode();this.match(47)?s.typeParameters=this.flowParseTypeParameterDeclaration():s.typeParameters=null,this.expect(10);const n=this.flowParseFunctionTypeParams();return s.params=n.params,s.rest=n.rest,s.this=n._this,this.expect(11),[s.returnType,e.predicate]=this.flowParseTypeAndPredicateInitialiser(),i.typeAnnotation=this.finishNode(s,"FunctionTypeAnnotation"),t.typeAnnotation=this.finishNode(i,"TypeAnnotation"),this.resetEndLocation(t),this.semicolon(),this.scope.declareName(e.id.name,2048,e.id.loc.start),this.finishNode(e,"DeclareFunction")}flowParseDeclare(e,t){return this.match(80)?this.flowParseDeclareClass(e):this.match(68)?this.flowParseDeclareFunction(e):this.match(74)?this.flowParseDeclareVariable(e):this.eatContextual(127)?this.match(16)?this.flowParseDeclareModuleExports(e):(t&&this.raise(ot.NestedDeclareModule,this.state.lastTokStartLoc),this.flowParseDeclareModule(e)):this.isContextual(130)?this.flowParseDeclareTypeAlias(e):this.isContextual(131)?this.flowParseDeclareOpaqueType(e):this.isContextual(129)?this.flowParseDeclareInterface(e):this.match(82)?this.flowParseDeclareExportDeclaration(e,t):void this.unexpected()}flowParseDeclareVariable(e){return this.next(),e.id=this.flowParseTypeAnnotatableIdentifier(!0),this.scope.declareName(e.id.name,5,e.id.loc.start),this.semicolon(),this.finishNode(e,"DeclareVariable")}flowParseDeclareModule(e){this.scope.enter(0),this.match(133)?e.id=super.parseExprAtom():e.id=this.parseIdentifier();const t=e.body=this.startNode(),s=t.body=[];for(this.expect(5);!this.match(8);){let e=this.startNode();this.match(83)?(this.next(),this.isContextual(130)||this.match(87)||this.raise(ot.InvalidNonTypeImportInDeclareModule,this.state.lastTokStartLoc),super.parseImport(e)):(this.expectContextual(125,ot.UnsupportedStatementInDeclareModule),e=this.flowParseDeclare(e,!0)),s.push(e)}this.scope.exit(),this.expect(8),this.finishNode(t,"BlockStatement");let i=null,n=!1;return s.forEach((e=>{!function(e){return"DeclareExportAllDeclaration"===e.type||"DeclareExportDeclaration"===e.type&&(!e.declaration||"TypeAlias"!==e.declaration.type&&"InterfaceDeclaration"!==e.declaration.type)}(e)?"DeclareModuleExports"===e.type&&(n&&this.raise(ot.DuplicateDeclareModuleExports,e),"ES"===i&&this.raise(ot.AmbiguousDeclareModuleKind,e),i="CommonJS",n=!0):("CommonJS"===i&&this.raise(ot.AmbiguousDeclareModuleKind,e),i="ES")})),e.kind=i||"CommonJS",this.finishNode(e,"DeclareModule")}flowParseDeclareExportDeclaration(e,t){if(this.expect(82),this.eat(65))return this.match(68)||this.match(80)?e.declaration=this.flowParseDeclare(this.startNode()):(e.declaration=this.flowParseType(),this.semicolon()),e.default=!0,this.finishNode(e,"DeclareExportDeclaration");if(this.match(75)||this.isLet()||(this.isContextual(130)||this.isContextual(129))&&!t){const e=this.state.value;throw this.raise(ot.UnsupportedDeclareExportKind,this.state.startLoc,{unsupportedExportKind:e,suggestion:ht[e]})}return this.match(74)||this.match(68)||this.match(80)||this.isContextual(131)?(e.declaration=this.flowParseDeclare(this.startNode()),e.default=!1,this.finishNode(e,"DeclareExportDeclaration")):this.match(55)||this.match(5)||this.isContextual(129)||this.isContextual(130)||this.isContextual(131)?("ExportNamedDeclaration"===(e=this.parseExport(e,null)).type&&(e.type="ExportDeclaration",e.default=!1,delete e.exportKind),e.type="Declare"+e.type,e):void this.unexpected()}flowParseDeclareModuleExports(e){return this.next(),this.expectContextual(111),e.typeAnnotation=this.flowParseTypeAnnotation(),this.semicolon(),this.finishNode(e,"DeclareModuleExports")}flowParseDeclareTypeAlias(e){this.next();const t=this.flowParseTypeAlias(e);return t.type="DeclareTypeAlias",t}flowParseDeclareOpaqueType(e){this.next();const t=this.flowParseOpaqueType(e,!0);return t.type="DeclareOpaqueType",t}flowParseDeclareInterface(e){return this.next(),this.flowParseInterfaceish(e,!1),this.finishNode(e,"DeclareInterface")}flowParseInterfaceish(e,t){if(e.id=this.flowParseRestrictedIdentifier(!t,!0),this.scope.declareName(e.id.name,t?17:8201,e.id.loc.start),this.match(47)?e.typeParameters=this.flowParseTypeParameterDeclaration():e.typeParameters=null,e.extends=[],this.eat(81))do{e.extends.push(this.flowParseInterfaceExtends())}while(!t&&this.eat(12));if(t){if(e.implements=[],e.mixins=[],this.eatContextual(117))do{e.mixins.push(this.flowParseInterfaceExtends())}while(this.eat(12));if(this.eatContextual(113))do{e.implements.push(this.flowParseInterfaceExtends())}while(this.eat(12))}e.body=this.flowParseObjectType({allowStatic:t,allowExact:!1,allowSpread:!1,allowProto:t,allowInexact:!1})}flowParseInterfaceExtends(){const e=this.startNode();return e.id=this.flowParseQualifiedTypeIdentifier(),this.match(47)?e.typeParameters=this.flowParseTypeParameterInstantiation():e.typeParameters=null,this.finishNode(e,"InterfaceExtends")}flowParseInterface(e){return this.flowParseInterfaceish(e,!1),this.finishNode(e,"InterfaceDeclaration")}checkNotUnderscore(e){"_"===e&&this.raise(ot.UnexpectedReservedUnderscore,this.state.startLoc)}checkReservedType(e,t,s){at.has(e)&&this.raise(s?ot.AssignReservedType:ot.UnexpectedReservedType,t,{reservedType:e})}flowParseRestrictedIdentifier(e,t){return this.checkReservedType(this.state.value,this.state.startLoc,t),this.parseIdentifier(e)}flowParseTypeAlias(e){return e.id=this.flowParseRestrictedIdentifier(!1,!0),this.scope.declareName(e.id.name,8201,e.id.loc.start),this.match(47)?e.typeParameters=this.flowParseTypeParameterDeclaration():e.typeParameters=null,e.right=this.flowParseTypeInitialiser(29),this.semicolon(),this.finishNode(e,"TypeAlias")}flowParseOpaqueType(e,t){return this.expectContextual(130),e.id=this.flowParseRestrictedIdentifier(!0,!0),this.scope.declareName(e.id.name,8201,e.id.loc.start),this.match(47)?e.typeParameters=this.flowParseTypeParameterDeclaration():e.typeParameters=null,e.supertype=null,this.match(14)&&(e.supertype=this.flowParseTypeInitialiser(14)),e.impltype=null,t||(e.impltype=this.flowParseTypeInitialiser(29)),this.semicolon(),this.finishNode(e,"OpaqueType")}flowParseTypeParameter(e=!1){const t=this.state.startLoc,s=this.startNode(),i=this.flowParseVariance(),n=this.flowParseTypeAnnotatableIdentifier();return s.name=n.name,s.variance=i,s.bound=n.typeAnnotation,this.match(29)?(this.eat(29),s.default=this.flowParseType()):e&&this.raise(ot.MissingTypeParamDefault,t),this.finishNode(s,"TypeParameter")}flowParseTypeParameterDeclaration(){const e=this.state.inType,t=this.startNode();t.params=[],this.state.inType=!0,this.match(47)||this.match(142)?this.next():this.unexpected();let s=!1;do{const e=this.flowParseTypeParameter(s);t.params.push(e),e.default&&(s=!0),this.match(48)||this.expect(12)}while(!this.match(48));return this.expect(48),this.state.inType=e,this.finishNode(t,"TypeParameterDeclaration")}flowParseTypeParameterInstantiation(){const e=this.startNode(),t=this.state.inType;e.params=[],this.state.inType=!0,this.expect(47);const s=this.state.noAnonFunctionType;for(this.state.noAnonFunctionType=!1;!this.match(48);)e.params.push(this.flowParseType()),this.match(48)||this.expect(12);return this.state.noAnonFunctionType=s,this.expect(48),this.state.inType=t,this.finishNode(e,"TypeParameterInstantiation")}flowParseTypeParameterInstantiationCallOrNew(){const e=this.startNode(),t=this.state.inType;for(e.params=[],this.state.inType=!0,this.expect(47);!this.match(48);)e.params.push(this.flowParseTypeOrImplicitInstantiation()),this.match(48)||this.expect(12);return this.expect(48),this.state.inType=t,this.finishNode(e,"TypeParameterInstantiation")}flowParseInterfaceType(){const e=this.startNode();if(this.expectContextual(129),e.extends=[],this.eat(81))do{e.extends.push(this.flowParseInterfaceExtends())}while(this.eat(12));return e.body=this.flowParseObjectType({allowStatic:!1,allowExact:!1,allowSpread:!1,allowProto:!1,allowInexact:!1}),this.finishNode(e,"InterfaceTypeAnnotation")}flowParseObjectPropertyKey(){return this.match(134)||this.match(133)?super.parseExprAtom():this.parseIdentifier(!0)}flowParseObjectTypeIndexer(e,t,s){return e.static=t,14===this.lookahead().type?(e.id=this.flowParseObjectPropertyKey(),e.key=this.flowParseTypeInitialiser()):(e.id=null,e.key=this.flowParseType()),this.expect(3),e.value=this.flowParseTypeInitialiser(),e.variance=s,this.finishNode(e,"ObjectTypeIndexer")}flowParseObjectTypeInternalSlot(e,t){return e.static=t,e.id=this.flowParseObjectPropertyKey(),this.expect(3),this.expect(3),this.match(47)||this.match(10)?(e.method=!0,e.optional=!1,e.value=this.flowParseObjectTypeMethodish(this.startNodeAt(e.loc.start))):(e.method=!1,this.eat(17)&&(e.optional=!0),e.value=this.flowParseTypeInitialiser()),this.finishNode(e,"ObjectTypeInternalSlot")}flowParseObjectTypeMethodish(e){for(e.params=[],e.rest=null,e.typeParameters=null,e.this=null,this.match(47)&&(e.typeParameters=this.flowParseTypeParameterDeclaration()),this.expect(10),this.match(78)&&(e.this=this.flowParseFunctionTypeParam(!0),e.this.name=null,this.match(11)||this.expect(12));!this.match(11)&&!this.match(21);)e.params.push(this.flowParseFunctionTypeParam(!1)),this.match(11)||this.expect(12);return this.eat(21)&&(e.rest=this.flowParseFunctionTypeParam(!1)),this.expect(11),e.returnType=this.flowParseTypeInitialiser(),this.finishNode(e,"FunctionTypeAnnotation")}flowParseObjectTypeCallProperty(e,t){const s=this.startNode();return e.static=t,e.value=this.flowParseObjectTypeMethodish(s),this.finishNode(e,"ObjectTypeCallProperty")}flowParseObjectType({allowStatic:e,allowExact:t,allowSpread:s,allowProto:i,allowInexact:n}){const r=this.state.inType;this.state.inType=!0;const a=this.startNode();let o,c;a.callProperties=[],a.properties=[],a.indexers=[],a.internalSlots=[];let h=!1;for(t&&this.match(6)?(this.expect(6),o=9,c=!0):(this.expect(5),o=8,c=!1),a.exact=c;!this.match(o);){let t=!1,r=null,o=null;const l=this.startNode();if(i&&this.isContextual(118)){const t=this.lookahead();14!==t.type&&17!==t.type&&(this.next(),r=this.state.startLoc,e=!1)}if(e&&this.isContextual(106)){const e=this.lookahead();14!==e.type&&17!==e.type&&(this.next(),t=!0)}const p=this.flowParseVariance();if(this.eat(0))null!=r&&this.unexpected(r),this.eat(0)?(p&&this.unexpected(p.loc.start),a.internalSlots.push(this.flowParseObjectTypeInternalSlot(l,t))):a.indexers.push(this.flowParseObjectTypeIndexer(l,t,p));else if(this.match(10)||this.match(47))null!=r&&this.unexpected(r),p&&this.unexpected(p.loc.start),a.callProperties.push(this.flowParseObjectTypeCallProperty(l,t));else{let e="init";(this.isContextual(99)||this.isContextual(104))&&$(this.lookahead().type)&&(e=this.state.value,this.next());const i=this.flowParseObjectTypeProperty(l,t,r,p,e,s,null!=n?n:!c);null===i?(h=!0,o=this.state.lastTokStartLoc):a.properties.push(i)}this.flowObjectTypeSemicolon(),!o||this.match(8)||this.match(9)||this.raise(ot.UnexpectedExplicitInexactInObject,o)}this.expect(o),s&&(a.inexact=h);const l=this.finishNode(a,"ObjectTypeAnnotation");return this.state.inType=r,l}flowParseObjectTypeProperty(e,t,s,i,n,r,a){if(this.eat(21))return this.match(12)||this.match(13)||this.match(8)||this.match(9)?(r?a||this.raise(ot.InexactInsideExact,this.state.lastTokStartLoc):this.raise(ot.InexactInsideNonObject,this.state.lastTokStartLoc),i&&this.raise(ot.InexactVariance,i),null):(r||this.raise(ot.UnexpectedSpreadType,this.state.lastTokStartLoc),null!=s&&this.unexpected(s),i&&this.raise(ot.SpreadVariance,i),e.argument=this.flowParseType(),this.finishNode(e,"ObjectTypeSpreadProperty"));{e.key=this.flowParseObjectPropertyKey(),e.static=t,e.proto=null!=s,e.kind=n;let a=!1;return this.match(47)||this.match(10)?(e.method=!0,null!=s&&this.unexpected(s),i&&this.unexpected(i.loc.start),e.value=this.flowParseObjectTypeMethodish(this.startNodeAt(e.loc.start)),"get"!==n&&"set"!==n||this.flowCheckGetterSetterParams(e),!r&&"constructor"===e.key.name&&e.value.this&&this.raise(ot.ThisParamBannedInConstructor,e.value.this)):("init"!==n&&this.unexpected(),e.method=!1,this.eat(17)&&(a=!0),e.value=this.flowParseTypeInitialiser(),e.variance=i),e.optional=a,this.finishNode(e,"ObjectTypeProperty")}}flowCheckGetterSetterParams(e){const t="get"===e.kind?0:1,s=e.value.params.length+(e.value.rest?1:0);e.value.this&&this.raise("get"===e.kind?ot.GetterMayNotHaveThisParam:ot.SetterMayNotHaveThisParam,e.value.this),s!==t&&this.raise("get"===e.kind?b.BadGetterArity:b.BadSetterArity,e),"set"===e.kind&&e.value.rest&&this.raise(b.BadSetterRestParameter,e)}flowObjectTypeSemicolon(){this.eat(13)||this.eat(12)||this.match(8)||this.match(9)||this.unexpected()}flowParseQualifiedTypeIdentifier(e,t){null!=e||(e=this.state.startLoc);let s=t||this.flowParseRestrictedIdentifier(!0);for(;this.eat(16);){const t=this.startNodeAt(e);t.qualification=s,t.id=this.flowParseRestrictedIdentifier(!0),s=this.finishNode(t,"QualifiedTypeIdentifier")}return s}flowParseGenericType(e,t){const s=this.startNodeAt(e);return s.typeParameters=null,s.id=this.flowParseQualifiedTypeIdentifier(e,t),this.match(47)&&(s.typeParameters=this.flowParseTypeParameterInstantiation()),this.finishNode(s,"GenericTypeAnnotation")}flowParseTypeofType(){const e=this.startNode();return this.expect(87),e.argument=this.flowParsePrimaryType(),this.finishNode(e,"TypeofTypeAnnotation")}flowParseTupleType(){const e=this.startNode();for(e.types=[],this.expect(0);this.state.pos<this.length&&!this.match(3)&&(e.types.push(this.flowParseType()),!this.match(3));)this.expect(12);return this.expect(3),this.finishNode(e,"TupleTypeAnnotation")}flowParseFunctionTypeParam(e){let t=null,s=!1,i=null;const n=this.startNode(),r=this.lookahead(),a=78===this.state.type;return 14===r.type||17===r.type?(a&&!e&&this.raise(ot.ThisParamMustBeFirst,n),t=this.parseIdentifier(a),this.eat(17)&&(s=!0,a&&this.raise(ot.ThisParamMayNotBeOptional,n)),i=this.flowParseTypeInitialiser()):i=this.flowParseType(),n.name=t,n.optional=s,n.typeAnnotation=i,this.finishNode(n,"FunctionTypeParam")}reinterpretTypeAsFunctionTypeParam(e){const t=this.startNodeAt(e.loc.start);return t.name=null,t.optional=!1,t.typeAnnotation=e,this.finishNode(t,"FunctionTypeParam")}flowParseFunctionTypeParams(e=[]){let t=null,s=null;for(this.match(78)&&(s=this.flowParseFunctionTypeParam(!0),s.name=null,this.match(11)||this.expect(12));!this.match(11)&&!this.match(21);)e.push(this.flowParseFunctionTypeParam(!1)),this.match(11)||this.expect(12);return this.eat(21)&&(t=this.flowParseFunctionTypeParam(!1)),{params:e,rest:t,_this:s}}flowIdentToTypeAnnotation(e,t,s){switch(s.name){case"any":return this.finishNode(t,"AnyTypeAnnotation");case"bool":case"boolean":return this.finishNode(t,"BooleanTypeAnnotation");case"mixed":return this.finishNode(t,"MixedTypeAnnotation");case"empty":return this.finishNode(t,"EmptyTypeAnnotation");case"number":return this.finishNode(t,"NumberTypeAnnotation");case"string":return this.finishNode(t,"StringTypeAnnotation");case"symbol":return this.finishNode(t,"SymbolTypeAnnotation");default:return this.checkNotUnderscore(s.name),this.flowParseGenericType(e,s)}}flowParsePrimaryType(){const e=this.state.startLoc,t=this.startNode();let s,i,n=!1;const r=this.state.noAnonFunctionType;switch(this.state.type){case 5:return this.flowParseObjectType({allowStatic:!1,allowExact:!1,allowSpread:!0,allowProto:!1,allowInexact:!0});case 6:return this.flowParseObjectType({allowStatic:!1,allowExact:!0,allowSpread:!0,allowProto:!1,allowInexact:!1});case 0:return this.state.noAnonFunctionType=!1,i=this.flowParseTupleType(),this.state.noAnonFunctionType=r,i;case 47:{const e=this.startNode();return e.typeParameters=this.flowParseTypeParameterDeclaration(),this.expect(10),s=this.flowParseFunctionTypeParams(),e.params=s.params,e.rest=s.rest,e.this=s._this,this.expect(11),this.expect(19),e.returnType=this.flowParseType(),this.finishNode(e,"FunctionTypeAnnotation")}case 10:{const e=this.startNode();if(this.next(),!this.match(11)&&!this.match(21))if(H(this.state.type)||this.match(78)){const e=this.lookahead().type;n=17!==e&&14!==e}else n=!0;if(n){if(this.state.noAnonFunctionType=!1,i=this.flowParseType(),this.state.noAnonFunctionType=r,this.state.noAnonFunctionType||!(this.match(12)||this.match(11)&&19===this.lookahead().type))return this.expect(11),i;this.eat(12)}return s=i?this.flowParseFunctionTypeParams([this.reinterpretTypeAsFunctionTypeParam(i)]):this.flowParseFunctionTypeParams(),e.params=s.params,e.rest=s.rest,e.this=s._this,this.expect(11),this.expect(19),e.returnType=this.flowParseType(),e.typeParameters=null,this.finishNode(e,"FunctionTypeAnnotation")}case 133:return this.parseLiteral(this.state.value,"StringLiteralTypeAnnotation");case 85:case 86:return t.value=this.match(85),this.next(),this.finishNode(t,"BooleanLiteralTypeAnnotation");case 53:if("-"===this.state.value){if(this.next(),this.match(134))return this.parseLiteralAtNode(-this.state.value,"NumberLiteralTypeAnnotation",t);if(this.match(135))return this.parseLiteralAtNode(-this.state.value,"BigIntLiteralTypeAnnotation",t);throw this.raise(ot.UnexpectedSubtractionOperand,this.state.startLoc)}return void this.unexpected();case 134:return this.parseLiteral(this.state.value,"NumberLiteralTypeAnnotation");case 135:return this.parseLiteral(this.state.value,"BigIntLiteralTypeAnnotation");case 88:return this.next(),this.finishNode(t,"VoidTypeAnnotation");case 84:return this.next(),this.finishNode(t,"NullLiteralTypeAnnotation");case 78:return this.next(),this.finishNode(t,"ThisTypeAnnotation");case 55:return this.next(),this.finishNode(t,"ExistsTypeAnnotation");case 87:return this.flowParseTypeofType();default:if(G(this.state.type)){const e=Y(this.state.type);return this.next(),super.createIdentifier(t,e)}if(H(this.state.type))return this.isContextual(129)?this.flowParseInterfaceType():this.flowIdentToTypeAnnotation(e,t,this.parseIdentifier())}this.unexpected()}flowParsePostfixType(){const e=this.state.startLoc;let t=this.flowParsePrimaryType(),s=!1;for(;(this.match(0)||this.match(18))&&!this.canInsertSemicolon();){const i=this.startNodeAt(e),n=this.eat(18);s=s||n,this.expect(0),!n&&this.match(3)?(i.elementType=t,this.next(),t=this.finishNode(i,"ArrayTypeAnnotation")):(i.objectType=t,i.indexType=this.flowParseType(),this.expect(3),s?(i.optional=n,t=this.finishNode(i,"OptionalIndexedAccessType")):t=this.finishNode(i,"IndexedAccessType"))}return t}flowParsePrefixType(){const e=this.startNode();return this.eat(17)?(e.typeAnnotation=this.flowParsePrefixType(),this.finishNode(e,"NullableTypeAnnotation")):this.flowParsePostfixType()}flowParseAnonFunctionWithoutParens(){const e=this.flowParsePrefixType();if(!this.state.noAnonFunctionType&&this.eat(19)){const t=this.startNodeAt(e.loc.start);return t.params=[this.reinterpretTypeAsFunctionTypeParam(e)],t.rest=null,t.this=null,t.returnType=this.flowParseType(),t.typeParameters=null,this.finishNode(t,"FunctionTypeAnnotation")}return e}flowParseIntersectionType(){const e=this.startNode();this.eat(45);const t=this.flowParseAnonFunctionWithoutParens();for(e.types=[t];this.eat(45);)e.types.push(this.flowParseAnonFunctionWithoutParens());return 1===e.types.length?t:this.finishNode(e,"IntersectionTypeAnnotation")}flowParseUnionType(){const e=this.startNode();this.eat(43);const t=this.flowParseIntersectionType();for(e.types=[t];this.eat(43);)e.types.push(this.flowParseIntersectionType());return 1===e.types.length?t:this.finishNode(e,"UnionTypeAnnotation")}flowParseType(){const e=this.state.inType;this.state.inType=!0;const t=this.flowParseUnionType();return this.state.inType=e,t}flowParseTypeOrImplicitInstantiation(){if(132===this.state.type&&"_"===this.state.value){const e=this.state.startLoc,t=this.parseIdentifier();return this.flowParseGenericType(e,t)}return this.flowParseType()}flowParseTypeAnnotation(){const e=this.startNode();return e.typeAnnotation=this.flowParseTypeInitialiser(),this.finishNode(e,"TypeAnnotation")}flowParseTypeAnnotatableIdentifier(e){const t=e?this.parseIdentifier():this.flowParseRestrictedIdentifier();return this.match(14)&&(t.typeAnnotation=this.flowParseTypeAnnotation(),this.resetEndLocation(t)),t}typeCastToParameter(e){return e.expression.typeAnnotation=e.typeAnnotation,this.resetEndLocation(e.expression,e.typeAnnotation.loc.end),e.expression}flowParseVariance(){let e=null;return this.match(53)?(e=this.startNode(),"+"===this.state.value?e.kind="plus":e.kind="minus",this.next(),this.finishNode(e,"Variance")):e}parseFunctionBody(e,t,s=!1){t?this.forwardNoArrowParamsConversionAt(e,(()=>super.parseFunctionBody(e,!0,s))):super.parseFunctionBody(e,!1,s)}parseFunctionBodyAndFinish(e,t,s=!1){if(this.match(14)){const t=this.startNode();[t.typeAnnotation,e.predicate]=this.flowParseTypeAndPredicateInitialiser(),e.returnType=t.typeAnnotation?this.finishNode(t,"TypeAnnotation"):null}return super.parseFunctionBodyAndFinish(e,t,s)}parseStatementLike(e){if(this.state.strict&&this.isContextual(129)){if(V(this.lookahead().type)){const e=this.startNode();return this.next(),this.flowParseInterface(e)}}else if(this.shouldParseEnums()&&this.isContextual(126)){const e=this.startNode();return this.next(),this.flowParseEnumDeclaration(e)}const t=super.parseStatementLike(e);return void 0!==this.flowPragma||this.isValidDirective(t)||(this.flowPragma=null),t}parseExpressionStatement(e,t,s){if("Identifier"===t.type)if("declare"===t.name){if(this.match(80)||H(this.state.type)||this.match(68)||this.match(74)||this.match(82))return this.flowParseDeclare(e)}else if(H(this.state.type)){if("interface"===t.name)return this.flowParseInterface(e);if("type"===t.name)return this.flowParseTypeAlias(e);if("opaque"===t.name)return this.flowParseOpaqueType(e,!1)}return super.parseExpressionStatement(e,t,s)}shouldParseExportDeclaration(){const{type:e}=this.state;return K(e)||this.shouldParseEnums()&&126===e?!this.state.containsEsc:super.shouldParseExportDeclaration()}isExportDefaultSpecifier(){const{type:e}=this.state;return K(e)||this.shouldParseEnums()&&126===e?this.state.containsEsc:super.isExportDefaultSpecifier()}parseExportDefaultExpression(){if(this.shouldParseEnums()&&this.isContextual(126)){const e=this.startNode();return this.next(),this.flowParseEnumDeclaration(e)}return super.parseExportDefaultExpression()}parseConditional(e,t,s){if(!this.match(17))return e;if(this.state.maybeInArrowParameters){const t=this.lookaheadCharCode();if(44===t||61===t||58===t||41===t)return this.setOptionalParametersError(s),e}this.expect(17);const i=this.state.clone(),n=this.state.noArrowAt,r=this.startNodeAt(t);let{consequent:a,failed:o}=this.tryParseConditionalConsequent(),[c,h]=this.getArrowLikeExpressions(a);if(o||h.length>0){const e=[...n];if(h.length>0){this.state=i,this.state.noArrowAt=e;for(let t=0;t<h.length;t++)e.push(h[t].start);({consequent:a,failed:o}=this.tryParseConditionalConsequent()),[c,h]=this.getArrowLikeExpressions(a)}o&&c.length>1&&this.raise(ot.AmbiguousConditionalArrow,i.startLoc),o&&1===c.length&&(this.state=i,e.push(c[0].start),this.state.noArrowAt=e,({consequent:a,failed:o}=this.tryParseConditionalConsequent()))}return this.getArrowLikeExpressions(a,!0),this.state.noArrowAt=n,this.expect(14),r.test=e,r.consequent=a,r.alternate=this.forwardNoArrowParamsConversionAt(r,(()=>this.parseMaybeAssign(void 0,void 0))),this.finishNode(r,"ConditionalExpression")}tryParseConditionalConsequent(){this.state.noArrowParamsConversionAt.push(this.state.start);const e=this.parseMaybeAssignAllowIn(),t=!this.match(14);return this.state.noArrowParamsConversionAt.pop(),{consequent:e,failed:t}}getArrowLikeExpressions(e,t){const s=[e],i=[];for(;0!==s.length;){const e=s.pop();"ArrowFunctionExpression"===e.type&&"BlockStatement"!==e.body.type?(e.typeParameters||!e.returnType?this.finishArrowValidation(e):i.push(e),s.push(e.body)):"ConditionalExpression"===e.type&&(s.push(e.consequent),s.push(e.alternate))}return t?(i.forEach((e=>this.finishArrowValidation(e))),[i,[]]):function(e,t){const s=[],i=[];for(let n=0;n<e.length;n++)(t(e[n])?s:i).push(e[n]);return[s,i]}(i,(e=>e.params.every((e=>this.isAssignable(e,!0)))))}finishArrowValidation(e){var t;this.toAssignableList(e.params,null==(t=e.extra)?void 0:t.trailingCommaLoc,!1),this.scope.enter(6),super.checkParams(e,!1,!0),this.scope.exit()}forwardNoArrowParamsConversionAt(e,t){let s;return-1!==this.state.noArrowParamsConversionAt.indexOf(e.start)?(this.state.noArrowParamsConversionAt.push(this.state.start),s=t(),this.state.noArrowParamsConversionAt.pop()):s=t(),s}parseParenItem(e,t){const s=super.parseParenItem(e,t);if(this.eat(17)&&(s.optional=!0,this.resetEndLocation(e)),this.match(14)){const e=this.startNodeAt(t);return e.expression=s,e.typeAnnotation=this.flowParseTypeAnnotation(),this.finishNode(e,"TypeCastExpression")}return s}assertModuleNodeAllowed(e){"ImportDeclaration"===e.type&&("type"===e.importKind||"typeof"===e.importKind)||"ExportNamedDeclaration"===e.type&&"type"===e.exportKind||"ExportAllDeclaration"===e.type&&"type"===e.exportKind||super.assertModuleNodeAllowed(e)}parseExportDeclaration(e){if(this.isContextual(130)){e.exportKind="type";const t=this.startNode();return this.next(),this.match(5)?(e.specifiers=this.parseExportSpecifiers(!0),super.parseExportFrom(e),null):this.flowParseTypeAlias(t)}if(this.isContextual(131)){e.exportKind="type";const t=this.startNode();return this.next(),this.flowParseOpaqueType(t,!1)}if(this.isContextual(129)){e.exportKind="type";const t=this.startNode();return this.next(),this.flowParseInterface(t)}if(this.shouldParseEnums()&&this.isContextual(126)){e.exportKind="value";const t=this.startNode();return this.next(),this.flowParseEnumDeclaration(t)}return super.parseExportDeclaration(e)}eatExportStar(e){return!!super.eatExportStar(e)||!(!this.isContextual(130)||55!==this.lookahead().type)&&(e.exportKind="type",this.next(),this.next(),!0)}maybeParseExportNamespaceSpecifier(e){const{startLoc:t}=this.state,s=super.maybeParseExportNamespaceSpecifier(e);return s&&"type"===e.exportKind&&this.unexpected(t),s}parseClassId(e,t,s){super.parseClassId(e,t,s),this.match(47)&&(e.typeParameters=this.flowParseTypeParameterDeclaration())}parseClassMember(e,t,s){const{startLoc:i}=this.state;if(this.isContextual(125)){if(super.parseClassMemberFromModifier(e,t))return;t.declare=!0}super.parseClassMember(e,t,s),t.declare&&("ClassProperty"!==t.type&&"ClassPrivateProperty"!==t.type&&"PropertyDefinition"!==t.type?this.raise(ot.DeclareClassElement,i):t.value&&this.raise(ot.DeclareClassFieldInitializer,t.value))}isIterator(e){return"iterator"===e||"asyncIterator"===e}readIterator(){const e=super.readWord1(),t="@@"+e;this.isIterator(e)&&this.state.inType||this.raise(b.InvalidIdentifier,this.state.curPosition(),{identifierName:t}),this.finishToken(132,t)}getTokenFromCode(e){const t=this.input.charCodeAt(this.state.pos+1);123===e&&124===t?this.finishOp(6,2):!this.state.inType||62!==e&&60!==e?this.state.inType&&63===e?46===t?this.finishOp(18,2):this.finishOp(17,1):function(e,t,s){return 64===e&&64===t&&ae(s)}(e,t,this.input.charCodeAt(this.state.pos+2))?(this.state.pos+=2,this.readIterator()):super.getTokenFromCode(e):this.finishOp(62===e?48:47,1)}isAssignable(e,t){return"TypeCastExpression"===e.type?this.isAssignable(e.expression,t):super.isAssignable(e,t)}toAssignable(e,t=!1){t||"AssignmentExpression"!==e.type||"TypeCastExpression"!==e.left.type||(e.left=this.typeCastToParameter(e.left)),super.toAssignable(e,t)}toAssignableList(e,t,s){for(let t=0;t<e.length;t++){const s=e[t];"TypeCastExpression"===(null==s?void 0:s.type)&&(e[t]=this.typeCastToParameter(s))}super.toAssignableList(e,t,s)}toReferencedList(e,t){for(let i=0;i<e.length;i++){var s;const n=e[i];!n||"TypeCastExpression"!==n.type||null!=(s=n.extra)&&s.parenthesized||!(e.length>1)&&t||this.raise(ot.TypeCastInPattern,n.typeAnnotation)}return e}parseArrayLike(e,t,s,i){const n=super.parseArrayLike(e,t,s,i);return t&&!this.state.maybeInArrowParameters&&this.toReferencedList(n.elements),n}isValidLVal(e,t,s){return"TypeCastExpression"===e||super.isValidLVal(e,t,s)}parseClassProperty(e){return this.match(14)&&(e.typeAnnotation=this.flowParseTypeAnnotation()),super.parseClassProperty(e)}parseClassPrivateProperty(e){return this.match(14)&&(e.typeAnnotation=this.flowParseTypeAnnotation()),super.parseClassPrivateProperty(e)}isClassMethod(){return this.match(47)||super.isClassMethod()}isClassProperty(){return this.match(14)||super.isClassProperty()}isNonstaticConstructor(e){return!this.match(14)&&super.isNonstaticConstructor(e)}pushClassMethod(e,t,s,i,n,r){if(t.variance&&this.unexpected(t.variance.loc.start),delete t.variance,this.match(47)&&(t.typeParameters=this.flowParseTypeParameterDeclaration()),super.pushClassMethod(e,t,s,i,n,r),t.params&&n){const e=t.params;e.length>0&&this.isThisParam(e[0])&&this.raise(ot.ThisParamBannedInConstructor,t)}else if("MethodDefinition"===t.type&&n&&t.value.params){const e=t.value.params;e.length>0&&this.isThisParam(e[0])&&this.raise(ot.ThisParamBannedInConstructor,t)}}pushClassPrivateMethod(e,t,s,i){t.variance&&this.unexpected(t.variance.loc.start),delete t.variance,this.match(47)&&(t.typeParameters=this.flowParseTypeParameterDeclaration()),super.pushClassPrivateMethod(e,t,s,i)}parseClassSuper(e){if(super.parseClassSuper(e),e.superClass&&this.match(47)&&(e.superTypeParameters=this.flowParseTypeParameterInstantiation()),this.isContextual(113)){this.next();const t=e.implements=[];do{const e=this.startNode();e.id=this.flowParseRestrictedIdentifier(!0),this.match(47)?e.typeParameters=this.flowParseTypeParameterInstantiation():e.typeParameters=null,t.push(this.finishNode(e,"ClassImplements"))}while(this.eat(12))}}checkGetterSetterParams(e){super.checkGetterSetterParams(e);const t=this.getObjectOrClassMethodParams(e);if(t.length>0){const s=t[0];this.isThisParam(s)&&"get"===e.kind?this.raise(ot.GetterMayNotHaveThisParam,s):this.isThisParam(s)&&this.raise(ot.SetterMayNotHaveThisParam,s)}}parsePropertyNamePrefixOperator(e){e.variance=this.flowParseVariance()}parseObjPropValue(e,t,s,i,n,r,a){let o;e.variance&&this.unexpected(e.variance.loc.start),delete e.variance,this.match(47)&&!r&&(o=this.flowParseTypeParameterDeclaration(),this.match(10)||this.unexpected());const c=super.parseObjPropValue(e,t,s,i,n,r,a);return o&&((c.value||c).typeParameters=o),c}parseAssignableListItemTypes(e){return this.eat(17)&&("Identifier"!==e.type&&this.raise(ot.PatternIsOptional,e),this.isThisParam(e)&&this.raise(ot.ThisParamMayNotBeOptional,e),e.optional=!0),this.match(14)?e.typeAnnotation=this.flowParseTypeAnnotation():this.isThisParam(e)&&this.raise(ot.ThisParamAnnotationRequired,e),this.match(29)&&this.isThisParam(e)&&this.raise(ot.ThisParamNoDefault,e),this.resetEndLocation(e),e}parseMaybeDefault(e,t){const s=super.parseMaybeDefault(e,t);return"AssignmentPattern"===s.type&&s.typeAnnotation&&s.right.start<s.typeAnnotation.start&&this.raise(ot.TypeBeforeInitializer,s.typeAnnotation),s}checkImportReflection(e){super.checkImportReflection(e),e.module&&"value"!==e.importKind&&this.raise(ot.ImportReflectionHasImportType,e.specifiers[0].loc.start)}parseImportSpecifierLocal(e,t,s){t.local=ct(e)?this.flowParseRestrictedIdentifier(!0,!0):this.parseIdentifier(),e.specifiers.push(this.finishImportSpecifier(t,s))}isPotentialImportPhase(e){if(super.isPotentialImportPhase(e))return!0;if(this.isContextual(130)){if(!e)return!0;const t=this.lookaheadCharCode();return 123===t||42===t}return!e&&this.isContextual(87)}applyImportPhase(e,t,s,i){if(super.applyImportPhase(e,t,s,i),t){if(!s&&this.match(65))return;e.exportKind="type"===s?s:"value"}else"type"===s&&this.match(55)&&this.unexpected(),e.importKind="type"===s||"typeof"===s?s:"value"}parseImportSpecifier(e,t,s,i,n){const r=e.imported;let a=null;"Identifier"===r.type&&("type"===r.name?a="type":"typeof"===r.name&&(a="typeof"));let o=!1;if(this.isContextual(93)&&!this.isLookaheadContextual("as")){const t=this.parseIdentifier(!0);null===a||V(this.state.type)?(e.imported=r,e.importKind=null,e.local=this.parseIdentifier()):(e.imported=t,e.importKind=a,e.local=nt(t))}else{if(null!==a&&V(this.state.type))e.imported=this.parseIdentifier(!0),e.importKind=a;else{if(t)throw this.raise(b.ImportBindingIsString,e,{importName:r.value});e.imported=r,e.importKind=null}this.eatContextual(93)?e.local=this.parseIdentifier():(o=!0,e.local=nt(e.imported))}const c=ct(e);return s&&c&&this.raise(ot.ImportTypeShorthandOnlyInPureImport,e),(s||c)&&this.checkReservedType(e.local.name,e.local.loc.start,!0),!o||s||c||this.checkReservedWord(e.local.name,e.loc.start,!0,!0),this.finishImportSpecifier(e,"ImportSpecifier")}parseBindingAtom(){return 78===this.state.type?this.parseIdentifier(!0):super.parseBindingAtom()}parseFunctionParams(e,t){const s=e.kind;"get"!==s&&"set"!==s&&this.match(47)&&(e.typeParameters=this.flowParseTypeParameterDeclaration()),super.parseFunctionParams(e,t)}parseVarId(e,t){super.parseVarId(e,t),this.match(14)&&(e.id.typeAnnotation=this.flowParseTypeAnnotation(),this.resetEndLocation(e.id))}parseAsyncArrowFromCallExpression(e,t){if(this.match(14)){const t=this.state.noAnonFunctionType;this.state.noAnonFunctionType=!0,e.returnType=this.flowParseTypeAnnotation(),this.state.noAnonFunctionType=t}return super.parseAsyncArrowFromCallExpression(e,t)}shouldParseAsyncArrow(){return this.match(14)||super.shouldParseAsyncArrow()}parseMaybeAssign(e,t){var s;let i,n=null;if(this.hasPlugin("jsx")&&(this.match(142)||this.match(47))){if(n=this.state.clone(),i=this.tryParse((()=>super.parseMaybeAssign(e,t)),n),!i.error)return i.node;const{context:s}=this.state,r=s[s.length-1];r!==T.j_oTag&&r!==T.j_expr||s.pop()}if(null!=(s=i)&&s.error||this.match(47)){var r,a;let s;n=n||this.state.clone();const o=this.tryParse((i=>{var n;s=this.flowParseTypeParameterDeclaration();const r=this.forwardNoArrowParamsConversionAt(s,(()=>{const i=super.parseMaybeAssign(e,t);return this.resetStartLocationFromNode(i,s),i}));null!=(n=r.extra)&&n.parenthesized&&i();const a=this.maybeUnwrapTypeCastExpression(r);return"ArrowFunctionExpression"!==a.type&&i(),a.typeParameters=s,this.resetStartLocationFromNode(a,s),r}),n);let c=null;if(o.node&&"ArrowFunctionExpression"===this.maybeUnwrapTypeCastExpression(o.node).type){if(!o.error&&!o.aborted)return o.node.async&&this.raise(ot.UnexpectedTypeParameterBeforeAsyncArrowFunction,s),o.node;c=o.node}if(null!=(r=i)&&r.node)return this.state=i.failState,i.node;if(c)return this.state=o.failState,c;if(null!=(a=i)&&a.thrown)throw i.error;if(o.thrown)throw o.error;throw this.raise(ot.UnexpectedTokenAfterTypeParameter,s)}return super.parseMaybeAssign(e,t)}parseArrow(e){if(this.match(14)){const t=this.tryParse((()=>{const t=this.state.noAnonFunctionType;this.state.noAnonFunctionType=!0;const s=this.startNode();return[s.typeAnnotation,e.predicate]=this.flowParseTypeAndPredicateInitialiser(),this.state.noAnonFunctionType=t,this.canInsertSemicolon()&&this.unexpected(),this.match(19)||this.unexpected(),s}));if(t.thrown)return null;t.error&&(this.state=t.failState),e.returnType=t.node.typeAnnotation?this.finishNode(t.node,"TypeAnnotation"):null}return super.parseArrow(e)}shouldParseArrow(e){return this.match(14)||super.shouldParseArrow(e)}setArrowFunctionParameters(e,t){-1!==this.state.noArrowParamsConversionAt.indexOf(e.start)?e.params=t:super.setArrowFunctionParameters(e,t)}checkParams(e,t,s,i=!0){if(!s||-1===this.state.noArrowParamsConversionAt.indexOf(e.start)){for(let t=0;t<e.params.length;t++)this.isThisParam(e.params[t])&&t>0&&this.raise(ot.ThisParamMustBeFirst,e.params[t]);super.checkParams(e,t,s,i)}}parseParenAndDistinguishExpression(e){return super.parseParenAndDistinguishExpression(e&&-1===this.state.noArrowAt.indexOf(this.state.start))}parseSubscripts(e,t,s){if("Identifier"===e.type&&"async"===e.name&&-1!==this.state.noArrowAt.indexOf(t.index)){this.next();const s=this.startNodeAt(t);s.callee=e,s.arguments=super.parseCallExpressionArguments(11,!1),e=this.finishNode(s,"CallExpression")}else if("Identifier"===e.type&&"async"===e.name&&this.match(47)){const i=this.state.clone(),n=this.tryParse((e=>this.parseAsyncArrowWithTypeParameters(t)||e()),i);if(!n.error&&!n.aborted)return n.node;const r=this.tryParse((()=>super.parseSubscripts(e,t,s)),i);if(r.node&&!r.error)return r.node;if(n.node)return this.state=n.failState,n.node;if(r.node)return this.state=r.failState,r.node;throw n.error||r.error}return super.parseSubscripts(e,t,s)}parseSubscript(e,t,s,i){if(this.match(18)&&this.isLookaheadToken_lt()){if(i.optionalChainMember=!0,s)return i.stop=!0,e;this.next();const n=this.startNodeAt(t);return n.callee=e,n.typeArguments=this.flowParseTypeParameterInstantiation(),this.expect(10),n.arguments=this.parseCallExpressionArguments(11,!1),n.optional=!0,this.finishCallExpression(n,!0)}if(!s&&this.shouldParseTypes()&&this.match(47)){const s=this.startNodeAt(t);s.callee=e;const n=this.tryParse((()=>(s.typeArguments=this.flowParseTypeParameterInstantiationCallOrNew(),this.expect(10),s.arguments=super.parseCallExpressionArguments(11,!1),i.optionalChainMember&&(s.optional=!1),this.finishCallExpression(s,i.optionalChainMember))));if(n.node)return n.error&&(this.state=n.failState),n.node}return super.parseSubscript(e,t,s,i)}parseNewCallee(e){super.parseNewCallee(e);let t=null;this.shouldParseTypes()&&this.match(47)&&(t=this.tryParse((()=>this.flowParseTypeParameterInstantiationCallOrNew())).node),e.typeArguments=t}parseAsyncArrowWithTypeParameters(e){const t=this.startNodeAt(e);if(this.parseFunctionParams(t,!1),this.parseArrow(t))return super.parseArrowExpression(t,void 0,!0)}readToken_mult_modulo(e){const t=this.input.charCodeAt(this.state.pos+1);if(42===e&&47===t&&this.state.hasFlowComment)return this.state.hasFlowComment=!1,this.state.pos+=2,void this.nextToken();super.readToken_mult_modulo(e)}readToken_pipe_amp(e){const t=this.input.charCodeAt(this.state.pos+1);124!==e||125!==t?super.readToken_pipe_amp(e):this.finishOp(9,2)}parseTopLevel(e,t){const s=super.parseTopLevel(e,t);return this.state.hasFlowComment&&this.raise(ot.UnterminatedFlowComment,this.state.curPosition()),s}skipBlockComment(){if(!this.hasPlugin("flowComments")||!this.skipFlowComment())return super.skipBlockComment(this.state.hasFlowComment?"*-/":"*/");{if(this.state.hasFlowComment)throw this.raise(ot.NestedFlowComment,this.state.startLoc);this.hasFlowCommentCompletion();const e=this.skipFlowComment();e&&(this.state.pos+=e,this.state.hasFlowComment=!0)}}skipFlowComment(){const{pos:e}=this.state;let t=2;for(;[32,9].includes(this.input.charCodeAt(e+t));)t++;const s=this.input.charCodeAt(t+e),i=this.input.charCodeAt(t+e+1);return 58===s&&58===i?t+2:"flow-include"===this.input.slice(t+e,t+e+12)?t+12:58===s&&58!==i&&t}hasFlowCommentCompletion(){if(-1===this.input.indexOf("*/",this.state.pos))throw this.raise(b.UnterminatedComment,this.state.curPosition())}flowEnumErrorBooleanMemberNotInitialized(e,{enumName:t,memberName:s}){this.raise(ot.EnumBooleanMemberNotInitialized,e,{memberName:s,enumName:t})}flowEnumErrorInvalidMemberInitializer(e,t){return this.raise(t.explicitType?"symbol"===t.explicitType?ot.EnumInvalidMemberInitializerSymbolType:ot.EnumInvalidMemberInitializerPrimaryType:ot.EnumInvalidMemberInitializerUnknownType,e,t)}flowEnumErrorNumberMemberNotInitialized(e,t){this.raise(ot.EnumNumberMemberNotInitialized,e,t)}flowEnumErrorStringMemberInconsistentlyInitialized(e,t){this.raise(ot.EnumStringMemberInconsistentlyInitialized,e,t)}flowEnumMemberInit(){const e=this.state.startLoc,t=()=>this.match(12)||this.match(8);switch(this.state.type){case 134:{const s=this.parseNumericLiteral(this.state.value);return t()?{type:"number",loc:s.loc.start,value:s}:{type:"invalid",loc:e}}case 133:{const s=this.parseStringLiteral(this.state.value);return t()?{type:"string",loc:s.loc.start,value:s}:{type:"invalid",loc:e}}case 85:case 86:{const s=this.parseBooleanLiteral(this.match(85));return t()?{type:"boolean",loc:s.loc.start,value:s}:{type:"invalid",loc:e}}default:return{type:"invalid",loc:e}}}flowEnumMemberRaw(){const e=this.state.startLoc;return{id:this.parseIdentifier(!0),init:this.eat(29)?this.flowEnumMemberInit():{type:"none",loc:e}}}flowEnumCheckExplicitTypeMismatch(e,t,s){const{explicitType:i}=t;null!==i&&i!==s&&this.flowEnumErrorInvalidMemberInitializer(e,t)}flowEnumMembers({enumName:e,explicitType:t}){const s=new Set,i={booleanMembers:[],numberMembers:[],stringMembers:[],defaultedMembers:[]};let n=!1;for(;!this.match(8);){if(this.eat(21)){n=!0;break}const r=this.startNode(),{id:a,init:o}=this.flowEnumMemberRaw(),c=a.name;if(""===c)continue;/^[a-z]/.test(c)&&this.raise(ot.EnumInvalidMemberName,a,{memberName:c,suggestion:c[0].toUpperCase()+c.slice(1),enumName:e}),s.has(c)&&this.raise(ot.EnumDuplicateMemberName,a,{memberName:c,enumName:e}),s.add(c);const h={enumName:e,explicitType:t,memberName:c};switch(r.id=a,o.type){case"boolean":this.flowEnumCheckExplicitTypeMismatch(o.loc,h,"boolean"),r.init=o.value,i.booleanMembers.push(this.finishNode(r,"EnumBooleanMember"));break;case"number":this.flowEnumCheckExplicitTypeMismatch(o.loc,h,"number"),r.init=o.value,i.numberMembers.push(this.finishNode(r,"EnumNumberMember"));break;case"string":this.flowEnumCheckExplicitTypeMismatch(o.loc,h,"string"),r.init=o.value,i.stringMembers.push(this.finishNode(r,"EnumStringMember"));break;case"invalid":throw this.flowEnumErrorInvalidMemberInitializer(o.loc,h);case"none":switch(t){case"boolean":this.flowEnumErrorBooleanMemberNotInitialized(o.loc,h);break;case"number":this.flowEnumErrorNumberMemberNotInitialized(o.loc,h);break;default:i.defaultedMembers.push(this.finishNode(r,"EnumDefaultedMember"))}}this.match(8)||this.expect(12)}return{members:i,hasUnknownMembers:n}}flowEnumStringMembers(e,t,{enumName:s}){if(0===e.length)return t;if(0===t.length)return e;if(t.length>e.length){for(const t of e)this.flowEnumErrorStringMemberInconsistentlyInitialized(t,{enumName:s});return t}for(const e of t)this.flowEnumErrorStringMemberInconsistentlyInitialized(e,{enumName:s});return e}flowEnumParseExplicitType({enumName:e}){if(!this.eatContextual(102))return null;if(!H(this.state.type))throw this.raise(ot.EnumInvalidExplicitTypeUnknownSupplied,this.state.startLoc,{enumName:e});const{value:t}=this.state;return this.next(),"boolean"!==t&&"number"!==t&&"string"!==t&&"symbol"!==t&&this.raise(ot.EnumInvalidExplicitType,this.state.startLoc,{enumName:e,invalidEnumType:t}),t}flowEnumBody(e,t){const s=t.name,i=t.loc.start,n=this.flowEnumParseExplicitType({enumName:s});this.expect(5);const{members:r,hasUnknownMembers:a}=this.flowEnumMembers({enumName:s,explicitType:n});switch(e.hasUnknownMembers=a,n){case"boolean":return e.explicitType=!0,e.members=r.booleanMembers,this.expect(8),this.finishNode(e,"EnumBooleanBody");case"number":return e.explicitType=!0,e.members=r.numberMembers,this.expect(8),this.finishNode(e,"EnumNumberBody");case"string":return e.explicitType=!0,e.members=this.flowEnumStringMembers(r.stringMembers,r.defaultedMembers,{enumName:s}),this.expect(8),this.finishNode(e,"EnumStringBody");case"symbol":return e.members=r.defaultedMembers,this.expect(8),this.finishNode(e,"EnumSymbolBody");default:{const t=()=>(e.members=[],this.expect(8),this.finishNode(e,"EnumStringBody"));e.explicitType=!1;const n=r.booleanMembers.length,a=r.numberMembers.length,o=r.stringMembers.length,c=r.defaultedMembers.length;if(n||a||o||c){if(n||a){if(!a&&!o&&n>=c){for(const e of r.defaultedMembers)this.flowEnumErrorBooleanMemberNotInitialized(e.loc.start,{enumName:s,memberName:e.id.name});return e.members=r.booleanMembers,this.expect(8),this.finishNode(e,"EnumBooleanBody")}if(!n&&!o&&a>=c){for(const e of r.defaultedMembers)this.flowEnumErrorNumberMemberNotInitialized(e.loc.start,{enumName:s,memberName:e.id.name});return e.members=r.numberMembers,this.expect(8),this.finishNode(e,"EnumNumberBody")}return this.raise(ot.EnumInconsistentMemberValues,i,{enumName:s}),t()}return e.members=this.flowEnumStringMembers(r.stringMembers,r.defaultedMembers,{enumName:s}),this.expect(8),this.finishNode(e,"EnumStringBody")}return t()}}}flowParseEnumDeclaration(e){const t=this.parseIdentifier();return e.id=t,e.body=this.flowEnumBody(this.startNode(),t),this.finishNode(e,"EnumDeclaration")}isLookaheadToken_lt(){const e=this.nextTokenStart();if(60===this.input.charCodeAt(e)){const t=this.input.charCodeAt(e+1);return 60!==t&&61!==t}return!1}maybeUnwrapTypeCastExpression(e){return"TypeCastExpression"===e.type?e.expression:e}},typescript:e=>class extends e{constructor(...e){super(...e),this.tsParseInOutModifiers=this.tsParseModifiers.bind(this,{allowedModifiers:["in","out"],disallowedModifiers:["const","public","private","protected","readonly","declare","abstract","override"],errorTemplate:_t.InvalidModifierOnTypeParameter}),this.tsParseConstModifier=this.tsParseModifiers.bind(this,{allowedModifiers:["const"],disallowedModifiers:["in","out"],errorTemplate:_t.InvalidModifierOnTypeParameterPositions}),this.tsParseInOutConstModifiers=this.tsParseModifiers.bind(this,{allowedModifiers:["in","out","const"],disallowedModifiers:["public","private","protected","readonly","declare","abstract","override"],errorTemplate:_t.InvalidModifierOnTypeParameter})}getScopeHandler(){return yt}tsIsIdentifier(){return H(this.state.type)}tsTokenCanFollowModifier(){return(this.match(0)||this.match(5)||this.match(55)||this.match(21)||this.match(138)||this.isLiteralPropertyName())&&!this.hasPrecedingLineBreak()}tsNextTokenCanFollowModifier(){return this.next(),this.tsTokenCanFollowModifier()}tsParseModifier(e,t){if(!H(this.state.type)&&58!==this.state.type&&75!==this.state.type)return;const s=this.state.value;if(-1!==e.indexOf(s)){if(t&&this.tsIsStartOfStaticBlocks())return;if(this.tsTryParse(this.tsNextTokenCanFollowModifier.bind(this)))return s}}tsParseModifiers({allowedModifiers:e,disallowedModifiers:t,stopOnStartOfClassStaticBlock:s,errorTemplate:i=_t.InvalidModifierOnTypeMember},n){const r=(e,t,s,i)=>{t===s&&n[i]&&this.raise(_t.InvalidModifiersOrder,e,{orderedModifiers:[s,i]})},a=(e,t,s,i)=>{(n[s]&&t===i||n[i]&&t===s)&&this.raise(_t.IncompatibleModifiers,e,{modifiers:[s,i]})};for(;;){const{startLoc:o}=this.state,c=this.tsParseModifier(e.concat(null!=t?t:[]),s);if(!c)break;xt(c)?n.accessibility?this.raise(_t.DuplicateAccessibilityModifier,o,{modifier:c}):(r(o,c,c,"override"),r(o,c,c,"static"),r(o,c,c,"readonly"),n.accessibility=c):vt(c)?(n[c]&&this.raise(_t.DuplicateModifier,o,{modifier:c}),n[c]=!0,r(o,c,"in","out")):(hasOwnProperty.call(n,c)?this.raise(_t.DuplicateModifier,o,{modifier:c}):(r(o,c,"static","readonly"),r(o,c,"static","override"),r(o,c,"override","readonly"),r(o,c,"abstract","override"),a(o,c,"declare","override"),a(o,c,"static","abstract")),n[c]=!0),null!=t&&t.includes(c)&&this.raise(i,o,{modifier:c})}}tsIsListTerminator(e){switch(e){case"EnumMembers":case"TypeMembers":return this.match(8);case"HeritageClauseElement":return this.match(5);case"TupleElementTypes":return this.match(3);case"TypeParametersOrArguments":return this.match(48)}}tsParseList(e,t){const s=[];for(;!this.tsIsListTerminator(e);)s.push(t());return s}tsParseDelimitedList(e,t,s){return function(e){if(null==e)throw new Error(`Unexpected ${e} value.`);return e}(this.tsParseDelimitedListWorker(e,t,!0,s))}tsParseDelimitedListWorker(e,t,s,i){const n=[];let r=-1;for(;!this.tsIsListTerminator(e);){r=-1;const i=t();if(null==i)return;if(n.push(i),!this.eat(12)){if(this.tsIsListTerminator(e))break;return void(s&&this.expect(12))}r=this.state.lastTokStartLoc.index}return i&&(i.value=r),n}tsParseBracketedList(e,t,s,i,n){i||(s?this.expect(0):this.expect(47));const r=this.tsParseDelimitedList(e,t,n);return s?this.expect(3):this.expect(48),r}tsParseImportType(){const e=this.startNode();return this.expect(83),this.expect(10),this.match(133)||this.raise(_t.UnsupportedImportTypeArgument,this.state.startLoc),e.argument=super.parseExprAtom(),(this.hasPlugin("importAttributes")||this.hasPlugin("importAssertions"))&&(e.options=null),this.eat(12)&&(this.expectImportAttributesPlugin(),this.match(11)||(e.options=super.parseMaybeAssignAllowIn(),this.eat(12))),this.expect(11),this.eat(16)&&(e.qualifier=this.tsParseEntityName()),this.match(47)&&(e.typeParameters=this.tsParseTypeArguments()),this.finishNode(e,"TSImportType")}tsParseEntityName(e=!0){let t=this.parseIdentifier(e);for(;this.eat(16);){const s=this.startNodeAtNode(t);s.left=t,s.right=this.parseIdentifier(e),t=this.finishNode(s,"TSQualifiedName")}return t}tsParseTypeReference(){const e=this.startNode();return e.typeName=this.tsParseEntityName(),!this.hasPrecedingLineBreak()&&this.match(47)&&(e.typeParameters=this.tsParseTypeArguments()),this.finishNode(e,"TSTypeReference")}tsParseThisTypePredicate(e){this.next();const t=this.startNodeAtNode(e);return t.parameterName=e,t.typeAnnotation=this.tsParseTypeAnnotation(!1),t.asserts=!1,this.finishNode(t,"TSTypePredicate")}tsParseThisTypeNode(){const e=this.startNode();return this.next(),this.finishNode(e,"TSThisType")}tsParseTypeQuery(){const e=this.startNode();return this.expect(87),this.match(83)?e.exprName=this.tsParseImportType():e.exprName=this.tsParseEntityName(),!this.hasPrecedingLineBreak()&&this.match(47)&&(e.typeParameters=this.tsParseTypeArguments()),this.finishNode(e,"TSTypeQuery")}tsParseTypeParameter(e){const t=this.startNode();return e(t),t.name=this.tsParseTypeParameterName(),t.constraint=this.tsEatThenParseType(81),t.default=this.tsEatThenParseType(29),this.finishNode(t,"TSTypeParameter")}tsTryParseTypeParameters(e){if(this.match(47))return this.tsParseTypeParameters(e)}tsParseTypeParameters(e){const t=this.startNode();this.match(47)||this.match(142)?this.next():this.unexpected();const s={value:-1};return t.params=this.tsParseBracketedList("TypeParametersOrArguments",this.tsParseTypeParameter.bind(this,e),!1,!0,s),0===t.params.length&&this.raise(_t.EmptyTypeParameters,t),-1!==s.value&&this.addExtra(t,"trailingComma",s.value),this.finishNode(t,"TSTypeParameterDeclaration")}tsFillSignature(e,t){const s=19===e;t.typeParameters=this.tsTryParseTypeParameters(this.tsParseConstModifier),this.expect(10),t.parameters=this.tsParseBindingListForSignature(),(s||this.match(e))&&(t.typeAnnotation=this.tsParseTypeOrTypePredicateAnnotation(e))}tsParseBindingListForSignature(){const e=super.parseBindingList(11,41,2);for(const t of e){const{type:e}=t;"AssignmentPattern"!==e&&"TSParameterProperty"!==e||this.raise(_t.UnsupportedSignatureParameterKind,t,{type:e})}return e}tsParseTypeMemberSemicolon(){this.eat(12)||this.isLineTerminator()||this.expect(13)}tsParseSignatureMember(e,t){return this.tsFillSignature(14,t),this.tsParseTypeMemberSemicolon(),this.finishNode(t,e)}tsIsUnambiguouslyIndexSignature(){return this.next(),!!H(this.state.type)&&(this.next(),this.match(14))}tsTryParseIndexSignature(e){if(!this.match(0)||!this.tsLookAhead(this.tsIsUnambiguouslyIndexSignature.bind(this)))return;this.expect(0);const t=this.parseIdentifier();t.typeAnnotation=this.tsParseTypeAnnotation(),this.resetEndLocation(t),this.expect(3),e.parameters=[t];const s=this.tsTryParseTypeAnnotation();return s&&(e.typeAnnotation=s),this.tsParseTypeMemberSemicolon(),this.finishNode(e,"TSIndexSignature")}tsParsePropertyOrMethodSignature(e,t){this.eat(17)&&(e.optional=!0);const s=e;if(this.match(10)||this.match(47)){t&&this.raise(_t.ReadonlyForMethodSignature,e);const i=s;i.kind&&this.match(47)&&this.raise(_t.AccesorCannotHaveTypeParameters,this.state.curPosition()),this.tsFillSignature(14,i),this.tsParseTypeMemberSemicolon();const n="parameters",r="typeAnnotation";if("get"===i.kind)i[n].length>0&&(this.raise(b.BadGetterArity,this.state.curPosition()),this.isThisParam(i[n][0])&&this.raise(_t.AccesorCannotDeclareThisParameter,this.state.curPosition()));else if("set"===i.kind){if(1!==i[n].length)this.raise(b.BadSetterArity,this.state.curPosition());else{const e=i[n][0];this.isThisParam(e)&&this.raise(_t.AccesorCannotDeclareThisParameter,this.state.curPosition()),"Identifier"===e.type&&e.optional&&this.raise(_t.SetAccesorCannotHaveOptionalParameter,this.state.curPosition()),"RestElement"===e.type&&this.raise(_t.SetAccesorCannotHaveRestParameter,this.state.curPosition())}i[r]&&this.raise(_t.SetAccesorCannotHaveReturnType,i[r])}else i.kind="method";return this.finishNode(i,"TSMethodSignature")}{const e=s;t&&(e.readonly=!0);const i=this.tsTryParseTypeAnnotation();return i&&(e.typeAnnotation=i),this.tsParseTypeMemberSemicolon(),this.finishNode(e,"TSPropertySignature")}}tsParseTypeMember(){const e=this.startNode();if(this.match(10)||this.match(47))return this.tsParseSignatureMember("TSCallSignatureDeclaration",e);if(this.match(77)){const t=this.startNode();return this.next(),this.match(10)||this.match(47)?this.tsParseSignatureMember("TSConstructSignatureDeclaration",e):(e.key=this.createIdentifier(t,"new"),this.tsParsePropertyOrMethodSignature(e,!1))}this.tsParseModifiers({allowedModifiers:["readonly"],disallowedModifiers:["declare","abstract","private","protected","public","static","override"]},e);return this.tsTryParseIndexSignature(e)||(super.parsePropertyName(e),e.computed||"Identifier"!==e.key.type||"get"!==e.key.name&&"set"!==e.key.name||!this.tsTokenCanFollowModifier()||(e.kind=e.key.name,super.parsePropertyName(e)),this.tsParsePropertyOrMethodSignature(e,!!e.readonly))}tsParseTypeLiteral(){const e=this.startNode();return e.members=this.tsParseObjectTypeMembers(),this.finishNode(e,"TSTypeLiteral")}tsParseObjectTypeMembers(){this.expect(5);const e=this.tsParseList("TypeMembers",this.tsParseTypeMember.bind(this));return this.expect(8),e}tsIsStartOfMappedType(){return this.next(),this.eat(53)?this.isContextual(122):(this.isContextual(122)&&this.next(),!!this.match(0)&&(this.next(),!!this.tsIsIdentifier()&&(this.next(),this.match(58))))}tsParseMappedTypeParameter(){const e=this.startNode();return e.name=this.tsParseTypeParameterName(),e.constraint=this.tsExpectThenParseType(58),this.finishNode(e,"TSTypeParameter")}tsParseMappedType(){const e=this.startNode();return this.expect(5),this.match(53)?(e.readonly=this.state.value,this.next(),this.expectContextual(122)):this.eatContextual(122)&&(e.readonly=!0),this.expect(0),e.typeParameter=this.tsParseMappedTypeParameter(),e.nameType=this.eatContextual(93)?this.tsParseType():null,this.expect(3),this.match(53)?(e.optional=this.state.value,this.next(),this.expect(17)):this.eat(17)&&(e.optional=!0),e.typeAnnotation=this.tsTryParseType(),this.semicolon(),this.expect(8),this.finishNode(e,"TSMappedType")}tsParseTupleType(){const e=this.startNode();e.elementTypes=this.tsParseBracketedList("TupleElementTypes",this.tsParseTupleElementType.bind(this),!0,!1);let t=!1;return e.elementTypes.forEach((e=>{const{type:s}=e;!t||"TSRestType"===s||"TSOptionalType"===s||"TSNamedTupleMember"===s&&e.optional||this.raise(_t.OptionalTypeBeforeRequired,e),t||(t="TSNamedTupleMember"===s&&e.optional||"TSOptionalType"===s)})),this.finishNode(e,"TSTupleType")}tsParseTupleElementType(){const{startLoc:e}=this.state,t=this.eat(21);let s,i,n,r;const a=V(this.state.type)?this.lookaheadCharCode():null;if(58===a)s=!0,n=!1,i=this.parseIdentifier(!0),this.expect(14),r=this.tsParseType();else if(63===a){n=!0;const e=this.state.startLoc,t=this.state.value,a=this.tsParseNonArrayType();58===this.lookaheadCharCode()?(s=!0,i=this.createIdentifier(this.startNodeAt(e),t),this.expect(17),this.expect(14),r=this.tsParseType()):(s=!1,r=a,this.expect(17))}else r=this.tsParseType(),n=this.eat(17),s=this.eat(14);if(s){let e;i?(e=this.startNodeAtNode(i),e.optional=n,e.label=i,e.elementType=r,this.eat(17)&&(e.optional=!0,this.raise(_t.TupleOptionalAfterType,this.state.lastTokStartLoc))):(e=this.startNodeAtNode(r),e.optional=n,this.raise(_t.InvalidTupleMemberLabel,r),e.label=r,e.elementType=this.tsParseType()),r=this.finishNode(e,"TSNamedTupleMember")}else if(n){const e=this.startNodeAtNode(r);e.typeAnnotation=r,r=this.finishNode(e,"TSOptionalType")}if(t){const t=this.startNodeAt(e);t.typeAnnotation=r,r=this.finishNode(t,"TSRestType")}return r}tsParseParenthesizedType(){const e=this.startNode();return this.expect(10),e.typeAnnotation=this.tsParseType(),this.expect(11),this.finishNode(e,"TSParenthesizedType")}tsParseFunctionOrConstructorType(e,t){const s=this.startNode();return"TSConstructorType"===e&&(s.abstract=!!t,t&&this.next(),this.next()),this.tsInAllowConditionalTypesContext((()=>this.tsFillSignature(19,s))),this.finishNode(s,e)}tsParseLiteralTypeNode(){const e=this.startNode();switch(this.state.type){case 134:case 135:case 133:case 85:case 86:e.literal=super.parseExprAtom();break;default:this.unexpected()}return this.finishNode(e,"TSLiteralType")}tsParseTemplateLiteralType(){const e=this.startNode();return e.literal=super.parseTemplate(!1),this.finishNode(e,"TSLiteralType")}parseTemplateSubstitution(){return this.state.inType?this.tsParseType():super.parseTemplateSubstitution()}tsParseThisTypeOrThisTypePredicate(){const e=this.tsParseThisTypeNode();return this.isContextual(116)&&!this.hasPrecedingLineBreak()?this.tsParseThisTypePredicate(e):e}tsParseNonArrayType(){switch(this.state.type){case 133:case 134:case 135:case 85:case 86:return this.tsParseLiteralTypeNode();case 53:if("-"===this.state.value){const e=this.startNode(),t=this.lookahead();return 134!==t.type&&135!==t.type&&this.unexpected(),e.literal=this.parseMaybeUnary(),this.finishNode(e,"TSLiteralType")}break;case 78:return this.tsParseThisTypeOrThisTypePredicate();case 87:return this.tsParseTypeQuery();case 83:return this.tsParseImportType();case 5:return this.tsLookAhead(this.tsIsStartOfMappedType.bind(this))?this.tsParseMappedType():this.tsParseTypeLiteral();case 0:return this.tsParseTupleType();case 10:return this.tsParseParenthesizedType();case 25:case 24:return this.tsParseTemplateLiteralType();default:{const{type:e}=this.state;if(H(e)||88===e||84===e){const t=88===e?"TSVoidKeyword":84===e?"TSNullKeyword":function(e){switch(e){case"any":return"TSAnyKeyword";case"boolean":return"TSBooleanKeyword";case"bigint":return"TSBigIntKeyword";case"never":return"TSNeverKeyword";case"number":return"TSNumberKeyword";case"object":return"TSObjectKeyword";case"string":return"TSStringKeyword";case"symbol":return"TSSymbolKeyword";case"undefined":return"TSUndefinedKeyword";case"unknown":return"TSUnknownKeyword";default:return}}(this.state.value);if(void 0!==t&&46!==this.lookaheadCharCode()){const e=this.startNode();return this.next(),this.finishNode(e,t)}return this.tsParseTypeReference()}}}this.unexpected()}tsParseArrayTypeOrHigher(){let e=this.tsParseNonArrayType();for(;!this.hasPrecedingLineBreak()&&this.eat(0);)if(this.match(3)){const t=this.startNodeAtNode(e);t.elementType=e,this.expect(3),e=this.finishNode(t,"TSArrayType")}else{const t=this.startNodeAtNode(e);t.objectType=e,t.indexType=this.tsParseType(),this.expect(3),e=this.finishNode(t,"TSIndexedAccessType")}return e}tsParseTypeOperator(){const e=this.startNode(),t=this.state.value;return this.next(),e.operator=t,e.typeAnnotation=this.tsParseTypeOperatorOrHigher(),"readonly"===t&&this.tsCheckTypeAnnotationForReadOnly(e),this.finishNode(e,"TSTypeOperator")}tsCheckTypeAnnotationForReadOnly(e){switch(e.typeAnnotation.type){case"TSTupleType":case"TSArrayType":return;default:this.raise(_t.UnexpectedReadonly,e)}}tsParseInferType(){const e=this.startNode();this.expectContextual(115);const t=this.startNode();return t.name=this.tsParseTypeParameterName(),t.constraint=this.tsTryParse((()=>this.tsParseConstraintForInferType())),e.typeParameter=this.finishNode(t,"TSTypeParameter"),this.finishNode(e,"TSInferType")}tsParseConstraintForInferType(){if(this.eat(81)){const e=this.tsInDisallowConditionalTypesContext((()=>this.tsParseType()));if(this.state.inDisallowConditionalTypesContext||!this.match(17))return e}}tsParseTypeOperatorOrHigher(){var e;return(e=this.state.type)>=121&&e<=123&&!this.state.containsEsc?this.tsParseTypeOperator():this.isContextual(115)?this.tsParseInferType():this.tsInAllowConditionalTypesContext((()=>this.tsParseArrayTypeOrHigher()))}tsParseUnionOrIntersectionType(e,t,s){const i=this.startNode(),n=this.eat(s),r=[];do{r.push(t())}while(this.eat(s));return 1!==r.length||n?(i.types=r,this.finishNode(i,e)):r[0]}tsParseIntersectionTypeOrHigher(){return this.tsParseUnionOrIntersectionType("TSIntersectionType",this.tsParseTypeOperatorOrHigher.bind(this),45)}tsParseUnionTypeOrHigher(){return this.tsParseUnionOrIntersectionType("TSUnionType",this.tsParseIntersectionTypeOrHigher.bind(this),43)}tsIsStartOfFunctionType(){return!!this.match(47)||this.match(10)&&this.tsLookAhead(this.tsIsUnambiguouslyStartOfFunctionType.bind(this))}tsSkipParameterStart(){if(H(this.state.type)||this.match(78))return this.next(),!0;if(this.match(5)){const{errors:e}=this.state,t=e.length;try{return this.parseObjectLike(8,!0),e.length===t}catch(e){return!1}}if(this.match(0)){this.next();const{errors:e}=this.state,t=e.length;try{return super.parseBindingList(3,93,1),e.length===t}catch(e){return!1}}return!1}tsIsUnambiguouslyStartOfFunctionType(){if(this.next(),this.match(11)||this.match(21))return!0;if(this.tsSkipParameterStart()){if(this.match(14)||this.match(12)||this.match(17)||this.match(29))return!0;if(this.match(11)&&(this.next(),this.match(19)))return!0}return!1}tsParseTypeOrTypePredicateAnnotation(e){return this.tsInType((()=>{const t=this.startNode();this.expect(e);const s=this.startNode(),i=!!this.tsTryParse(this.tsParseTypePredicateAsserts.bind(this));if(i&&this.match(78)){let e=this.tsParseThisTypeOrThisTypePredicate();return"TSThisType"===e.type?(s.parameterName=e,s.asserts=!0,s.typeAnnotation=null,e=this.finishNode(s,"TSTypePredicate")):(this.resetStartLocationFromNode(e,s),e.asserts=!0),t.typeAnnotation=e,this.finishNode(t,"TSTypeAnnotation")}const n=this.tsIsIdentifier()&&this.tsTryParse(this.tsParseTypePredicatePrefix.bind(this));if(!n)return i?(s.parameterName=this.parseIdentifier(),s.asserts=i,s.typeAnnotation=null,t.typeAnnotation=this.finishNode(s,"TSTypePredicate"),this.finishNode(t,"TSTypeAnnotation")):this.tsParseTypeAnnotation(!1,t);const r=this.tsParseTypeAnnotation(!1);return s.parameterName=n,s.typeAnnotation=r,s.asserts=i,t.typeAnnotation=this.finishNode(s,"TSTypePredicate"),this.finishNode(t,"TSTypeAnnotation")}))}tsTryParseTypeOrTypePredicateAnnotation(){if(this.match(14))return this.tsParseTypeOrTypePredicateAnnotation(14)}tsTryParseTypeAnnotation(){if(this.match(14))return this.tsParseTypeAnnotation()}tsTryParseType(){return this.tsEatThenParseType(14)}tsParseTypePredicatePrefix(){const e=this.parseIdentifier();if(this.isContextual(116)&&!this.hasPrecedingLineBreak())return this.next(),e}tsParseTypePredicateAsserts(){if(109!==this.state.type)return!1;const e=this.state.containsEsc;return this.next(),!(!H(this.state.type)&&!this.match(78)||(e&&this.raise(b.InvalidEscapedReservedWord,this.state.lastTokStartLoc,{reservedWord:"asserts"}),0))}tsParseTypeAnnotation(e=!0,t=this.startNode()){return this.tsInType((()=>{e&&this.expect(14),t.typeAnnotation=this.tsParseType()})),this.finishNode(t,"TSTypeAnnotation")}tsParseType(){wt(this.state.inType);const e=this.tsParseNonConditionalType();if(this.state.inDisallowConditionalTypesContext||this.hasPrecedingLineBreak()||!this.eat(81))return e;const t=this.startNodeAtNode(e);return t.checkType=e,t.extendsType=this.tsInDisallowConditionalTypesContext((()=>this.tsParseNonConditionalType())),this.expect(17),t.trueType=this.tsInAllowConditionalTypesContext((()=>this.tsParseType())),this.expect(14),t.falseType=this.tsInAllowConditionalTypesContext((()=>this.tsParseType())),this.finishNode(t,"TSConditionalType")}isAbstractConstructorSignature(){return this.isContextual(124)&&77===this.lookahead().type}tsParseNonConditionalType(){return this.tsIsStartOfFunctionType()?this.tsParseFunctionOrConstructorType("TSFunctionType"):this.match(77)?this.tsParseFunctionOrConstructorType("TSConstructorType"):this.isAbstractConstructorSignature()?this.tsParseFunctionOrConstructorType("TSConstructorType",!0):this.tsParseUnionTypeOrHigher()}tsParseTypeAssertion(){this.getPluginOption("typescript","disallowAmbiguousJSXLike")&&this.raise(_t.ReservedTypeAssertion,this.state.startLoc);const e=this.startNode();return e.typeAnnotation=this.tsInType((()=>(this.next(),this.match(75)?this.tsParseTypeReference():this.tsParseType()))),this.expect(48),e.expression=this.parseMaybeUnary(),this.finishNode(e,"TSTypeAssertion")}tsParseHeritageClause(e){const t=this.state.startLoc,s=this.tsParseDelimitedList("HeritageClauseElement",(()=>{const e=this.startNode();return e.expression=this.tsParseEntityName(),this.match(47)&&(e.typeParameters=this.tsParseTypeArguments()),this.finishNode(e,"TSExpressionWithTypeArguments")}));return s.length||this.raise(_t.EmptyHeritageClauseType,t,{token:e}),s}tsParseInterfaceDeclaration(e,t={}){if(this.hasFollowingLineBreak())return null;this.expectContextual(129),t.declare&&(e.declare=!0),H(this.state.type)?(e.id=this.parseIdentifier(),this.checkIdentifier(e.id,130)):(e.id=null,this.raise(_t.MissingInterfaceName,this.state.startLoc)),e.typeParameters=this.tsTryParseTypeParameters(this.tsParseInOutConstModifiers),this.eat(81)&&(e.extends=this.tsParseHeritageClause("extends"));const s=this.startNode();return s.body=this.tsInType(this.tsParseObjectTypeMembers.bind(this)),e.body=this.finishNode(s,"TSInterfaceBody"),this.finishNode(e,"TSInterfaceDeclaration")}tsParseTypeAliasDeclaration(e){return e.id=this.parseIdentifier(),this.checkIdentifier(e.id,2),e.typeAnnotation=this.tsInType((()=>{if(e.typeParameters=this.tsTryParseTypeParameters(this.tsParseInOutModifiers),this.expect(29),this.isContextual(114)&&16!==this.lookahead().type){const e=this.startNode();return this.next(),this.finishNode(e,"TSIntrinsicKeyword")}return this.tsParseType()})),this.semicolon(),this.finishNode(e,"TSTypeAliasDeclaration")}tsInNoContext(e){const t=this.state.context;this.state.context=[t[0]];try{return e()}finally{this.state.context=t}}tsInType(e){const t=this.state.inType;this.state.inType=!0;try{return e()}finally{this.state.inType=t}}tsInDisallowConditionalTypesContext(e){const t=this.state.inDisallowConditionalTypesContext;this.state.inDisallowConditionalTypesContext=!0;try{return e()}finally{this.state.inDisallowConditionalTypesContext=t}}tsInAllowConditionalTypesContext(e){const t=this.state.inDisallowConditionalTypesContext;this.state.inDisallowConditionalTypesContext=!1;try{return e()}finally{this.state.inDisallowConditionalTypesContext=t}}tsEatThenParseType(e){if(this.match(e))return this.tsNextThenParseType()}tsExpectThenParseType(e){return this.tsInType((()=>(this.expect(e),this.tsParseType())))}tsNextThenParseType(){return this.tsInType((()=>(this.next(),this.tsParseType())))}tsParseEnumMember(){const e=this.startNode();return e.id=this.match(133)?super.parseStringLiteral(this.state.value):this.parseIdentifier(!0),this.eat(29)&&(e.initializer=super.parseMaybeAssignAllowIn()),this.finishNode(e,"TSEnumMember")}tsParseEnumDeclaration(e,t={}){return t.const&&(e.const=!0),t.declare&&(e.declare=!0),this.expectContextual(126),e.id=this.parseIdentifier(),this.checkIdentifier(e.id,e.const?8971:8459),this.expect(5),e.members=this.tsParseDelimitedList("EnumMembers",this.tsParseEnumMember.bind(this)),this.expect(8),this.finishNode(e,"TSEnumDeclaration")}tsParseModuleBlock(){const e=this.startNode();return this.scope.enter(0),this.expect(5),super.parseBlockOrModuleBlockBody(e.body=[],void 0,!0,8),this.scope.exit(),this.finishNode(e,"TSModuleBlock")}tsParseModuleOrNamespaceDeclaration(e,t=!1){if(e.id=this.parseIdentifier(),t||this.checkIdentifier(e.id,1024),this.eat(16)){const t=this.startNode();this.tsParseModuleOrNamespaceDeclaration(t,!0),e.body=t}else this.scope.enter(256),this.prodParam.enter(0),e.body=this.tsParseModuleBlock(),this.prodParam.exit(),this.scope.exit();return this.finishNode(e,"TSModuleDeclaration")}tsParseAmbientExternalModuleDeclaration(e){return this.isContextual(112)?(e.global=!0,e.id=this.parseIdentifier()):this.match(133)?e.id=super.parseStringLiteral(this.state.value):this.unexpected(),this.match(5)?(this.scope.enter(256),this.prodParam.enter(0),e.body=this.tsParseModuleBlock(),this.prodParam.exit(),this.scope.exit()):this.semicolon(),this.finishNode(e,"TSModuleDeclaration")}tsParseImportEqualsDeclaration(e,t,s){e.isExport=s||!1,e.id=t||this.parseIdentifier(),this.checkIdentifier(e.id,4096),this.expect(29);const i=this.tsParseModuleReference();return"type"===e.importKind&&"TSExternalModuleReference"!==i.type&&this.raise(_t.ImportAliasHasImportType,i),e.moduleReference=i,this.semicolon(),this.finishNode(e,"TSImportEqualsDeclaration")}tsIsExternalModuleReference(){return this.isContextual(119)&&40===this.lookaheadCharCode()}tsParseModuleReference(){return this.tsIsExternalModuleReference()?this.tsParseExternalModuleReference():this.tsParseEntityName(!1)}tsParseExternalModuleReference(){const e=this.startNode();return this.expectContextual(119),this.expect(10),this.match(133)||this.unexpected(),e.expression=super.parseExprAtom(),this.expect(11),this.sawUnambiguousESM=!0,this.finishNode(e,"TSExternalModuleReference")}tsLookAhead(e){const t=this.state.clone(),s=e();return this.state=t,s}tsTryParseAndCatch(e){const t=this.tryParse((t=>e()||t()));if(!t.aborted&&t.node)return t.error&&(this.state=t.failState),t.node}tsTryParse(e){const t=this.state.clone(),s=e();if(void 0!==s&&!1!==s)return s;this.state=t}tsTryParseDeclare(e){if(this.isLineTerminator())return;let t,s=this.state.type;return this.isContextual(100)&&(s=74,t="let"),this.tsInAmbientContext((()=>{switch(s){case 68:return e.declare=!0,super.parseFunctionStatement(e,!1,!1);case 80:return e.declare=!0,this.parseClass(e,!0,!1);case 126:return this.tsParseEnumDeclaration(e,{declare:!0});case 112:return this.tsParseAmbientExternalModuleDeclaration(e);case 75:case 74:return this.match(75)&&this.isLookaheadContextual("enum")?(this.expect(75),this.tsParseEnumDeclaration(e,{const:!0,declare:!0})):(e.declare=!0,this.parseVarStatement(e,t||this.state.value,!0));case 129:{const t=this.tsParseInterfaceDeclaration(e,{declare:!0});if(t)return t}default:if(H(s))return this.tsParseDeclaration(e,this.state.value,!0,null)}}))}tsTryParseExportDeclaration(){return this.tsParseDeclaration(this.startNode(),this.state.value,!0,null)}tsParseExpressionStatement(e,t,s){switch(t.name){case"declare":{const t=this.tsTryParseDeclare(e);return t&&(t.declare=!0),t}case"global":if(this.match(5)){this.scope.enter(256),this.prodParam.enter(0);const s=e;return s.global=!0,s.id=t,s.body=this.tsParseModuleBlock(),this.scope.exit(),this.prodParam.exit(),this.finishNode(s,"TSModuleDeclaration")}break;default:return this.tsParseDeclaration(e,t.name,!1,s)}}tsParseDeclaration(e,t,s,i){switch(t){case"abstract":if(this.tsCheckLineTerminator(s)&&(this.match(80)||H(this.state.type)))return this.tsParseAbstractDeclaration(e,i);break;case"module":if(this.tsCheckLineTerminator(s)){if(this.match(133))return this.tsParseAmbientExternalModuleDeclaration(e);if(H(this.state.type))return this.tsParseModuleOrNamespaceDeclaration(e)}break;case"namespace":if(this.tsCheckLineTerminator(s)&&H(this.state.type))return this.tsParseModuleOrNamespaceDeclaration(e);break;case"type":if(this.tsCheckLineTerminator(s)&&H(this.state.type))return this.tsParseTypeAliasDeclaration(e)}}tsCheckLineTerminator(e){return e?!this.hasFollowingLineBreak()&&(this.next(),!0):!this.isLineTerminator()}tsTryParseGenericAsyncArrowFunction(e){if(!this.match(47))return;const t=this.state.maybeInArrowParameters;this.state.maybeInArrowParameters=!0;const s=this.tsTryParseAndCatch((()=>{const t=this.startNodeAt(e);return t.typeParameters=this.tsParseTypeParameters(this.tsParseConstModifier),super.parseFunctionParams(t),t.returnType=this.tsTryParseTypeOrTypePredicateAnnotation(),this.expect(19),t}));return this.state.maybeInArrowParameters=t,s?super.parseArrowExpression(s,null,!0):void 0}tsParseTypeArgumentsInExpression(){if(47===this.reScan_lt())return this.tsParseTypeArguments()}tsParseTypeArguments(){const e=this.startNode();return e.params=this.tsInType((()=>this.tsInNoContext((()=>(this.expect(47),this.tsParseDelimitedList("TypeParametersOrArguments",this.tsParseType.bind(this))))))),0===e.params.length?this.raise(_t.EmptyTypeArguments,e):this.state.inType||this.curContext()!==T.brace||this.reScan_lt_gt(),this.expect(48),this.finishNode(e,"TSTypeParameterInstantiation")}tsIsDeclarationStart(){return(e=this.state.type)>=124&&e<=130;var e}isExportDefaultSpecifier(){return!this.tsIsDeclarationStart()&&super.isExportDefaultSpecifier()}parseAssignableListItem(e,t){const s=this.state.startLoc,i={};this.tsParseModifiers({allowedModifiers:["public","private","protected","override","readonly"]},i);const n=i.accessibility,r=i.override,a=i.readonly;4&e||!(n||a||r)||this.raise(_t.UnexpectedParameterModifier,s);const o=this.parseMaybeDefault();this.parseAssignableListItemTypes(o,e);const c=this.parseMaybeDefault(o.loc.start,o);if(n||a||r){const e=this.startNodeAt(s);return t.length&&(e.decorators=t),n&&(e.accessibility=n),a&&(e.readonly=a),r&&(e.override=r),"Identifier"!==c.type&&"AssignmentPattern"!==c.type&&this.raise(_t.UnsupportedParameterPropertyKind,e),e.parameter=c,this.finishNode(e,"TSParameterProperty")}return t.length&&(o.decorators=t),c}isSimpleParameter(e){return"TSParameterProperty"===e.type&&super.isSimpleParameter(e.parameter)||super.isSimpleParameter(e)}tsDisallowOptionalPattern(e){for(const t of e.params)"Identifier"!==t.type&&t.optional&&!this.state.isAmbientContext&&this.raise(_t.PatternIsOptional,t)}setArrowFunctionParameters(e,t,s){super.setArrowFunctionParameters(e,t,s),this.tsDisallowOptionalPattern(e)}parseFunctionBodyAndFinish(e,t,s=!1){this.match(14)&&(e.returnType=this.tsParseTypeOrTypePredicateAnnotation(14));const i="FunctionDeclaration"===t?"TSDeclareFunction":"ClassMethod"===t||"ClassPrivateMethod"===t?"TSDeclareMethod":void 0;return i&&!this.match(5)&&this.isLineTerminator()?this.finishNode(e,i):"TSDeclareFunction"===i&&this.state.isAmbientContext&&(this.raise(_t.DeclareFunctionHasImplementation,e),e.declare)?super.parseFunctionBodyAndFinish(e,i,s):(this.tsDisallowOptionalPattern(e),super.parseFunctionBodyAndFinish(e,t,s))}registerFunctionStatementId(e){!e.body&&e.id?this.checkIdentifier(e.id,1024):super.registerFunctionStatementId(e)}tsCheckForInvalidTypeCasts(e){e.forEach((e=>{"TSTypeCastExpression"===(null==e?void 0:e.type)&&this.raise(_t.UnexpectedTypeAnnotation,e.typeAnnotation)}))}toReferencedList(e,t){return this.tsCheckForInvalidTypeCasts(e),e}parseArrayLike(e,t,s,i){const n=super.parseArrayLike(e,t,s,i);return"ArrayExpression"===n.type&&this.tsCheckForInvalidTypeCasts(n.elements),n}parseSubscript(e,t,s,i){if(!this.hasPrecedingLineBreak()&&this.match(35)){this.state.canStartJSXElement=!1,this.next();const s=this.startNodeAt(t);return s.expression=e,this.finishNode(s,"TSNonNullExpression")}let n=!1;if(this.match(18)&&60===this.lookaheadCharCode()){if(s)return i.stop=!0,e;i.optionalChainMember=n=!0,this.next()}if(this.match(47)||this.match(51)){let r;const a=this.tsTryParseAndCatch((()=>{if(!s&&this.atPossibleAsyncArrow(e)){const e=this.tsTryParseGenericAsyncArrowFunction(t);if(e)return e}const a=this.tsParseTypeArgumentsInExpression();if(!a)return;if(n&&!this.match(10))return void(r=this.state.curPosition());if(X(this.state.type)){const s=super.parseTaggedTemplateExpression(e,t,i);return s.typeParameters=a,s}if(!s&&this.eat(10)){const s=this.startNodeAt(t);return s.callee=e,s.arguments=this.parseCallExpressionArguments(11,!1),this.tsCheckForInvalidTypeCasts(s.arguments),s.typeParameters=a,i.optionalChainMember&&(s.optional=n),this.finishCallExpression(s,i.optionalChainMember)}const o=this.state.type;if(48===o||52===o||10!==o&&W(o)&&!this.hasPrecedingLineBreak())return;const c=this.startNodeAt(t);return c.expression=e,c.typeParameters=a,this.finishNode(c,"TSInstantiationExpression")}));if(r&&this.unexpected(r,10),a)return"TSInstantiationExpression"===a.type&&(this.match(16)||this.match(18)&&40!==this.lookaheadCharCode())&&this.raise(_t.InvalidPropertyAccessAfterInstantiationExpression,this.state.startLoc),a}return super.parseSubscript(e,t,s,i)}parseNewCallee(e){var t;super.parseNewCallee(e);const{callee:s}=e;"TSInstantiationExpression"!==s.type||null!=(t=s.extra)&&t.parenthesized||(e.typeParameters=s.typeParameters,e.callee=s.expression)}parseExprOp(e,t,s){let i;if(J(58)>s&&!this.hasPrecedingLineBreak()&&(this.isContextual(93)||(i=this.isContextual(120)))){const n=this.startNodeAt(t);return n.expression=e,n.typeAnnotation=this.tsInType((()=>(this.next(),this.match(75)?(i&&this.raise(b.UnexpectedKeyword,this.state.startLoc,{keyword:"const"}),this.tsParseTypeReference()):this.tsParseType()))),this.finishNode(n,i?"TSSatisfiesExpression":"TSAsExpression"),this.reScan_lt_gt(),this.parseExprOp(n,t,s)}return super.parseExprOp(e,t,s)}checkReservedWord(e,t,s,i){this.state.isAmbientContext||super.checkReservedWord(e,t,s,i)}checkImportReflection(e){super.checkImportReflection(e),e.module&&"value"!==e.importKind&&this.raise(_t.ImportReflectionHasImportType,e.specifiers[0].loc.start)}checkDuplicateExports(){}isPotentialImportPhase(e){if(super.isPotentialImportPhase(e))return!0;if(this.isContextual(130)){const t=this.lookaheadCharCode();return e?123===t||42===t:61!==t}return!e&&this.isContextual(87)}applyImportPhase(e,t,s,i){super.applyImportPhase(e,t,s,i),t?e.exportKind="type"===s?"type":"value":e.importKind="type"===s||"typeof"===s?s:"value"}parseImport(e){if(this.match(133))return e.importKind="value",super.parseImport(e);let t;if(H(this.state.type)&&61===this.lookaheadCharCode())return e.importKind="value",this.tsParseImportEqualsDeclaration(e);if(this.isContextual(130)){const s=this.parseMaybeImportPhase(e,!1);if(61===this.lookaheadCharCode())return this.tsParseImportEqualsDeclaration(e,s);t=super.parseImportSpecifiersAndAfter(e,s)}else t=super.parseImport(e);return"type"===t.importKind&&t.specifiers.length>1&&"ImportDefaultSpecifier"===t.specifiers[0].type&&this.raise(_t.TypeImportCannotSpecifyDefaultAndNamed,t),t}parseExport(e,t){if(this.match(83)){this.next();const t=e;let s=null;return this.isContextual(130)&&this.isPotentialImportPhase(!1)?s=this.parseMaybeImportPhase(t,!1):t.importKind="value",this.tsParseImportEqualsDeclaration(t,s,!0)}if(this.eat(29)){const t=e;return t.expression=super.parseExpression(),this.semicolon(),this.sawUnambiguousESM=!0,this.finishNode(t,"TSExportAssignment")}if(this.eatContextual(93)){const t=e;return this.expectContextual(128),t.id=this.parseIdentifier(),this.semicolon(),this.finishNode(t,"TSNamespaceExportDeclaration")}return super.parseExport(e,t)}isAbstractClass(){return this.isContextual(124)&&80===this.lookahead().type}parseExportDefaultExpression(){if(this.isAbstractClass()){const e=this.startNode();return this.next(),e.abstract=!0,this.parseClass(e,!0,!0)}if(this.match(129)){const e=this.tsParseInterfaceDeclaration(this.startNode());if(e)return e}return super.parseExportDefaultExpression()}parseVarStatement(e,t,s=!1){const{isAmbientContext:i}=this.state,n=super.parseVarStatement(e,t,s||i);if(!i)return n;for(const{id:e,init:s}of n.declarations)s&&("const"!==t||e.typeAnnotation?this.raise(_t.InitializerNotAllowedInAmbientContext,s):Pt(s,this.hasPlugin("estree"))||this.raise(_t.ConstInitiailizerMustBeStringOrNumericLiteralOrLiteralEnumReference,s));return n}parseStatementContent(e,t){if(this.match(75)&&this.isLookaheadContextual("enum")){const e=this.startNode();return this.expect(75),this.tsParseEnumDeclaration(e,{const:!0})}if(this.isContextual(126))return this.tsParseEnumDeclaration(this.startNode());if(this.isContextual(129)){const e=this.tsParseInterfaceDeclaration(this.startNode());if(e)return e}return super.parseStatementContent(e,t)}parseAccessModifier(){return this.tsParseModifier(["public","protected","private"])}tsHasSomeModifiers(e,t){return t.some((t=>xt(t)?e.accessibility===t:!!e[t]))}tsIsStartOfStaticBlocks(){return this.isContextual(106)&&123===this.lookaheadCharCode()}parseClassMember(e,t,s){const i=["declare","private","public","protected","override","abstract","readonly","static"];this.tsParseModifiers({allowedModifiers:i,disallowedModifiers:["in","out"],stopOnStartOfClassStaticBlock:!0,errorTemplate:_t.InvalidModifierOnTypeParameterPositions},t);const n=()=>{this.tsIsStartOfStaticBlocks()?(this.next(),this.next(),this.tsHasSomeModifiers(t,i)&&this.raise(_t.StaticBlockCannotHaveModifier,this.state.curPosition()),super.parseClassStaticBlock(e,t)):this.parseClassMemberWithIsStatic(e,t,s,!!t.static)};t.declare?this.tsInAmbientContext(n):n()}parseClassMemberWithIsStatic(e,t,s,i){const n=this.tsTryParseIndexSignature(t);if(n)return e.body.push(n),t.abstract&&this.raise(_t.IndexSignatureHasAbstract,t),t.accessibility&&this.raise(_t.IndexSignatureHasAccessibility,t,{modifier:t.accessibility}),t.declare&&this.raise(_t.IndexSignatureHasDeclare,t),void(t.override&&this.raise(_t.IndexSignatureHasOverride,t));!this.state.inAbstractClass&&t.abstract&&this.raise(_t.NonAbstractClassHasAbstractMethod,t),t.override&&(s.hadSuperClass||this.raise(_t.OverrideNotInSubClass,t)),super.parseClassMemberWithIsStatic(e,t,s,i)}parsePostMemberNameModifiers(e){this.eat(17)&&(e.optional=!0),e.readonly&&this.match(10)&&this.raise(_t.ClassMethodHasReadonly,e),e.declare&&this.match(10)&&this.raise(_t.ClassMethodHasDeclare,e)}parseExpressionStatement(e,t,s){return("Identifier"===t.type?this.tsParseExpressionStatement(e,t,s):void 0)||super.parseExpressionStatement(e,t,s)}shouldParseExportDeclaration(){return!!this.tsIsDeclarationStart()||super.shouldParseExportDeclaration()}parseConditional(e,t,s){if(!this.state.maybeInArrowParameters||!this.match(17))return super.parseConditional(e,t,s);const i=this.tryParse((()=>super.parseConditional(e,t)));return i.node?(i.error&&(this.state=i.failState),i.node):(i.error&&super.setOptionalParametersError(s,i.error),e)}parseParenItem(e,t){const s=super.parseParenItem(e,t);if(this.eat(17)&&(s.optional=!0,this.resetEndLocation(e)),this.match(14)){const s=this.startNodeAt(t);return s.expression=e,s.typeAnnotation=this.tsParseTypeAnnotation(),this.finishNode(s,"TSTypeCastExpression")}return e}parseExportDeclaration(e){if(!this.state.isAmbientContext&&this.isContextual(125))return this.tsInAmbientContext((()=>this.parseExportDeclaration(e)));const t=this.state.startLoc,s=this.eatContextual(125);if(s&&(this.isContextual(125)||!this.shouldParseExportDeclaration()))throw this.raise(_t.ExpectedAmbientAfterExportDeclare,this.state.startLoc);const i=H(this.state.type)&&this.tsTryParseExportDeclaration()||super.parseExportDeclaration(e);return i?(("TSInterfaceDeclaration"===i.type||"TSTypeAliasDeclaration"===i.type||s)&&(e.exportKind="type"),s&&(this.resetStartLocation(i,t),i.declare=!0),i):null}parseClassId(e,t,s,i){if((!t||s)&&this.isContextual(113))return;super.parseClassId(e,t,s,e.declare?1024:8331);const n=this.tsTryParseTypeParameters(this.tsParseInOutConstModifiers);n&&(e.typeParameters=n)}parseClassPropertyAnnotation(e){e.optional||(this.eat(35)?e.definite=!0:this.eat(17)&&(e.optional=!0));const t=this.tsTryParseTypeAnnotation();t&&(e.typeAnnotation=t)}parseClassProperty(e){if(this.parseClassPropertyAnnotation(e),this.state.isAmbientContext&&(!e.readonly||e.typeAnnotation)&&this.match(29)&&this.raise(_t.DeclareClassFieldHasInitializer,this.state.startLoc),e.abstract&&this.match(29)){const{key:t}=e;this.raise(_t.AbstractPropertyHasInitializer,this.state.startLoc,{propertyName:"Identifier"!==t.type||e.computed?`[${this.input.slice(t.start,t.end)}]`:t.name})}return super.parseClassProperty(e)}parseClassPrivateProperty(e){return e.abstract&&this.raise(_t.PrivateElementHasAbstract,e),e.accessibility&&this.raise(_t.PrivateElementHasAccessibility,e,{modifier:e.accessibility}),this.parseClassPropertyAnnotation(e),super.parseClassPrivateProperty(e)}parseClassAccessorProperty(e){return this.parseClassPropertyAnnotation(e),e.optional&&this.raise(_t.AccessorCannotBeOptional,e),super.parseClassAccessorProperty(e)}pushClassMethod(e,t,s,i,n,r){const a=this.tsTryParseTypeParameters(this.tsParseConstModifier);a&&n&&this.raise(_t.ConstructorHasTypeParameters,a);const{declare:o=!1,kind:c}=t;!o||"get"!==c&&"set"!==c||this.raise(_t.DeclareAccessor,t,{kind:c}),a&&(t.typeParameters=a),super.pushClassMethod(e,t,s,i,n,r)}pushClassPrivateMethod(e,t,s,i){const n=this.tsTryParseTypeParameters(this.tsParseConstModifier);n&&(t.typeParameters=n),super.pushClassPrivateMethod(e,t,s,i)}declareClassPrivateMethodInScope(e,t){"TSDeclareMethod"!==e.type&&("MethodDefinition"!==e.type||hasOwnProperty.call(e.value,"body"))&&super.declareClassPrivateMethodInScope(e,t)}parseClassSuper(e){super.parseClassSuper(e),e.superClass&&(this.match(47)||this.match(51))&&(e.superTypeParameters=this.tsParseTypeArgumentsInExpression()),this.eatContextual(113)&&(e.implements=this.tsParseHeritageClause("implements"))}parseObjPropValue(e,t,s,i,n,r,a){const o=this.tsTryParseTypeParameters(this.tsParseConstModifier);return o&&(e.typeParameters=o),super.parseObjPropValue(e,t,s,i,n,r,a)}parseFunctionParams(e,t){const s=this.tsTryParseTypeParameters(this.tsParseConstModifier);s&&(e.typeParameters=s),super.parseFunctionParams(e,t)}parseVarId(e,t){super.parseVarId(e,t),"Identifier"===e.id.type&&!this.hasPrecedingLineBreak()&&this.eat(35)&&(e.definite=!0);const s=this.tsTryParseTypeAnnotation();s&&(e.id.typeAnnotation=s,this.resetEndLocation(e.id))}parseAsyncArrowFromCallExpression(e,t){return this.match(14)&&(e.returnType=this.tsParseTypeAnnotation()),super.parseAsyncArrowFromCallExpression(e,t)}parseMaybeAssign(e,t){var s,i,n,r,a;let o,c,h,l;if(this.hasPlugin("jsx")&&(this.match(142)||this.match(47))){if(o=this.state.clone(),c=this.tryParse((()=>super.parseMaybeAssign(e,t)),o),!c.error)return c.node;const{context:s}=this.state,i=s[s.length-1];i!==T.j_oTag&&i!==T.j_expr||s.pop()}if(!(null!=(s=c)&&s.error||this.match(47)))return super.parseMaybeAssign(e,t);o&&o!==this.state||(o=this.state.clone());const p=this.tryParse((s=>{var i,n;l=this.tsParseTypeParameters(this.tsParseConstModifier);const r=super.parseMaybeAssign(e,t);return("ArrowFunctionExpression"!==r.type||null!=(i=r.extra)&&i.parenthesized)&&s(),0!==(null==(n=l)?void 0:n.params.length)&&this.resetStartLocationFromNode(r,l),r.typeParameters=l,r}),o);if(!p.error&&!p.aborted)return l&&this.reportReservedArrowTypeParam(l),p.node;if(!c&&(wt(!this.hasPlugin("jsx")),h=this.tryParse((()=>super.parseMaybeAssign(e,t)),o),!h.error))return h.node;if(null!=(i=c)&&i.node)return this.state=c.failState,c.node;if(p.node)return this.state=p.failState,l&&this.reportReservedArrowTypeParam(l),p.node;if(null!=(n=h)&&n.node)return this.state=h.failState,h.node;throw(null==(r=c)?void 0:r.error)||p.error||(null==(a=h)?void 0:a.error)}reportReservedArrowTypeParam(e){var t;1!==e.params.length||e.params[0].constraint||null!=(t=e.extra)&&t.trailingComma||!this.getPluginOption("typescript","disallowAmbiguousJSXLike")||this.raise(_t.ReservedArrowTypeParam,e)}parseMaybeUnary(e,t){return!this.hasPlugin("jsx")&&this.match(47)?this.tsParseTypeAssertion():super.parseMaybeUnary(e,t)}parseArrow(e){if(this.match(14)){const t=this.tryParse((e=>{const t=this.tsParseTypeOrTypePredicateAnnotation(14);return!this.canInsertSemicolon()&&this.match(19)||e(),t}));if(t.aborted)return;t.thrown||(t.error&&(this.state=t.failState),e.returnType=t.node)}return super.parseArrow(e)}parseAssignableListItemTypes(e,t){if(!(2&t))return e;this.eat(17)&&(e.optional=!0);const s=this.tsTryParseTypeAnnotation();return s&&(e.typeAnnotation=s),this.resetEndLocation(e),e}isAssignable(e,t){switch(e.type){case"TSTypeCastExpression":return this.isAssignable(e.expression,t);case"TSParameterProperty":return!0;default:return super.isAssignable(e,t)}}toAssignable(e,t=!1){switch(e.type){case"ParenthesizedExpression":this.toAssignableParenthesizedExpression(e,t);break;case"TSAsExpression":case"TSSatisfiesExpression":case"TSNonNullExpression":case"TSTypeAssertion":t?this.expressionScope.recordArrowParameterBindingError(_t.UnexpectedTypeCastInParameter,e):this.raise(_t.UnexpectedTypeCastInParameter,e),this.toAssignable(e.expression,t);break;case"AssignmentExpression":t||"TSTypeCastExpression"!==e.left.type||(e.left=this.typeCastToParameter(e.left));default:super.toAssignable(e,t)}}toAssignableParenthesizedExpression(e,t){switch(e.expression.type){case"TSAsExpression":case"TSSatisfiesExpression":case"TSNonNullExpression":case"TSTypeAssertion":case"ParenthesizedExpression":this.toAssignable(e.expression,t);break;default:super.toAssignable(e,t)}}checkToRestConversion(e,t){switch(e.type){case"TSAsExpression":case"TSSatisfiesExpression":case"TSTypeAssertion":case"TSNonNullExpression":this.checkToRestConversion(e.expression,!1);break;default:super.checkToRestConversion(e,t)}}isValidLVal(e,t,s){return i={TSTypeCastExpression:!0,TSParameterProperty:"parameter",TSNonNullExpression:"expression",TSAsExpression:(64!==s||!t)&&["expression",!0],TSSatisfiesExpression:(64!==s||!t)&&["expression",!0],TSTypeAssertion:(64!==s||!t)&&["expression",!0]},n=e,hasOwnProperty.call(i,n)&&i[n]||super.isValidLVal(e,t,s);var i,n}parseBindingAtom(){return 78===this.state.type?this.parseIdentifier(!0):super.parseBindingAtom()}parseMaybeDecoratorArguments(e){if(this.match(47)||this.match(51)){const t=this.tsParseTypeArgumentsInExpression();if(this.match(10)){const s=super.parseMaybeDecoratorArguments(e);return s.typeParameters=t,s}this.unexpected(null,10)}return super.parseMaybeDecoratorArguments(e)}checkCommaAfterRest(e){return this.state.isAmbientContext&&this.match(12)&&this.lookaheadCharCode()===e?(this.next(),!1):super.checkCommaAfterRest(e)}isClassMethod(){return this.match(47)||super.isClassMethod()}isClassProperty(){return this.match(35)||this.match(14)||super.isClassProperty()}parseMaybeDefault(e,t){const s=super.parseMaybeDefault(e,t);return"AssignmentPattern"===s.type&&s.typeAnnotation&&s.right.start<s.typeAnnotation.start&&this.raise(_t.TypeAnnotationAfterAssign,s.typeAnnotation),s}getTokenFromCode(e){if(this.state.inType){if(62===e)return void this.finishOp(48,1);if(60===e)return void this.finishOp(47,1)}super.getTokenFromCode(e)}reScan_lt_gt(){const{type:e}=this.state;47===e?(this.state.pos-=1,this.readToken_lt()):48===e&&(this.state.pos-=1,this.readToken_gt())}reScan_lt(){const{type:e}=this.state;return 51===e?(this.state.pos-=2,this.finishOp(47,1),47):e}toAssignableList(e,t,s){for(let t=0;t<e.length;t++){const s=e[t];"TSTypeCastExpression"===(null==s?void 0:s.type)&&(e[t]=this.typeCastToParameter(s))}super.toAssignableList(e,t,s)}typeCastToParameter(e){return e.expression.typeAnnotation=e.typeAnnotation,this.resetEndLocation(e.expression,e.typeAnnotation.loc.end),e.expression}shouldParseArrow(e){return this.match(14)?e.every((e=>this.isAssignable(e,!0))):super.shouldParseArrow(e)}shouldParseAsyncArrow(){return this.match(14)||super.shouldParseAsyncArrow()}canHaveLeadingDecorator(){return super.canHaveLeadingDecorator()||this.isAbstractClass()}jsxParseOpeningElementAfterName(e){if(this.match(47)||this.match(51)){const t=this.tsTryParseAndCatch((()=>this.tsParseTypeArgumentsInExpression()));t&&(e.typeParameters=t)}return super.jsxParseOpeningElementAfterName(e)}getGetterSetterExpectedParamCount(e){const t=super.getGetterSetterExpectedParamCount(e),s=this.getObjectOrClassMethodParams(e)[0];return s&&this.isThisParam(s)?t+1:t}parseCatchClauseParam(){const e=super.parseCatchClauseParam(),t=this.tsTryParseTypeAnnotation();return t&&(e.typeAnnotation=t,this.resetEndLocation(e)),e}tsInAmbientContext(e){const t=this.state.isAmbientContext;this.state.isAmbientContext=!0;try{return e()}finally{this.state.isAmbientContext=t}}parseClass(e,t,s){const i=this.state.inAbstractClass;this.state.inAbstractClass=!!e.abstract;try{return super.parseClass(e,t,s)}finally{this.state.inAbstractClass=i}}tsParseAbstractDeclaration(e,t){if(this.match(80))return e.abstract=!0,this.maybeTakeDecorators(t,this.parseClass(e,!0,!1));if(this.isContextual(129)){if(!this.hasFollowingLineBreak())return e.abstract=!0,this.raise(_t.NonClassMethodPropertyHasAbstractModifer,e),this.tsParseInterfaceDeclaration(e)}else this.unexpected(null,80)}parseMethod(e,t,s,i,n,r,a){const o=super.parseMethod(e,t,s,i,n,r,a);if(o.abstract&&(this.hasPlugin("estree")?o.value.body:o.body)){const{key:e}=o;this.raise(_t.AbstractMethodHasImplementation,o,{methodName:"Identifier"!==e.type||o.computed?`[${this.input.slice(e.start,e.end)}]`:e.name})}return o}tsParseTypeParameterName(){return this.parseIdentifier().name}shouldParseAsAmbientContext(){return!!this.getPluginOption("typescript","dts")}parse(){return this.shouldParseAsAmbientContext()&&(this.state.isAmbientContext=!0),super.parse()}getExpression(){return this.shouldParseAsAmbientContext()&&(this.state.isAmbientContext=!0),super.getExpression()}parseExportSpecifier(e,t,s,i){return!t&&i?(this.parseTypeOnlyImportExportSpecifier(e,!1,s),this.finishNode(e,"ExportSpecifier")):(e.exportKind="value",super.parseExportSpecifier(e,t,s,i))}parseImportSpecifier(e,t,s,i,n){return!t&&i?(this.parseTypeOnlyImportExportSpecifier(e,!0,s),this.finishNode(e,"ImportSpecifier")):(e.importKind="value",super.parseImportSpecifier(e,t,s,i,s?4098:4096))}parseTypeOnlyImportExportSpecifier(e,t,s){const i=t?"imported":"local",n=t?"local":"exported";let r,a=e[i],o=!1,c=!0;const h=a.loc.start;if(this.isContextual(93)){const e=this.parseIdentifier();if(this.isContextual(93)){const s=this.parseIdentifier();V(this.state.type)?(o=!0,a=e,r=t?this.parseIdentifier():this.parseModuleExportName(),c=!1):(r=s,c=!1)}else V(this.state.type)?(c=!1,r=t?this.parseIdentifier():this.parseModuleExportName()):(o=!0,a=e)}else V(this.state.type)&&(o=!0,t?(a=this.parseIdentifier(!0),this.isContextual(93)||this.checkReservedWord(a.name,a.loc.start,!0,!0)):a=this.parseModuleExportName());o&&s&&this.raise(t?_t.TypeModifierIsUsedInTypeImports:_t.TypeModifierIsUsedInTypeExports,h),e[i]=a,e[n]=r,e[t?"importKind":"exportKind"]=o?"type":"value",c&&this.eatContextual(93)&&(e[n]=t?this.parseIdentifier():this.parseModuleExportName()),e[n]||(e[n]=nt(e[i])),t&&this.checkIdentifier(e[n],o?4098:4096)}},v8intrinsic:e=>class extends e{parseV8Intrinsic(){if(this.match(54)){const e=this.state.startLoc,t=this.startNode();if(this.next(),H(this.state.type)){const e=this.parseIdentifierName(),s=this.createIdentifier(t,e);if(s.type="V8IntrinsicIdentifier",this.match(10))return s}this.unexpected(e)}}parseExprAtom(e){return this.parseV8Intrinsic()||super.parseExprAtom(e)}},placeholders:e=>class extends e{parsePlaceholder(e){if(this.match(144)){const t=this.startNode();return this.next(),this.assertNoSpace(),t.name=super.parseIdentifier(!0),this.assertNoSpace(),this.expect(144),this.finishPlaceholder(t,e)}}finishPlaceholder(e,t){let s=e;return s.expectedNode&&s.type||(s=this.finishNode(s,"Placeholder")),s.expectedNode=t,s}getTokenFromCode(e){37===e&&37===this.input.charCodeAt(this.state.pos+1)?this.finishOp(144,2):super.getTokenFromCode(e)}parseExprAtom(e){return this.parsePlaceholder("Expression")||super.parseExprAtom(e)}parseIdentifier(e){return this.parsePlaceholder("Identifier")||super.parseIdentifier(e)}checkReservedWord(e,t,s,i){void 0!==e&&super.checkReservedWord(e,t,s,i)}parseBindingAtom(){return this.parsePlaceholder("Pattern")||super.parseBindingAtom()}isValidLVal(e,t,s){return"Placeholder"===e||super.isValidLVal(e,t,s)}toAssignable(e,t){e&&"Placeholder"===e.type&&"Expression"===e.expectedNode?e.expectedNode="Pattern":super.toAssignable(e,t)}chStartsBindingIdentifier(e,t){return!!super.chStartsBindingIdentifier(e,t)||144===this.lookahead().type}verifyBreakContinue(e,t){e.label&&"Placeholder"===e.label.type||super.verifyBreakContinue(e,t)}parseExpressionStatement(e,t){var s;if("Placeholder"!==t.type||null!=(s=t.extra)&&s.parenthesized)return super.parseExpressionStatement(e,t);if(this.match(14)){const s=e;return s.label=this.finishPlaceholder(t,"Identifier"),this.next(),s.body=super.parseStatementOrSloppyAnnexBFunctionDeclaration(),this.finishNode(s,"LabeledStatement")}this.semicolon();const i=e;return i.name=t.name,this.finishPlaceholder(i,"Statement")}parseBlock(e,t,s){return this.parsePlaceholder("BlockStatement")||super.parseBlock(e,t,s)}parseFunctionId(e){return this.parsePlaceholder("Identifier")||super.parseFunctionId(e)}parseClass(e,t,s){const i=t?"ClassDeclaration":"ClassExpression";this.next();const n=this.state.strict,r=this.parsePlaceholder("Identifier");if(r){if(!(this.match(81)||this.match(144)||this.match(5))){if(s||!t)return e.id=null,e.body=this.finishPlaceholder(r,"ClassBody"),this.finishNode(e,i);throw this.raise(Et.ClassNameIsRequired,this.state.startLoc)}e.id=r}else this.parseClassId(e,t,s);return super.parseClassSuper(e),e.body=this.parsePlaceholder("ClassBody")||super.parseClassBody(!!e.superClass,n),this.finishNode(e,i)}parseExport(e,t){const s=this.parsePlaceholder("Identifier");if(!s)return super.parseExport(e,t);const i=e;if(!this.isContextual(98)&&!this.match(12))return i.specifiers=[],i.source=null,i.declaration=this.finishPlaceholder(s,"Declaration"),this.finishNode(i,"ExportNamedDeclaration");this.expectPlugin("exportDefaultFrom");const n=this.startNode();return n.exported=s,i.specifiers=[this.finishNode(n,"ExportDefaultSpecifier")],super.parseExport(i,t)}isExportDefaultSpecifier(){if(this.match(65)){const e=this.nextTokenStart();if(this.isUnparsedContextual(e,"from")&&this.input.startsWith(Y(144),this.nextTokenStartSince(e+4)))return!0}return super.isExportDefaultSpecifier()}maybeParseExportDefaultSpecifier(e,t){var s;return!(null==(s=e.specifiers)||!s.length)||super.maybeParseExportDefaultSpecifier(e,t)}checkExport(e){const{specifiers:t}=e;null!=t&&t.length&&(e.specifiers=t.filter((e=>"Placeholder"===e.exported.type))),super.checkExport(e),e.specifiers=t}parseImport(e){const t=this.parsePlaceholder("Identifier");if(!t)return super.parseImport(e);if(e.specifiers=[],!this.isContextual(98)&&!this.match(12))return e.source=this.finishPlaceholder(t,"StringLiteral"),this.semicolon(),this.finishNode(e,"ImportDeclaration");const s=this.startNodeAtNode(t);return s.local=t,e.specifiers.push(this.finishNode(s,"ImportDefaultSpecifier")),this.eat(12)&&(this.maybeParseStarImportSpecifier(e)||this.parseNamedImportSpecifiers(e)),this.expectContextual(98),e.source=this.parseImportSource(),this.semicolon(),this.finishNode(e,"ImportDeclaration")}parseImportSource(){return this.parsePlaceholder("StringLiteral")||super.parseImportSource()}assertNoSpace(){this.state.start>this.state.lastTokEndLoc.index&&this.raise(Et.UnexpectedSpace,this.state.lastTokEndLoc)}}},Ot=Object.keys(Dt),Mt={sourceType:"script",sourceFilename:void 0,startColumn:0,startLine:1,allowAwaitOutsideFunction:!1,allowReturnOutsideFunction:!1,allowNewTargetOutsideFunction:!1,allowImportExportEverywhere:!1,allowSuperOutsideMethod:!1,allowUndeclaredExports:!1,plugins:[],strictMode:null,ranges:!1,tokens:!1,createImportExpressions:!1,createParenthesizedExpressions:!1,errorRecovery:!1,attachComment:!0,annexB:!0};class Rt extends bt{checkProto(e,t,s,i){if("SpreadElement"===e.type||this.isObjectMethod(e)||e.computed||e.shorthand)return;const n=e.key;if("__proto__"===("Identifier"===n.type?n.name:n.value)){if(t)return void this.raise(b.RecordNoProto,n);s.used&&(i?null===i.doubleProtoLoc&&(i.doubleProtoLoc=n.loc.start):this.raise(b.DuplicateProto,n)),s.used=!0}}shouldExitDescending(e,t){return"ArrowFunctionExpression"===e.type&&e.start===t}getExpression(){this.enterInitialScopes(),this.nextToken();const e=this.parseExpression();return this.match(139)||this.unexpected(),this.finalizeRemainingComments(),e.comments=this.comments,e.errors=this.state.errors,this.options.tokens&&(e.tokens=this.tokens),e}parseExpression(e,t){return e?this.disallowInAnd((()=>this.parseExpressionBase(t))):this.allowInAnd((()=>this.parseExpressionBase(t)))}parseExpressionBase(e){const t=this.state.startLoc,s=this.parseMaybeAssign(e);if(this.match(12)){const i=this.startNodeAt(t);for(i.expressions=[s];this.eat(12);)i.expressions.push(this.parseMaybeAssign(e));return this.toReferencedList(i.expressions),this.finishNode(i,"SequenceExpression")}return s}parseMaybeAssignDisallowIn(e,t){return this.disallowInAnd((()=>this.parseMaybeAssign(e,t)))}parseMaybeAssignAllowIn(e,t){return this.allowInAnd((()=>this.parseMaybeAssign(e,t)))}setOptionalParametersError(e,t){var s;e.optionalParametersLoc=null!=(s=null==t?void 0:t.loc)?s:this.state.startLoc}parseMaybeAssign(e,t){const s=this.state.startLoc;if(this.isContextual(108)&&this.prodParam.hasYield){let e=this.parseYield();return t&&(e=t.call(this,e,s)),e}let i;e?i=!1:(e=new tt,i=!0);const{type:n}=this.state;(10===n||H(n))&&(this.state.potentialArrowAt=this.state.start);let r=this.parseMaybeConditional(e);if(t&&(r=t.call(this,r,s)),(a=this.state.type)>=29&&a<=33){const t=this.startNodeAt(s),i=this.state.value;if(t.operator=i,this.match(29)){this.toAssignable(r,!0),t.left=r;const i=s.index;null!=e.doubleProtoLoc&&e.doubleProtoLoc.index>=i&&(e.doubleProtoLoc=null),null!=e.shorthandAssignLoc&&e.shorthandAssignLoc.index>=i&&(e.shorthandAssignLoc=null),null!=e.privateKeyLoc&&e.privateKeyLoc.index>=i&&(this.checkDestructuringPrivate(e),e.privateKeyLoc=null)}else t.left=r;return this.next(),t.right=this.parseMaybeAssign(),this.checkLVal(r,{in:this.finishNode(t,"AssignmentExpression")}),t}var a;return i&&this.checkExpressionErrors(e,!0),r}parseMaybeConditional(e){const t=this.state.startLoc,s=this.state.potentialArrowAt,i=this.parseExprOps(e);return this.shouldExitDescending(i,s)?i:this.parseConditional(i,t,e)}parseConditional(e,t,s){if(this.eat(17)){const s=this.startNodeAt(t);return s.test=e,s.consequent=this.parseMaybeAssignAllowIn(),this.expect(14),s.alternate=this.parseMaybeAssign(),this.finishNode(s,"ConditionalExpression")}return e}parseMaybeUnaryOrPrivate(e){return this.match(138)?this.parsePrivateName():this.parseMaybeUnary(e)}parseExprOps(e){const t=this.state.startLoc,s=this.state.potentialArrowAt,i=this.parseMaybeUnaryOrPrivate(e);return this.shouldExitDescending(i,s)?i:this.parseExprOp(i,t,-1)}parseExprOp(e,t,s){if(this.isPrivateName(e)){const t=this.getPrivateNameSV(e);(s>=J(58)||!this.prodParam.hasIn||!this.match(58))&&this.raise(b.PrivateInExpectedIn,e,{identifierName:t}),this.classScope.usePrivateName(t,e.loc.start)}const i=this.state.type;if((n=i)>=39&&n<=59&&(this.prodParam.hasIn||!this.match(58))){let n=J(i);if(n>s){if(39===i){if(this.expectPlugin("pipelineOperator"),this.state.inFSharpPipelineDirectBody)return e;this.checkPipelineAtInfixOperator(e,t)}const r=this.startNodeAt(t);r.left=e,r.operator=this.state.value;const a=41===i||42===i,o=40===i;if(o&&(n=J(42)),this.next(),39===i&&this.hasPlugin(["pipelineOperator",{proposal:"minimal"}])&&96===this.state.type&&this.prodParam.hasAwait)throw this.raise(b.UnexpectedAwaitAfterPipelineBody,this.state.startLoc);r.right=this.parseExprOpRightExpr(i,n);const c=this.finishNode(r,a||o?"LogicalExpression":"BinaryExpression"),h=this.state.type;if(o&&(41===h||42===h)||a&&40===h)throw this.raise(b.MixingCoalesceWithLogical,this.state.startLoc);return this.parseExprOp(c,t,s)}}var n;return e}parseExprOpRightExpr(e,t){const s=this.state.startLoc;if(39===e)switch(this.getPluginOption("pipelineOperator","proposal")){case"hack":return this.withTopicBindingContext((()=>this.parseHackPipeBody()));case"smart":return this.withTopicBindingContext((()=>{if(this.prodParam.hasYield&&this.isContextual(108))throw this.raise(b.PipeBodyIsTighter,this.state.startLoc);return this.parseSmartPipelineBodyInStyle(this.parseExprOpBaseRightExpr(e,t),s)}));case"fsharp":return this.withSoloAwaitPermittingContext((()=>this.parseFSharpPipelineBody(t)))}return this.parseExprOpBaseRightExpr(e,t)}parseExprOpBaseRightExpr(e,t){const s=this.state.startLoc;return this.parseExprOp(this.parseMaybeUnaryOrPrivate(),s,57===e?t-1:t)}parseHackPipeBody(){var e;const{startLoc:t}=this.state,s=this.parseMaybeAssign();return!p.has(s.type)||null!=(e=s.extra)&&e.parenthesized||this.raise(b.PipeUnparenthesizedBody,t,{type:s.type}),this.topicReferenceWasUsedInCurrentContext()||this.raise(b.PipeTopicUnused,t),s}checkExponentialAfterUnary(e){this.match(57)&&this.raise(b.UnexpectedTokenUnaryExponentiation,e.argument)}parseMaybeUnary(e,t){const s=this.state.startLoc,i=this.isContextual(96);if(i&&this.isAwaitAllowed()){this.next();const e=this.parseAwait(s);return t||this.checkExponentialAfterUnary(e),e}const n=this.match(34),r=this.startNode();if(a=this.state.type,j[a]){r.operator=this.state.value,r.prefix=!0,this.match(72)&&this.expectPlugin("throwExpressions");const s=this.match(89);if(this.next(),r.argument=this.parseMaybeUnary(null,!0),this.checkExpressionErrors(e,!0),this.state.strict&&s){const e=r.argument;"Identifier"===e.type?this.raise(b.StrictDelete,r):this.hasPropertyAsPrivateName(e)&&this.raise(b.DeletePrivateField,r)}if(!n)return t||this.checkExponentialAfterUnary(r),this.finishNode(r,"UnaryExpression")}var a;const o=this.parseUpdate(r,n,e);if(i){const{type:e}=this.state;if((this.hasPlugin("v8intrinsic")?W(e):W(e)&&!this.match(54))&&!this.isAmbiguousAwait())return this.raiseOverwrite(b.AwaitNotInAsyncContext,s),this.parseAwait(s)}return o}parseUpdate(e,t,s){if(t){const t=e;return this.checkLVal(t.argument,{in:this.finishNode(t,"UpdateExpression")}),e}const i=this.state.startLoc;let n=this.parseExprSubscripts(s);if(this.checkExpressionErrors(s,!1))return n;for(;34===this.state.type&&!this.canInsertSemicolon();){const e=this.startNodeAt(i);e.operator=this.state.value,e.prefix=!1,e.argument=n,this.next(),this.checkLVal(n,{in:n=this.finishNode(e,"UpdateExpression")})}return n}parseExprSubscripts(e){const t=this.state.startLoc,s=this.state.potentialArrowAt,i=this.parseExprAtom(e);return this.shouldExitDescending(i,s)?i:this.parseSubscripts(i,t)}parseSubscripts(e,t,s){const i={optionalChainMember:!1,maybeAsyncArrow:this.atPossibleAsyncArrow(e),stop:!1};do{e=this.parseSubscript(e,t,s,i),i.maybeAsyncArrow=!1}while(!i.stop);return e}parseSubscript(e,t,s,i){const{type:n}=this.state;if(!s&&15===n)return this.parseBind(e,t,s,i);if(X(n))return this.parseTaggedTemplateExpression(e,t,i);let r=!1;if(18===n){if(s&&(this.raise(b.OptionalChainingNoNew,this.state.startLoc),40===this.lookaheadCharCode()))return i.stop=!0,e;i.optionalChainMember=r=!0,this.next()}if(!s&&this.match(10))return this.parseCoverCallAndAsyncArrowHead(e,t,i,r);{const s=this.eat(0);return s||r||this.eat(16)?this.parseMember(e,t,i,s,r):(i.stop=!0,e)}}parseMember(e,t,s,i,n){const r=this.startNodeAt(t);return r.object=e,r.computed=i,i?(r.property=this.parseExpression(),this.expect(3)):this.match(138)?("Super"===e.type&&this.raise(b.SuperPrivateField,t),this.classScope.usePrivateName(this.state.value,this.state.startLoc),r.property=this.parsePrivateName()):r.property=this.parseIdentifier(!0),s.optionalChainMember?(r.optional=n,this.finishNode(r,"OptionalMemberExpression")):this.finishNode(r,"MemberExpression")}parseBind(e,t,s,i){const n=this.startNodeAt(t);return n.object=e,this.next(),n.callee=this.parseNoCallExpr(),i.stop=!0,this.parseSubscripts(this.finishNode(n,"BindExpression"),t,s)}parseCoverCallAndAsyncArrowHead(e,t,s,i){const n=this.state.maybeInArrowParameters;let r=null;this.state.maybeInArrowParameters=!0,this.next();const a=this.startNodeAt(t);a.callee=e;const{maybeAsyncArrow:o,optionalChainMember:c}=s;o&&(this.expressionScope.enter(new Ye(2)),r=new tt),c&&(a.optional=i),a.arguments=i?this.parseCallExpressionArguments(11):this.parseCallExpressionArguments(11,"Import"===e.type,"Super"!==e.type,a,r);let h=this.finishCallExpression(a,c);return o&&this.shouldParseAsyncArrow()&&!i?(s.stop=!0,this.checkDestructuringPrivate(r),this.expressionScope.validateAsPattern(),this.expressionScope.exit(),h=this.parseAsyncArrowFromCallExpression(this.startNodeAt(t),h)):(o&&(this.checkExpressionErrors(r,!0),this.expressionScope.exit()),this.toReferencedArguments(h)),this.state.maybeInArrowParameters=n,h}toReferencedArguments(e,t){this.toReferencedListDeep(e.arguments,t)}parseTaggedTemplateExpression(e,t,s){const i=this.startNodeAt(t);return i.tag=e,i.quasi=this.parseTemplate(!0),s.optionalChainMember&&this.raise(b.OptionalChainingNoTemplate,t),this.finishNode(i,"TaggedTemplateExpression")}atPossibleAsyncArrow(e){return"Identifier"===e.type&&"async"===e.name&&this.state.lastTokEndLoc.index===e.end&&!this.canInsertSemicolon()&&e.end-e.start==5&&e.start===this.state.potentialArrowAt}expectImportAttributesPlugin(){this.hasPlugin("importAssertions")||this.expectPlugin("importAttributes")}finishCallExpression(e,t){if("Import"===e.callee.type)if(2===e.arguments.length&&(this.hasPlugin("moduleAttributes")||this.expectImportAttributesPlugin()),0===e.arguments.length||e.arguments.length>2)this.raise(b.ImportCallArity,e,{maxArgumentCount:this.hasPlugin("importAttributes")||this.hasPlugin("importAssertions")||this.hasPlugin("moduleAttributes")?2:1});else for(const t of e.arguments)"SpreadElement"===t.type&&this.raise(b.ImportCallSpreadArgument,t);return this.finishNode(e,t?"OptionalCallExpression":"CallExpression")}parseCallExpressionArguments(e,t,s,i,n){const r=[];let a=!0;const o=this.state.inFSharpPipelineDirectBody;for(this.state.inFSharpPipelineDirectBody=!1;!this.eat(e);){if(a)a=!1;else if(this.expect(12),this.match(e)){!t||this.hasPlugin("importAttributes")||this.hasPlugin("importAssertions")||this.hasPlugin("moduleAttributes")||this.raise(b.ImportCallArgumentTrailingComma,this.state.lastTokStartLoc),i&&this.addTrailingCommaExtraToNode(i),this.next();break}r.push(this.parseExprListItem(!1,n,s))}return this.state.inFSharpPipelineDirectBody=o,r}shouldParseAsyncArrow(){return this.match(19)&&!this.canInsertSemicolon()}parseAsyncArrowFromCallExpression(e,t){var s;return this.resetPreviousNodeTrailingComments(t),this.expect(19),this.parseArrowExpression(e,t.arguments,!0,null==(s=t.extra)?void 0:s.trailingCommaLoc),t.innerComments&&ve(e,t.innerComments),t.callee.trailingComments&&ve(e,t.callee.trailingComments),e}parseNoCallExpr(){const e=this.state.startLoc;return this.parseSubscripts(this.parseExprAtom(),e,!0)}parseExprAtom(e){let t,s=null;const{type:i}=this.state;switch(i){case 79:return this.parseSuper();case 83:return t=this.startNode(),this.next(),this.match(16)?this.parseImportMetaProperty(t):this.match(10)?this.options.createImportExpressions?this.parseImportCall(t):this.finishNode(t,"Import"):(this.raise(b.UnsupportedImport,this.state.lastTokStartLoc),this.finishNode(t,"Import"));case 78:return t=this.startNode(),this.next(),this.finishNode(t,"ThisExpression");case 90:return this.parseDo(this.startNode(),!1);case 56:case 31:return this.readRegexp(),this.parseRegExpLiteral(this.state.value);case 134:return this.parseNumericLiteral(this.state.value);case 135:return this.parseBigIntLiteral(this.state.value);case 136:return this.parseDecimalLiteral(this.state.value);case 133:return this.parseStringLiteral(this.state.value);case 84:return this.parseNullLiteral();case 85:return this.parseBooleanLiteral(!0);case 86:return this.parseBooleanLiteral(!1);case 10:{const e=this.state.potentialArrowAt===this.state.start;return this.parseParenAndDistinguishExpression(e)}case 2:case 1:return this.parseArrayLike(2===this.state.type?4:3,!1,!0);case 0:return this.parseArrayLike(3,!0,!1,e);case 6:case 7:return this.parseObjectLike(6===this.state.type?9:8,!1,!0);case 5:return this.parseObjectLike(8,!1,!1,e);case 68:return this.parseFunctionOrFunctionSent();case 26:s=this.parseDecorators();case 80:return this.parseClass(this.maybeTakeDecorators(s,this.startNode()),!1);case 77:return this.parseNewOrNewTarget();case 25:case 24:return this.parseTemplate(!1);case 15:{t=this.startNode(),this.next(),t.object=null;const e=t.callee=this.parseNoCallExpr();if("MemberExpression"===e.type)return this.finishNode(t,"BindExpression");throw this.raise(b.UnsupportedBind,e)}case 138:return this.raise(b.PrivateInExpectedIn,this.state.startLoc,{identifierName:this.state.value}),this.parsePrivateName();case 33:return this.parseTopicReferenceThenEqualsSign(54,"%");case 32:return this.parseTopicReferenceThenEqualsSign(44,"^");case 37:case 38:return this.parseTopicReference("hack");case 44:case 54:case 27:{const e=this.getPluginOption("pipelineOperator","proposal");if(e)return this.parseTopicReference(e);this.unexpected();break}case 47:{const e=this.input.codePointAt(this.nextTokenStart());ae(e)||62===e?this.expectOnePlugin(["jsx","flow","typescript"]):this.unexpected();break}default:if(H(i)){if(this.isContextual(127)&&123===this.lookaheadInLineCharCode())return this.parseModuleExpression();const e=this.state.potentialArrowAt===this.state.start,t=this.state.containsEsc,s=this.parseIdentifier();if(!t&&"async"===s.name&&!this.canInsertSemicolon()){const{type:e}=this.state;if(68===e)return this.resetPreviousNodeTrailingComments(s),this.next(),this.parseAsyncFunctionExpression(this.startNodeAtNode(s));if(H(e))return 61===this.lookaheadCharCode()?this.parseAsyncArrowUnaryFunction(this.startNodeAtNode(s)):s;if(90===e)return this.resetPreviousNodeTrailingComments(s),this.parseDo(this.startNodeAtNode(s),!0)}return e&&this.match(19)&&!this.canInsertSemicolon()?(this.next(),this.parseArrowExpression(this.startNodeAtNode(s),[s],!1)):s}this.unexpected()}}parseTopicReferenceThenEqualsSign(e,t){const s=this.getPluginOption("pipelineOperator","proposal");if(s)return this.state.type=e,this.state.value=t,this.state.pos--,this.state.end--,this.state.endLoc=r(this.state.endLoc,-1),this.parseTopicReference(s);this.unexpected()}parseTopicReference(e){const t=this.startNode(),s=this.state.startLoc,i=this.state.type;return this.next(),this.finishTopicReference(t,s,e,i)}finishTopicReference(e,t,s,i){if(this.testTopicReferenceConfiguration(s,t,i)){const i="smart"===s?"PipelinePrimaryTopicReference":"TopicReference";return this.topicReferenceIsAllowedInCurrentContext()||this.raise("smart"===s?b.PrimaryTopicNotAllowed:b.PipeTopicUnbound,t),this.registerTopicReference(),this.finishNode(e,i)}throw this.raise(b.PipeTopicUnconfiguredToken,t,{token:Y(i)})}testTopicReferenceConfiguration(e,t,s){switch(e){case"hack":return this.hasPlugin(["pipelineOperator",{topicToken:Y(s)}]);case"smart":return 27===s;default:throw this.raise(b.PipeTopicRequiresHackPipes,t)}}parseAsyncArrowUnaryFunction(e){this.prodParam.enter(Qe(!0,this.prodParam.hasYield));const t=[this.parseIdentifier()];return this.prodParam.exit(),this.hasPrecedingLineBreak()&&this.raise(b.LineTerminatorBeforeArrow,this.state.curPosition()),this.expect(19),this.parseArrowExpression(e,t,!0)}parseDo(e,t){this.expectPlugin("doExpressions"),t&&this.expectPlugin("asyncDoExpressions"),e.async=t,this.next();const s=this.state.labels;return this.state.labels=[],t?(this.prodParam.enter(2),e.body=this.parseBlock(),this.prodParam.exit()):e.body=this.parseBlock(),this.state.labels=s,this.finishNode(e,"DoExpression")}parseSuper(){const e=this.startNode();return this.next(),!this.match(10)||this.scope.allowDirectSuper||this.options.allowSuperOutsideMethod?this.scope.allowSuper||this.options.allowSuperOutsideMethod||this.raise(b.UnexpectedSuper,e):this.raise(b.SuperNotAllowed,e),this.match(10)||this.match(0)||this.match(16)||this.raise(b.UnsupportedSuper,e),this.finishNode(e,"Super")}parsePrivateName(){const e=this.startNode(),t=this.startNodeAt(r(this.state.startLoc,1)),s=this.state.value;return this.next(),e.id=this.createIdentifier(t,s),this.finishNode(e,"PrivateName")}parseFunctionOrFunctionSent(){const e=this.startNode();if(this.next(),this.prodParam.hasYield&&this.match(16)){const t=this.createIdentifier(this.startNodeAtNode(e),"function");return this.next(),this.match(103)?this.expectPlugin("functionSent"):this.hasPlugin("functionSent")||this.unexpected(),this.parseMetaProperty(e,t,"sent")}return this.parseFunction(e)}parseMetaProperty(e,t,s){e.meta=t;const i=this.state.containsEsc;return e.property=this.parseIdentifier(!0),(e.property.name!==s||i)&&this.raise(b.UnsupportedMetaProperty,e.property,{target:t.name,onlyValidPropertyName:s}),this.finishNode(e,"MetaProperty")}parseImportMetaProperty(e){const t=this.createIdentifier(this.startNodeAtNode(e),"import");if(this.next(),this.isContextual(101))this.inModule||this.raise(b.ImportMetaOutsideModule,t),this.sawUnambiguousESM=!0;else if(this.isContextual(105)||this.isContextual(97)){const t=this.isContextual(105);if(t||this.unexpected(),this.expectPlugin(t?"sourcePhaseImports":"deferredImportEvaluation"),!this.options.createImportExpressions)throw this.raise(b.DynamicImportPhaseRequiresImportExpressions,this.state.startLoc,{phase:this.state.value});return this.next(),e.phase=t?"source":"defer",this.parseImportCall(e)}return this.parseMetaProperty(e,t,"meta")}parseLiteralAtNode(e,t,s){return this.addExtra(s,"rawValue",e),this.addExtra(s,"raw",this.input.slice(s.start,this.state.end)),s.value=e,this.next(),this.finishNode(s,t)}parseLiteral(e,t){const s=this.startNode();return this.parseLiteralAtNode(e,t,s)}parseStringLiteral(e){return this.parseLiteral(e,"StringLiteral")}parseNumericLiteral(e){return this.parseLiteral(e,"NumericLiteral")}parseBigIntLiteral(e){return this.parseLiteral(e,"BigIntLiteral")}parseDecimalLiteral(e){return this.parseLiteral(e,"DecimalLiteral")}parseRegExpLiteral(e){const t=this.parseLiteral(e.value,"RegExpLiteral");return t.pattern=e.pattern,t.flags=e.flags,t}parseBooleanLiteral(e){const t=this.startNode();return t.value=e,this.next(),this.finishNode(t,"BooleanLiteral")}parseNullLiteral(){const e=this.startNode();return this.next(),this.finishNode(e,"NullLiteral")}parseParenAndDistinguishExpression(e){const t=this.state.startLoc;let s;this.next(),this.expressionScope.enter(new Ye(1));const i=this.state.maybeInArrowParameters,n=this.state.inFSharpPipelineDirectBody;this.state.maybeInArrowParameters=!0,this.state.inFSharpPipelineDirectBody=!1;const r=this.state.startLoc,a=[],o=new tt;let c,h,l=!0;for(;!this.match(11);){if(l)l=!1;else if(this.expect(12,null===o.optionalParametersLoc?null:o.optionalParametersLoc),this.match(11)){h=this.state.startLoc;break}if(this.match(21)){const e=this.state.startLoc;if(c=this.state.startLoc,a.push(this.parseParenItem(this.parseRestBinding(),e)),!this.checkCommaAfterRest(41))break}else a.push(this.parseMaybeAssignAllowIn(o,this.parseParenItem))}const p=this.state.lastTokEndLoc;this.expect(11),this.state.maybeInArrowParameters=i,this.state.inFSharpPipelineDirectBody=n;let u=this.startNodeAt(t);return e&&this.shouldParseArrow(a)&&(u=this.parseArrow(u))?(this.checkDestructuringPrivate(o),this.expressionScope.validateAsPattern(),this.expressionScope.exit(),this.parseArrowExpression(u,a,!1),u):(this.expressionScope.exit(),a.length||this.unexpected(this.state.lastTokStartLoc),h&&this.unexpected(h),c&&this.unexpected(c),this.checkExpressionErrors(o,!0),this.toReferencedListDeep(a,!0),a.length>1?(s=this.startNodeAt(r),s.expressions=a,this.finishNode(s,"SequenceExpression"),this.resetEndLocation(s,p)):s=a[0],this.wrapParenthesis(t,s))}wrapParenthesis(e,t){if(!this.options.createParenthesizedExpressions)return this.addExtra(t,"parenthesized",!0),this.addExtra(t,"parenStart",e.index),this.takeSurroundingComments(t,e.index,this.state.lastTokEndLoc.index),t;const s=this.startNodeAt(e);return s.expression=t,this.finishNode(s,"ParenthesizedExpression")}shouldParseArrow(e){return!this.canInsertSemicolon()}parseArrow(e){if(this.eat(19))return e}parseParenItem(e,t){return e}parseNewOrNewTarget(){const e=this.startNode();if(this.next(),this.match(16)){const t=this.createIdentifier(this.startNodeAtNode(e),"new");this.next();const s=this.parseMetaProperty(e,t,"target");return this.scope.inNonArrowFunction||this.scope.inClass||this.options.allowNewTargetOutsideFunction||this.raise(b.UnexpectedNewTarget,s),s}return this.parseNew(e)}parseNew(e){if(this.parseNewCallee(e),this.eat(10)){const t=this.parseExprList(11);this.toReferencedList(t),e.arguments=t}else e.arguments=[];return this.finishNode(e,"NewExpression")}parseNewCallee(e){const t=this.match(83),s=this.parseNoCallExpr();e.callee=s,!t||"Import"!==s.type&&"ImportExpression"!==s.type||this.raise(b.ImportCallNotNewExpression,s)}parseTemplateElement(e){const{start:t,startLoc:s,end:i,value:n}=this.state,a=t+1,o=this.startNodeAt(r(s,1));null===n&&(e||this.raise(b.InvalidEscapeSequenceTemplate,r(this.state.firstInvalidTemplateEscapePos,1)));const c=this.match(24),h=c?-1:-2,l=i+h;o.value={raw:this.input.slice(a,l).replace(/\r\n?/g,"\n"),cooked:null===n?null:n.slice(1,h)},o.tail=c,this.next();const p=this.finishNode(o,"TemplateElement");return this.resetEndLocation(p,r(this.state.lastTokEndLoc,h)),p}parseTemplate(e){const t=this.startNode();let s=this.parseTemplateElement(e);const i=[s],n=[];for(;!s.tail;)n.push(this.parseTemplateSubstitution()),this.readTemplateContinuation(),i.push(s=this.parseTemplateElement(e));return t.expressions=n,t.quasis=i,this.finishNode(t,"TemplateLiteral")}parseTemplateSubstitution(){return this.parseExpression()}parseObjectLike(e,t,s,i){s&&this.expectPlugin("recordAndTuple");const n=this.state.inFSharpPipelineDirectBody;this.state.inFSharpPipelineDirectBody=!1;const r=Object.create(null);let a=!0;const o=this.startNode();for(o.properties=[],this.next();!this.match(e);){if(a)a=!1;else if(this.expect(12),this.match(e)){this.addTrailingCommaExtraToNode(o);break}let n;t?n=this.parseBindingProperty():(n=this.parsePropertyDefinition(i),this.checkProto(n,s,r,i)),s&&!this.isObjectProperty(n)&&"SpreadElement"!==n.type&&this.raise(b.InvalidRecordProperty,n),n.shorthand&&this.addExtra(n,"shorthand",!0),o.properties.push(n)}this.next(),this.state.inFSharpPipelineDirectBody=n;let c="ObjectExpression";return t?c="ObjectPattern":s&&(c="RecordExpression"),this.finishNode(o,c)}addTrailingCommaExtraToNode(e){this.addExtra(e,"trailingComma",this.state.lastTokStartLoc.index),this.addExtra(e,"trailingCommaLoc",this.state.lastTokStartLoc,!1)}maybeAsyncOrAccessorProp(e){return!e.computed&&"Identifier"===e.key.type&&(this.isLiteralPropertyName()||this.match(0)||this.match(55))}parsePropertyDefinition(e){let t=[];if(this.match(26))for(this.hasPlugin("decorators")&&this.raise(b.UnsupportedPropertyDecorator,this.state.startLoc);this.match(26);)t.push(this.parseDecorator());const s=this.startNode();let i,n=!1,r=!1;if(this.match(21))return t.length&&this.unexpected(),this.parseSpread();t.length&&(s.decorators=t,t=[]),s.method=!1,e&&(i=this.state.startLoc);let a=this.eat(55);this.parsePropertyNamePrefixOperator(s);const o=this.state.containsEsc;if(this.parsePropertyName(s,e),!a&&!o&&this.maybeAsyncOrAccessorProp(s)){const{key:e}=s,t=e.name;"async"!==t||this.hasPrecedingLineBreak()||(n=!0,this.resetPreviousNodeTrailingComments(e),a=this.eat(55),this.parsePropertyName(s)),"get"!==t&&"set"!==t||(r=!0,this.resetPreviousNodeTrailingComments(e),s.kind=t,this.match(55)&&(a=!0,this.raise(b.AccessorIsGenerator,this.state.curPosition(),{kind:t}),this.next()),this.parsePropertyName(s))}return this.parseObjPropValue(s,i,a,n,!1,r,e)}getGetterSetterExpectedParamCount(e){return"get"===e.kind?0:1}getObjectOrClassMethodParams(e){return e.params}checkGetterSetterParams(e){var t;const s=this.getGetterSetterExpectedParamCount(e),i=this.getObjectOrClassMethodParams(e);i.length!==s&&this.raise("get"===e.kind?b.BadGetterArity:b.BadSetterArity,e),"set"===e.kind&&"RestElement"===(null==(t=i[i.length-1])?void 0:t.type)&&this.raise(b.BadSetterRestParameter,e)}parseObjectMethod(e,t,s,i,n){if(n){const s=this.parseMethod(e,t,!1,!1,!1,"ObjectMethod");return this.checkGetterSetterParams(s),s}if(s||t||this.match(10))return i&&this.unexpected(),e.kind="method",e.method=!0,this.parseMethod(e,t,s,!1,!1,"ObjectMethod")}parseObjectProperty(e,t,s,i){if(e.shorthand=!1,this.eat(14))return e.value=s?this.parseMaybeDefault(this.state.startLoc):this.parseMaybeAssignAllowIn(i),this.finishNode(e,"ObjectProperty");if(!e.computed&&"Identifier"===e.key.type){if(this.checkReservedWord(e.key.name,e.key.loc.start,!0,!1),s)e.value=this.parseMaybeDefault(t,nt(e.key));else if(this.match(29)){const s=this.state.startLoc;null!=i?null===i.shorthandAssignLoc&&(i.shorthandAssignLoc=s):this.raise(b.InvalidCoverInitializedName,s),e.value=this.parseMaybeDefault(t,nt(e.key))}else e.value=nt(e.key);return e.shorthand=!0,this.finishNode(e,"ObjectProperty")}}parseObjPropValue(e,t,s,i,n,r,a){const o=this.parseObjectMethod(e,s,i,n,r)||this.parseObjectProperty(e,t,n,a);return o||this.unexpected(),o}parsePropertyName(e,t){if(this.eat(0))e.computed=!0,e.key=this.parseMaybeAssignAllowIn(),this.expect(3);else{const{type:s,value:i}=this.state;let n;if(V(s))n=this.parseIdentifier(!0);else switch(s){case 134:n=this.parseNumericLiteral(i);break;case 133:n=this.parseStringLiteral(i);break;case 135:n=this.parseBigIntLiteral(i);break;case 136:n=this.parseDecimalLiteral(i);break;case 138:{const e=this.state.startLoc;null!=t?null===t.privateKeyLoc&&(t.privateKeyLoc=e):this.raise(b.UnexpectedPrivateField,e),n=this.parsePrivateName();break}default:this.unexpected()}e.key=n,138!==s&&(e.computed=!1)}}initFunction(e,t){e.id=null,e.generator=!1,e.async=t}parseMethod(e,t,s,i,n,r,a=!1){this.initFunction(e,s),e.generator=t,this.scope.enter(18|(a?64:0)|(n?32:0)),this.prodParam.enter(Qe(s,e.generator)),this.parseFunctionParams(e,i);const o=this.parseFunctionBodyAndFinish(e,r,!0);return this.prodParam.exit(),this.scope.exit(),o}parseArrayLike(e,t,s,i){s&&this.expectPlugin("recordAndTuple");const n=this.state.inFSharpPipelineDirectBody;this.state.inFSharpPipelineDirectBody=!1;const r=this.startNode();return this.next(),r.elements=this.parseExprList(e,!s,i,r),this.state.inFSharpPipelineDirectBody=n,this.finishNode(r,s?"TupleExpression":"ArrayExpression")}parseArrowExpression(e,t,s,i){this.scope.enter(6);let n=Qe(s,!1);!this.match(5)&&this.prodParam.hasIn&&(n|=8),this.prodParam.enter(n),this.initFunction(e,s);const r=this.state.maybeInArrowParameters;return t&&(this.state.maybeInArrowParameters=!0,this.setArrowFunctionParameters(e,t,i)),this.state.maybeInArrowParameters=!1,this.parseFunctionBody(e,!0),this.prodParam.exit(),this.scope.exit(),this.state.maybeInArrowParameters=r,this.finishNode(e,"ArrowFunctionExpression")}setArrowFunctionParameters(e,t,s){this.toAssignableList(t,s,!1),e.params=t}parseFunctionBodyAndFinish(e,t,s=!1){return this.parseFunctionBody(e,!1,s),this.finishNode(e,t)}parseFunctionBody(e,t,s=!1){const i=t&&!this.match(5);if(this.expressionScope.enter(Xe()),i)e.body=this.parseMaybeAssign(),this.checkParams(e,!1,t,!1);else{const i=this.state.strict,n=this.state.labels;this.state.labels=[],this.prodParam.enter(4|this.prodParam.currentFlags()),e.body=this.parseBlock(!0,!1,(n=>{const r=!this.isSimpleParamList(e.params);n&&r&&this.raise(b.IllegalLanguageModeDirective,"method"!==e.kind&&"constructor"!==e.kind||!e.key?e:e.key.loc.end);const a=!i&&this.state.strict;this.checkParams(e,!(this.state.strict||t||s||r),t,a),this.state.strict&&e.id&&this.checkIdentifier(e.id,65,a)})),this.prodParam.exit(),this.state.labels=n}this.expressionScope.exit()}isSimpleParameter(e){return"Identifier"===e.type}isSimpleParamList(e){for(let t=0,s=e.length;t<s;t++)if(!this.isSimpleParameter(e[t]))return!1;return!0}checkParams(e,t,s,i=!0){const n=!t&&new Set,r={type:"FormalParameters"};for(const t of e.params)this.checkLVal(t,{in:r,binding:5,checkClashes:n,strictModeChanged:i})}parseExprList(e,t,s,i){const n=[];let r=!0;for(;!this.eat(e);){if(r)r=!1;else if(this.expect(12),this.match(e)){i&&this.addTrailingCommaExtraToNode(i),this.next();break}n.push(this.parseExprListItem(t,s))}return n}parseExprListItem(e,t,s){let i;if(this.match(12))e||this.raise(b.UnexpectedToken,this.state.curPosition(),{unexpected:","}),i=null;else if(this.match(21)){const e=this.state.startLoc;i=this.parseParenItem(this.parseSpread(t),e)}else if(this.match(17)){this.expectPlugin("partialApplication"),s||this.raise(b.UnexpectedArgumentPlaceholder,this.state.startLoc);const e=this.startNode();this.next(),i=this.finishNode(e,"ArgumentPlaceholder")}else i=this.parseMaybeAssignAllowIn(t,this.parseParenItem);return i}parseIdentifier(e){const t=this.startNode(),s=this.parseIdentifierName(e);return this.createIdentifier(t,s)}createIdentifier(e,t){return e.name=t,e.loc.identifierName=t,this.finishNode(e,"Identifier")}parseIdentifierName(e){let t;const{startLoc:s,type:i}=this.state;V(i)?t=this.state.value:this.unexpected();const n=i<=92;return e?n&&this.replaceToken(132):this.checkReservedWord(t,s,n,!1),this.next(),t}checkReservedWord(e,t,s,i){if(!(e.length>10)&&function(e){return me.has(e)}(e))if(s&&function(e){return ce.has(e)}(e))this.raise(b.UnexpectedKeyword,t,{keyword:e});else if((this.state.strict?i?fe:ue:pe)(e,this.inModule))this.raise(b.UnexpectedReservedWord,t,{reservedWord:e});else if("yield"===e){if(this.prodParam.hasYield)return void this.raise(b.YieldBindingIdentifier,t)}else if("await"===e){if(this.prodParam.hasAwait)return void this.raise(b.AwaitBindingIdentifier,t);if(this.scope.inStaticBlock)return void this.raise(b.AwaitBindingIdentifierInStaticBlock,t);this.expressionScope.recordAsyncArrowParametersError(t)}else if("arguments"===e&&this.scope.inClassAndNotInNonArrowFunction)return void this.raise(b.ArgumentsInClass,t)}isAwaitAllowed(){return!!this.prodParam.hasAwait||!(!this.options.allowAwaitOutsideFunction||this.scope.inFunction)}parseAwait(e){const t=this.startNodeAt(e);return this.expressionScope.recordParameterInitializerError(b.AwaitExpressionFormalParameter,t),this.eat(55)&&this.raise(b.ObsoleteAwaitStar,t),this.scope.inFunction||this.options.allowAwaitOutsideFunction||(this.isAmbiguousAwait()?this.ambiguousScriptDifferentAst=!0:this.sawUnambiguousESM=!0),this.state.soloAwait||(t.argument=this.parseMaybeUnary(null,!0)),this.finishNode(t,"AwaitExpression")}isAmbiguousAwait(){if(this.hasPrecedingLineBreak())return!0;const{type:e}=this.state;return 53===e||10===e||0===e||X(e)||102===e&&!this.state.containsEsc||137===e||56===e||this.hasPlugin("v8intrinsic")&&54===e}parseYield(){const e=this.startNode();this.expressionScope.recordParameterInitializerError(b.YieldInParameter,e),this.next();let t=!1,s=null;if(!this.hasPrecedingLineBreak())switch(t=this.eat(55),this.state.type){case 13:case 139:case 8:case 11:case 3:case 9:case 14:case 12:if(!t)break;default:s=this.parseMaybeAssign()}return e.delegate=t,e.argument=s,this.finishNode(e,"YieldExpression")}parseImportCall(e){return this.next(),e.source=this.parseMaybeAssignAllowIn(),(this.hasPlugin("importAttributes")||this.hasPlugin("importAssertions"))&&(e.options=null),this.eat(12)&&(this.expectImportAttributesPlugin(),this.match(11)||(e.options=this.parseMaybeAssignAllowIn(),this.eat(12))),this.expect(11),this.finishNode(e,"ImportExpression")}checkPipelineAtInfixOperator(e,t){this.hasPlugin(["pipelineOperator",{proposal:"smart"}])&&"SequenceExpression"===e.type&&this.raise(b.PipelineHeadSequenceExpression,t)}parseSmartPipelineBodyInStyle(e,t){if(this.isSimpleReference(e)){const s=this.startNodeAt(t);return s.callee=e,this.finishNode(s,"PipelineBareFunction")}{const s=this.startNodeAt(t);return this.checkSmartPipeTopicBodyEarlyErrors(t),s.expression=e,this.finishNode(s,"PipelineTopicExpression")}}isSimpleReference(e){switch(e.type){case"MemberExpression":return!e.computed&&this.isSimpleReference(e.object);case"Identifier":return!0;default:return!1}}checkSmartPipeTopicBodyEarlyErrors(e){if(this.match(19))throw this.raise(b.PipelineBodyNoArrow,this.state.startLoc);this.topicReferenceWasUsedInCurrentContext()||this.raise(b.PipelineTopicUnused,e)}withTopicBindingContext(e){const t=this.state.topicContext;this.state.topicContext={maxNumOfResolvableTopics:1,maxTopicIndex:null};try{return e()}finally{this.state.topicContext=t}}withSmartMixTopicForbiddingContext(e){if(!this.hasPlugin(["pipelineOperator",{proposal:"smart"}]))return e();{const t=this.state.topicContext;this.state.topicContext={maxNumOfResolvableTopics:0,maxTopicIndex:null};try{return e()}finally{this.state.topicContext=t}}}withSoloAwaitPermittingContext(e){const t=this.state.soloAwait;this.state.soloAwait=!0;try{return e()}finally{this.state.soloAwait=t}}allowInAnd(e){const t=this.prodParam.currentFlags();if(8&~t){this.prodParam.enter(8|t);try{return e()}finally{this.prodParam.exit()}}return e()}disallowInAnd(e){const t=this.prodParam.currentFlags();if(8&t){this.prodParam.enter(-9&t);try{return e()}finally{this.prodParam.exit()}}return e()}registerTopicReference(){this.state.topicContext.maxTopicIndex=0}topicReferenceIsAllowedInCurrentContext(){return this.state.topicContext.maxNumOfResolvableTopics>=1}topicReferenceWasUsedInCurrentContext(){return null!=this.state.topicContext.maxTopicIndex&&this.state.topicContext.maxTopicIndex>=0}parseFSharpPipelineBody(e){const t=this.state.startLoc;this.state.potentialArrowAt=this.state.start;const s=this.state.inFSharpPipelineDirectBody;this.state.inFSharpPipelineDirectBody=!0;const i=this.parseExprOp(this.parseMaybeUnaryOrPrivate(),t,e);return this.state.inFSharpPipelineDirectBody=s,i}parseModuleExpression(){this.expectPlugin("moduleBlocks");const e=this.startNode();this.next(),this.match(5)||this.unexpected(null,5);const t=this.startNodeAt(this.state.endLoc);this.next();const s=this.initializeScopes(!0);this.enterInitialScopes();try{e.body=this.parseProgram(t,8,"module")}finally{s()}return this.finishNode(e,"ModuleExpression")}parsePropertyNamePrefixOperator(e){}}const Ft={kind:1},Bt={kind:2},jt=/[\uD800-\uDFFF]/u,Ut=/in(?:stanceof)?/y;class zt extends Rt{parseTopLevel(e,t){return e.program=this.parseProgram(t),e.comments=this.comments,this.options.tokens&&(e.tokens=function(e,t){for(let s=0;s<e.length;s++){const i=e[s],{type:n}=i;if("number"==typeof n){if(138===n){const{loc:t,start:n,value:a,end:o}=i,c=n+1,h=r(t.start,1);e.splice(s,1,new Ve({type:Z(27),value:"#",start:n,end:c,startLoc:t.start,endLoc:h}),new Ve({type:Z(132),value:a,start:c,end:o,startLoc:h,endLoc:t.end})),s++;continue}if(X(n)){const{loc:a,start:o,value:c,end:h}=i,l=o+1,p=r(a.start,1);let u,d,f,m,y;u=96===t.charCodeAt(o)?new Ve({type:Z(22),value:"`",start:o,end:l,startLoc:a.start,endLoc:p}):new Ve({type:Z(8),value:"}",start:o,end:l,startLoc:a.start,endLoc:p}),24===n?(f=h-1,m=r(a.end,-1),d=null===c?null:c.slice(1,-1),y=new Ve({type:Z(22),value:"`",start:f,end:h,startLoc:m,endLoc:a.end})):(f=h-2,m=r(a.end,-2),d=null===c?null:c.slice(1,-2),y=new Ve({type:Z(23),value:"${",start:f,end:h,startLoc:m,endLoc:a.end})),e.splice(s,1,u,new Ve({type:Z(20),value:d,start:l,end:f,startLoc:p,endLoc:m}),y),s+=2;continue}i.type=Z(n)}}return e}(this.tokens,this.input)),this.finishNode(e,"File")}parseProgram(e,t=139,s=this.options.sourceType){if(e.sourceType=s,e.interpreter=this.parseInterpreterDirective(),this.parseBlockBody(e,!0,!0,t),this.inModule&&!this.options.allowUndeclaredExports&&this.scope.undefinedExports.size>0)for(const[e,t]of Array.from(this.scope.undefinedExports))this.raise(b.ModuleExportUndefined,t,{localName:e});let i;return i=139===t?this.finishNode(e,"Program"):this.finishNodeAt(e,"Program",r(this.state.startLoc,-1)),i}stmtToDirective(e){const t=e;t.type="Directive",t.value=t.expression,delete t.expression;const s=t.value,i=s.value,n=this.input.slice(s.start,s.end),r=s.value=n.slice(1,-1);return this.addExtra(s,"raw",n),this.addExtra(s,"rawValue",r),this.addExtra(s,"expressionValue",i),s.type="DirectiveLiteral",t}parseInterpreterDirective(){if(!this.match(28))return null;const e=this.startNode();return e.value=this.state.value,this.next(),this.finishNode(e,"InterpreterDirective")}isLet(){return!!this.isContextual(100)&&this.hasFollowingBindingAtom()}chStartsBindingIdentifier(e,t){if(ae(e)){if(Ut.lastIndex=t,Ut.test(this.input)){const e=this.codePointAtPos(Ut.lastIndex);if(!oe(e)&&92!==e)return!1}return!0}return 92===e}chStartsBindingPattern(e){return 91===e||123===e}hasFollowingBindingAtom(){const e=this.nextTokenStart(),t=this.codePointAtPos(e);return this.chStartsBindingPattern(t)||this.chStartsBindingIdentifier(t,e)}hasInLineFollowingBindingIdentifier(){const e=this.nextTokenInLineStart(),t=this.codePointAtPos(e);return this.chStartsBindingIdentifier(t,e)}startsUsingForOf(){const{type:e,containsEsc:t}=this.lookahead();return!(102===e&&!t)&&(H(e)&&!this.hasFollowingLineBreak()?(this.expectPlugin("explicitResourceManagement"),!0):void 0)}startsAwaitUsing(){let e=this.nextTokenInLineStart();if(this.isUnparsedContextual(e,"using")){e=this.nextTokenInLineStartSince(e+5);const t=this.codePointAtPos(e);if(this.chStartsBindingIdentifier(t,e))return this.expectPlugin("explicitResourceManagement"),!0}return!1}parseModuleItem(){return this.parseStatementLike(15)}parseStatementListItem(){return this.parseStatementLike(6|(!this.options.annexB||this.state.strict?0:8))}parseStatementOrSloppyAnnexBFunctionDeclaration(e=!1){let t=0;return this.options.annexB&&!this.state.strict&&(t|=4,e&&(t|=8)),this.parseStatementLike(t)}parseStatement(){return this.parseStatementLike(0)}parseStatementLike(e){let t=null;return this.match(26)&&(t=this.parseDecorators(!0)),this.parseStatementContent(e,t)}parseStatementContent(e,t){const s=this.state.type,i=this.startNode(),n=!!(2&e),r=!!(4&e),a=1&e;switch(s){case 60:return this.parseBreakContinueStatement(i,!0);case 63:return this.parseBreakContinueStatement(i,!1);case 64:return this.parseDebuggerStatement(i);case 90:return this.parseDoWhileStatement(i);case 91:return this.parseForStatement(i);case 68:if(46===this.lookaheadCharCode())break;return r||this.raise(this.state.strict?b.StrictFunction:this.options.annexB?b.SloppyFunctionAnnexB:b.SloppyFunction,this.state.startLoc),this.parseFunctionStatement(i,!1,!n&&r);case 80:return n||this.unexpected(),this.parseClass(this.maybeTakeDecorators(t,i),!0);case 69:return this.parseIfStatement(i);case 70:return this.parseReturnStatement(i);case 71:return this.parseSwitchStatement(i);case 72:return this.parseThrowStatement(i);case 73:return this.parseTryStatement(i);case 96:if(!this.state.containsEsc&&this.startsAwaitUsing())return this.isAwaitAllowed()?n||this.raise(b.UnexpectedLexicalDeclaration,i):this.raise(b.AwaitUsingNotInAsyncContext,i),this.next(),this.parseVarStatement(i,"await using");break;case 107:if(this.state.containsEsc||!this.hasInLineFollowingBindingIdentifier())break;return this.expectPlugin("explicitResourceManagement"),!this.scope.inModule&&this.scope.inTopLevel?this.raise(b.UnexpectedUsingDeclaration,this.state.startLoc):n||this.raise(b.UnexpectedLexicalDeclaration,this.state.startLoc),this.parseVarStatement(i,"using");case 100:{if(this.state.containsEsc)break;const e=this.nextTokenStart(),t=this.codePointAtPos(e);if(91!==t){if(!n&&this.hasFollowingLineBreak())break;if(!this.chStartsBindingIdentifier(t,e)&&123!==t)break}}case 75:n||this.raise(b.UnexpectedLexicalDeclaration,this.state.startLoc);case 74:{const e=this.state.value;return this.parseVarStatement(i,e)}case 92:return this.parseWhileStatement(i);case 76:return this.parseWithStatement(i);case 5:return this.parseBlock();case 13:return this.parseEmptyStatement(i);case 83:{const e=this.lookaheadCharCode();if(40===e||46===e)break}case 82:{let e;return this.options.allowImportExportEverywhere||a||this.raise(b.UnexpectedImportExport,this.state.startLoc),this.next(),83===s?(e=this.parseImport(i),"ImportDeclaration"!==e.type||e.importKind&&"value"!==e.importKind||(this.sawUnambiguousESM=!0)):(e=this.parseExport(i,t),("ExportNamedDeclaration"!==e.type||e.exportKind&&"value"!==e.exportKind)&&("ExportAllDeclaration"!==e.type||e.exportKind&&"value"!==e.exportKind)&&"ExportDefaultDeclaration"!==e.type||(this.sawUnambiguousESM=!0)),this.assertModuleNodeAllowed(e),e}default:if(this.isAsyncFunction())return n||this.raise(b.AsyncFunctionInSingleStatementContext,this.state.startLoc),this.next(),this.parseFunctionStatement(i,!0,!n&&r)}const o=this.state.value,c=this.parseExpression();return H(s)&&"Identifier"===c.type&&this.eat(14)?this.parseLabeledStatement(i,o,c,e):this.parseExpressionStatement(i,c,t)}assertModuleNodeAllowed(e){this.options.allowImportExportEverywhere||this.inModule||this.raise(b.ImportOutsideModule,e)}decoratorsEnabledBeforeExport(){return!!this.hasPlugin("decorators-legacy")||this.hasPlugin("decorators")&&!1!==this.getPluginOption("decorators","decoratorsBeforeExport")}maybeTakeDecorators(e,t,s){return e&&(t.decorators&&t.decorators.length>0?("boolean"!=typeof this.getPluginOption("decorators","decoratorsBeforeExport")&&this.raise(b.DecoratorsBeforeAfterExport,t.decorators[0]),t.decorators.unshift(...e)):t.decorators=e,this.resetStartLocationFromNode(t,e[0]),s&&this.resetStartLocationFromNode(s,t)),t}canHaveLeadingDecorator(){return this.match(80)}parseDecorators(e){const t=[];do{t.push(this.parseDecorator())}while(this.match(26));if(this.match(82))e||this.unexpected(),this.decoratorsEnabledBeforeExport()||this.raise(b.DecoratorExportClass,this.state.startLoc);else if(!this.canHaveLeadingDecorator())throw this.raise(b.UnexpectedLeadingDecorator,this.state.startLoc);return t}parseDecorator(){this.expectOnePlugin(["decorators","decorators-legacy"]);const e=this.startNode();if(this.next(),this.hasPlugin("decorators")){const t=this.state.startLoc;let s;if(this.match(10)){const t=this.state.startLoc;this.next(),s=this.parseExpression(),this.expect(11),s=this.wrapParenthesis(t,s);const i=this.state.startLoc;e.expression=this.parseMaybeDecoratorArguments(s),!1===this.getPluginOption("decorators","allowCallParenthesized")&&e.expression!==s&&this.raise(b.DecoratorArgumentsOutsideParentheses,i)}else{for(s=this.parseIdentifier(!1);this.eat(16);){const e=this.startNodeAt(t);e.object=s,this.match(138)?(this.classScope.usePrivateName(this.state.value,this.state.startLoc),e.property=this.parsePrivateName()):e.property=this.parseIdentifier(!0),e.computed=!1,s=this.finishNode(e,"MemberExpression")}e.expression=this.parseMaybeDecoratorArguments(s)}}else e.expression=this.parseExprSubscripts();return this.finishNode(e,"Decorator")}parseMaybeDecoratorArguments(e){if(this.eat(10)){const t=this.startNodeAtNode(e);return t.callee=e,t.arguments=this.parseCallExpressionArguments(11,!1),this.toReferencedList(t.arguments),this.finishNode(t,"CallExpression")}return e}parseBreakContinueStatement(e,t){return this.next(),this.isLineTerminator()?e.label=null:(e.label=this.parseIdentifier(),this.semicolon()),this.verifyBreakContinue(e,t),this.finishNode(e,t?"BreakStatement":"ContinueStatement")}verifyBreakContinue(e,t){let s;for(s=0;s<this.state.labels.length;++s){const i=this.state.labels[s];if(null==e.label||i.name===e.label.name){if(null!=i.kind&&(t||1===i.kind))break;if(e.label&&t)break}}if(s===this.state.labels.length){const s=t?"BreakStatement":"ContinueStatement";this.raise(b.IllegalBreakContinue,e,{type:s})}}parseDebuggerStatement(e){return this.next(),this.semicolon(),this.finishNode(e,"DebuggerStatement")}parseHeaderExpression(){this.expect(10);const e=this.parseExpression();return this.expect(11),e}parseDoWhileStatement(e){return this.next(),this.state.labels.push(Ft),e.body=this.withSmartMixTopicForbiddingContext((()=>this.parseStatement())),this.state.labels.pop(),this.expect(92),e.test=this.parseHeaderExpression(),this.eat(13),this.finishNode(e,"DoWhileStatement")}parseForStatement(e){this.next(),this.state.labels.push(Ft);let t=null;if(this.isAwaitAllowed()&&this.eatContextual(96)&&(t=this.state.lastTokStartLoc),this.scope.enter(0),this.expect(10),this.match(13))return null!==t&&this.unexpected(t),this.parseFor(e,null);const s=this.isContextual(100);{const i=this.isContextual(96)&&this.startsAwaitUsing(),n=i||this.isContextual(107)&&this.startsUsingForOf(),r=s&&this.hasFollowingBindingAtom()||n;if(this.match(74)||this.match(75)||r){const s=this.startNode();let r;i?(r="await using",this.isAwaitAllowed()||this.raise(b.AwaitUsingNotInAsyncContext,this.state.startLoc),this.next()):r=this.state.value,this.next(),this.parseVar(s,!0,r);const a=this.finishNode(s,"VariableDeclaration"),o=this.match(58);return o&&n&&this.raise(b.ForInUsing,a),(o||this.isContextual(102))&&1===a.declarations.length?this.parseForIn(e,a,t):(null!==t&&this.unexpected(t),this.parseFor(e,a))}}const i=this.isContextual(95),n=new tt,r=this.parseExpression(!0,n),a=this.isContextual(102);if(a&&(s&&this.raise(b.ForOfLet,r),null===t&&i&&"Identifier"===r.type&&this.raise(b.ForOfAsync,r)),a||this.match(58)){this.checkDestructuringPrivate(n),this.toAssignable(r,!0);const s=a?"ForOfStatement":"ForInStatement";return this.checkLVal(r,{in:{type:s}}),this.parseForIn(e,r,t)}return this.checkExpressionErrors(n,!0),null!==t&&this.unexpected(t),this.parseFor(e,r)}parseFunctionStatement(e,t,s){return this.next(),this.parseFunction(e,1|(s?2:0)|(t?8:0))}parseIfStatement(e){return this.next(),e.test=this.parseHeaderExpression(),e.consequent=this.parseStatementOrSloppyAnnexBFunctionDeclaration(),e.alternate=this.eat(66)?this.parseStatementOrSloppyAnnexBFunctionDeclaration():null,this.finishNode(e,"IfStatement")}parseReturnStatement(e){return this.prodParam.hasReturn||this.options.allowReturnOutsideFunction||this.raise(b.IllegalReturn,this.state.startLoc),this.next(),this.isLineTerminator()?e.argument=null:(e.argument=this.parseExpression(),this.semicolon()),this.finishNode(e,"ReturnStatement")}parseSwitchStatement(e){this.next(),e.discriminant=this.parseHeaderExpression();const t=e.cases=[];let s;this.expect(5),this.state.labels.push(Bt),this.scope.enter(0);for(let e;!this.match(8);)if(this.match(61)||this.match(65)){const i=this.match(61);s&&this.finishNode(s,"SwitchCase"),t.push(s=this.startNode()),s.consequent=[],this.next(),i?s.test=this.parseExpression():(e&&this.raise(b.MultipleDefaultsInSwitch,this.state.lastTokStartLoc),e=!0,s.test=null),this.expect(14)}else s?s.consequent.push(this.parseStatementListItem()):this.unexpected();return this.scope.exit(),s&&this.finishNode(s,"SwitchCase"),this.next(),this.state.labels.pop(),this.finishNode(e,"SwitchStatement")}parseThrowStatement(e){return this.next(),this.hasPrecedingLineBreak()&&this.raise(b.NewlineAfterThrow,this.state.lastTokEndLoc),e.argument=this.parseExpression(),this.semicolon(),this.finishNode(e,"ThrowStatement")}parseCatchClauseParam(){const e=this.parseBindingAtom();return this.scope.enter(this.options.annexB&&"Identifier"===e.type?8:0),this.checkLVal(e,{in:{type:"CatchClause"},binding:9}),e}parseTryStatement(e){if(this.next(),e.block=this.parseBlock(),e.handler=null,this.match(62)){const t=this.startNode();this.next(),this.match(10)?(this.expect(10),t.param=this.parseCatchClauseParam(),this.expect(11)):(t.param=null,this.scope.enter(0)),t.body=this.withSmartMixTopicForbiddingContext((()=>this.parseBlock(!1,!1))),this.scope.exit(),e.handler=this.finishNode(t,"CatchClause")}return e.finalizer=this.eat(67)?this.parseBlock():null,e.handler||e.finalizer||this.raise(b.NoCatchOrFinally,e),this.finishNode(e,"TryStatement")}parseVarStatement(e,t,s=!1){return this.next(),this.parseVar(e,!1,t,s),this.semicolon(),this.finishNode(e,"VariableDeclaration")}parseWhileStatement(e){return this.next(),e.test=this.parseHeaderExpression(),this.state.labels.push(Ft),e.body=this.withSmartMixTopicForbiddingContext((()=>this.parseStatement())),this.state.labels.pop(),this.finishNode(e,"WhileStatement")}parseWithStatement(e){return this.state.strict&&this.raise(b.StrictWith,this.state.startLoc),this.next(),e.object=this.parseHeaderExpression(),e.body=this.withSmartMixTopicForbiddingContext((()=>this.parseStatement())),this.finishNode(e,"WithStatement")}parseEmptyStatement(e){return this.next(),this.finishNode(e,"EmptyStatement")}parseLabeledStatement(e,t,s,i){for(const e of this.state.labels)e.name===t&&this.raise(b.LabelRedeclaration,s,{labelName:t});const n=(r=this.state.type)>=90&&r<=92?1:this.match(71)?2:null;var r;for(let t=this.state.labels.length-1;t>=0;t--){const s=this.state.labels[t];if(s.statementStart!==e.start)break;s.statementStart=this.state.start,s.kind=n}return this.state.labels.push({name:t,kind:n,statementStart:this.state.start}),e.body=8&i?this.parseStatementOrSloppyAnnexBFunctionDeclaration(!0):this.parseStatement(),this.state.labels.pop(),e.label=s,this.finishNode(e,"LabeledStatement")}parseExpressionStatement(e,t,s){return e.expression=t,this.semicolon(),this.finishNode(e,"ExpressionStatement")}parseBlock(e=!1,t=!0,s){const i=this.startNode();return e&&this.state.strictErrors.clear(),this.expect(5),t&&this.scope.enter(0),this.parseBlockBody(i,e,!1,8,s),t&&this.scope.exit(),this.finishNode(i,"BlockStatement")}isValidDirective(e){return"ExpressionStatement"===e.type&&"StringLiteral"===e.expression.type&&!e.expression.extra.parenthesized}parseBlockBody(e,t,s,i,n){const r=e.body=[],a=e.directives=[];this.parseBlockOrModuleBlockBody(r,t?a:void 0,s,i,n)}parseBlockOrModuleBlockBody(e,t,s,i,n){const r=this.state.strict;let a=!1,o=!1;for(;!this.match(i);){const i=s?this.parseModuleItem():this.parseStatementListItem();if(t&&!o){if(this.isValidDirective(i)){const e=this.stmtToDirective(i);t.push(e),a||"use strict"!==e.value.value||(a=!0,this.setStrict(!0));continue}o=!0,this.state.strictErrors.clear()}e.push(i)}null==n||n.call(this,a),r||this.setStrict(!1),this.next()}parseFor(e,t){return e.init=t,this.semicolon(!1),e.test=this.match(13)?null:this.parseExpression(),this.semicolon(!1),e.update=this.match(11)?null:this.parseExpression(),this.expect(11),e.body=this.withSmartMixTopicForbiddingContext((()=>this.parseStatement())),this.scope.exit(),this.state.labels.pop(),this.finishNode(e,"ForStatement")}parseForIn(e,t,s){const i=this.match(58);return this.next(),i?null!==s&&this.unexpected(s):e.await=null!==s,"VariableDeclaration"!==t.type||null==t.declarations[0].init||i&&this.options.annexB&&!this.state.strict&&"var"===t.kind&&"Identifier"===t.declarations[0].id.type||this.raise(b.ForInOfLoopInitializer,t,{type:i?"ForInStatement":"ForOfStatement"}),"AssignmentPattern"===t.type&&this.raise(b.InvalidLhs,t,{ancestor:{type:"ForStatement"}}),e.left=t,e.right=i?this.parseExpression():this.parseMaybeAssignAllowIn(),this.expect(11),e.body=this.withSmartMixTopicForbiddingContext((()=>this.parseStatement())),this.scope.exit(),this.state.labels.pop(),this.finishNode(e,i?"ForInStatement":"ForOfStatement")}parseVar(e,t,s,i=!1){const n=e.declarations=[];for(e.kind=s;;){const e=this.startNode();if(this.parseVarId(e,s),e.init=this.eat(29)?t?this.parseMaybeAssignDisallowIn():this.parseMaybeAssignAllowIn():null,null!==e.init||i||("Identifier"===e.id.type||t&&(this.match(58)||this.isContextual(102))?"const"!==s&&"using"!==s&&"await using"!==s||this.match(58)||this.isContextual(102)||this.raise(b.DeclarationMissingInitializer,this.state.lastTokEndLoc,{kind:s}):this.raise(b.DeclarationMissingInitializer,this.state.lastTokEndLoc,{kind:"destructuring"})),n.push(this.finishNode(e,"VariableDeclarator")),!this.eat(12))break}return e}parseVarId(e,t){const s=this.parseBindingAtom();this.checkLVal(s,{in:{type:"VariableDeclarator"},binding:"var"===t?5:8201}),e.id=s}parseAsyncFunctionExpression(e){return this.parseFunction(e,8)}parseFunction(e,t=0){const s=2&t,i=!!(1&t),n=i&&!(4&t),r=!!(8&t);this.initFunction(e,r),this.match(55)&&(s&&this.raise(b.GeneratorInSingleStatementContext,this.state.startLoc),this.next(),e.generator=!0),i&&(e.id=this.parseFunctionId(n));const a=this.state.maybeInArrowParameters;return this.state.maybeInArrowParameters=!1,this.scope.enter(2),this.prodParam.enter(Qe(r,e.generator)),i||(e.id=this.parseFunctionId()),this.parseFunctionParams(e,!1),this.withSmartMixTopicForbiddingContext((()=>{this.parseFunctionBodyAndFinish(e,i?"FunctionDeclaration":"FunctionExpression")})),this.prodParam.exit(),this.scope.exit(),i&&!s&&this.registerFunctionStatementId(e),this.state.maybeInArrowParameters=a,e}parseFunctionId(e){return e||H(this.state.type)?this.parseIdentifier():null}parseFunctionParams(e,t){this.expect(10),this.expressionScope.enter(new Ge(3)),e.params=this.parseBindingList(11,41,2|(t?4:0)),this.expressionScope.exit()}registerFunctionStatementId(e){e.id&&this.scope.declareName(e.id.name,!this.options.annexB||this.state.strict||e.generator||e.async?this.scope.treatFunctionsAsVar?5:8201:17,e.id.loc.start)}parseClass(e,t,s){this.next();const i=this.state.strict;return this.state.strict=!0,this.parseClassId(e,t,s),this.parseClassSuper(e),e.body=this.parseClassBody(!!e.superClass,i),this.finishNode(e,t?"ClassDeclaration":"ClassExpression")}isClassProperty(){return this.match(29)||this.match(13)||this.match(8)}isClassMethod(){return this.match(10)}nameIsConstructor(e){return"Identifier"===e.type&&"constructor"===e.name||"StringLiteral"===e.type&&"constructor"===e.value}isNonstaticConstructor(e){return!e.computed&&!e.static&&this.nameIsConstructor(e.key)}parseClassBody(e,t){this.classScope.enter();const s={hadConstructor:!1,hadSuperClass:e};let i=[];const n=this.startNode();if(n.body=[],this.expect(5),this.withSmartMixTopicForbiddingContext((()=>{for(;!this.match(8);){if(this.eat(13)){if(i.length>0)throw this.raise(b.DecoratorSemicolon,this.state.lastTokEndLoc);continue}if(this.match(26)){i.push(this.parseDecorator());continue}const e=this.startNode();i.length&&(e.decorators=i,this.resetStartLocationFromNode(e,i[0]),i=[]),this.parseClassMember(n,e,s),"constructor"===e.kind&&e.decorators&&e.decorators.length>0&&this.raise(b.DecoratorConstructor,e)}})),this.state.strict=t,this.next(),i.length)throw this.raise(b.TrailingDecorator,this.state.startLoc);return this.classScope.exit(),this.finishNode(n,"ClassBody")}parseClassMemberFromModifier(e,t){const s=this.parseIdentifier(!0);if(this.isClassMethod()){const i=t;return i.kind="method",i.computed=!1,i.key=s,i.static=!1,this.pushClassMethod(e,i,!1,!1,!1,!1),!0}if(this.isClassProperty()){const i=t;return i.computed=!1,i.key=s,i.static=!1,e.body.push(this.parseClassProperty(i)),!0}return this.resetPreviousNodeTrailingComments(s),!1}parseClassMember(e,t,s){const i=this.isContextual(106);if(i){if(this.parseClassMemberFromModifier(e,t))return;if(this.eat(5))return void this.parseClassStaticBlock(e,t)}this.parseClassMemberWithIsStatic(e,t,s,i)}parseClassMemberWithIsStatic(e,t,s,i){const n=t,r=t,a=t,o=t,c=t,h=n,l=n;if(t.static=i,this.parsePropertyNamePrefixOperator(t),this.eat(55)){h.kind="method";const t=this.match(138);return this.parseClassElementName(h),t?void this.pushClassPrivateMethod(e,r,!0,!1):(this.isNonstaticConstructor(n)&&this.raise(b.ConstructorIsGenerator,n.key),void this.pushClassMethod(e,n,!0,!1,!1,!1))}const p=!this.state.containsEsc&&H(this.state.type),u=this.parseClassElementName(t),d=p?u.name:null,f=this.isPrivateName(u),m=this.state.startLoc;if(this.parsePostMemberNameModifiers(l),this.isClassMethod()){if(h.kind="method",f)return void this.pushClassPrivateMethod(e,r,!1,!1);const i=this.isNonstaticConstructor(n);let a=!1;i&&(n.kind="constructor",s.hadConstructor&&!this.hasPlugin("typescript")&&this.raise(b.DuplicateConstructor,u),i&&this.hasPlugin("typescript")&&t.override&&this.raise(b.OverrideOnConstructor,u),s.hadConstructor=!0,a=s.hadSuperClass),this.pushClassMethod(e,n,!1,!1,i,a)}else if(this.isClassProperty())f?this.pushClassPrivateProperty(e,o):this.pushClassProperty(e,a);else if("async"!==d||this.isLineTerminator())if("get"!==d&&"set"!==d||this.match(55)&&this.isLineTerminator())if("accessor"!==d||this.isLineTerminator())this.isLineTerminator()?f?this.pushClassPrivateProperty(e,o):this.pushClassProperty(e,a):this.unexpected();else{this.expectPlugin("decoratorAutoAccessors"),this.resetPreviousNodeTrailingComments(u);const t=this.match(138);this.parseClassElementName(a),this.pushClassAccessorProperty(e,c,t)}else{this.resetPreviousNodeTrailingComments(u),h.kind=d;const t=this.match(138);this.parseClassElementName(n),t?this.pushClassPrivateMethod(e,r,!1,!1):(this.isNonstaticConstructor(n)&&this.raise(b.ConstructorIsAccessor,n.key),this.pushClassMethod(e,n,!1,!1,!1,!1)),this.checkGetterSetterParams(n)}else{this.resetPreviousNodeTrailingComments(u);const t=this.eat(55);l.optional&&this.unexpected(m),h.kind="method";const s=this.match(138);this.parseClassElementName(h),this.parsePostMemberNameModifiers(l),s?this.pushClassPrivateMethod(e,r,t,!0):(this.isNonstaticConstructor(n)&&this.raise(b.ConstructorIsAsync,n.key),this.pushClassMethod(e,n,t,!0,!1,!1))}}parseClassElementName(e){const{type:t,value:s}=this.state;if(132!==t&&133!==t||!e.static||"prototype"!==s||this.raise(b.StaticPrototype,this.state.startLoc),138===t){"constructor"===s&&this.raise(b.ConstructorClassPrivateField,this.state.startLoc);const t=this.parsePrivateName();return e.key=t,t}return this.parsePropertyName(e),e.key}parseClassStaticBlock(e,t){var s;this.scope.enter(208);const i=this.state.labels;this.state.labels=[],this.prodParam.enter(0);const n=t.body=[];this.parseBlockOrModuleBlockBody(n,void 0,!1,8),this.prodParam.exit(),this.scope.exit(),this.state.labels=i,e.body.push(this.finishNode(t,"StaticBlock")),null!=(s=t.decorators)&&s.length&&this.raise(b.DecoratorStaticBlock,t)}pushClassProperty(e,t){!t.computed&&this.nameIsConstructor(t.key)&&this.raise(b.ConstructorClassField,t.key),e.body.push(this.parseClassProperty(t))}pushClassPrivateProperty(e,t){const s=this.parseClassPrivateProperty(t);e.body.push(s),this.classScope.declarePrivateName(this.getPrivateNameSV(s.key),0,s.key.loc.start)}pushClassAccessorProperty(e,t,s){s||t.computed||!this.nameIsConstructor(t.key)||this.raise(b.ConstructorClassField,t.key);const i=this.parseClassAccessorProperty(t);e.body.push(i),s&&this.classScope.declarePrivateName(this.getPrivateNameSV(i.key),0,i.key.loc.start)}pushClassMethod(e,t,s,i,n,r){e.body.push(this.parseMethod(t,s,i,n,r,"ClassMethod",!0))}pushClassPrivateMethod(e,t,s,i){const n=this.parseMethod(t,s,i,!1,!1,"ClassPrivateMethod",!0);e.body.push(n);const r="get"===n.kind?n.static?6:2:"set"===n.kind?n.static?5:1:0;this.declareClassPrivateMethodInScope(n,r)}declareClassPrivateMethodInScope(e,t){this.classScope.declarePrivateName(this.getPrivateNameSV(e.key),t,e.key.loc.start)}parsePostMemberNameModifiers(e){}parseClassPrivateProperty(e){return this.parseInitializer(e),this.semicolon(),this.finishNode(e,"ClassPrivateProperty")}parseClassProperty(e){return this.parseInitializer(e),this.semicolon(),this.finishNode(e,"ClassProperty")}parseClassAccessorProperty(e){return this.parseInitializer(e),this.semicolon(),this.finishNode(e,"ClassAccessorProperty")}parseInitializer(e){this.scope.enter(80),this.expressionScope.enter(Xe()),this.prodParam.enter(0),e.value=this.eat(29)?this.parseMaybeAssignAllowIn():null,this.expressionScope.exit(),this.prodParam.exit(),this.scope.exit()}parseClassId(e,t,s,i=8331){if(H(this.state.type))e.id=this.parseIdentifier(),t&&this.declareNameFromIdentifier(e.id,i);else{if(!s&&t)throw this.raise(b.MissingClassName,this.state.startLoc);e.id=null}}parseClassSuper(e){e.superClass=this.eat(81)?this.parseExprSubscripts():null}parseExport(e,t){const s=this.parseMaybeImportPhase(e,!0),i=this.maybeParseExportDefaultSpecifier(e,s),n=!i||this.eat(12),r=n&&this.eatExportStar(e),a=r&&this.maybeParseExportNamespaceSpecifier(e),o=n&&(!a||this.eat(12)),c=i||r;if(r&&!a){if(i&&this.unexpected(),t)throw this.raise(b.UnsupportedDecoratorExport,e);return this.parseExportFrom(e,!0),this.finishNode(e,"ExportAllDeclaration")}const h=this.maybeParseExportNamedSpecifiers(e);let l;if(i&&n&&!r&&!h&&this.unexpected(null,5),a&&o&&this.unexpected(null,98),c||h){if(l=!1,t)throw this.raise(b.UnsupportedDecoratorExport,e);this.parseExportFrom(e,c)}else l=this.maybeParseExportDeclaration(e);if(c||h||l){var p;const s=e;if(this.checkExport(s,!0,!1,!!s.source),"ClassDeclaration"===(null==(p=s.declaration)?void 0:p.type))this.maybeTakeDecorators(t,s.declaration,s);else if(t)throw this.raise(b.UnsupportedDecoratorExport,e);return this.finishNode(s,"ExportNamedDeclaration")}if(this.eat(65)){const s=e,i=this.parseExportDefaultExpression();if(s.declaration=i,"ClassDeclaration"===i.type)this.maybeTakeDecorators(t,i,s);else if(t)throw this.raise(b.UnsupportedDecoratorExport,e);return this.checkExport(s,!0,!0),this.finishNode(s,"ExportDefaultDeclaration")}this.unexpected(null,5)}eatExportStar(e){return this.eat(55)}maybeParseExportDefaultSpecifier(e,t){if(t||this.isExportDefaultSpecifier()){this.expectPlugin("exportDefaultFrom",null==t?void 0:t.loc.start);const s=t||this.parseIdentifier(!0),i=this.startNodeAtNode(s);return i.exported=s,e.specifiers=[this.finishNode(i,"ExportDefaultSpecifier")],!0}return!1}maybeParseExportNamespaceSpecifier(e){if(this.isContextual(93)){var t;null!=(t=e).specifiers||(t.specifiers=[]);const s=this.startNodeAt(this.state.lastTokStartLoc);return this.next(),s.exported=this.parseModuleExportName(),e.specifiers.push(this.finishNode(s,"ExportNamespaceSpecifier")),!0}return!1}maybeParseExportNamedSpecifiers(e){if(this.match(5)){const t=e;t.specifiers||(t.specifiers=[]);const s="type"===t.exportKind;return t.specifiers.push(...this.parseExportSpecifiers(s)),t.source=null,t.declaration=null,this.hasPlugin("importAssertions")&&(t.assertions=[]),!0}return!1}maybeParseExportDeclaration(e){return!!this.shouldParseExportDeclaration()&&(e.specifiers=[],e.source=null,this.hasPlugin("importAssertions")&&(e.assertions=[]),e.declaration=this.parseExportDeclaration(e),!0)}isAsyncFunction(){if(!this.isContextual(95))return!1;const e=this.nextTokenInLineStart();return this.isUnparsedContextual(e,"function")}parseExportDefaultExpression(){const e=this.startNode();if(this.match(68))return this.next(),this.parseFunction(e,5);if(this.isAsyncFunction())return this.next(),this.next(),this.parseFunction(e,13);if(this.match(80))return this.parseClass(e,!0,!0);if(this.match(26))return this.hasPlugin("decorators")&&!0===this.getPluginOption("decorators","decoratorsBeforeExport")&&this.raise(b.DecoratorBeforeExport,this.state.startLoc),this.parseClass(this.maybeTakeDecorators(this.parseDecorators(!1),this.startNode()),!0,!0);if(this.match(75)||this.match(74)||this.isLet())throw this.raise(b.UnsupportedDefaultExport,this.state.startLoc);const t=this.parseMaybeAssignAllowIn();return this.semicolon(),t}parseExportDeclaration(e){return this.match(80)?this.parseClass(this.startNode(),!0,!1):this.parseStatementListItem()}isExportDefaultSpecifier(){const{type:e}=this.state;if(H(e)){if(95===e&&!this.state.containsEsc||100===e)return!1;if((130===e||129===e)&&!this.state.containsEsc){const{type:e}=this.lookahead();if(H(e)&&98!==e||5===e)return this.expectOnePlugin(["flow","typescript"]),!1}}else if(!this.match(65))return!1;const t=this.nextTokenStart(),s=this.isUnparsedContextual(t,"from");if(44===this.input.charCodeAt(t)||H(this.state.type)&&s)return!0;if(this.match(65)&&s){const e=this.input.charCodeAt(this.nextTokenStartSince(t+4));return 34===e||39===e}return!1}parseExportFrom(e,t){this.eatContextual(98)?(e.source=this.parseImportSource(),this.checkExport(e),this.maybeParseImportAttributes(e),this.checkJSONModuleImport(e)):t&&this.unexpected(),this.semicolon()}shouldParseExportDeclaration(){const{type:e}=this.state;return 26===e&&(this.expectOnePlugin(["decorators","decorators-legacy"]),this.hasPlugin("decorators"))?(!0===this.getPluginOption("decorators","decoratorsBeforeExport")&&this.raise(b.DecoratorBeforeExport,this.state.startLoc),!0):this.isContextual(107)||this.isContextual(96)&&this.startsAwaitUsing()?(this.raise(b.UsingDeclarationExport,this.state.startLoc),!0):74===e||75===e||68===e||80===e||this.isLet()||this.isAsyncFunction()}checkExport(e,t,s,i){var n;if(t)if(s){if(this.checkDuplicateExports(e,"default"),this.hasPlugin("exportDefaultFrom")){var r;const t=e.declaration;"Identifier"!==t.type||"from"!==t.name||t.end-t.start!=4||null!=(r=t.extra)&&r.parenthesized||this.raise(b.ExportDefaultFromAsIdentifier,t)}}else if(null!=(n=e.specifiers)&&n.length)for(const t of e.specifiers){const{exported:e}=t,s="Identifier"===e.type?e.name:e.value;if(this.checkDuplicateExports(t,s),!i&&t.local){const{local:e}=t;"Identifier"!==e.type?this.raise(b.ExportBindingIsString,t,{localName:e.value,exportName:s}):(this.checkReservedWord(e.name,e.loc.start,!0,!1),this.scope.checkLocalExport(e))}}else if(e.declaration){const t=e.declaration;if("FunctionDeclaration"===t.type||"ClassDeclaration"===t.type){const{id:s}=t;if(!s)throw new Error("Assertion failure");this.checkDuplicateExports(e,s.name)}else if("VariableDeclaration"===t.type)for(const e of t.declarations)this.checkDeclaration(e.id)}}checkDeclaration(e){if("Identifier"===e.type)this.checkDuplicateExports(e,e.name);else if("ObjectPattern"===e.type)for(const t of e.properties)this.checkDeclaration(t);else if("ArrayPattern"===e.type)for(const t of e.elements)t&&this.checkDeclaration(t);else"ObjectProperty"===e.type?this.checkDeclaration(e.value):"RestElement"===e.type?this.checkDeclaration(e.argument):"AssignmentPattern"===e.type&&this.checkDeclaration(e.left)}checkDuplicateExports(e,t){this.exportedIdentifiers.has(t)&&("default"===t?this.raise(b.DuplicateDefaultExport,e):this.raise(b.DuplicateExport,e,{exportName:t})),this.exportedIdentifiers.add(t)}parseExportSpecifiers(e){const t=[];let s=!0;for(this.expect(5);!this.eat(8);){if(s)s=!1;else if(this.expect(12),this.eat(8))break;const i=this.isContextual(130),n=this.match(133),r=this.startNode();r.local=this.parseModuleExportName(),t.push(this.parseExportSpecifier(r,n,e,i))}return t}parseExportSpecifier(e,t,s,i){return this.eatContextual(93)?e.exported=this.parseModuleExportName():t?e.exported=function(e){const{type:t,start:s,end:i,loc:n,range:r,extra:a}=e;if("Placeholder"===t)return function(e){return nt(e)}(e);const o=Object.create(it);return o.type=t,o.start=s,o.end=i,o.loc=n,o.range=r,void 0!==e.raw?o.raw=e.raw:o.extra=a,o.value=e.value,o}(e.local):e.exported||(e.exported=nt(e.local)),this.finishNode(e,"ExportSpecifier")}parseModuleExportName(){if(this.match(133)){const e=this.parseStringLiteral(this.state.value),t=e.value.match(jt);return t&&this.raise(b.ModuleExportNameHasLoneSurrogate,e,{surrogateCharCode:t[0].charCodeAt(0)}),e}return this.parseIdentifier(!0)}isJSONModuleImport(e){return null!=e.assertions&&e.assertions.some((({key:e,value:t})=>"json"===t.value&&("Identifier"===e.type?"type"===e.name:"type"===e.value)))}checkImportReflection(e){const{specifiers:t}=e,s=1===t.length?t[0].type:null;if("source"===e.phase)"ImportDefaultSpecifier"!==s&&this.raise(b.SourcePhaseImportRequiresDefault,t[0].loc.start);else if("defer"===e.phase)"ImportNamespaceSpecifier"!==s&&this.raise(b.DeferImportRequiresNamespace,t[0].loc.start);else if(e.module){var i;"ImportDefaultSpecifier"!==s&&this.raise(b.ImportReflectionNotBinding,t[0].loc.start),(null==(i=e.assertions)?void 0:i.length)>0&&this.raise(b.ImportReflectionHasAssertion,t[0].loc.start)}}checkJSONModuleImport(e){if(this.isJSONModuleImport(e)&&"ExportAllDeclaration"!==e.type){const{specifiers:t}=e;if(null!=t){const e=t.find((e=>{let t;if("ExportSpecifier"===e.type?t=e.local:"ImportSpecifier"===e.type&&(t=e.imported),void 0!==t)return"Identifier"===t.type?"default"!==t.name:"default"!==t.value}));void 0!==e&&this.raise(b.ImportJSONBindingNotDefault,e.loc.start)}}}isPotentialImportPhase(e){return!e&&(this.isContextual(105)||this.isContextual(97)||this.isContextual(127))}applyImportPhase(e,t,s,i){t||("module"===s?(this.expectPlugin("importReflection",i),e.module=!0):this.hasPlugin("importReflection")&&(e.module=!1),"source"===s?(this.expectPlugin("sourcePhaseImports",i),e.phase="source"):"defer"===s?(this.expectPlugin("deferredImportEvaluation",i),e.phase="defer"):this.hasPlugin("sourcePhaseImports")&&(e.phase=null))}parseMaybeImportPhase(e,t){if(!this.isPotentialImportPhase(t))return this.applyImportPhase(e,t,null),null;const s=this.parseIdentifier(!0),{type:i}=this.state;return(V(i)?98!==i||102===this.lookaheadCharCode():12!==i)?(this.resetPreviousIdentifierLeadingComments(s),this.applyImportPhase(e,t,s.name,s.loc.start),null):(this.applyImportPhase(e,t,null),s)}isPrecedingIdImportPhase(e){const{type:t}=this.state;return H(t)?98!==t||102===this.lookaheadCharCode():12!==t}parseImport(e){return this.match(133)?this.parseImportSourceAndAttributes(e):this.parseImportSpecifiersAndAfter(e,this.parseMaybeImportPhase(e,!1))}parseImportSpecifiersAndAfter(e,t){e.specifiers=[];const s=!this.maybeParseDefaultImportSpecifier(e,t)||this.eat(12),i=s&&this.maybeParseStarImportSpecifier(e);return s&&!i&&this.parseNamedImportSpecifiers(e),this.expectContextual(98),this.parseImportSourceAndAttributes(e)}parseImportSourceAndAttributes(e){return null!=e.specifiers||(e.specifiers=[]),e.source=this.parseImportSource(),this.maybeParseImportAttributes(e),this.checkImportReflection(e),this.checkJSONModuleImport(e),this.semicolon(),this.finishNode(e,"ImportDeclaration")}parseImportSource(){return this.match(133)||this.unexpected(),this.parseExprAtom()}parseImportSpecifierLocal(e,t,s){t.local=this.parseIdentifier(),e.specifiers.push(this.finishImportSpecifier(t,s))}finishImportSpecifier(e,t,s=8201){return this.checkLVal(e.local,{in:{type:t},binding:s}),this.finishNode(e,t)}parseImportAttributes(){this.expect(5);const e=[],t=new Set;do{if(this.match(8))break;const s=this.startNode(),i=this.state.value;if(t.has(i)&&this.raise(b.ModuleAttributesWithDuplicateKeys,this.state.startLoc,{key:i}),t.add(i),this.match(133)?s.key=this.parseStringLiteral(i):s.key=this.parseIdentifier(!0),this.expect(14),!this.match(133))throw this.raise(b.ModuleAttributeInvalidValue,this.state.startLoc);s.value=this.parseStringLiteral(this.state.value),e.push(this.finishNode(s,"ImportAttribute"))}while(this.eat(12));return this.expect(8),e}parseModuleAttributes(){const e=[],t=new Set;do{const s=this.startNode();if(s.key=this.parseIdentifier(!0),"type"!==s.key.name&&this.raise(b.ModuleAttributeDifferentFromType,s.key),t.has(s.key.name)&&this.raise(b.ModuleAttributesWithDuplicateKeys,s.key,{key:s.key.name}),t.add(s.key.name),this.expect(14),!this.match(133))throw this.raise(b.ModuleAttributeInvalidValue,this.state.startLoc);s.value=this.parseStringLiteral(this.state.value),e.push(this.finishNode(s,"ImportAttribute"))}while(this.eat(12));return e}maybeParseImportAttributes(e){let t,s=!1;if(this.match(76)){if(this.hasPrecedingLineBreak()&&40===this.lookaheadCharCode())return;this.next(),this.hasPlugin("moduleAttributes")?t=this.parseModuleAttributes():(this.expectImportAttributesPlugin(),t=this.parseImportAttributes()),s=!0}else if(this.isContextual(94)&&!this.hasPrecedingLineBreak())this.hasPlugin("importAttributes")?(!0!==this.getPluginOption("importAttributes","deprecatedAssertSyntax")&&this.raise(b.ImportAttributesUseAssert,this.state.startLoc),this.addExtra(e,"deprecatedAssertSyntax",!0)):this.expectOnePlugin(["importAttributes","importAssertions"]),this.next(),t=this.parseImportAttributes();else if(this.hasPlugin("importAttributes")||this.hasPlugin("importAssertions"))t=[];else{if(!this.hasPlugin("moduleAttributes"))return;t=[]}!s&&this.hasPlugin("importAssertions")?e.assertions=t:e.attributes=t}maybeParseDefaultImportSpecifier(e,t){if(t){const s=this.startNodeAtNode(t);return s.local=t,e.specifiers.push(this.finishImportSpecifier(s,"ImportDefaultSpecifier")),!0}return!!V(this.state.type)&&(this.parseImportSpecifierLocal(e,this.startNode(),"ImportDefaultSpecifier"),!0)}maybeParseStarImportSpecifier(e){if(this.match(55)){const t=this.startNode();return this.next(),this.expectContextual(93),this.parseImportSpecifierLocal(e,t,"ImportNamespaceSpecifier"),!0}return!1}parseNamedImportSpecifiers(e){let t=!0;for(this.expect(5);!this.eat(8);){if(t)t=!1;else{if(this.eat(14))throw this.raise(b.DestructureNamedImport,this.state.startLoc);if(this.expect(12),this.eat(8))break}const s=this.startNode(),i=this.match(133),n=this.isContextual(130);s.imported=this.parseModuleExportName();const r=this.parseImportSpecifier(s,i,"type"===e.importKind||"typeof"===e.importKind,n,void 0);e.specifiers.push(r)}}parseImportSpecifier(e,t,s,i,n){if(this.eatContextual(93))e.local=this.parseIdentifier();else{const{imported:s}=e;if(t)throw this.raise(b.ImportBindingIsString,e,{importName:s.value});this.checkReservedWord(s.name,e.loc.start,!0,!0),e.local||(e.local=nt(s))}return this.finishImportSpecifier(e,"ImportSpecifier",n)}isThisParam(e){return"Identifier"===e.type&&"this"===e.name}}class qt extends zt{constructor(e,t){super(e=function(e){if(null==e)return Object.assign({},Mt);if(null!=e.annexB&&!1!==e.annexB)throw new Error("The `annexB` option can only be set to `false`.");const t={};for(const i of Object.keys(Mt)){var s;t[i]=null!=(s=e[i])?s:Mt[i]}return t}(e),t),this.options=e,this.initializeScopes(),this.plugins=function(e){const t=new Map;for(const s of e){const[e,i]=Array.isArray(s)?s:[s,{}];t.has(e)||t.set(e,i||{})}return t}(this.options.plugins),this.filename=e.sourceFilename}getScopeHandler(){return ge}parse(){this.enterInitialScopes();const e=this.startNode(),t=this.startNode();return this.nextToken(),e.errors=null,this.parseTopLevel(e,t),e.errors=this.state.errors,e.comments.length=this.state.commentsLen,e}}!function(e){const t={};for(const s of Object.keys(e))t[s]=Z(e[s])}(q);function Ht(e,t){let s=qt;return null!=e&&e.plugins&&(function(e){if(At(e,"decorators")){if(At(e,"decorators-legacy"))throw new Error("Cannot use the decorators and decorators-legacy plugin together");const t=St(e,"decorators","decoratorsBeforeExport");if(null!=t&&"boolean"!=typeof t)throw new Error("'decoratorsBeforeExport' must be a boolean, if specified.");const s=St(e,"decorators","allowCallParenthesized");if(null!=s&&"boolean"!=typeof s)throw new Error("'allowCallParenthesized' must be a boolean.")}if(At(e,"flow")&&At(e,"typescript"))throw new Error("Cannot combine flow and typescript plugins.");if(At(e,"placeholders")&&At(e,"v8intrinsic"))throw new Error("Cannot combine placeholders and v8intrinsic plugins.");if(At(e,"pipelineOperator")){const t=St(e,"pipelineOperator","proposal");if(!It.includes(t)){const e=It.map((e=>`"${e}"`)).join(", ");throw new Error(`"pipelineOperator" requires "proposal" option whose value must be one of: ${e}.`)}const s=At(e,["recordAndTuple",{syntaxType:"hash"}]);if("hack"===t){if(At(e,"placeholders"))throw new Error("Cannot combine placeholders plugin and Hack-style pipes.");if(At(e,"v8intrinsic"))throw new Error("Cannot combine v8intrinsic plugin and Hack-style pipes.");const t=St(e,"pipelineOperator","topicToken");if(!Nt.includes(t)){const e=Nt.map((e=>`"${e}"`)).join(", ");throw new Error(`"pipelineOperator" in "proposal": "hack" mode also requires a "topicToken" option whose value must be one of: ${e}.`)}if("#"===t&&s)throw new Error('Plugin conflict between `["pipelineOperator", { proposal: "hack", topicToken: "#" }]` and `["recordAndtuple", { syntaxType: "hash"}]`.')}else if("smart"===t&&s)throw new Error('Plugin conflict between `["pipelineOperator", { proposal: "smart" }]` and `["recordAndtuple", { syntaxType: "hash"}]`.')}if(At(e,"moduleAttributes")){if(At(e,"importAssertions")||At(e,"importAttributes"))throw new Error("Cannot combine importAssertions, importAttributes and moduleAttributes plugins.");if("may-2020"!==St(e,"moduleAttributes","version"))throw new Error("The 'moduleAttributes' plugin requires a 'version' option, representing the last proposal update. Currently, the only supported value is 'may-2020'.")}if(At(e,"importAssertions")&&At(e,"importAttributes"))throw new Error("Cannot combine importAssertions and importAttributes plugins.");if(At(e,"recordAndTuple")&&null!=St(e,"recordAndTuple","syntaxType")&&!Lt.includes(St(e,"recordAndTuple","syntaxType")))throw new Error("The 'syntaxType' option of the 'recordAndTuple' plugin must be one of: "+Lt.map((e=>`'${e}'`)).join(", "));if(At(e,"asyncDoExpressions")&&!At(e,"doExpressions")){const e=new Error("'asyncDoExpressions' requires 'doExpressions', please add 'doExpressions' to parser plugins.");throw e.missingPlugins="doExpressions",e}if(At(e,"optionalChainingAssign")&&"2023-07"!==St(e,"optionalChainingAssign","version"))throw new Error("The 'optionalChainingAssign' plugin requires a 'version' option, representing the last proposal update. Currently, the only supported value is '2023-07'.")}(e.plugins),s=function(e){const t=Ot.filter((t=>At(e,t))),s=t.join("/");let i=Vt[s];if(!i){i=qt;for(const e of t)i=Dt[e](i);Vt[s]=i}return i}(e.plugins)),new s(e,t)}const Vt={};t.qg=function(e,t){var s;if("unambiguous"!==(null==(s=t)?void 0:s.sourceType))return Ht(t,e).parse();t=Object.assign({},t);try{t.sourceType="module";const s=Ht(t,e),i=s.parse();if(s.sawUnambiguousESM)return i;if(s.ambiguousScriptDifferentAst)try{return t.sourceType="script",Ht(t,e).parse()}catch(e){}else i.program.sourceType="script";return i}catch(s){try{return t.sourceType="script",Ht(t,e).parse()}catch(e){}throw s}}}},t={};function s(i){var n=t[i];if(void 0!==n)return n.exports;var r=t[i]={exports:{}};return e[i](r,r.exports,s),r.exports}s.d=(e,t)=>{for(var i in t)s.o(t,i)&&!s.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={};s.r(e),s.d(e,{Decoder:()=>me,Encoder:()=>de,PacketType:()=>ue,protocol:()=>pe});var t={};s.r(t),s.d(t,{decode:()=>ef,encode:()=>Zd});const i=Object.create(null);i.open="0",i.close="1",i.ping="2",i.pong="3",i.message="4",i.upgrade="5",i.noop="6";const n=Object.create(null);Object.keys(i).forEach((e=>{n[i[e]]=e}));const r={type:"error",data:"parser error"},a="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),o="function"==typeof ArrayBuffer,c=e=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,h=({type:e,data:t},s,n)=>a&&t instanceof Blob?s?n(t):l(t,n):o&&(t instanceof ArrayBuffer||c(t))?s?n(t):l(new Blob([t]),n):n(i[e]+(t||"")),l=(e,t)=>{const s=new FileReader;return s.onload=function(){const e=s.result.split(",")[1];t("b"+(e||""))},s.readAsDataURL(e)};function p(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let u;const d="undefined"==typeof Uint8Array?[]:new Uint8Array(256);for(let e=0;e<64;e++)d["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(e)]=e;const f="function"==typeof ArrayBuffer,m=(e,t)=>{if("string"!=typeof e)return{type:"message",data:g(e,t)};const s=e.charAt(0);return"b"===s?{type:"message",data:y(e.substring(1),t)}:n[s]?e.length>1?{type:n[s],data:e.substring(1)}:{type:n[s]}:r},y=(e,t)=>{if(f){const s=(e=>{let t,s,i,n,r,a=.75*e.length,o=e.length,c=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);const h=new ArrayBuffer(a),l=new Uint8Array(h);for(t=0;t<o;t+=4)s=d[e.charCodeAt(t)],i=d[e.charCodeAt(t+1)],n=d[e.charCodeAt(t+2)],r=d[e.charCodeAt(t+3)],l[c++]=s<<2|i>>4,l[c++]=(15&i)<<4|n>>2,l[c++]=(3&n)<<6|63&r;return h})(e);return g(s,t)}return{base64:!0,data:e}},g=(e,t)=>"blob"===t?e instanceof Blob?e:new Blob([e]):e instanceof ArrayBuffer?e:e.buffer,b=String.fromCharCode(30);let w;function _(e){return e.reduce(((e,t)=>e+t.length),0)}function x(e,t){if(e[0].length===t)return e.shift();const s=new Uint8Array(t);let i=0;for(let n=0;n<t;n++)s[n]=e[0][i++],i===e[0].length&&(e.shift(),i=0);return e.length&&i<e[0].length&&(e[0]=e[0].slice(i)),s}function v(e){if(e)return function(e){for(var t in v.prototype)e[t]=v.prototype[t];return e}(e)}v.prototype.on=v.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},v.prototype.once=function(e,t){function s(){this.off(e,s),t.apply(this,arguments)}return s.fn=t,this.on(e,s),this},v.prototype.off=v.prototype.removeListener=v.prototype.removeAllListeners=v.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var s,i=this._callbacks["$"+e];if(!i)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var n=0;n<i.length;n++)if((s=i[n])===t||s.fn===t){i.splice(n,1);break}return 0===i.length&&delete this._callbacks["$"+e],this},v.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),s=this._callbacks["$"+e],i=1;i<arguments.length;i++)t[i-1]=arguments[i];if(s){i=0;for(var n=(s=s.slice(0)).length;i<n;++i)s[i].apply(this,t)}return this},v.prototype.emitReserved=v.prototype.emit,v.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},v.prototype.hasListeners=function(e){return!!this.listeners(e).length};const T="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")();function P(e,...t){return t.reduce(((t,s)=>(e.hasOwnProperty(s)&&(t[s]=e[s]),t)),{})}const k=T.setTimeout,C=T.clearTimeout;function E(e,t){t.useNativeTimers?(e.setTimeoutFn=k.bind(T),e.clearTimeoutFn=C.bind(T)):(e.setTimeoutFn=T.setTimeout.bind(T),e.clearTimeoutFn=T.clearTimeout.bind(T))}class A extends Error{constructor(e,t,s){super(e),this.description=t,this.context=s,this.type="TransportError"}}class S extends v{constructor(e){super(),this.writable=!1,E(this,e),this.opts=e,this.query=e.query,this.socket=e.socket}onError(e,t,s){return super.emitReserved("error",new A(e,t,s)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(e){"open"===this.readyState&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=m(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return-1===e.indexOf(":")?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(443!==this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}_query(e){const t=function(e){let t="";for(let s in e)e.hasOwnProperty(s)&&(t.length&&(t+="&"),t+=encodeURIComponent(s)+"="+encodeURIComponent(e[s]));return t}(e);return t.length?"?"+t:""}}const I="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),N=64,L={};let D,O=0,M=0;function R(e){let t="";do{t=I[e%N]+t,e=Math.floor(e/N)}while(e>0);return t}function F(){const e=R(+new Date);return e!==D?(O=0,D=e):e+"."+R(O++)}for(;M<N;M++)L[I[M]]=M;let B=!1;try{B="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(Up){}const j=B;function U(e){const t=e.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!t||j))return new XMLHttpRequest}catch(e){}if(!t)try{return new(T[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}function z(){}const q=null!=new U({xdomain:!1}).responseType;class H extends v{constructor(e,t){super(),E(this,t),this.opts=t,this.method=t.method||"GET",this.uri=e,this.data=void 0!==t.data?t.data:null,this.create()}create(){var e;const t=P(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd;const s=this.xhr=new U(t);try{s.open(this.method,this.uri,!0);try{if(this.opts.extraHeaders){s.setDisableHeaderCheck&&s.setDisableHeaderCheck(!0);for(let e in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(e)&&s.setRequestHeader(e,this.opts.extraHeaders[e])}}catch(e){}if("POST"===this.method)try{s.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{s.setRequestHeader("Accept","*/*")}catch(e){}null===(e=this.opts.cookieJar)||void 0===e||e.addCookies(s),"withCredentials"in s&&(s.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(s.timeout=this.opts.requestTimeout),s.onreadystatechange=()=>{var e;3===s.readyState&&(null===(e=this.opts.cookieJar)||void 0===e||e.parseCookies(s)),4===s.readyState&&(200===s.status||1223===s.status?this.onLoad():this.setTimeoutFn((()=>{this.onError("number"==typeof s.status?s.status:0)}),0))},s.send(this.data)}catch(e){return void this.setTimeoutFn((()=>{this.onError(e)}),0)}"undefined"!=typeof document&&(this.index=H.requestsCount++,H.requests[this.index]=this)}onError(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}cleanup(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=z,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete H.requests[this.index],this.xhr=null}}onLoad(){const e=this.xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}function V(){for(let e in H.requests)H.requests.hasOwnProperty(e)&&H.requests[e].abort()}H.requestsCount=0,H.requests={},"undefined"!=typeof document&&("function"==typeof attachEvent?attachEvent("onunload",V):"function"==typeof addEventListener&&addEventListener("onpagehide"in T?"pagehide":"unload",V,!1));const $="function"==typeof Promise&&"function"==typeof Promise.resolve?e=>Promise.resolve().then(e):(e,t)=>t(e,0),W=T.WebSocket||T.MozWebSocket,K="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),G={websocket:class extends S{constructor(e){super(e),this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const e=this.uri(),t=this.opts.protocols,s=K?{}:P(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(s.headers=this.opts.extraHeaders);try{this.ws=K?new W(e,t,s):t?new W(e,t):new W(e)}catch(e){return this.emitReserved("error",e)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const s=e[t],i=t===e.length-1;h(s,this.supportsBinary,(e=>{try{this.ws.send(e)}catch(e){}i&&$((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){void 0!==this.ws&&(this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=F()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}check(){return!!W}},webtransport:class extends S{get name(){return"webtransport"}doOpen(){"function"==typeof WebTransport&&(this.transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name]),this.transport.closed.then((()=>{this.onClose()})).catch((e=>{this.onError("webtransport error",e)})),this.transport.ready.then((()=>{this.transport.createBidirectionalStream().then((e=>{const t=function(e,t){w||(w=new TextDecoder);const s=[];let i=0,n=-1,a=!1;return new TransformStream({transform(o,c){for(s.push(o);;){if(0===i){if(_(s)<1)break;const e=x(s,1);a=128==(128&e[0]),n=127&e[0],i=n<126?3:126===n?1:2}else if(1===i){if(_(s)<2)break;const e=x(s,2);n=new DataView(e.buffer,e.byteOffset,e.length).getUint16(0),i=3}else if(2===i){if(_(s)<8)break;const e=x(s,8),t=new DataView(e.buffer,e.byteOffset,e.length),a=t.getUint32(0);if(a>Math.pow(2,21)-1){c.enqueue(r);break}n=a*Math.pow(2,32)+t.getUint32(4),i=3}else{if(_(s)<n)break;const e=x(s,n);c.enqueue(m(a?e:w.decode(e),t)),i=0}if(0===n||n>e){c.enqueue(r);break}}}})}(Number.MAX_SAFE_INTEGER,this.socket.binaryType),s=e.readable.pipeThrough(t).getReader(),i=new TransformStream({transform(e,t){!function(e,t){a&&e.data instanceof Blob?e.data.arrayBuffer().then(p).then(t):o&&(e.data instanceof ArrayBuffer||c(e.data))?t(p(e.data)):h(e,!1,(e=>{u||(u=new TextEncoder),t(u.encode(e))}))}(e,(s=>{const i=s.length;let n;if(i<126)n=new Uint8Array(1),new DataView(n.buffer).setUint8(0,i);else if(i<65536){n=new Uint8Array(3);const e=new DataView(n.buffer);e.setUint8(0,126),e.setUint16(1,i)}else{n=new Uint8Array(9);const e=new DataView(n.buffer);e.setUint8(0,127),e.setBigUint64(1,BigInt(i))}e.data&&"string"!=typeof e.data&&(n[0]|=128),t.enqueue(n),t.enqueue(s)}))}});i.readable.pipeTo(e.writable),this.writer=i.writable.getWriter();const n=()=>{s.read().then((({done:e,value:t})=>{e||(this.onPacket(t),n())})).catch((e=>{}))};n();const l={type:"open"};this.query.sid&&(l.data=`{"sid":"${this.query.sid}"}`),this.writer.write(l).then((()=>this.onOpen()))}))})))}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const s=e[t],i=t===e.length-1;this.writer.write(s).then((()=>{i&&$((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){var e;null===(e=this.transport)||void 0===e||e.close()}},polling:class extends S{constructor(e){if(super(e),this.polling=!1,"undefined"!=typeof location){const t="https:"===location.protocol;let s=location.port;s||(s=t?"443":"80"),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||s!==e.port}const t=e&&e.forceBase64;this.supportsBinary=q&&!t,this.opts.withCredentials&&(this.cookieJar=void 0)}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this.polling||!this.writable){let e=0;this.polling&&(e++,this.once("pollComplete",(function(){--e||t()}))),this.writable||(e++,this.once("drain",(function(){--e||t()})))}else t()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){((e,t)=>{const s=e.split(b),i=[];for(let e=0;e<s.length;e++){const n=m(s[e],t);if(i.push(n),"error"===n.type)break}return i})(e,this.socket.binaryType).forEach((e=>{if("opening"===this.readyState&&"open"===e.type&&this.onOpen(),"close"===e.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(e)})),"closed"!==this.readyState&&(this.polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this.poll())}doClose(){const e=()=>{this.write([{type:"close"}])};"open"===this.readyState?e():this.once("open",e)}write(e){this.writable=!1,((e,t)=>{const s=e.length,i=new Array(s);let n=0;e.forEach(((e,r)=>{h(e,!1,(e=>{i[r]=e,++n===s&&t(i.join(b))}))}))})(e,(e=>{this.doWrite(e,(()=>{this.writable=!0,this.emitReserved("drain")}))}))}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=F()),this.supportsBinary||t.sid||(t.b64=1),this.createUri(e,t)}request(e={}){return Object.assign(e,{xd:this.xd,cookieJar:this.cookieJar},this.opts),new H(this.uri(),e)}doWrite(e,t){const s=this.request({method:"POST",data:e});s.on("success",t),s.on("error",((e,t)=>{this.onError("xhr post error",e,t)}))}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",((e,t)=>{this.onError("xhr poll error",e,t)})),this.pollXhr=e}}},Y=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,J=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function X(e){if(e.length>2e3)throw"URI too long";const t=e,s=e.indexOf("["),i=e.indexOf("]");-1!=s&&-1!=i&&(e=e.substring(0,s)+e.substring(s,i).replace(/:/g,";")+e.substring(i,e.length));let n=Y.exec(e||""),r={},a=14;for(;a--;)r[J[a]]=n[a]||"";return-1!=s&&-1!=i&&(r.source=t,r.host=r.host.substring(1,r.host.length-1).replace(/;/g,":"),r.authority=r.authority.replace("[","").replace("]","").replace(/;/g,":"),r.ipv6uri=!0),r.pathNames=function(e,t){const s=t.replace(/\/{2,9}/g,"/").split("/");return"/"!=t.slice(0,1)&&0!==t.length||s.splice(0,1),"/"==t.slice(-1)&&s.splice(s.length-1,1),s}(0,r.path),r.queryKey=function(e,t){const s={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(e,t,i){t&&(s[t]=i)})),s}(0,r.query),r}class Z extends v{constructor(e,t={}){super(),this.binaryType="arraybuffer",this.writeBuffer=[],e&&"object"==typeof e&&(t=e,e=null),e?(e=X(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=X(t.host).host),E(this,t),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=t.transports||["polling","websocket","webtransport"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"==typeof this.opts.query&&(this.opts.query=function(e){let t={},s=e.split("&");for(let e=0,i=s.length;e<i;e++){let i=s[e].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"==typeof addEventListener&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=4,t.transport=e,this.id&&(t.sid=this.id);const s=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new G[e](s)}open(){let e;if(this.opts.rememberUpgrade&&Z.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn((()=>{this.emitReserved("error","No transports available")}),0);e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",(e=>this.onClose("transport close",e)))}probe(e){let t=this.createTransport(e),s=!1;Z.priorWebsocketSuccess=!1;const i=()=>{s||(t.send([{type:"ping",data:"probe"}]),t.once("packet",(e=>{if(!s)if("pong"===e.type&&"probe"===e.data){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;Z.priorWebsocketSuccess="websocket"===t.name,this.transport.pause((()=>{s||"closed"!==this.readyState&&(h(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())}))}else{const e=new Error("probe error");e.transport=t.name,this.emitReserved("upgradeError",e)}})))};function n(){s||(s=!0,h(),t.close(),t=null)}const r=e=>{const s=new Error("probe error: "+e);s.transport=t.name,n(),this.emitReserved("upgradeError",s)};function a(){r("transport closed")}function o(){r("socket closed")}function c(e){t&&e.name!==t.name&&n()}const h=()=>{t.removeListener("open",i),t.removeListener("error",r),t.removeListener("close",a),this.off("close",o),this.off("upgrading",c)};t.once("open",i),t.once("error",r),t.once("close",a),this.once("close",o),this.once("upgrading",c),-1!==this.upgrades.indexOf("webtransport")&&"webtransport"!==e?this.setTimeoutFn((()=>{s||t.open()}),200):t.open()}onOpen(){if(this.readyState="open",Z.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade){let e=0;const t=this.upgrades.length;for(;e<t;e++)this.probe(this.upgrades[e])}}onPacket(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),this.resetPingTimeout(),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn((()=>{this.onClose("ping timeout")}),this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this.getWritablePackets();this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let s=0;s<this.writeBuffer.length;s++){const i=this.writeBuffer[s].data;if(i&&(e+="string"==typeof(t=i)?function(e){let t=0,s=0;for(let i=0,n=e.length;i<n;i++)t=e.charCodeAt(i),t<128?s+=1:t<2048?s+=2:t<55296||t>=57344?s+=3:(i++,s+=4);return s}(t):Math.ceil(1.33*(t.byteLength||t.size))),s>0&&e>this.maxPayload)return this.writeBuffer.slice(0,s);e+=2}var t;return this.writeBuffer}write(e,t,s){return this.sendPacket("message",e,t,s),this}send(e,t,s){return this.sendPacket("message",e,t,s),this}sendPacket(e,t,s,i){if("function"==typeof t&&(i=t,t=void 0),"function"==typeof s&&(i=s,s=null),"closing"===this.readyState||"closed"===this.readyState)return;(s=s||{}).compress=!1!==s.compress;const n={type:e,data:t,options:s};this.emitReserved("packetCreate",n),this.writeBuffer.push(n),i&&this.once("flush",i),this.flush()}close(){const e=()=>{this.onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},s=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(()=>{this.upgrading?s():e()})):this.upgrading?s():e()),this}onError(e){Z.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}onClose(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){const t=[];let s=0;const i=e.length;for(;s<i;s++)~this.transports.indexOf(e[s])&&t.push(e[s]);return t}}Z.protocol=4,Z.protocol;const Q="function"==typeof ArrayBuffer,ee=e=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,te=Object.prototype.toString,se="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===te.call(Blob),ie="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===te.call(File);function ne(e){return Q&&(e instanceof ArrayBuffer||ee(e))||se&&e instanceof Blob||ie&&e instanceof File}function re(e,t){if(!e||"object"!=typeof e)return!1;if(Array.isArray(e)){for(let t=0,s=e.length;t<s;t++)if(re(e[t]))return!0;return!1}if(ne(e))return!0;if(e.toJSON&&"function"==typeof e.toJSON&&1===arguments.length)return re(e.toJSON(),!0);for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&re(e[t]))return!0;return!1}function ae(e){const t=[],s=e.data,i=e;return i.data=oe(s,t),i.attachments=t.length,{packet:i,buffers:t}}function oe(e,t){if(!e)return e;if(ne(e)){const s={_placeholder:!0,num:t.length};return t.push(e),s}if(Array.isArray(e)){const s=new Array(e.length);for(let i=0;i<e.length;i++)s[i]=oe(e[i],t);return s}if("object"==typeof e&&!(e instanceof Date)){const s={};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(s[i]=oe(e[i],t));return s}return e}function ce(e,t){return e.data=he(e.data,t),delete e.attachments,e}function he(e,t){if(!e)return e;if(e&&!0===e._placeholder){if("number"==typeof e.num&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}if(Array.isArray(e))for(let s=0;s<e.length;s++)e[s]=he(e[s],t);else if("object"==typeof e)for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&(e[s]=he(e[s],t));return e}const le=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],pe=5;var ue;!function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"}(ue||(ue={}));class de{constructor(e){this.replacer=e}encode(e){return e.type!==ue.EVENT&&e.type!==ue.ACK||!re(e)?[this.encodeAsString(e)]:this.encodeAsBinary({type:e.type===ue.EVENT?ue.BINARY_EVENT:ue.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id})}encodeAsString(e){let t=""+e.type;return e.type!==ue.BINARY_EVENT&&e.type!==ue.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=ae(e),s=this.encodeAsString(t.packet),i=t.buffers;return i.unshift(s),i}}function fe(e){return"[object Object]"===Object.prototype.toString.call(e)}class me extends v{constructor(e){super(),this.reviver=e}add(e){let t;if("string"==typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const s=t.type===ue.BINARY_EVENT;s||t.type===ue.BINARY_ACK?(t.type=s?ue.EVENT:ue.ACK,this.reconstructor=new ye(t),0===t.attachments&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else{if(!ne(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t))}}decodeString(e){let t=0;const s={type:Number(e.charAt(0))};if(void 0===ue[s.type])throw new Error("unknown packet type "+s.type);if(s.type===ue.BINARY_EVENT||s.type===ue.BINARY_ACK){const i=t+1;for(;"-"!==e.charAt(++t)&&t!=e.length;);const n=e.substring(i,t);if(n!=Number(n)||"-"!==e.charAt(t))throw new Error("Illegal attachments");s.attachments=Number(n)}if("/"===e.charAt(t+1)){const i=t+1;for(;++t&&","!==e.charAt(t)&&t!==e.length;);s.nsp=e.substring(i,t)}else s.nsp="/";const i=e.charAt(t+1);if(""!==i&&Number(i)==i){const i=t+1;for(;++t;){const s=e.charAt(t);if(null==s||Number(s)!=s){--t;break}if(t===e.length)break}s.id=Number(e.substring(i,t+1))}if(e.charAt(++t)){const i=this.tryParse(e.substr(t));if(!me.isPayloadValid(s.type,i))throw new Error("invalid payload");s.data=i}return s}tryParse(e){try{return JSON.parse(e,this.reviver)}catch(e){return!1}}static isPayloadValid(e,t){switch(e){case ue.CONNECT:return fe(t);case ue.DISCONNECT:return void 0===t;case ue.CONNECT_ERROR:return"string"==typeof t||fe(t);case ue.EVENT:case ue.BINARY_EVENT:return Array.isArray(t)&&("number"==typeof t[0]||"string"==typeof t[0]&&-1===le.indexOf(t[0]));case ue.ACK:case ue.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class ye{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const e=ce(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function ge(e,t,s){return e.on(t,s),function(){e.off(t,s)}}const be=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class we extends v{constructor(e,t,s){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,s&&s.auth&&(this.auth=s.auth),this._opts=Object.assign({},s),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[ge(e,"open",this.onopen.bind(this)),ge(e,"packet",this.onpacket.bind(this)),ge(e,"error",this.onerror.bind(this)),ge(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){if(be.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const s={type:ue.EVENT,data:t,options:{}};if(s.options.compress=!1!==this.flags.compress,"function"==typeof t[t.length-1]){const e=this.ids++,i=t.pop();this._registerAckCallback(e,i),s.id=e}const i=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!i||!this.connected)||(this.connected?(this.notifyOutgoingListeners(s),this.packet(s)):this.sendBuffer.push(s)),this.flags={},this}_registerAckCallback(e,t){var s;const i=null!==(s=this.flags.timeout)&&void 0!==s?s:this._opts.ackTimeout;if(void 0===i)return void(this.acks[e]=t);const n=this.io.setTimeoutFn((()=>{delete this.acks[e];for(let t=0;t<this.sendBuffer.length;t++)this.sendBuffer[t].id===e&&this.sendBuffer.splice(t,1);t.call(this,new Error("operation has timed out"))}),i),r=(...e)=>{this.io.clearTimeoutFn(n),t.apply(this,e)};r.withError=!0,this.acks[e]=r}emitWithAck(e,...t){return new Promise(((s,i)=>{const n=(e,t)=>e?i(e):s(t);n.withError=!0,t.push(n),this.emit(e,...t)}))}_addToQueue(e){let t;"function"==typeof e[e.length-1]&&(t=e.pop());const s={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push(((e,...i)=>{if(s===this._queue[0])return null!==e?s.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(e)):(this._queue.shift(),t&&t(null,...i)),s.pending=!1,this._drainQueue()})),this._queue.push(s),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||0===this._queue.length)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){"function"==typeof this.auth?this.auth((e=>{this._sendConnectPacket(e)})):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:ue.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach((e=>{if(!this.sendBuffer.some((t=>String(t.id)===e))){const t=this.acks[e];delete this.acks[e],t.withError&&t.call(this,new Error("socket has been disconnected"))}}))}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case ue.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case ue.EVENT:case ue.BINARY_EVENT:this.onevent(e);break;case ue.ACK:case ue.BINARY_ACK:this.onack(e);break;case ue.DISCONNECT:this.ondisconnect();break;case ue.CONNECT_ERROR:this.destroy();const t=new Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t)}}onevent(e){const t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const s of t)s.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&"string"==typeof e[e.length-1]&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let s=!1;return function(...i){s||(s=!0,t.packet({type:ue.ACK,id:e,data:i}))}}onack(e){const t=this.acks[e.id];"function"==typeof t&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach((e=>this.emitEvent(e))),this.receiveBuffer=[],this.sendBuffer.forEach((e=>{this.notifyOutgoingListeners(e),this.packet(e)})),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach((e=>e())),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:ue.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let s=0;s<t.length;s++)if(e===t[s])return t.splice(s,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let s=0;s<t.length;s++)if(e===t[s])return t.splice(s,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const s of t)s.apply(this,e.data)}}}function _e(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}_e.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),s=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-s:e+s}return 0|Math.min(e,this.max)},_e.prototype.reset=function(){this.attempts=0},_e.prototype.setMin=function(e){this.ms=e},_e.prototype.setMax=function(e){this.max=e},_e.prototype.setJitter=function(e){this.jitter=e};class xe extends v{constructor(t,s){var i;super(),this.nsps={},this.subs=[],t&&"object"==typeof t&&(s=t,t=void 0),(s=s||{}).path=s.path||"/socket.io",this.opts=s,E(this,s),this.reconnection(!1!==s.reconnection),this.reconnectionAttempts(s.reconnectionAttempts||1/0),this.reconnectionDelay(s.reconnectionDelay||1e3),this.reconnectionDelayMax(s.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(i=s.randomizationFactor)&&void 0!==i?i:.5),this.backoff=new _e({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==s.timeout?2e4:s.timeout),this._readyState="closed",this.uri=t;const n=s.parser||e;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this._autoConnect=!1!==s.autoConnect,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}randomizationFactor(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new Z(this.uri,this.opts);const t=this.engine,s=this;this._readyState="opening",this.skipReconnect=!1;const i=ge(t,"open",(function(){s.onopen(),e&&e()})),n=t=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",t),e?e(t):this.maybeReconnectOnOpen()},r=ge(t,"error",n);if(!1!==this._timeout){const e=this._timeout,s=this.setTimeoutFn((()=>{i(),n(new Error("timeout")),t.close()}),e);this.opts.autoUnref&&s.unref(),this.subs.push((()=>{this.clearTimeoutFn(s)}))}return this.subs.push(i),this.subs.push(r),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(ge(e,"ping",this.onping.bind(this)),ge(e,"data",this.ondata.bind(this)),ge(e,"error",this.onerror.bind(this)),ge(e,"close",this.onclose.bind(this)),ge(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(e){this.onclose("parse error",e)}}ondecoded(e){$((()=>{this.emitReserved("packet",e)}),this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let s=this.nsps[e];return s?this._autoConnect&&!s.active&&s.connect():(s=new we(this,e,t),this.nsps[e]=s),s}_destroy(e){const t=Object.keys(this.nsps);for(const e of t)if(this.nsps[e].active)return;this._close()}_packet(e){const t=this.encoder.encode(e);for(let s=0;s<t.length;s++)this.engine.write(t[s],e.options)}cleanup(){this.subs.forEach((e=>e())),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e,t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const s=this.setTimeoutFn((()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open((t=>{t?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",t)):e.onreconnect()})))}),t);this.opts.autoUnref&&s.unref(),this.subs.push((()=>{this.clearTimeoutFn(s)}))}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const ve={};function Te(e,t){"object"==typeof e&&(t=e,e=void 0);const s=function(e,t="",s){let i=e;s=s||"undefined"!=typeof location&&location,null==e&&(e=s.protocol+"//"+s.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?s.protocol+e:s.host+e),/^(https?|wss?):\/\//.test(e)||(e=void 0!==s?s.protocol+"//"+e:"https://"+e),i=X(e)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";const n=-1!==i.host.indexOf(":")?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+n+":"+i.port+t,i.href=i.protocol+"://"+n+(s&&s.port===i.port?"":":"+i.port),i}(e,(t=t||{}).path||"/socket.io"),i=s.source,n=s.id,r=s.path,a=ve[n]&&r in ve[n].nsps;let o;return t.forceNew||t["force new connection"]||!1===t.multiplex||a?o=new xe(i,t):(ve[n]||(ve[n]=new xe(i,t)),o=ve[n]),s.query&&!t.query&&(t.query=s.queryKey),o.socket(s.path,t)}Object.assign(Te,{Manager:xe,Socket:we,io:Te,connect:Te});const Pe=function(e,t){if(!e)throw ke(t)},ke=function(e){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+e)},Ce=function(e){const t=[];let s=0;for(let i=0;i<e.length;i++){let n=e.charCodeAt(i);n<128?t[s++]=n:n<2048?(t[s++]=n>>6|192,t[s++]=63&n|128):55296==(64512&n)&&i+1<e.length&&56320==(64512&e.charCodeAt(i+1))?(n=65536+((1023&n)<<10)+(1023&e.charCodeAt(++i)),t[s++]=n>>18|240,t[s++]=n>>12&63|128,t[s++]=n>>6&63|128,t[s++]=63&n|128):(t[s++]=n>>12|224,t[s++]=n>>6&63|128,t[s++]=63&n|128)}return t},Ee={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const s=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let t=0;t<e.length;t+=3){const n=e[t],r=t+1<e.length,a=r?e[t+1]:0,o=t+2<e.length,c=o?e[t+2]:0,h=n>>2,l=(3&n)<<4|a>>4;let p=(15&a)<<2|c>>6,u=63&c;o||(u=64,r||(p=64)),i.push(s[h],s[l],s[p],s[u])}return i.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Ce(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let s=0,i=0;for(;s<e.length;){const n=e[s++];if(n<128)t[i++]=String.fromCharCode(n);else if(n>191&&n<224){const r=e[s++];t[i++]=String.fromCharCode((31&n)<<6|63&r)}else if(n>239&&n<365){const r=((7&n)<<18|(63&e[s++])<<12|(63&e[s++])<<6|63&e[s++])-65536;t[i++]=String.fromCharCode(55296+(r>>10)),t[i++]=String.fromCharCode(56320+(1023&r))}else{const r=e[s++],a=e[s++];t[i++]=String.fromCharCode((15&n)<<12|(63&r)<<6|63&a)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const s=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let t=0;t<e.length;){const n=s[e.charAt(t++)],r=t<e.length?s[e.charAt(t)]:0;++t;const a=t<e.length?s[e.charAt(t)]:64;++t;const o=t<e.length?s[e.charAt(t)]:64;if(++t,null==n||null==r||null==a||null==o)throw new Ae;const c=n<<2|r>>4;if(i.push(c),64!==a){const e=r<<4&240|a>>2;if(i.push(e),64!==o){const e=a<<6&192|o;i.push(e)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class Ae extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Se=function(e){const t=Ce(e);return Ee.encodeByteArray(t,!0)},Ie=function(e){return Se(e).replace(/\./g,"")},Ne=function(e){try{return Ee.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Le(e){return De(void 0,e)}function De(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(const s in t)t.hasOwnProperty(s)&&"__proto__"!==s&&(e[s]=De(e[s],t[s]));return e}const Oe=()=>{try{return function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==s.g)return s.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const e=process.env.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"==typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}const t=e&&Ne(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},Me=()=>{var e;return null===(e=Oe())||void 0===e?void 0:e.config};class Re{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,s)=>{t?this.reject(t):this.resolve(s),"function"==typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,s))}}}function Fe(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test("undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:"")}function Be(){try{return"object"==typeof indexedDB}catch(e){return!1}}function je(){return new Promise(((e,t)=>{try{let s=!0;const i="validate-browser-context-for-indexeddb-analytics-module",n=self.indexedDB.open(i);n.onsuccess=()=>{n.result.close(),s||self.indexedDB.deleteDatabase(i),e(!0)},n.onupgradeneeded=()=>{s=!1},n.onerror=()=>{var e;t((null===(e=n.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}}))}class Ue extends Error{constructor(e,t,s){super(t),this.code=e,this.customData=s,this.name="FirebaseError",Object.setPrototypeOf(this,Ue.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ze.prototype.create)}}class ze{constructor(e,t,s){this.service=e,this.serviceName=t,this.errors=s}create(e,...t){const s=t[0]||{},i=`${this.service}/${e}`,n=this.errors[e],r=n?function(e,t){return e.replace(qe,((e,s)=>{const i=t[s];return null!=i?String(i):`<${s}?>`}))}(n,s):"Error",a=`${this.serviceName}: ${r} (${i}).`;return new Ue(i,a,s)}}const qe=/\{\$([^}]+)}/g;function He(e){return JSON.parse(e)}function Ve(e){return JSON.stringify(e)}const $e=function(e){let t={},s={},i={},n="";try{const r=e.split(".");t=He(Ne(r[0])||""),s=He(Ne(r[1])||""),n=r[2],i=s.d||{},delete s.d}catch(e){}return{header:t,claims:s,data:i,signature:n}};function We(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Ke(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function Ge(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function Ye(e,t,s){const i={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=t.call(s,e[n],n,e));return i}function Je(e,t){if(e===t)return!0;const s=Object.keys(e),i=Object.keys(t);for(const n of s){if(!i.includes(n))return!1;const s=e[n],r=t[n];if(Xe(s)&&Xe(r)){if(!Je(s,r))return!1}else if(s!==r)return!1}for(const e of i)if(!s.includes(e))return!1;return!0}function Xe(e){return null!==e&&"object"==typeof e}class Ze{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const s=this.W_;if("string"==typeof e)for(let i=0;i<16;i++)s[i]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let i=0;i<16;i++)s[i]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let e=16;e<80;e++){const t=s[e-3]^s[e-8]^s[e-14]^s[e-16];s[e]=4294967295&(t<<1|t>>>31)}let i,n,r=this.chain_[0],a=this.chain_[1],o=this.chain_[2],c=this.chain_[3],h=this.chain_[4];for(let e=0;e<80;e++){e<40?e<20?(i=c^a&(o^c),n=1518500249):(i=a^o^c,n=1859775393):e<60?(i=a&o|c&(a|o),n=2400959708):(i=a^o^c,n=3395469782);const t=(r<<5|r>>>27)+i+h+n+s[e]&4294967295;h=c,c=o,o=4294967295&(a<<30|a>>>2),a=r,r=t}this.chain_[0]=this.chain_[0]+r&4294967295,this.chain_[1]=this.chain_[1]+a&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295}update(e,t){if(null==e)return;void 0===t&&(t=e.length);const s=t-this.blockSize;let i=0;const n=this.buf_;let r=this.inbuf_;for(;i<t;){if(0===r)for(;i<=s;)this.compress_(e,i),i+=this.blockSize;if("string"==typeof e){for(;i<t;)if(n[r]=e.charCodeAt(i),++r,++i,r===this.blockSize){this.compress_(n),r=0;break}}else for(;i<t;)if(n[r]=e[i],++r,++i,r===this.blockSize){this.compress_(n),r=0;break}}this.inbuf_=r,this.total_+=t}digest(){const e=[];let t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let e=this.blockSize-1;e>=56;e--)this.buf_[e]=255&t,t/=256;this.compress_(this.buf_);let s=0;for(let t=0;t<5;t++)for(let i=24;i>=0;i-=8)e[s]=this.chain_[t]>>i&255,++s;return e}}function Qe(e,t){return`${e} failed: ${t} argument `}const et=function(e){let t=0;for(let s=0;s<e.length;s++){const i=e.charCodeAt(s);i<128?t++:i<2048?t+=2:i>=55296&&i<=56319?(t+=4,s++):t+=3}return t},tt=1e3,st=2,it=144e5,nt=.5;function rt(e,t=tt,s=st){const i=t*Math.pow(s,e),n=Math.round(nt*i*(Math.random()-.5)*2);return Math.min(it,i+n)}function at(e){return e&&e._delegate?e._delegate:e}class ot{constructor(e,t,s){this.name=e,this.instanceFactory=t,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const ct="[DEFAULT]";class ht{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new Re;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&e.resolve(s)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const s=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),i=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(s)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:s})}catch(e){if(i)return null;throw e}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:ct})}catch(e){}for(const[e,t]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:s});t.resolve(e)}catch(e){}}}}clearInstance(e=ct){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(e=ct){return this.instances.has(e)}getOptions(e=ct){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:s,options:t});for(const[e,t]of this.instancesDeferred.entries())s===this.normalizeInstanceIdentifier(e)&&t.resolve(i);return i}onInit(e,t){var s;const i=this.normalizeInstanceIdentifier(t),n=null!==(s=this.onInitCallbacks.get(i))&&void 0!==s?s:new Set;n.add(e),this.onInitCallbacks.set(i,n);const r=this.instances.get(i);return r&&e(r,i),()=>{n.delete(e)}}invokeOnInitCallbacks(e,t){const s=this.onInitCallbacks.get(t);if(s)for(const i of s)try{i(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:(i=e,i===ct?void 0:i),options:t}),this.instances.set(e,s),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch(e){}var i;return s||null}normalizeInstanceIdentifier(e=ct){return this.component?this.component.multipleInstances?e:ct:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class lt{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new ht(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const pt=[];var ut;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(ut||(ut={}));const dt={debug:ut.DEBUG,verbose:ut.VERBOSE,info:ut.INFO,warn:ut.WARN,error:ut.ERROR,silent:ut.SILENT},ft=ut.INFO,mt={[ut.DEBUG]:"log",[ut.VERBOSE]:"log",[ut.INFO]:"info",[ut.WARN]:"warn",[ut.ERROR]:"error"},yt=(e,t,...s)=>{if(t<e.logLevel)return;const i=(new Date).toISOString(),n=mt[t];if(!n)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[n](`[${i}]  ${e.name}:`,...s)};class gt{constructor(e){this.name=e,this._logLevel=ft,this._logHandler=yt,this._userLogHandler=null,pt.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ut))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?dt[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ut.DEBUG,...e),this._logHandler(this,ut.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ut.VERBOSE,...e),this._logHandler(this,ut.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ut.INFO,...e),this._logHandler(this,ut.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ut.WARN,...e),this._logHandler(this,ut.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ut.ERROR,...e),this._logHandler(this,ut.ERROR,...e)}}const bt=(e,t)=>t.some((t=>e instanceof t));let wt,_t;const xt=new WeakMap,vt=new WeakMap,Tt=new WeakMap,Pt=new WeakMap,kt=new WeakMap;let Ct={get(e,t,s){if(e instanceof IDBTransaction){if("done"===t)return vt.get(e);if("objectStoreNames"===t)return e.objectStoreNames||Tt.get(e);if("store"===t)return s.objectStoreNames[1]?void 0:s.objectStore(s.objectStoreNames[0])}return At(e[t])},set:(e,t,s)=>(e[t]=s,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function Et(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(_t||(_t=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(St(this),e),At(xt.get(this))}:function(...e){return At(t.apply(St(this),e))}:function(e,...s){const i=t.call(St(this),e,...s);return Tt.set(i,e.sort?e.sort():[e]),At(i)}:(e instanceof IDBTransaction&&function(e){if(vt.has(e))return;const t=new Promise(((t,s)=>{const i=()=>{e.removeEventListener("complete",n),e.removeEventListener("error",r),e.removeEventListener("abort",r)},n=()=>{t(),i()},r=()=>{s(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",n),e.addEventListener("error",r),e.addEventListener("abort",r)}));vt.set(e,t)}(e),bt(e,wt||(wt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,Ct):e);var t}function At(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,s)=>{const i=()=>{e.removeEventListener("success",n),e.removeEventListener("error",r)},n=()=>{t(At(e.result)),i()},r=()=>{s(e.error),i()};e.addEventListener("success",n),e.addEventListener("error",r)}));return t.then((t=>{t instanceof IDBCursor&&xt.set(t,e)})).catch((()=>{})),kt.set(t,e),t}(e);if(Pt.has(e))return Pt.get(e);const t=Et(e);return t!==e&&(Pt.set(e,t),kt.set(t,e)),t}const St=e=>kt.get(e);function It(e,t,{blocked:s,upgrade:i,blocking:n,terminated:r}={}){const a=indexedDB.open(e,t),o=At(a);return i&&a.addEventListener("upgradeneeded",(e=>{i(At(a.result),e.oldVersion,e.newVersion,At(a.transaction),e)})),s&&a.addEventListener("blocked",(e=>s(e.oldVersion,e.newVersion,e))),o.then((e=>{r&&e.addEventListener("close",(()=>r())),n&&e.addEventListener("versionchange",(e=>n(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),o}const Nt=["get","getKey","getAll","getAllKeys","count"],Lt=["put","add","delete","clear"],Dt=new Map;function Ot(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(Dt.get(t))return Dt.get(t);const s=t.replace(/FromIndex$/,""),i=t!==s,n=Lt.includes(s);if(!(s in(i?IDBIndex:IDBObjectStore).prototype)||!n&&!Nt.includes(s))return;const r=async function(e,...t){const r=this.transaction(e,n?"readwrite":"readonly");let a=r.store;return i&&(a=a.index(t.shift())),(await Promise.all([a[s](...t),n&&r.done]))[0]};return Dt.set(t,r),r}var Mt;Mt=Ct,Ct={...Mt,get:(e,t,s)=>Ot(e,t)||Mt.get(e,t,s),has:(e,t)=>!!Ot(e,t)||Mt.has(e,t)};class Rt{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const Ft="@firebase/app",Bt="0.10.2",jt=new gt("@firebase/app"),Ut="[DEFAULT]",zt={[Ft]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},qt=new Map,Ht=new Map,Vt=new Map;function $t(e,t){try{e.container.addComponent(t)}catch(s){jt.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,s)}}function Wt(e){const t=e.name;if(Vt.has(t))return jt.debug(`There were multiple attempts to register component ${t}.`),!1;Vt.set(t,e);for(const t of qt.values())$t(t,e);for(const t of Ht.values())$t(t,e);return!0}function Kt(e,t){const s=e.container.getProvider("heartbeat").getImmediate({optional:!0});return s&&s.triggerHeartbeat(),e.container.getProvider(t)}const Gt=new ze("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class Yt{constructor(e,t,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new ot("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Gt.create("app-deleted",{appName:this._name})}}function Jt(e,t={}){let s=e;"object"!=typeof t&&(t={name:t});const i=Object.assign({name:Ut,automaticDataCollectionEnabled:!1},t),n=i.name;if("string"!=typeof n||!n)throw Gt.create("bad-app-name",{appName:String(n)});if(s||(s=Me()),!s)throw Gt.create("no-options");const r=qt.get(n);if(r){if(Je(s,r.options)&&Je(i,r.config))return r;throw Gt.create("duplicate-app",{appName:n})}const a=new lt(n);for(const e of Vt.values())a.addComponent(e);const o=new Yt(s,i,a);return qt.set(n,o),o}function Xt(e=Ut){const t=qt.get(e);if(!t&&e===Ut&&Me())return Jt();if(!t)throw Gt.create("no-app",{appName:e});return t}function Zt(e,t,s){var i;let n=null!==(i=zt[e])&&void 0!==i?i:e;s&&(n+=`-${s}`);const r=n.match(/\s|\//),a=t.match(/\s|\//);if(r||a){const e=[`Unable to register library "${n}" with version "${t}":`];return r&&e.push(`library name "${n}" contains illegal characters (whitespace or "/")`),r&&a&&e.push("and"),a&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void jt.warn(e.join(" "))}Wt(new ot(`${n}-version`,(()=>({library:n,version:t})),"VERSION"))}const Qt="firebase-heartbeat-database",es=1,ts="firebase-heartbeat-store";let ss=null;function is(){return ss||(ss=It(Qt,es,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(ts)}catch(e){console.warn(e)}}}).catch((e=>{throw Gt.create("idb-open",{originalErrorMessage:e.message})}))),ss}async function ns(e,t){try{const s=(await is()).transaction(ts,"readwrite"),i=s.objectStore(ts);await i.put(t,rs(e)),await s.done}catch(e){if(e instanceof Ue)jt.warn(e.message);else{const t=Gt.create("idb-set",{originalErrorMessage:null==e?void 0:e.message});jt.warn(t.message)}}}function rs(e){return`${e.name}!${e.options.appId}`}class as{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new cs(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){var e,t;const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=os();if((null!=(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||(this._heartbeatsCache=await this._heartbeatsCachePromise,null!=(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))&&this._heartbeatsCache.lastSentHeartbeatDate!==i&&!this._heartbeatsCache.heartbeats.some((e=>e.date===i)))return this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=os(),{heartbeatsToSend:s,unsentEntries:i}=function(e,t=1024){const s=[];let i=e.slice();for(const n of e){const e=s.find((e=>e.agent===n.agent));if(e){if(e.dates.push(n.date),hs(s)>t){e.dates.pop();break}}else if(s.push({agent:n.agent,dates:[n.date]}),hs(s)>t){s.pop();break}i=i.slice(1)}return{heartbeatsToSend:s,unsentEntries:i}}(this._heartbeatsCache.heartbeats),n=Ie(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),n}}function os(){return(new Date).toISOString().substring(0,10)}class cs{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!Be()&&je().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await is()).transaction(ts),s=await t.objectStore(ts).get(rs(e));return await t.done,s}catch(e){if(e instanceof Ue)jt.warn(e.message);else{const t=Gt.create("idb-get",{originalErrorMessage:null==e?void 0:e.message});jt.warn(t.message)}}}(this.app);return(null==e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return ns(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return ns(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}}}function hs(e){return Ie(JSON.stringify({version:2,heartbeats:e})).length}Wt(new ot("platform-logger",(e=>new Rt(e)),"PRIVATE")),Wt(new ot("heartbeat",(e=>new as(e)),"PRIVATE")),Zt(Ft,Bt,""),Zt(Ft,Bt,"esm2017"),Zt("fire-js",""),Zt("firebase","10.11.1","app");const ls="@firebase/installations",ps="0.6.6",us=1e4,ds=`w:${ps}`,fs="FIS_v2",ms="https://firebaseinstallations.googleapis.com/v1",ys=36e5,gs=new ze("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function bs(e){return e instanceof Ue&&e.code.includes("request-failed")}function ws({projectId:e}){return`${ms}/projects/${e}/installations`}function _s(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function xs(e,t){const s=(await t.json()).error;return gs.create("request-failed",{requestName:e,serverCode:s.code,serverMessage:s.message,serverStatus:s.status})}function vs({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}async function Ts(e){const t=await e();return t.status>=500&&t.status<600?e():t}function Ps(e){return new Promise((t=>{setTimeout(t,e)}))}const ks=/^[cdef][\w-]{21}$/,Cs="";function Es(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){var t;return(t=e,btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22)}(e);return ks.test(t)?t:Cs}catch(e){return Cs}}function As(e){return`${e.appName}!${e.appId}`}const Ss=new Map;function Is(e,t){const s=As(e);Ns(s,t),function(e,t){const s=(!Ls&&"BroadcastChannel"in self&&(Ls=new BroadcastChannel("[Firebase] FID Change"),Ls.onmessage=e=>{Ns(e.data.key,e.data.fid)}),Ls);s&&s.postMessage({key:e,fid:t}),0===Ss.size&&Ls&&(Ls.close(),Ls=null)}(s,t)}function Ns(e,t){const s=Ss.get(e);if(s)for(const e of s)e(t)}let Ls=null;const Ds="firebase-installations-database",Os=1,Ms="firebase-installations-store";let Rs=null;function Fs(){return Rs||(Rs=It(Ds,Os,{upgrade:(e,t)=>{0===t&&e.createObjectStore(Ms)}})),Rs}async function Bs(e,t){const s=As(e),i=(await Fs()).transaction(Ms,"readwrite"),n=i.objectStore(Ms),r=await n.get(s);return await n.put(t,s),await i.done,r&&r.fid===t.fid||Is(e,t.fid),t}async function js(e){const t=As(e),s=(await Fs()).transaction(Ms,"readwrite");await s.objectStore(Ms).delete(t),await s.done}async function Us(e,t){const s=As(e),i=(await Fs()).transaction(Ms,"readwrite"),n=i.objectStore(Ms),r=await n.get(s),a=t(r);return void 0===a?await n.delete(s):await n.put(a,s),await i.done,!a||r&&r.fid===a.fid||Is(e,a.fid),a}async function zs(e){let t;const s=await Us(e.appConfig,(s=>{const i=function(e){return Vs(e||{fid:Es(),registrationStatus:0})}(s),n=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(gs.create("app-offline"))};const s={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},i=async function(e,t){try{const s=await async function({appConfig:e,heartbeatServiceProvider:t},{fid:s}){const i=ws(e),n=vs(e),r=t.getImmediate({optional:!0});if(r){const e=await r.getHeartbeatsHeader();e&&n.append("x-firebase-client",e)}const a={fid:s,authVersion:fs,appId:e.appId,sdkVersion:ds},o={method:"POST",headers:n,body:JSON.stringify(a)},c=await Ts((()=>fetch(i,o)));if(c.ok){const e=await c.json();return{fid:e.fid||s,registrationStatus:2,refreshToken:e.refreshToken,authToken:_s(e.authToken)}}throw await xs("Create Installation",c)}(e,t);return Bs(e.appConfig,s)}catch(s){throw bs(s)&&409===s.customData.serverCode?await js(e.appConfig):await Bs(e.appConfig,{fid:t.fid,registrationStatus:0}),s}}(e,s);return{installationEntry:s,registrationPromise:i}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:qs(e)}:{installationEntry:t}}(e,i);return t=n.registrationPromise,n.installationEntry}));return s.fid===Cs?{installationEntry:await t}:{installationEntry:s,registrationPromise:t}}async function qs(e){let t=await Hs(e.appConfig);for(;1===t.registrationStatus;)await Ps(100),t=await Hs(e.appConfig);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:s}=await zs(e);return s||t}return t}function Hs(e){return Us(e,(e=>{if(!e)throw gs.create("installation-not-found");return Vs(e)}))}function Vs(e){return 1===(t=e).registrationStatus&&t.registrationTime+us<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}async function $s({appConfig:e,heartbeatServiceProvider:t},s){const i=function(e,{fid:t}){return`${ws(e)}/${t}/authTokens:generate`}(e,s),n=function(e,{refreshToken:t}){const s=vs(e);return s.append("Authorization",function(e){return`${fs} ${e}`}(t)),s}(e,s),r=t.getImmediate({optional:!0});if(r){const e=await r.getHeartbeatsHeader();e&&n.append("x-firebase-client",e)}const a={installation:{sdkVersion:ds,appId:e.appId}},o={method:"POST",headers:n,body:JSON.stringify(a)},c=await Ts((()=>fetch(i,o)));if(c.ok)return _s(await c.json());throw await xs("Generate Auth Token",c)}async function Ws(e,t=!1){let s;const i=await Us(e.appConfig,(i=>{if(!Gs(i))throw gs.create("not-registered");const n=i.authToken;if(!t&&(2===(r=n).requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+ys}(r)))return i;var r;if(1===n.requestStatus)return s=async function(e,t){let s=await Ks(e.appConfig);for(;1===s.authToken.requestStatus;)await Ps(100),s=await Ks(e.appConfig);const i=s.authToken;return 0===i.requestStatus?Ws(e,t):i}(e,t),i;{if(!navigator.onLine)throw gs.create("app-offline");const t=function(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}(i);return s=async function(e,t){try{const s=await $s(e,t),i=Object.assign(Object.assign({},t),{authToken:s});return await Bs(e.appConfig,i),s}catch(s){if(!bs(s)||401!==s.customData.serverCode&&404!==s.customData.serverCode){const s=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await Bs(e.appConfig,s)}else await js(e.appConfig);throw s}}(e,t),t}}));return s?await s:i.authToken}function Ks(e){return Us(e,(e=>{if(!Gs(e))throw gs.create("not-registered");return 1===(t=e.authToken).requestStatus&&t.requestTime+us<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e;var t}))}function Gs(e){return void 0!==e&&2===e.registrationStatus}function Ys(e){return gs.create("missing-app-config-values",{valueName:e})}const Js="installations";Wt(new ot(Js,(e=>{const t=e.getProvider("app").getImmediate(),s=function(e){if(!e||!e.options)throw Ys("App Configuration");if(!e.name)throw Ys("App Name");const t=["projectId","apiKey","appId"];for(const s of t)if(!e.options[s])throw Ys(s);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:s,heartbeatServiceProvider:Kt(t,"heartbeat"),_delete:()=>Promise.resolve()}}),"PUBLIC")),Wt(new ot("installations-internal",(e=>{const t=Kt(e.getProvider("app").getImmediate(),Js).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:s,registrationPromise:i}=await zs(t);return i?i.catch(console.error):Ws(t).catch(console.error),s.fid}(t),getToken:e=>async function(e,t=!1){const s=e;return await async function(e){const{registrationPromise:t}=await zs(e);t&&await t}(s),(await Ws(s,t)).token}(t,e)}}),"PRIVATE")),Zt(ls,ps),Zt(ls,ps,"esm2017");const Xs="analytics",Zs="firebase_id",Qs="origin",ei=6e4,ti="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",si="https://www.googletagmanager.com/gtag/js",ii=new gt("@firebase/analytics"),ni=new ze("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function ri(e){if(!e.startsWith(si)){const t=ni.create("invalid-gtag-resource",{gtagURL:e});return ii.warn(t.message),""}return e}function ai(e){return Promise.all(e.map((e=>e.catch((e=>e)))))}const oi=30,ci=new class{constructor(e={},t=1e3){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function hi(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function li(e,t=ci,s){const{appId:i,apiKey:n,measurementId:r}=e.options;if(!i)throw ni.create("no-app-id");if(!n){if(r)return{measurementId:r,appId:i};throw ni.create("no-api-key")}const a=t.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},o=new ui;return setTimeout((async()=>{o.abort()}),void 0!==s?s:ei),pi({appId:i,apiKey:n,measurementId:r},a,o,t)}async function pi(e,{throttleEndTimeMillis:t,backoffCount:s},i,n=ci){var r;const{appId:a,measurementId:o}=e;try{await function(e,t){return new Promise(((s,i)=>{const n=Math.max(t-Date.now(),0),r=setTimeout(s,n);e.addEventListener((()=>{clearTimeout(r),i(ni.create("fetch-throttle",{throttleEndTimeMillis:t}))}))}))}(i,t)}catch(e){if(o)return ii.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${null==e?void 0:e.message}]`),{appId:a,measurementId:o};throw e}try{const t=await async function(e){var t;const{appId:s,apiKey:i}=e,n={method:"GET",headers:hi(i)},r=ti.replace("{app-id}",s),a=await fetch(r,n);if(200!==a.status&&304!==a.status){let e="";try{const s=await a.json();(null===(t=s.error)||void 0===t?void 0:t.message)&&(e=s.error.message)}catch(e){}throw ni.create("config-fetch-failed",{httpStatus:a.status,responseMessage:e})}return a.json()}(e);return n.deleteThrottleMetadata(a),t}catch(t){const c=t;if(!function(e){if(!(e instanceof Ue&&e.customData))return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(c)){if(n.deleteThrottleMetadata(a),o)return ii.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${null==c?void 0:c.message}]`),{appId:a,measurementId:o};throw t}const h=503===Number(null===(r=null==c?void 0:c.customData)||void 0===r?void 0:r.httpStatus)?rt(s,n.intervalMillis,oi):rt(s,n.intervalMillis),l={throttleEndTimeMillis:Date.now()+h,backoffCount:s+1};return n.setThrottleMetadata(a,l),ii.debug(`Calling attemptFetch again in ${h} millis`),pi(e,l,i,n)}}class ui{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach((e=>e()))}}let di,fi;async function mi(e,t,s,i,n,r,a){var o;const c=li(e);c.then((t=>{s[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&ii.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${t.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((e=>ii.error(e))),t.push(c);const h=async function(){if(!Be())return ii.warn(ni.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await je()}catch(e){return ii.warn(ni.create("indexeddb-unavailable",{errorInfo:null==e?void 0:e.toString()}).message),!1}return!0}().then((e=>e?i.getId():void 0)),[l,p]=await Promise.all([c,h]);(function(e){const t=window.document.getElementsByTagName("script");for(const s of Object.values(t))if(s.src&&s.src.includes(si)&&s.src.includes(e))return s;return null})(r)||function(e,t){const s=function(e,t){let s;return window.trustedTypes&&(s=window.trustedTypes.createPolicy("firebase-js-sdk-policy",t)),s}(0,{createScriptURL:ri}),i=document.createElement("script"),n=`${si}?l=${e}&id=${t}`;i.src=s?null==s?void 0:s.createScriptURL(n):n,i.async=!0,document.head.appendChild(i)}(r,l.measurementId),fi&&(n("consent","default",fi),fi=void 0),n("js",new Date);const u=null!==(o=null==a?void 0:a.config)&&void 0!==o?o:{};return u[Qs]="firebase",u.update=!0,null!=p&&(u[Zs]=p),n("config",l.measurementId,u),di&&(n("set",di),di=void 0),l.measurementId}class yi{constructor(e){this.app=e}_delete(){return delete gi[this.app.options.appId],Promise.resolve()}}let gi={},bi=[];const wi={};let _i,xi,vi="dataLayer",Ti=!1;function Pi(e,t,s){!function(){const e=[];if(function(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}()&&e.push("This is a browser extension environment."),"undefined"!=typeof navigator&&navigator.cookieEnabled||e.push("Cookies are not available."),e.length>0){const t=e.map(((e,t)=>`(${t+1}) ${e}`)).join(" "),s=ni.create("invalid-analytics-context",{errorInfo:t});ii.warn(s.message)}}();const i=e.options.appId;if(!i)throw ni.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw ni.create("no-api-key");ii.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=gi[i])throw ni.create("already-exists",{id:i});if(!Ti){!function(e){let t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(vi);const{wrappedGtag:e,gtagCore:t}=function(e,t,s,i,n){let r=function(...e){window[i].push(arguments)};return window[n]&&"function"==typeof window[n]&&(r=window[n]),window[n]=function(e,t,s,i){return async function(n,...r){try{if("event"===n){const[i,n]=r;await async function(e,t,s,i,n){try{let r=[];if(n&&n.send_to){let e=n.send_to;Array.isArray(e)||(e=[e]);const i=await ai(s);for(const s of e){const e=i.find((e=>e.measurementId===s)),n=e&&t[e.appId];if(!n){r=[];break}r.push(n)}}0===r.length&&(r=Object.values(t)),await Promise.all(r),e("event",i,n||{})}catch(e){ii.error(e)}}(e,t,s,i,n)}else if("config"===n){const[n,a]=r;await async function(e,t,s,i,n,r){const a=i[n];try{if(a)await t[a];else{const e=(await ai(s)).find((e=>e.measurementId===n));e&&await t[e.appId]}}catch(e){ii.error(e)}e("config",n,r)}(e,t,s,i,n,a)}else if("consent"===n){const[t]=r;e("consent","update",t)}else if("get"===n){const[t,s,i]=r;e("get",t,s,i)}else if("set"===n){const[t]=r;e("set",t)}else e(n,...r)}catch(e){ii.error(e)}}}(r,e,t,s),{gtagCore:r,wrappedGtag:window[n]}}(gi,bi,wi,vi,"gtag");xi=e,_i=t,Ti=!0}return gi[i]=mi(e,bi,wi,t,_i,vi,s),new yi(e)}const ki="@firebase/analytics",Ci="0.10.2";Wt(new ot(Xs,((e,{options:t})=>Pi(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),t)),"PUBLIC")),Wt(new ot("analytics-internal",(function(e){try{const t=e.getProvider(Xs).getImmediate();return{logEvent:(e,s,i)=>function(e,t,s,i){e=at(e),async function(e,t,s,i,n){if(n&&n.global)e("event",s,i);else{const n=await t;e("event",s,Object.assign(Object.assign({},i),{send_to:n}))}}(xi,gi[e.app.options.appId],t,s,i).catch((e=>ii.error(e)))}(t,e,s,i)}}catch(e){throw ni.create("interop-component-reg-failed",{reason:e})}}),"PRIVATE")),Zt(ki,Ci),Zt(ki,Ci,"esm2017");const Ei="@firebase/database",Ai="1.0.4";let Si="";class Ii{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Ve(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:He(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class Ni{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return We(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const Li=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new Ii(t)}}catch(e){}return new Ni},Di=Li("localStorage"),Oi=Li("sessionStorage"),Mi=new gt("@firebase/database"),Ri=function(){let e=1;return function(){return e++}}(),Fi=function(e){const t=function(e){const t=[];let s=0;for(let i=0;i<e.length;i++){let n=e.charCodeAt(i);if(n>=55296&&n<=56319){const t=n-55296;i++,Pe(i<e.length,"Surrogate pair missing trail surrogate."),n=65536+(t<<10)+(e.charCodeAt(i)-56320)}n<128?t[s++]=n:n<2048?(t[s++]=n>>6|192,t[s++]=63&n|128):n<65536?(t[s++]=n>>12|224,t[s++]=n>>6&63|128,t[s++]=63&n|128):(t[s++]=n>>18|240,t[s++]=n>>12&63|128,t[s++]=n>>6&63|128,t[s++]=63&n|128)}return t}(e),s=new Ze;s.update(t);const i=s.digest();return Ee.encodeByteArray(i)},Bi=function(...e){let t="";for(let s=0;s<e.length;s++){const i=e[s];Array.isArray(i)||i&&"object"==typeof i&&"number"==typeof i.length?t+=Bi.apply(null,i):t+="object"==typeof i?Ve(i):i,t+=" "}return t};let ji=null,Ui=!0;const zi=function(...e){if(!0===Ui&&(Ui=!1,null===ji&&!0===Oi.get("logging_enabled")&&(t=!0,Pe(!s||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(Mi.logLevel=ut.VERBOSE,ji=Mi.log.bind(Mi),s&&Oi.set("logging_enabled",!0)):"function"==typeof t?ji=t:(ji=null,Oi.remove("logging_enabled")))),ji){const t=Bi.apply(null,e);ji(t)}var t,s},qi=function(e){return function(...t){zi(e,...t)}},Hi=function(...e){const t="FIREBASE INTERNAL ERROR: "+Bi(...e);Mi.error(t)},Vi=function(...e){const t=`FIREBASE FATAL ERROR: ${Bi(...e)}`;throw Mi.error(t),new Error(t)},$i=function(...e){const t="FIREBASE WARNING: "+Bi(...e);Mi.warn(t)},Wi=function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},Ki="[MIN_NAME]",Gi="[MAX_NAME]",Yi=function(e,t){if(e===t)return 0;if(e===Ki||t===Gi)return-1;if(t===Ki||e===Gi)return 1;{const s=nn(e),i=nn(t);return null!==s?null!==i?s-i==0?e.length-t.length:s-i:-1:null!==i?1:e<t?-1:1}},Ji=function(e,t){return e===t?0:e<t?-1:1},Xi=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+Ve(t))},Zi=function(e){if("object"!=typeof e||null===e)return Ve(e);const t=[];for(const s in e)t.push(s);t.sort();let s="{";for(let i=0;i<t.length;i++)0!==i&&(s+=","),s+=Ve(t[i]),s+=":",s+=Zi(e[t[i]]);return s+="}",s},Qi=function(e,t){const s=e.length;if(s<=t)return[e];const i=[];for(let n=0;n<s;n+=t)n+t>s?i.push(e.substring(n,s)):i.push(e.substring(n,n+t));return i};function en(e,t){for(const s in e)e.hasOwnProperty(s)&&t(s,e[s])}const tn=function(e){Pe(!Wi(e),"Invalid JSON number");let t,s,i,n,r;0===e?(s=0,i=0,t=1/e==-1/0?1:0):(t=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(n=Math.min(Math.floor(Math.log(e)/Math.LN2),1023),s=n+1023,i=Math.round(e*Math.pow(2,52-n)-Math.pow(2,52))):(s=0,i=Math.round(e/Math.pow(2,-1074))));const a=[];for(r=52;r;r-=1)a.push(i%2?1:0),i=Math.floor(i/2);for(r=11;r;r-=1)a.push(s%2?1:0),s=Math.floor(s/2);a.push(t?1:0),a.reverse();const o=a.join("");let c="";for(r=0;r<64;r+=8){let e=parseInt(o.substr(r,8),2).toString(16);1===e.length&&(e="0"+e),c+=e}return c.toLowerCase()},sn=new RegExp("^-?(0*)\\d{1,10}$"),nn=function(e){if(sn.test(e)){const t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},rn=function(e){try{e()}catch(e){setTimeout((()=>{const t=e.stack||"";throw $i("Exception was thrown by user callback.",t),e}),Math.floor(0))}},an=function(e,t){const s=setTimeout(e,t);return"number"==typeof s&&"undefined"!=typeof Deno&&Deno.unrefTimer?Deno.unrefTimer(s):"object"==typeof s&&s.unref&&s.unref(),s};class on{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=null==t?void 0:t.getImmediate({optional:!0}),this.appCheck||null==t||t.get().then((e=>this.appCheck=e))}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise(((t,s)=>{setTimeout((()=>{this.appCheck?this.getToken(e).then(t,s):t(null)}),0)}))}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then((t=>t.addTokenListener(e)))}notifyForInvalidToken(){$i(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class cn{constructor(e,t,s){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=s,this.auth_=null,this.auth_=s.getImmediate({optional:!0}),this.auth_||s.onInit((e=>this.auth_=e))}getToken(e){return this.auth_?this.auth_.getToken(e).catch((e=>e&&"auth/token-not-initialized"===e.code?(zi("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e))):new Promise(((t,s)=>{setTimeout((()=>{this.auth_?this.getToken(e).then(t,s):t(null)}),0)}))}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then((t=>t.addAuthTokenListener(e)))}removeTokenChangeListener(e){this.authProvider_.get().then((t=>t.removeAuthTokenListener(e)))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',$i(e)}}class hn{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}hn.OWNER="owner";const ln="5",pn=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,un="ac",dn="websocket",fn="long_polling";class mn{constructor(e,t,s,i,n=!1,r="",a=!1,o=!1){this.secure=t,this.namespace=s,this.webSocketOnly=i,this.nodeAdmin=n,this.persistenceKey=r,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=o,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Di.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Di.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function yn(e,t,s){let i;if(Pe("string"==typeof t,"typeof type must == string"),Pe("object"==typeof s,"typeof params must == object"),t===dn)i=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==fn)throw new Error("Unknown connection type: "+t);i=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(s.ns=e.namespace);const n=[];return en(s,((e,t)=>{n.push(e+"="+t)})),i+n.join("&")}class gn{constructor(){this.counters_={}}incrementCounter(e,t=1){We(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return Le(this.counters_)}}const bn={},wn={};function _n(e){const t=e.toString();return bn[t]||(bn[t]=new gn),bn[t]}class xn{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const e=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let t=0;t<e.length;++t)e[t]&&rn((()=>{this.onMessage_(e[t])}));if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}const vn="start";class Tn{constructor(e,t,s,i,n,r,a){this.connId=e,this.repoInfo=t,this.applicationId=s,this.appCheckToken=i,this.authToken=n,this.transportSessionId=r,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=qi(e),this.stats_=_n(t),this.urlFn=e=>(this.appCheckToken&&(e[un]=this.appCheckToken),yn(t,fn,e))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new xn(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if("complete"===document.readyState)e();else{let t=!1;const s=function(){document.body?t||(t=!0,e()):setTimeout(s,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",s,!1),window.addEventListener("load",s,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(()=>{"complete"===document.readyState&&s()})),window.attachEvent("onload",s))}}((()=>{if(this.isClosed_)return;this.scriptTagHolder=new Pn(((...e)=>{const[t,s,i,n,r]=e;if(this.incrementIncomingBytes_(e),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,t===vn)this.id=s,this.password=i;else{if("close"!==t)throw new Error("Unrecognized command received: "+t);s?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(s,(()=>{this.onClosed_()}))):this.onClosed_()}}),((...e)=>{const[t,s]=e;this.incrementIncomingBytes_(e),this.myPacketOrderer.handleResponse(t,s)}),(()=>{this.onClosed_()}),this.urlFn);const e={};e[vn]="t",e.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=this.scriptTagHolder.uniqueCallbackIdentifier),e.v=ln,this.transportSessionId&&(e.s=this.transportSessionId),this.lastSessionId&&(e.ls=this.lastSessionId),this.applicationId&&(e.p=this.applicationId),this.appCheckToken&&(e[un]=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&pn.test(location.hostname)&&(e.r="f");const t=this.urlFn(e);this.log_("Connecting via long-poll to "+t),this.scriptTagHolder.addTag(t,(()=>{}))}))}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Tn.forceAllow_=!0}static forceDisallow(){Tn.forceDisallow_=!0}static isAvailable(){return!(!Tn.forceAllow_&&(Tn.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=Ve(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const s=Se(t),i=Qi(s,1840);for(let e=0;e<i.length;e++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[e]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const s={dframe:"t"};s.id=e,s.pw=t,this.myDisconnFrame.src=this.urlFn(s),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=Ve(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class Pn{constructor(e,t,s,i){this.onDisconnect=s,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=Ri(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=Pn.createIFrame_();let s="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(s='<script>document.domain="'+document.domain+'";<\/script>');const i="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(i),this.myIFrame.doc.close()}catch(e){zi("frame writing exception"),e.stack&&zi(e.stack),zi(e)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||zi("No IE domain setting required")}catch(t){const s=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+s+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout((()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)}),Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),s="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+s.length<=1870;){const e=this.pendingSegs.shift();s=s+"&seg"+i+"="+e.seg+"&ts"+i+"="+e.ts+"&d"+i+"="+e.d,i++}return t+=s,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,s){this.pendingSegs.push({seg:e,ts:t,d:s}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const s=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(s,Math.floor(25e3));this.addTag(e,(()=>{clearTimeout(i),s()}))}addTag(e,t){setTimeout((()=>{try{if(!this.sendNewPolls)return;const s=this.myIFrame.doc.createElement("script");s.type="text/javascript",s.async=!0,s.src=e,s.onload=s.onreadystatechange=function(){const e=s.readyState;e&&"loaded"!==e&&"complete"!==e||(s.onload=s.onreadystatechange=null,s.parentNode&&s.parentNode.removeChild(s),t())},s.onerror=()=>{zi("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(s)}catch(e){}}),Math.floor(1))}}let kn=null;"undefined"!=typeof MozWebSocket?kn=MozWebSocket:"undefined"!=typeof WebSocket&&(kn=WebSocket);class Cn{constructor(e,t,s,i,n,r,a){this.connId=e,this.applicationId=s,this.appCheckToken=i,this.authToken=n,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=qi(this.connId),this.stats_=_n(t),this.connURL=Cn.connectionURL_(t,r,a,i,s),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,s,i,n){const r={};return r.v=ln,"undefined"!=typeof location&&location.hostname&&pn.test(location.hostname)&&(r.r="f"),t&&(r.s=t),s&&(r.ls=s),i&&(r[un]=i),n&&(r.p=n),yn(e,dn,r)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Di.set("previous_websocket_failure",!0);try{let e;0,this.mySock=new kn(this.connURL,[],e)}catch(e){this.log_("Error instantiating WebSocket.");const t=e.message||e.data;return t&&this.log_(t),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=e=>{this.handleIncomingFrame(e)},this.mySock.onerror=e=>{this.log_("WebSocket error.  Closing connection.");const t=e.message||e.data;t&&this.log_(t),this.onClosed_()}}start(){}static forceDisallow(){Cn.forceDisallow_=!0}static isAvailable(){let e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,s=navigator.userAgent.match(t);s&&s.length>1&&parseFloat(s[1])<4.4&&(e=!0)}return!e&&null!==kn&&!Cn.forceDisallow_}static previouslyFailed(){return Di.isInMemoryStorage||!0===Di.get("previous_websocket_failure")}markConnectionHealthy(){Di.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const e=this.frames.join("");this.frames=null;const t=He(e);this.onMessage(t)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(Pe(null===this.frames,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{const e=this.extractFrameCount_(t);null!==e&&this.appendFrame_(e)}}send(e){this.resetKeepAlive();const t=Ve(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const s=Qi(t,16384);s.length>1&&this.sendString_(String(s.length));for(let e=0;e<s.length;e++)this.sendString_(s[e])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()}),Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Cn.responsesRequiredToBeHealthy=2,Cn.healthyTimeout=3e4;class En{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[Tn,Cn]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const t=Cn&&Cn.isAvailable();let s=t&&!Cn.previouslyFailed();if(e.webSocketOnly&&(t||$i("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),s=!0),s)this.transports_=[Cn];else{const e=this.transports_=[];for(const t of En.ALL_TRANSPORTS)t&&t.isAvailable()&&e.push(t);En.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}En.globalTransportInitialized_=!1;class An{constructor(e,t,s,i,n,r,a,o,c,h){this.id=e,this.repoInfo_=t,this.applicationId_=s,this.appCheckToken_=i,this.authToken_=n,this.onMessage_=r,this.onReady_=a,this.onDisconnect_=o,this.onKill_=c,this.lastSessionId=h,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=qi("c:"+this.id+":"),this.transportManager_=new En(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),s=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((()=>{this.conn_&&this.conn_.open(t,s)}),Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=an((()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))}),Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=Xi("t",e),s=Xi("d",e);if("c"===t)this.onSecondaryControl_(s);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(s)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=Xi("t",e),s=Xi("d",e);"c"===t?this.onControl_(s):"d"===t&&this.onDataMessage_(s)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=Xi("t",e);if("d"in e){const s=e.d;if("h"===t){const e=Object.assign({},s);this.repoInfo_.isUsingEmulator&&(e.h=this.repoInfo_.host),this.onHandshake_(e)}else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let e=0;e<this.pendingDataMessages.length;++e)this.onDataMessage_(this.pendingDataMessages[e]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(s):"r"===t?this.onReset_(s):"e"===t?Hi("Server Error: "+s):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Hi("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,s=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),ln!==s&&$i("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),s=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,s),an((()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())}),Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):an((()=>{this.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Di.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class Sn{put(e,t,s,i){}merge(e,t,s,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,s){}onDisconnectMerge(e,t,s){}onDisconnectCancel(e,t){}reportStats(e){}}class In{constructor(e){this.allowedEvents_=e,this.listeners_={},Pe(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const s=[...this.listeners_[e]];for(let e=0;e<s.length;e++)s[e].callback.apply(s[e].context,t)}}on(e,t,s){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:s});const i=this.getInitialEvent(e);i&&t.apply(s,i)}off(e,t,s){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let e=0;e<i.length;e++)if(i[e].callback===t&&(!s||s===i[e].context))return void i.splice(e,1)}validateEventType_(e){Pe(this.allowedEvents_.find((t=>t===e)),"Unknown event: "+e)}}class Nn extends In{constructor(){super(["online"]),this.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||Fe()||(window.addEventListener("online",(()=>{this.online_||(this.online_=!0,this.trigger("online",!0))}),!1),window.addEventListener("offline",(()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))}),!1))}static getInstance(){return new Nn}getInitialEvent(e){return Pe("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class Ln{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let t=0;for(let e=0;e<this.pieces_.length;e++)this.pieces_[e].length>0&&(this.pieces_[t]=this.pieces_[e],t++);this.pieces_.length=t,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function Dn(){return new Ln("")}function On(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function Mn(e){return e.pieces_.length-e.pieceNum_}function Rn(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new Ln(e.pieces_,t)}function Fn(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function Bn(e,t=0){return e.pieces_.slice(e.pieceNum_+t)}function jn(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let s=e.pieceNum_;s<e.pieces_.length-1;s++)t.push(e.pieces_[s]);return new Ln(t,0)}function Un(e,t){const s=[];for(let t=e.pieceNum_;t<e.pieces_.length;t++)s.push(e.pieces_[t]);if(t instanceof Ln)for(let e=t.pieceNum_;e<t.pieces_.length;e++)s.push(t.pieces_[e]);else{const e=t.split("/");for(let t=0;t<e.length;t++)e[t].length>0&&s.push(e[t])}return new Ln(s,0)}function zn(e){return e.pieceNum_>=e.pieces_.length}function qn(e,t){const s=On(e),i=On(t);if(null===s)return t;if(s===i)return qn(Rn(e),Rn(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function Hn(e,t){if(Mn(e)!==Mn(t))return!1;for(let s=e.pieceNum_,i=t.pieceNum_;s<=e.pieces_.length;s++,i++)if(e.pieces_[s]!==t.pieces_[i])return!1;return!0}function Vn(e,t){let s=e.pieceNum_,i=t.pieceNum_;if(Mn(e)>Mn(t))return!1;for(;s<e.pieces_.length;){if(e.pieces_[s]!==t.pieces_[i])return!1;++s,++i}return!0}class $n{constructor(e,t){this.errorPrefix_=t,this.parts_=Bn(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let e=0;e<this.parts_.length;e++)this.byteLength_+=et(this.parts_[e]);Wn(this)}}function Wn(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+Kn(e))}function Kn(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}class Gn extends In{constructor(){let e,t;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(t="visibilitychange",e="hidden"):void 0!==document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(t="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,(()=>{const t=!document[e];t!==this.visible_&&(this.visible_=t,this.trigger("visible",t))}),!1)}static getInstance(){return new Gn}getInitialEvent(e){return Pe("visible"===e,"Unknown event type: "+e),[this.visible_]}}const Yn=1e3;class Jn extends Sn{constructor(e,t,s,i,n,r,a,o){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=s,this.onConnectStatus_=i,this.onServerInfoUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=a,this.authOverride_=o,this.id=Jn.nextPersistentConnectionId_++,this.log_=qi("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Yn,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,o)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Gn.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&Nn.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,s){const i=++this.requestNumber_,n={r:i,a:e,b:t};this.log_(Ve(n)),Pe(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(n),s&&(this.requestCBHash_[i]=s)}get(e){this.initConnection_();const t=new Re,s={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:e=>{const s=e.d;"ok"===e.s?t.resolve(s):t.reject(s)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(i),t.promise}listen(e,t,s,i){this.initConnection_();const n=e._queryIdentifier,r=e._path.toString();this.log_("Listen called for "+r+" "+n),this.listens.has(r)||this.listens.set(r,new Map),Pe(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),Pe(!this.listens.get(r).has(n),"listen() called twice for same path/queryId.");const a={onComplete:i,hashFn:t,query:e,tag:s};this.listens.get(r).set(n,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,(s=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(s)}))}sendListen_(e){const t=e.query,s=t._path.toString(),i=t._queryIdentifier;this.log_("Listen on "+s+" for "+i);const n={p:s};e.tag&&(n.q=t._queryObject,n.t=e.tag),n.h=e.hashFn(),this.sendRequest("q",n,(n=>{const r=n.d,a=n.s;Jn.warnOnListenWarnings_(r,t),(this.listens.get(s)&&this.listens.get(s).get(i))===e&&(this.log_("listen response",n),"ok"!==a&&this.removeListen_(s,i),e.onComplete&&e.onComplete(a,r))}))}static warnOnListenWarnings_(e,t){if(e&&"object"==typeof e&&We(e,"w")){const s=Ke(e,"w");if(Array.isArray(s)&&~s.indexOf("no_index")){const e='".indexOn": "'+t._queryParams.getIndex().toString()+'"',s=t._path.toString();$i(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${e} at ${s} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(()=>{})),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||function(e){const t=$e(e).claims;return"object"==typeof t&&!0===t.admin}(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(()=>{}))}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=function(e){const t=$e(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")}(e)?"auth":"gauth",s={cred:e};null===this.authOverride_?s.noauth=!0:"object"==typeof this.authOverride_&&(s.authvar=this.authOverride_),this.sendRequest(t,s,(t=>{const s=t.s,i=t.d||"error";this.authToken_===e&&("ok"===s?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(s,i))}))}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(e=>{const t=e.s,s=e.d||"error";"ok"===t?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,s)}))}unlisten(e,t){const s=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+s+" "+i),Pe(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(s,i)&&this.connected_&&this.sendUnlisten_(s,i,e._queryObject,t)}sendUnlisten_(e,t,s,i){this.log_("Unlisten on "+e+" for "+t);const n={p:e};i&&(n.q=s,n.t=i),this.sendRequest("n",n)}onDisconnectPut(e,t,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:s})}onDisconnectMerge(e,t,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:s})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,s,i){const n={p:t,d:s};this.log_("onDisconnect "+e,n),this.sendRequest(e,n,(e=>{i&&setTimeout((()=>{i(e.s,e.d)}),Math.floor(0))}))}put(e,t,s,i){this.putInternal("p",e,t,s,i)}merge(e,t,s,i){this.putInternal("m",e,t,s,i)}putInternal(e,t,s,i,n){this.initConnection_();const r={p:t,d:s};void 0!==n&&(r.h=n),this.outstandingPuts_.push({action:e,request:r,onComplete:i}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,s=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,s,(s=>{this.log_(t+" response",s),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),i&&i(s.s,s.d)}))}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,(e=>{if("ok"!==e.s){const t=e.d;this.log_("reportStats","Error sending stats: "+t)}}))}}onDataMessage_(e){if("r"in e){this.log_("from server: "+Ve(e));const t=e.r,s=this.requestCBHash_[t];s&&(delete this.requestCBHash_[t],s(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):Hi("Unrecognized action received from server: "+Ve(e)+"\nAre you using the latest client?")}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){Pe(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((()=>{this.establishConnectionTimer_=null,this.establishConnection_()}),Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Yn,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Yn,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Yn),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const e=(new Date).getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),s=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+Jn.nextConnectionId_++,n=this.lastSessionId;let r=!1,a=null;const o=function(){a?a.close():(r=!0,s())},c=function(e){Pe(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(e)};this.realtime_={close:o,sendRequest:c};const h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[o,c]=await Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)]);r?zi("getToken() completed but was canceled"):(zi("getToken() completed. Creating connection."),this.authToken_=o&&o.accessToken,this.appCheckToken_=c&&c.token,a=new An(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,s,(e=>{$i(e+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")}),n))}catch(e){this.log_("Failed to get token: "+e),r||(this.repoInfo_.nodeAdmin&&$i(e),o())}}}interrupt(e){zi("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){zi("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Ge(this.interruptReasons_)&&(this.reconnectDelay_=Yn,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let s;s=t?t.map((e=>Zi(e))).join("$"):"default";const i=this.removeListen_(e,s);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,t){const s=new Ln(e).toString();let i;if(this.listens.has(s)){const e=this.listens.get(s);i=e.get(t),e.delete(t),0===e.size&&this.listens.delete(s)}else i=void 0;return i}onAuthRevoked_(e,t){zi("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){zi("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+Si.replace(/\./g,"-")]=1,Fe()?e["framework.cordova"]=1:"object"==typeof navigator&&"ReactNative"===navigator.product&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=Nn.getInstance().currentlyOnline();return Ge(this.interruptReasons_)&&e}}Jn.nextPersistentConnectionId_=0,Jn.nextConnectionId_=0;class Xn{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Xn(e,t)}}class Zn{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const s=new Xn(Ki,e),i=new Xn(Ki,t);return 0!==this.compare(s,i)}minPost(){return Xn.MIN}}let Qn;class er extends Zn{static get __EMPTY_NODE(){return Qn}static set __EMPTY_NODE(e){Qn=e}compare(e,t){return Yi(e.name,t.name)}isDefinedOn(e){throw ke("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Xn.MIN}maxPost(){return new Xn(Gi,Qn)}makePost(e,t){return Pe("string"==typeof e,"KeyIndex indexValue must always be a string."),new Xn(e,Qn)}toString(){return".key"}}const tr=new er;class sr{constructor(e,t,s,i,n=null){this.isReverse_=i,this.resultGenerator_=n,this.nodeStack_=[];let r=1;for(;!e.isEmpty();)if(r=t?s(e.key,t):1,i&&(r*=-1),r<0)e=this.isReverse_?e.left:e.right;else{if(0===r){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class ir{constructor(e,t,s,i,n){this.key=e,this.value=t,this.color=null!=s?s:ir.RED,this.left=null!=i?i:nr.EMPTY_NODE,this.right=null!=n?n:nr.EMPTY_NODE}copy(e,t,s,i,n){return new ir(null!=e?e:this.key,null!=t?t:this.value,null!=s?s:this.color,null!=i?i:this.left,null!=n?n:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let i=this;const n=s(e,i.key);return i=n<0?i.copy(null,null,null,i.left.insert(e,t,s),null):0===n?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,s)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return nr.EMPTY_NODE;let e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let s,i;if(s=this,t(e,s.key)<0)s.left.isEmpty()||s.left.isRed_()||s.left.left.isRed_()||(s=s.moveRedLeft_()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed_()&&(s=s.rotateRight_()),s.right.isEmpty()||s.right.isRed_()||s.right.left.isRed_()||(s=s.moveRedRight_()),0===t(e,s.key)){if(s.right.isEmpty())return nr.EMPTY_NODE;i=s.right.min_(),s=s.copy(i.key,i.value,null,null,s.right.removeMin_())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,ir.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,ir.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}ir.RED=!0,ir.BLACK=!1;class nr{constructor(e,t=nr.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new nr(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,ir.BLACK,null,null))}remove(e){return new nr(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,ir.BLACK,null,null))}get(e){let t,s=this.root_;for(;!s.isEmpty();){if(t=this.comparator_(e,s.key),0===t)return s.value;t<0?s=s.left:t>0&&(s=s.right)}return null}getPredecessorKey(e){let t,s=this.root_,i=null;for(;!s.isEmpty();){if(t=this.comparator_(e,s.key),0===t){if(s.left.isEmpty())return i?i.key:null;for(s=s.left;!s.right.isEmpty();)s=s.right;return s.key}t<0?s=s.left:t>0&&(i=s,s=s.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new sr(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new sr(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new sr(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new sr(this.root_,null,this.comparator_,!0,e)}}function rr(e,t){return Yi(e.name,t.name)}function ar(e,t){return Yi(e,t)}let or;nr.EMPTY_NODE=new class{copy(e,t,s,i,n){return this}insert(e,t,s){return new ir(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const cr=function(e){return"number"==typeof e?"number:"+tn(e):"string:"+e},hr=function(e){if(e.isLeafNode()){const t=e.val();Pe("string"==typeof t||"number"==typeof t||"object"==typeof t&&We(t,".sv"),"Priority must be a string or number.")}else Pe(e===or||e.isEmpty(),"priority of unexpected type.");Pe(e===or||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let lr,pr,ur;class dr{constructor(e,t=dr.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,Pe(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),hr(this.priorityNode_)}static set __childrenNodeConstructor(e){lr=e}static get __childrenNodeConstructor(){return lr}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new dr(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:dr.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return zn(e)?this:".priority"===On(e)?this.priorityNode_:dr.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:dr.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const s=On(e);return null===s?t:t.isEmpty()&&".priority"!==s?this:(Pe(".priority"!==s||1===Mn(e),".priority must be the last token in a path"),this.updateImmediateChild(s,dr.__childrenNodeConstructor.EMPTY_NODE.updateChild(Rn(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+cr(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",e+="number"===t?tn(this.value_):this.value_,this.lazyHash_=Fi(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===dr.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof dr.__childrenNodeConstructor?-1:(Pe(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,s=typeof this.value_,i=dr.VALUE_TYPE_ORDER.indexOf(t),n=dr.VALUE_TYPE_ORDER.indexOf(s);return Pe(i>=0,"Unknown leaf type: "+t),Pe(n>=0,"Unknown leaf type: "+s),i===n?"object"===s?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:n-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}dr.VALUE_TYPE_ORDER=["object","boolean","number","string"];const fr=new class extends Zn{compare(e,t){const s=e.node.getPriority(),i=t.node.getPriority(),n=s.compareTo(i);return 0===n?Yi(e.name,t.name):n}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Xn.MIN}maxPost(){return new Xn(Gi,new dr("[PRIORITY-POST]",ur))}makePost(e,t){const s=pr(e);return new Xn(t,new dr("[PRIORITY-POST]",s))}toString(){return".priority"}},mr=Math.log(2);class yr{constructor(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/mr,10)),this.current_=this.count-1;const s=(i=this.count,parseInt(Array(i+1).join("1"),2));var i;this.bits_=e+1&s}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const gr=function(e,t,s,i){e.sort(t);const n=function(t,i){const r=i-t;let a,o;if(0===r)return null;if(1===r)return a=e[t],o=s?s(a):a,new ir(o,a.node,ir.BLACK,null,null);{const c=parseInt(r/2,10)+t,h=n(t,c),l=n(c+1,i);return a=e[c],o=s?s(a):a,new ir(o,a.node,ir.BLACK,h,l)}},r=function(t){let i=null,r=null,a=e.length;const o=function(t,i){const r=a-t,o=a;a-=t;const h=n(r+1,o),l=e[r],p=s?s(l):l;c(new ir(p,l.node,i,null,h))},c=function(e){i?(i.left=e,i=e):(r=e,i=e)};for(let e=0;e<t.count;++e){const s=t.nextBitIsOne(),i=Math.pow(2,t.count-(e+1));s?o(i,ir.BLACK):(o(i,ir.BLACK),o(i,ir.RED))}return r}(new yr(e.length));return new nr(i||t,r)};let br;const wr={};class _r{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return Pe(wr&&fr,"ChildrenNode.ts has not been loaded"),br=br||new _r({".priority":wr},{".priority":fr}),br}get(e){const t=Ke(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof nr?t:null}hasIndex(e){return We(this.indexSet_,e.toString())}addIndex(e,t){Pe(e!==tr,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const s=[];let i=!1;const n=t.getIterator(Xn.Wrap);let r,a=n.getNext();for(;a;)i=i||e.isDefinedOn(a.node),s.push(a),a=n.getNext();r=i?gr(s,e.getCompare()):wr;const o=e.toString(),c=Object.assign({},this.indexSet_);c[o]=e;const h=Object.assign({},this.indexes_);return h[o]=r,new _r(h,c)}addToIndexes(e,t){const s=Ye(this.indexes_,((s,i)=>{const n=Ke(this.indexSet_,i);if(Pe(n,"Missing index implementation for "+i),s===wr){if(n.isDefinedOn(e.node)){const s=[],i=t.getIterator(Xn.Wrap);let r=i.getNext();for(;r;)r.name!==e.name&&s.push(r),r=i.getNext();return s.push(e),gr(s,n.getCompare())}return wr}{const i=t.get(e.name);let n=s;return i&&(n=n.remove(new Xn(e.name,i))),n.insert(e,e.node)}}));return new _r(s,this.indexSet_)}removeFromIndexes(e,t){const s=Ye(this.indexes_,(s=>{if(s===wr)return s;{const i=t.get(e.name);return i?s.remove(new Xn(e.name,i)):s}}));return new _r(s,this.indexSet_)}}let xr;class vr{constructor(e,t,s){this.children_=e,this.priorityNode_=t,this.indexMap_=s,this.lazyHash_=null,this.priorityNode_&&hr(this.priorityNode_),this.children_.isEmpty()&&Pe(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return xr||(xr=new vr(new nr(ar),null,_r.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||xr}updatePriority(e){return this.children_.isEmpty()?this:new vr(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{const t=this.children_.get(e);return null===t?xr:t}}getChild(e){const t=On(e);return null===t?this:this.getImmediateChild(t).getChild(Rn(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(e,t){if(Pe(t,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(t);{const s=new Xn(e,t);let i,n;t.isEmpty()?(i=this.children_.remove(e),n=this.indexMap_.removeFromIndexes(s,this.children_)):(i=this.children_.insert(e,t),n=this.indexMap_.addToIndexes(s,this.children_));const r=i.isEmpty()?xr:this.priorityNode_;return new vr(i,r,n)}}updateChild(e,t){const s=On(e);if(null===s)return t;{Pe(".priority"!==On(e)||1===Mn(e),".priority must be the last token in a path");const i=this.getImmediateChild(s).updateChild(Rn(e),t);return this.updateImmediateChild(s,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let s=0,i=0,n=!0;if(this.forEachChild(fr,((r,a)=>{t[r]=a.val(e),s++,n&&vr.INTEGER_REGEXP_.test(r)?i=Math.max(i,Number(r)):n=!1})),!e&&n&&i<2*s){const e=[];for(const s in t)e[s]=t[s];return e}return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+cr(this.getPriority().val())+":"),this.forEachChild(fr,((t,s)=>{const i=s.hash();""!==i&&(e+=":"+t+":"+i)})),this.lazyHash_=""===e?"":Fi(e)}return this.lazyHash_}getPredecessorChildName(e,t,s){const i=this.resolveIndex_(s);if(i){const s=i.getPredecessorKey(new Xn(e,t));return s?s.name:null}return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.minKey();return e&&e.name}return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new Xn(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.maxKey();return e&&e.name}return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new Xn(t,this.children_.get(t)):null}forEachChild(e,t){const s=this.resolveIndex_(e);return s?s.inorderTraversal((e=>t(e.name,e.node))):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const s=this.resolveIndex_(t);if(s)return s.getIteratorFrom(e,(e=>e));{const s=this.children_.getIteratorFrom(e.name,Xn.Wrap);let i=s.peek();for(;null!=i&&t.compare(i,e)<0;)s.getNext(),i=s.peek();return s}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const s=this.resolveIndex_(t);if(s)return s.getReverseIteratorFrom(e,(e=>e));{const s=this.children_.getReverseIteratorFrom(e.name,Xn.Wrap);let i=s.peek();for(;null!=i&&t.compare(i,e)>0;)s.getNext(),i=s.peek();return s}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Tr?-1:0}withIndex(e){if(e===tr||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new vr(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===tr||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){const e=this.getIterator(fr),s=t.getIterator(fr);let i=e.getNext(),n=s.getNext();for(;i&&n;){if(i.name!==n.name||!i.node.equals(n.node))return!1;i=e.getNext(),n=s.getNext()}return null===i&&null===n}return!1}return!1}}resolveIndex_(e){return e===tr?null:this.indexMap_.get(e.toString())}}vr.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;const Tr=new class extends vr{constructor(){super(new nr(ar),vr.EMPTY_NODE,_r.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return vr.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(Xn,{MIN:{value:new Xn(Ki,vr.EMPTY_NODE)},MAX:{value:new Xn(Gi,Tr)}}),er.__EMPTY_NODE=vr.EMPTY_NODE,dr.__childrenNodeConstructor=vr,or=Tr,ur=Tr;const Pr=!0;function kr(e,t=null){if(null===e)return vr.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),Pe(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e)return new dr(e,kr(t));if(e instanceof Array||!Pr){let s=vr.EMPTY_NODE;return en(e,((t,i)=>{if(We(e,t)&&"."!==t.substring(0,1)){const e=kr(i);!e.isLeafNode()&&e.isEmpty()||(s=s.updateImmediateChild(t,e))}})),s.updatePriority(kr(t))}{const s=[];let i=!1;if(en(e,((e,t)=>{if("."!==e.substring(0,1)){const n=kr(t);n.isEmpty()||(i=i||!n.getPriority().isEmpty(),s.push(new Xn(e,n)))}})),0===s.length)return vr.EMPTY_NODE;const n=gr(s,rr,(e=>e.name),ar);if(i){const e=gr(s,fr.getCompare());return new vr(n,kr(t),new _r({".priority":e},{".priority":fr}))}return new vr(n,kr(t),_r.Default)}}!function(e){pr=e}(kr);class Cr extends Zn{constructor(e){super(),this.indexPath_=e,Pe(!zn(e)&&".priority"!==On(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const s=this.extractChild(e.node),i=this.extractChild(t.node),n=s.compareTo(i);return 0===n?Yi(e.name,t.name):n}makePost(e,t){const s=kr(e),i=vr.EMPTY_NODE.updateChild(this.indexPath_,s);return new Xn(t,i)}maxPost(){const e=vr.EMPTY_NODE.updateChild(this.indexPath_,Tr);return new Xn(Gi,e)}toString(){return Bn(this.indexPath_,0).join("/")}}const Er=new class extends Zn{compare(e,t){const s=e.node.compareTo(t.node);return 0===s?Yi(e.name,t.name):s}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Xn.MIN}maxPost(){return Xn.MAX}makePost(e,t){const s=kr(e);return new Xn(t,s)}toString(){return".value"}};function Ar(e){return{type:"value",snapshotNode:e}}function Sr(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function Ir(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function Nr(e,t,s){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:s}}class Lr{constructor(e){this.index_=e}updateChild(e,t,s,i,n,r){Pe(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(t);return a.getChild(i).equals(s.getChild(i))&&a.isEmpty()===s.isEmpty()?e:(null!=r&&(s.isEmpty()?e.hasChild(t)?r.trackChildChange(Ir(t,a)):Pe(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?r.trackChildChange(Sr(t,s)):r.trackChildChange(Nr(t,s,a))),e.isLeafNode()&&s.isEmpty()?e:e.updateImmediateChild(t,s).withIndex(this.index_))}updateFullNode(e,t,s){return null!=s&&(e.isLeafNode()||e.forEachChild(fr,((e,i)=>{t.hasChild(e)||s.trackChildChange(Ir(e,i))})),t.isLeafNode()||t.forEachChild(fr,((t,i)=>{if(e.hasChild(t)){const n=e.getImmediateChild(t);n.equals(i)||s.trackChildChange(Nr(t,i,n))}else s.trackChildChange(Sr(t,i))}))),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?vr.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class Dr{constructor(e){this.indexedFilter_=new Lr(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Dr.getStartPost_(e),this.endPost_=Dr.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,s=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&s}updateChild(e,t,s,i,n,r){return this.matches(new Xn(t,s))||(s=vr.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,s,i,n,r)}updateFullNode(e,t,s){t.isLeafNode()&&(t=vr.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(vr.EMPTY_NODE);const n=this;return t.forEachChild(fr,((e,t)=>{n.matches(new Xn(e,t))||(i=i.updateImmediateChild(e,vr.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(e,i,s)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class Or{constructor(e){this.withinDirectionalStart=e=>this.reverse_?this.withinEndPost(e):this.withinStartPost(e),this.withinDirectionalEnd=e=>this.reverse_?this.withinStartPost(e):this.withinEndPost(e),this.withinStartPost=e=>{const t=this.index_.compare(this.rangedFilter_.getStartPost(),e);return this.startIsInclusive_?t<=0:t<0},this.withinEndPost=e=>{const t=this.index_.compare(e,this.rangedFilter_.getEndPost());return this.endIsInclusive_?t<=0:t<0},this.rangedFilter_=new Dr(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,s,i,n,r){return this.rangedFilter_.matches(new Xn(t,s))||(s=vr.EMPTY_NODE),e.getImmediateChild(t).equals(s)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,s,i,n,r):this.fullLimitUpdateChild_(e,t,s,n,r)}updateFullNode(e,t,s){let i;if(t.isLeafNode()||t.isEmpty())i=vr.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let e;i=vr.EMPTY_NODE.withIndex(this.index_),e=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let s=0;for(;e.hasNext()&&s<this.limit_;){const t=e.getNext();if(this.withinDirectionalStart(t)){if(!this.withinDirectionalEnd(t))break;i=i.updateImmediateChild(t.name,t.node),s++}}}else{let e;i=t.withIndex(this.index_),i=i.updatePriority(vr.EMPTY_NODE),e=this.reverse_?i.getReverseIterator(this.index_):i.getIterator(this.index_);let s=0;for(;e.hasNext();){const t=e.getNext();s<this.limit_&&this.withinDirectionalStart(t)&&this.withinDirectionalEnd(t)?s++:i=i.updateImmediateChild(t.name,vr.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,s)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,s,i,n){let r;if(this.reverse_){const e=this.index_.getCompare();r=(t,s)=>e(s,t)}else r=this.index_.getCompare();const a=e;Pe(a.numChildren()===this.limit_,"");const o=new Xn(t,s),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),h=this.rangedFilter_.matches(o);if(a.hasChild(t)){const e=a.getImmediateChild(t);let l=i.getChildAfterChild(this.index_,c,this.reverse_);for(;null!=l&&(l.name===t||a.hasChild(l.name));)l=i.getChildAfterChild(this.index_,l,this.reverse_);const p=null==l?1:r(l,o);if(h&&!s.isEmpty()&&p>=0)return null!=n&&n.trackChildChange(Nr(t,s,e)),a.updateImmediateChild(t,s);{null!=n&&n.trackChildChange(Ir(t,e));const s=a.updateImmediateChild(t,vr.EMPTY_NODE);return null!=l&&this.rangedFilter_.matches(l)?(null!=n&&n.trackChildChange(Sr(l.name,l.node)),s.updateImmediateChild(l.name,l.node)):s}}return s.isEmpty()?e:h&&r(c,o)>=0?(null!=n&&(n.trackChildChange(Ir(c.name,c.node)),n.trackChildChange(Sr(t,s))),a.updateImmediateChild(t,s).updateImmediateChild(c.name,vr.EMPTY_NODE)):e}}class Mr{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=fr}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return Pe(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return Pe(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Ki}hasEnd(){return this.endSet_}getIndexEndValue(){return Pe(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return Pe(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Gi}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return Pe(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===fr}copy(){const e=new Mr;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function Rr(e){const t={};if(e.isDefault())return t;let s;if(e.index_===fr?s="$priority":e.index_===Er?s="$value":e.index_===tr?s="$key":(Pe(e.index_ instanceof Cr,"Unrecognized index type!"),s=e.index_.toString()),t.orderBy=Ve(s),e.startSet_){const s=e.startAfterSet_?"startAfter":"startAt";t[s]=Ve(e.indexStartValue_),e.startNameSet_&&(t[s]+=","+Ve(e.indexStartName_))}if(e.endSet_){const s=e.endBeforeSet_?"endBefore":"endAt";t[s]=Ve(e.indexEndValue_),e.endNameSet_&&(t[s]+=","+Ve(e.indexEndName_))}return e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function Fr(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_),t.sin=!e.startAfterSet_),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_),t.ein=!e.endBeforeSet_),e.limitSet_){t.l=e.limit_;let s=e.viewFrom_;""===s&&(s=e.isViewFromLeft()?"l":"r"),t.vf=s}return e.index_!==fr&&(t.i=e.index_.toString()),t}class Br extends Sn{constructor(e,t,s,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=s,this.appCheckTokenProvider_=i,this.log_=qi("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:(Pe(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,s,i){const n=e._path.toString();this.log_("Listen called for "+n+" "+e._queryIdentifier);const r=Br.getListenId_(e,s),a={};this.listens_[r]=a;const o=Rr(e._queryParams);this.restRequest_(n+".json",o,((e,t)=>{let o=t;if(404===e&&(o=null,e=null),null===e&&this.onDataUpdate_(n,o,!1,s),Ke(this.listens_,r)===a){let t;t=e?401===e?"permission_denied":"rest_error:"+e:"ok",i(t,null)}}))}unlisten(e,t){const s=Br.getListenId_(e,t);delete this.listens_[s]}get(e){const t=Rr(e._queryParams),s=e._path.toString(),i=new Re;return this.restRequest_(s+".json",t,((e,t)=>{let n=t;404===e&&(n=null,e=null),null===e?(this.onDataUpdate_(s,n,!1,null),i.resolve(n)):i.reject(new Error(n))})),i.promise}refreshAuthToken(e){}restRequest_(e,t={},s){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((([i,n])=>{i&&i.accessToken&&(t.auth=i.accessToken),n&&n.token&&(t.ac=n.token);const r=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+function(e){const t=[];for(const[s,i]of Object.entries(e))Array.isArray(i)?i.forEach((e=>{t.push(encodeURIComponent(s)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(s)+"="+encodeURIComponent(i));return t.length?"&"+t.join("&"):""}(t);this.log_("Sending REST request for "+r);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(s&&4===a.readyState){this.log_("REST Response for "+r+" received. status:",a.status,"response:",a.responseText);let e=null;if(a.status>=200&&a.status<300){try{e=He(a.responseText)}catch(e){$i("Failed to parse JSON response for "+r+": "+a.responseText)}s(null,e)}else 401!==a.status&&404!==a.status&&$i("Got unsuccessful REST response for "+r+" Status: "+a.status),s(a.status);s=null}},a.open("GET",r,!0),a.send()}))}}class jr{constructor(){this.rootNode_=vr.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function Ur(){return{value:null,children:new Map}}function zr(e,t,s){if(zn(t))e.value=s,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,s);else{const i=On(t);e.children.has(i)||e.children.set(i,Ur()),zr(e.children.get(i),t=Rn(t),s)}}function qr(e,t,s){null!==e.value?s(t,e.value):function(e,t){e.children.forEach(((e,s)=>{t(s,e)}))}(e,((e,i)=>{qr(i,new Ln(t.toString()+"/"+e),s)}))}class Hr{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&en(this.last_,((e,s)=>{t[e]=t[e]-s})),this.last_=e,t}}class Vr{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Hr(e);const s=1e4+2e4*Math.random();an(this.reportStats_.bind(this),Math.floor(s))}reportStats_(){const e=this.statsListener_.get(),t={};let s=!1;en(e,((e,i)=>{i>0&&We(this.statsToReport_,e)&&(t[e]=i,s=!0)})),s&&this.server_.reportStats(t),an(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var $r;function Wr(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}($r||($r={}));class Kr{constructor(e,t,s){this.path=e,this.affectedTree=t,this.revert=s,this.type=$r.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(zn(this.path)){if(null!=this.affectedTree.value)return Pe(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new Ln(e));return new Kr(Dn(),t,this.revert)}}return Pe(On(this.path)===e,"operationForChild called for unrelated child."),new Kr(Rn(this.path),this.affectedTree,this.revert)}}class Gr{constructor(e,t){this.source=e,this.path=t,this.type=$r.LISTEN_COMPLETE}operationForChild(e){return zn(this.path)?new Gr(this.source,Dn()):new Gr(this.source,Rn(this.path))}}class Yr{constructor(e,t,s){this.source=e,this.path=t,this.snap=s,this.type=$r.OVERWRITE}operationForChild(e){return zn(this.path)?new Yr(this.source,Dn(),this.snap.getImmediateChild(e)):new Yr(this.source,Rn(this.path),this.snap)}}class Jr{constructor(e,t,s){this.source=e,this.path=t,this.children=s,this.type=$r.MERGE}operationForChild(e){if(zn(this.path)){const t=this.children.subtree(new Ln(e));return t.isEmpty()?null:t.value?new Yr(this.source,Dn(),t.value):new Jr(this.source,Dn(),t)}return Pe(On(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Jr(this.source,Rn(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class Xr{constructor(e,t,s){this.node_=e,this.fullyInitialized_=t,this.filtered_=s}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(zn(e))return this.isFullyInitialized()&&!this.filtered_;const t=On(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class Zr{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function Qr(e,t,s,i,n,r){const a=i.filter((e=>e.type===s));a.sort(((t,s)=>function(e,t,s){if(null==t.childName||null==s.childName)throw ke("Should only compare child_ events.");const i=new Xn(t.childName,t.snapshotNode),n=new Xn(s.childName,s.snapshotNode);return e.index_.compare(i,n)}(e,t,s))),a.forEach((s=>{const i=function(e,t,s){return"value"===t.type||"child_removed"===t.type||(t.prevName=s.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,s,r);n.forEach((n=>{n.respondsTo(s.type)&&t.push(n.createEvent(i,e.query_))}))}))}function ea(e,t){return{eventCache:e,serverCache:t}}function ta(e,t,s,i){return ea(new Xr(t,s,i),e.serverCache)}function sa(e,t,s,i){return ea(e.eventCache,new Xr(t,s,i))}function ia(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function na(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}let ra;class aa{constructor(e,t=(()=>(ra||(ra=new nr(Ji)),ra))()){this.value=e,this.children=t}static fromObject(e){let t=new aa(null);return en(e,((e,s)=>{t=t.set(new Ln(e),s)})),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:Dn(),value:this.value};if(zn(e))return null;{const s=On(e),i=this.children.get(s);if(null!==i){const n=i.findRootMostMatchingPathAndValue(Rn(e),t);return null!=n?{path:Un(new Ln(s),n.path),value:n.value}:null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,(()=>!0))}subtree(e){if(zn(e))return this;{const t=On(e),s=this.children.get(t);return null!==s?s.subtree(Rn(e)):new aa(null)}}set(e,t){if(zn(e))return new aa(t,this.children);{const s=On(e),i=(this.children.get(s)||new aa(null)).set(Rn(e),t),n=this.children.insert(s,i);return new aa(this.value,n)}}remove(e){if(zn(e))return this.children.isEmpty()?new aa(null):new aa(null,this.children);{const t=On(e),s=this.children.get(t);if(s){const i=s.remove(Rn(e));let n;return n=i.isEmpty()?this.children.remove(t):this.children.insert(t,i),null===this.value&&n.isEmpty()?new aa(null):new aa(this.value,n)}return this}}get(e){if(zn(e))return this.value;{const t=On(e),s=this.children.get(t);return s?s.get(Rn(e)):null}}setTree(e,t){if(zn(e))return t;{const s=On(e),i=(this.children.get(s)||new aa(null)).setTree(Rn(e),t);let n;return n=i.isEmpty()?this.children.remove(s):this.children.insert(s,i),new aa(this.value,n)}}fold(e){return this.fold_(Dn(),e)}fold_(e,t){const s={};return this.children.inorderTraversal(((i,n)=>{s[i]=n.fold_(Un(e,i),t)})),t(e,this.value,s)}findOnPath(e,t){return this.findOnPath_(e,Dn(),t)}findOnPath_(e,t,s){const i=!!this.value&&s(t,this.value);if(i)return i;if(zn(e))return null;{const i=On(e),n=this.children.get(i);return n?n.findOnPath_(Rn(e),Un(t,i),s):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Dn(),t)}foreachOnPath_(e,t,s){if(zn(e))return this;{this.value&&s(t,this.value);const i=On(e),n=this.children.get(i);return n?n.foreachOnPath_(Rn(e),Un(t,i),s):new aa(null)}}foreach(e){this.foreach_(Dn(),e)}foreach_(e,t){this.children.inorderTraversal(((s,i)=>{i.foreach_(Un(e,s),t)})),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal(((t,s)=>{s.value&&e(t,s.value)}))}}class oa{constructor(e){this.writeTree_=e}static empty(){return new oa(new aa(null))}}function ca(e,t,s){if(zn(t))return new oa(new aa(s));{const i=e.writeTree_.findRootMostValueAndPath(t);if(null!=i){const n=i.path;let r=i.value;const a=qn(n,t);return r=r.updateChild(a,s),new oa(e.writeTree_.set(n,r))}{const i=new aa(s),n=e.writeTree_.setTree(t,i);return new oa(n)}}}function ha(e,t,s){let i=e;return en(s,((e,s)=>{i=ca(i,Un(t,e),s)})),i}function la(e,t){if(zn(t))return oa.empty();{const s=e.writeTree_.setTree(t,new aa(null));return new oa(s)}}function pa(e,t){return null!=ua(e,t)}function ua(e,t){const s=e.writeTree_.findRootMostValueAndPath(t);return null!=s?e.writeTree_.get(s.path).getChild(qn(s.path,t)):null}function da(e){const t=[],s=e.writeTree_.value;return null!=s?s.isLeafNode()||s.forEachChild(fr,((e,s)=>{t.push(new Xn(e,s))})):e.writeTree_.children.inorderTraversal(((e,s)=>{null!=s.value&&t.push(new Xn(e,s.value))})),t}function fa(e,t){if(zn(t))return e;{const s=ua(e,t);return new oa(null!=s?new aa(s):e.writeTree_.subtree(t))}}function ma(e){return e.writeTree_.isEmpty()}function ya(e,t){return ga(Dn(),e.writeTree_,t)}function ga(e,t,s){if(null!=t.value)return s.updateChild(e,t.value);{let i=null;return t.children.inorderTraversal(((t,n)=>{".priority"===t?(Pe(null!==n.value,"Priority writes must always be leaf nodes"),i=n.value):s=ga(Un(e,t),n,s)})),s.getChild(e).isEmpty()||null===i||(s=s.updateChild(Un(e,".priority"),i)),s}}function ba(e,t){return Sa(t,e)}function wa(e,t){if(e.snap)return Vn(e.path,t);for(const s in e.children)if(e.children.hasOwnProperty(s)&&Vn(Un(e.path,s),t))return!0;return!1}function _a(e){return e.visible}function xa(e,t,s){let i=oa.empty();for(let n=0;n<e.length;++n){const r=e[n];if(t(r)){const e=r.path;let t;if(r.snap)Vn(s,e)?(t=qn(s,e),i=ca(i,t,r.snap)):Vn(e,s)&&(t=qn(e,s),i=ca(i,Dn(),r.snap.getChild(t)));else{if(!r.children)throw ke("WriteRecord should have .snap or .children");if(Vn(s,e))t=qn(s,e),i=ha(i,t,r.children);else if(Vn(e,s))if(t=qn(e,s),zn(t))i=ha(i,Dn(),r.children);else{const e=Ke(r.children,On(t));if(e){const s=e.getChild(Rn(t));i=ca(i,Dn(),s)}}}}}return i}function va(e,t,s,i,n){if(i||n){const r=fa(e.visibleWrites,t);if(!n&&ma(r))return s;if(n||null!=s||pa(r,Dn())){const r=function(e){return(e.visible||n)&&(!i||!~i.indexOf(e.writeId))&&(Vn(e.path,t)||Vn(t,e.path))};return ya(xa(e.allWrites,r,t),s||vr.EMPTY_NODE)}return null}{const i=ua(e.visibleWrites,t);if(null!=i)return i;{const i=fa(e.visibleWrites,t);return ma(i)?s:null!=s||pa(i,Dn())?ya(i,s||vr.EMPTY_NODE):null}}}function Ta(e,t,s,i){return va(e.writeTree,e.treePath,t,s,i)}function Pa(e,t){return function(e,t,s){let i=vr.EMPTY_NODE;const n=ua(e.visibleWrites,t);if(n)return n.isLeafNode()||n.forEachChild(fr,((e,t)=>{i=i.updateImmediateChild(e,t)})),i;if(s){const n=fa(e.visibleWrites,t);return s.forEachChild(fr,((e,t)=>{const s=ya(fa(n,new Ln(e)),t);i=i.updateImmediateChild(e,s)})),da(n).forEach((e=>{i=i.updateImmediateChild(e.name,e.node)})),i}return da(fa(e.visibleWrites,t)).forEach((e=>{i=i.updateImmediateChild(e.name,e.node)})),i}(e.writeTree,e.treePath,t)}function ka(e,t,s,i){return function(e,t,s,i,n){Pe(i||n,"Either existingEventSnap or existingServerSnap must exist");const r=Un(t,s);if(pa(e.visibleWrites,r))return null;{const t=fa(e.visibleWrites,r);return ma(t)?n.getChild(s):ya(t,n.getChild(s))}}(e.writeTree,e.treePath,t,s,i)}function Ca(e,t){return function(e,t){return ua(e.visibleWrites,t)}(e.writeTree,Un(e.treePath,t))}function Ea(e,t,s){return function(e,t,s,i){const n=Un(t,s),r=ua(e.visibleWrites,n);return null!=r?r:i.isCompleteForChild(s)?ya(fa(e.visibleWrites,n),i.getNode().getImmediateChild(s)):null}(e.writeTree,e.treePath,t,s)}function Aa(e,t){return Sa(Un(e.treePath,t),e.writeTree)}function Sa(e,t){return{treePath:e,writeTree:t}}class Ia{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,s=e.childName;Pe("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),Pe(".priority"!==s,"Only non-priority child changes can be tracked.");const i=this.changeMap.get(s);if(i){const n=i.type;if("child_added"===t&&"child_removed"===n)this.changeMap.set(s,Nr(s,e.snapshotNode,i.snapshotNode));else if("child_removed"===t&&"child_added"===n)this.changeMap.delete(s);else if("child_removed"===t&&"child_changed"===n)this.changeMap.set(s,Ir(s,i.oldSnap));else if("child_changed"===t&&"child_added"===n)this.changeMap.set(s,Sr(s,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==n)throw ke("Illegal combination of changes: "+e+" occurred after "+i);this.changeMap.set(s,Nr(s,e.snapshotNode,i.oldSnap))}}else this.changeMap.set(s,e)}getChanges(){return Array.from(this.changeMap.values())}}const Na=new class{getCompleteChild(e){return null}getChildAfterChild(e,t,s){return null}};class La{constructor(e,t,s=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=s}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const t=null!=this.optCompleteServerCache_?new Xr(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Ea(this.writes_,e,t)}}getChildAfterChild(e,t,s){const i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:na(this.viewCache_),n=function(e,t,s,i,n,r){return function(e,t,s,i,n,r,a){let o;const c=fa(e.visibleWrites,t),h=ua(c,Dn());if(null!=h)o=h;else{if(null==s)return[];o=ya(c,s)}if(o=o.withIndex(a),o.isEmpty()||o.isLeafNode())return[];{const e=[],t=a.getCompare(),s=r?o.getReverseIteratorFrom(i,a):o.getIteratorFrom(i,a);let c=s.getNext();for(;c&&e.length<n;)0!==t(c,i)&&e.push(c),c=s.getNext();return e}}(e.writeTree,e.treePath,t,s,i,n,r)}(this.writes_,i,t,1,s,e);return 0===n.length?null:n[0]}}function Da(e,t,s,i,n,r){const a=t.eventCache;if(null!=Ca(i,s))return t;{let o,c;if(zn(s))if(Pe(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const s=na(t),n=Pa(i,s instanceof vr?s:vr.EMPTY_NODE);o=e.filter.updateFullNode(t.eventCache.getNode(),n,r)}else{const s=Ta(i,na(t));o=e.filter.updateFullNode(t.eventCache.getNode(),s,r)}else{const h=On(s);if(".priority"===h){Pe(1===Mn(s),"Can't have a priority with additional path components");const n=a.getNode();c=t.serverCache.getNode();const r=ka(i,s,n,c);o=null!=r?e.filter.updatePriority(n,r):a.getNode()}else{const l=Rn(s);let p;if(a.isCompleteForChild(h)){c=t.serverCache.getNode();const e=ka(i,s,a.getNode(),c);p=null!=e?a.getNode().getImmediateChild(h).updateChild(l,e):a.getNode().getImmediateChild(h)}else p=Ea(i,h,t.serverCache);o=null!=p?e.filter.updateChild(a.getNode(),h,p,l,n,r):a.getNode()}}return ta(t,o,a.isFullyInitialized()||zn(s),e.filter.filtersNodes())}}function Oa(e,t,s,i,n,r,a,o){const c=t.serverCache;let h;const l=a?e.filter:e.filter.getIndexedFilter();if(zn(s))h=l.updateFullNode(c.getNode(),i,null);else if(l.filtersNodes()&&!c.isFiltered()){const e=c.getNode().updateChild(s,i);h=l.updateFullNode(c.getNode(),e,null)}else{const e=On(s);if(!c.isCompleteForPath(s)&&Mn(s)>1)return t;const n=Rn(s),r=c.getNode().getImmediateChild(e).updateChild(n,i);h=".priority"===e?l.updatePriority(c.getNode(),r):l.updateChild(c.getNode(),e,r,n,Na,null)}const p=sa(t,h,c.isFullyInitialized()||zn(s),l.filtersNodes());return Da(e,p,s,n,new La(n,p,r),o)}function Ma(e,t,s,i,n,r,a){const o=t.eventCache;let c,h;const l=new La(n,t,r);if(zn(s))h=e.filter.updateFullNode(t.eventCache.getNode(),i,a),c=ta(t,h,!0,e.filter.filtersNodes());else{const n=On(s);if(".priority"===n)h=e.filter.updatePriority(t.eventCache.getNode(),i),c=ta(t,h,o.isFullyInitialized(),o.isFiltered());else{const r=Rn(s),h=o.getNode().getImmediateChild(n);let p;if(zn(r))p=i;else{const e=l.getCompleteChild(n);p=null!=e?".priority"===Fn(r)&&e.getChild(jn(r)).isEmpty()?e:e.updateChild(r,i):vr.EMPTY_NODE}c=h.equals(p)?t:ta(t,e.filter.updateChild(o.getNode(),n,p,r,l,a),o.isFullyInitialized(),e.filter.filtersNodes())}}return c}function Ra(e,t){return e.eventCache.isCompleteForChild(t)}function Fa(e,t,s){return s.foreach(((e,s)=>{t=t.updateChild(e,s)})),t}function Ba(e,t,s,i,n,r,a,o){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let c,h=t;c=zn(s)?i:new aa(null).setTree(s,i);const l=t.serverCache.getNode();return c.children.inorderTraversal(((s,i)=>{if(l.hasChild(s)){const c=Fa(0,t.serverCache.getNode().getImmediateChild(s),i);h=Oa(e,h,new Ln(s),c,n,r,a,o)}})),c.children.inorderTraversal(((s,i)=>{const c=!t.serverCache.isCompleteForChild(s)&&null===i.value;if(!l.hasChild(s)&&!c){const c=Fa(0,t.serverCache.getNode().getImmediateChild(s),i);h=Oa(e,h,new Ln(s),c,n,r,a,o)}})),h}class ja{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const s=this.query_._queryParams,i=new Lr(s.getIndex()),n=(r=s).loadsAllData()?new Lr(r.getIndex()):r.hasLimit()?new Or(r):new Dr(r);var r;this.processor_=function(e){return{filter:e}}(n);const a=t.serverCache,o=t.eventCache,c=i.updateFullNode(vr.EMPTY_NODE,a.getNode(),null),h=n.updateFullNode(vr.EMPTY_NODE,o.getNode(),null),l=new Xr(c,a.isFullyInitialized(),i.filtersNodes()),p=new Xr(h,o.isFullyInitialized(),n.filtersNodes());this.viewCache_=ea(p,l),this.eventGenerator_=new Zr(this.query_)}get query(){return this.query_}}function Ua(e,t){const s=na(e.viewCache_);return s&&(e.query._queryParams.loadsAllData()||!zn(t)&&!s.getImmediateChild(On(t)).isEmpty())?s.getChild(t):null}function za(e){return 0===e.eventRegistrations_.length}function qa(e,t,s){const i=[];if(s){Pe(null==t,"A cancel should cancel all event registrations.");const n=e.query._path;e.eventRegistrations_.forEach((e=>{const t=e.createCancelEvent(s,n);t&&i.push(t)}))}if(t){let s=[];for(let i=0;i<e.eventRegistrations_.length;++i){const n=e.eventRegistrations_[i];if(n.matches(t)){if(t.hasAnyCallback()){s=s.concat(e.eventRegistrations_.slice(i+1));break}}else s.push(n)}e.eventRegistrations_=s}else e.eventRegistrations_=[];return i}function Ha(e,t,s,i){t.type===$r.MERGE&&null!==t.source.queryId&&(Pe(na(e.viewCache_),"We should always have a full cache before handling merges"),Pe(ia(e.viewCache_),"Missing event cache, even though we have a server cache"));const n=e.viewCache_,r=function(e,t,s,i,n){const r=new Ia;let a,o;if(s.type===$r.OVERWRITE){const c=s;c.source.fromUser?a=Ma(e,t,c.path,c.snap,i,n,r):(Pe(c.source.fromServer,"Unknown source."),o=c.source.tagged||t.serverCache.isFiltered()&&!zn(c.path),a=Oa(e,t,c.path,c.snap,i,n,o,r))}else if(s.type===$r.MERGE){const c=s;c.source.fromUser?a=function(e,t,s,i,n,r,a){let o=t;return i.foreach(((i,c)=>{const h=Un(s,i);Ra(t,On(h))&&(o=Ma(e,o,h,c,n,r,a))})),i.foreach(((i,c)=>{const h=Un(s,i);Ra(t,On(h))||(o=Ma(e,o,h,c,n,r,a))})),o}(e,t,c.path,c.children,i,n,r):(Pe(c.source.fromServer,"Unknown source."),o=c.source.tagged||t.serverCache.isFiltered(),a=Ba(e,t,c.path,c.children,i,n,o,r))}else if(s.type===$r.ACK_USER_WRITE){const o=s;a=o.revert?function(e,t,s,i,n,r){let a;if(null!=Ca(i,s))return t;{const o=new La(i,t,n),c=t.eventCache.getNode();let h;if(zn(s)||".priority"===On(s)){let s;if(t.serverCache.isFullyInitialized())s=Ta(i,na(t));else{const e=t.serverCache.getNode();Pe(e instanceof vr,"serverChildren would be complete if leaf node"),s=Pa(i,e)}h=e.filter.updateFullNode(c,s,r)}else{const n=On(s);let l=Ea(i,n,t.serverCache);null==l&&t.serverCache.isCompleteForChild(n)&&(l=c.getImmediateChild(n)),h=null!=l?e.filter.updateChild(c,n,l,Rn(s),o,r):t.eventCache.getNode().hasChild(n)?e.filter.updateChild(c,n,vr.EMPTY_NODE,Rn(s),o,r):c,h.isEmpty()&&t.serverCache.isFullyInitialized()&&(a=Ta(i,na(t)),a.isLeafNode()&&(h=e.filter.updateFullNode(h,a,r)))}return a=t.serverCache.isFullyInitialized()||null!=Ca(i,Dn()),ta(t,h,a,e.filter.filtersNodes())}}(e,t,o.path,i,n,r):function(e,t,s,i,n,r,a){if(null!=Ca(n,s))return t;const o=t.serverCache.isFiltered(),c=t.serverCache;if(null!=i.value){if(zn(s)&&c.isFullyInitialized()||c.isCompleteForPath(s))return Oa(e,t,s,c.getNode().getChild(s),n,r,o,a);if(zn(s)){let i=new aa(null);return c.getNode().forEachChild(tr,((e,t)=>{i=i.set(new Ln(e),t)})),Ba(e,t,s,i,n,r,o,a)}return t}{let h=new aa(null);return i.foreach(((e,t)=>{const i=Un(s,e);c.isCompleteForPath(i)&&(h=h.set(e,c.getNode().getChild(i)))})),Ba(e,t,s,h,n,r,o,a)}}(e,t,o.path,o.affectedTree,i,n,r)}else{if(s.type!==$r.LISTEN_COMPLETE)throw ke("Unknown operation type: "+s.type);a=function(e,t,s,i,n){const r=t.serverCache;return Da(e,sa(t,r.getNode(),r.isFullyInitialized()||zn(s),r.isFiltered()),s,i,Na,n)}(e,t,s.path,i,r)}const c=r.getChanges();return function(e,t,s){const i=t.eventCache;if(i.isFullyInitialized()){const n=i.getNode().isLeafNode()||i.getNode().isEmpty(),r=ia(e);(s.length>0||!e.eventCache.isFullyInitialized()||n&&!i.getNode().equals(r)||!i.getNode().getPriority().equals(r.getPriority()))&&s.push(Ar(ia(t)))}}(t,a,c),{viewCache:a,changes:c}}(e.processor_,n,t,s,i);var a,o;return a=e.processor_,o=r.viewCache,Pe(o.eventCache.getNode().isIndexed(a.filter.getIndex()),"Event snap not indexed"),Pe(o.serverCache.getNode().isIndexed(a.filter.getIndex()),"Server snap not indexed"),Pe(r.viewCache.serverCache.isFullyInitialized()||!n.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=r.viewCache,Va(e,r.changes,r.viewCache.eventCache.getNode(),null)}function Va(e,t,s,i){const n=i?[i]:e.eventRegistrations_;return function(e,t,s,i){const n=[],r=[];return t.forEach((t=>{var s;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&r.push((s=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:s}))})),Qr(e,n,"child_removed",t,i,s),Qr(e,n,"child_added",t,i,s),Qr(e,n,"child_moved",r,i,s),Qr(e,n,"child_changed",t,i,s),Qr(e,n,"value",t,i,s),n}(e.eventGenerator_,t,s,n)}let $a,Wa;class Ka{constructor(){this.views=new Map}}function Ga(e,t,s,i){const n=t.source.queryId;if(null!==n){const r=e.views.get(n);return Pe(null!=r,"SyncTree gave us an op for an invalid query."),Ha(r,t,s,i)}{let n=[];for(const r of e.views.values())n=n.concat(Ha(r,t,s,i));return n}}function Ya(e,t,s,i,n){const r=t._queryIdentifier,a=e.views.get(r);if(!a){let e=Ta(s,n?i:null),r=!1;e?r=!0:i instanceof vr?(e=Pa(s,i),r=!1):(e=vr.EMPTY_NODE,r=!1);const a=ea(new Xr(e,r,!1),new Xr(i,n,!1));return new ja(t,a)}return a}function Ja(e){const t=[];for(const s of e.views.values())s.query._queryParams.loadsAllData()||t.push(s);return t}function Xa(e,t){let s=null;for(const i of e.views.values())s=s||Ua(i,t);return s}function Za(e,t){if(t._queryParams.loadsAllData())return to(e);{const s=t._queryIdentifier;return e.views.get(s)}}function Qa(e,t){return null!=Za(e,t)}function eo(e){return null!=to(e)}function to(e){for(const t of e.views.values())if(t.query._queryParams.loadsAllData())return t;return null}let so=1;class io{constructor(e){this.listenProvider_=e,this.syncPointTree_=new aa(null),this.pendingWriteTree_={visibleWrites:oa.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function no(e,t,s,i,n){return function(e,t,s,i,n){Pe(i>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===n&&(n=!0),e.allWrites.push({path:t,snap:s,writeId:i,visible:n}),n&&(e.visibleWrites=ca(e.visibleWrites,t,s)),e.lastWriteId=i}(e.pendingWriteTree_,t,s,i,n),n?po(e,new Yr({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,s)):[]}function ro(e,t,s=!1){const i=function(e,t){for(let s=0;s<e.allWrites.length;s++){const i=e.allWrites[s];if(i.writeId===t)return i}return null}(e.pendingWriteTree_,t);if(function(e,t){const s=e.allWrites.findIndex((e=>e.writeId===t));Pe(s>=0,"removeWrite called with nonexistent writeId.");const i=e.allWrites[s];e.allWrites.splice(s,1);let n=i.visible,r=!1,a=e.allWrites.length-1;for(;n&&a>=0;){const t=e.allWrites[a];t.visible&&(a>=s&&wa(t,i.path)?n=!1:Vn(i.path,t.path)&&(r=!0)),a--}return!!n&&(r?(function(e){e.visibleWrites=xa(e.allWrites,_a,Dn()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0):(i.snap?e.visibleWrites=la(e.visibleWrites,i.path):en(i.children,(t=>{e.visibleWrites=la(e.visibleWrites,Un(i.path,t))})),!0))}(e.pendingWriteTree_,t)){let t=new aa(null);return null!=i.snap?t=t.set(Dn(),!0):en(i.children,(e=>{t=t.set(new Ln(e),!0)})),po(e,new Kr(i.path,t,s))}return[]}function ao(e,t,s){return po(e,new Yr({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,s))}function oo(e,t,s,i,n=!1){const r=t._path,a=e.syncPointTree_.get(r);let o=[];if(a&&("default"===t._queryIdentifier||Qa(a,t))){const c=function(e,t,s,i){const n=t._queryIdentifier,r=[];let a=[];const o=eo(e);if("default"===n)for(const[t,n]of e.views.entries())a=a.concat(qa(n,s,i)),za(n)&&(e.views.delete(t),n.query._queryParams.loadsAllData()||r.push(n.query));else{const t=e.views.get(n);t&&(a=a.concat(qa(t,s,i)),za(t)&&(e.views.delete(n),t.query._queryParams.loadsAllData()||r.push(t.query)))}return o&&!eo(e)&&r.push(new(Pe($a,"Reference.ts has not been loaded"),$a)(t._repo,t._path)),{removed:r,events:a}}(a,t,s,i);0===a.views.size&&(e.syncPointTree_=e.syncPointTree_.remove(r));const h=c.removed;if(o=c.events,!n){const s=-1!==h.findIndex((e=>e._queryParams.loadsAllData())),n=e.syncPointTree_.findOnPath(r,((e,t)=>eo(t)));if(s&&!n){const t=e.syncPointTree_.subtree(r);if(!t.isEmpty()){const s=function(e){return e.fold(((e,t,s)=>{if(t&&eo(t))return[to(t)];{let e=[];return t&&(e=Ja(t)),en(s,((t,s)=>{e=e.concat(s)})),e}}))}(t);for(let t=0;t<s.length;++t){const i=s[t],n=i.query,r=mo(e,i);e.listenProvider_.startListening(xo(n),yo(e,n),r.hashFn,r.onComplete)}}}if(!n&&h.length>0&&!i)if(s){const s=null;e.listenProvider_.stopListening(xo(t),s)}else h.forEach((t=>{const s=e.queryToTagMap.get(go(t));e.listenProvider_.stopListening(xo(t),s)}))}!function(e,t){for(let s=0;s<t.length;++s){const i=t[s];if(!i._queryParams.loadsAllData()){const t=go(i),s=e.queryToTagMap.get(t);e.queryToTagMap.delete(t),e.tagToQueryMap.delete(s)}}}(e,h)}return o}function co(e,t,s,i){const n=bo(e,i);if(null!=n){const i=wo(n),r=i.path,a=i.queryId,o=qn(r,t);return _o(e,r,new Yr(Wr(a),o,s))}return[]}function ho(e,t,s,i=!1){const n=t._path;let r=null,a=!1;e.syncPointTree_.foreachOnPath(n,((e,t)=>{const s=qn(e,n);r=r||Xa(t,s),a=a||eo(t)}));let o,c=e.syncPointTree_.get(n);c?(a=a||eo(c),r=r||Xa(c,Dn())):(c=new Ka,e.syncPointTree_=e.syncPointTree_.set(n,c)),null!=r?o=!0:(o=!1,r=vr.EMPTY_NODE,e.syncPointTree_.subtree(n).foreachChild(((e,t)=>{const s=Xa(t,Dn());s&&(r=r.updateImmediateChild(e,s))})));const h=Qa(c,t);if(!h&&!t._queryParams.loadsAllData()){const s=go(t);Pe(!e.queryToTagMap.has(s),"View does not exist, but we have a tag");const i=so++;e.queryToTagMap.set(s,i),e.tagToQueryMap.set(i,s)}let l=function(e,t,s,i,n,r){const a=Ya(e,t,i,n,r);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,a),function(e,t){e.eventRegistrations_.push(t)}(a,s),function(e,t){const s=e.viewCache_.eventCache,i=[];return s.getNode().isLeafNode()||s.getNode().forEachChild(fr,((e,t)=>{i.push(Sr(e,t))})),s.isFullyInitialized()&&i.push(Ar(s.getNode())),Va(e,i,s.getNode(),t)}(a,s)}(c,t,s,ba(e.pendingWriteTree_,n),r,o);if(!h&&!a&&!i){const s=Za(c,t);l=l.concat(function(e,t,s){const i=t._path,n=yo(e,t),r=mo(e,s),a=e.listenProvider_.startListening(xo(t),n,r.hashFn,r.onComplete),o=e.syncPointTree_.subtree(i);if(n)Pe(!eo(o.value),"If we're adding a query, it shouldn't be shadowed");else{const t=o.fold(((e,t,s)=>{if(!zn(e)&&t&&eo(t))return[to(t).query];{let e=[];return t&&(e=e.concat(Ja(t).map((e=>e.query)))),en(s,((t,s)=>{e=e.concat(s)})),e}}));for(let s=0;s<t.length;++s){const i=t[s];e.listenProvider_.stopListening(xo(i),yo(e,i))}}return a}(e,t,s))}return l}function lo(e,t,s){const i=e.pendingWriteTree_,n=e.syncPointTree_.findOnPath(t,((e,s)=>{const i=Xa(s,qn(e,t));if(i)return i}));return va(i,t,n,s,!0)}function po(e,t){return uo(t,e.syncPointTree_,null,ba(e.pendingWriteTree_,Dn()))}function uo(e,t,s,i){if(zn(e.path))return fo(e,t,s,i);{const n=t.get(Dn());null==s&&null!=n&&(s=Xa(n,Dn()));let r=[];const a=On(e.path),o=e.operationForChild(a),c=t.children.get(a);if(c&&o){const e=s?s.getImmediateChild(a):null,t=Aa(i,a);r=r.concat(uo(o,c,e,t))}return n&&(r=r.concat(Ga(n,e,i,s))),r}}function fo(e,t,s,i){const n=t.get(Dn());null==s&&null!=n&&(s=Xa(n,Dn()));let r=[];return t.children.inorderTraversal(((t,n)=>{const a=s?s.getImmediateChild(t):null,o=Aa(i,t),c=e.operationForChild(t);c&&(r=r.concat(fo(c,n,a,o)))})),n&&(r=r.concat(Ga(n,e,i,s))),r}function mo(e,t){const s=t.query,i=yo(e,s);return{hashFn:()=>{const e=function(e){return e.viewCache_.serverCache.getNode()}(t)||vr.EMPTY_NODE;return e.hash()},onComplete:t=>{if("ok"===t)return i?function(e,t,s){const i=bo(e,s);if(i){const s=wo(i),n=s.path,r=s.queryId,a=qn(n,t);return _o(e,n,new Gr(Wr(r),a))}return[]}(e,s._path,i):function(e,t){return po(e,new Gr({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t))}(e,s._path);{const i=function(e,t){let s="Unknown Error";"too_big"===e?s="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?s="Client doesn't have permission to access the desired data.":"unavailable"===e&&(s="The service is unavailable");const i=new Error(e+" at "+t._path.toString()+": "+s);return i.code=e.toUpperCase(),i}(t,s);return oo(e,s,null,i)}}}}function yo(e,t){const s=go(t);return e.queryToTagMap.get(s)}function go(e){return e._path.toString()+"$"+e._queryIdentifier}function bo(e,t){return e.tagToQueryMap.get(t)}function wo(e){const t=e.indexOf("$");return Pe(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new Ln(e.substr(0,t))}}function _o(e,t,s){const i=e.syncPointTree_.get(t);return Pe(i,"Missing sync point for query tag that we're tracking"),Ga(i,s,ba(e.pendingWriteTree_,t),null)}function xo(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(Pe(Wa,"Reference.ts has not been loaded"),Wa)(e._repo,e._path):e}class vo{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new vo(t)}node(){return this.node_}}class To{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Un(this.path_,e);return new To(this.syncTree_,t)}node(){return lo(this.syncTree_,this.path_)}}const Po=function(e){return(e=e||{}).timestamp=e.timestamp||(new Date).getTime(),e},ko=function(e,t,s){return e&&"object"==typeof e?(Pe(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?Co(e[".sv"],t,s):"object"==typeof e[".sv"]?Eo(e[".sv"],t):void Pe(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},Co=function(e,t,s){if("timestamp"===e)return s.timestamp;Pe(!1,"Unexpected server value: "+e)},Eo=function(e,t,s){e.hasOwnProperty("increment")||Pe(!1,"Unexpected server value: "+JSON.stringify(e,null,2));const i=e.increment;"number"!=typeof i&&Pe(!1,"Unexpected increment value: "+i);const n=t.node();if(Pe(null!=n,"Expected ChildrenNode.EMPTY_NODE for nulls"),!n.isLeafNode())return i;const r=n.getValue();return"number"!=typeof r?i:r+i},Ao=function(e,t,s,i){return Io(t,new To(s,e),i)},So=function(e,t,s){return Io(e,new vo(t),s)};function Io(e,t,s){const i=e.getPriority().val(),n=ko(i,t.getImmediateChild(".priority"),s);let r;if(e.isLeafNode()){const i=e,r=ko(i.getValue(),t,s);return r!==i.getValue()||n!==i.getPriority().val()?new dr(r,kr(n)):e}{const i=e;return r=i,n!==i.getPriority().val()&&(r=r.updatePriority(new dr(n))),i.forEachChild(fr,((e,i)=>{const n=Io(i,t.getImmediateChild(e),s);n!==i&&(r=r.updateImmediateChild(e,n))})),r}}class No{constructor(e="",t=null,s={children:{},childCount:0}){this.name=e,this.parent=t,this.node=s}}function Lo(e,t){let s=t instanceof Ln?t:new Ln(t),i=e,n=On(s);for(;null!==n;){const e=Ke(i.node.children,n)||{children:{},childCount:0};i=new No(n,i,e),s=Rn(s),n=On(s)}return i}function Do(e){return e.node.value}function Oo(e,t){e.node.value=t,jo(e)}function Mo(e){return e.node.childCount>0}function Ro(e,t){en(e.node.children,((s,i)=>{t(new No(s,e,i))}))}function Fo(e,t,s,i){s&&!i&&t(e),Ro(e,(e=>{Fo(e,t,!0,i)})),s&&i&&t(e)}function Bo(e){return new Ln(null===e.parent?e.name:Bo(e.parent)+"/"+e.name)}function jo(e){null!==e.parent&&function(e,t,s){const i=function(e){return void 0===Do(e)&&!Mo(e)}(s),n=We(e.node.children,t);i&&n?(delete e.node.children[t],e.node.childCount--,jo(e)):i||n||(e.node.children[t]=s.node,e.node.childCount++,jo(e))}(e.parent,e.name,e)}const Uo=/[\[\].#$\/\u0000-\u001F\u007F]/,zo=/[\[\].#$\u0000-\u001F\u007F]/,qo=10485760,Ho=function(e){return"string"==typeof e&&0!==e.length&&!Uo.test(e)},Vo=function(e){return"string"==typeof e&&0!==e.length&&!zo.test(e)},$o=function(e,t,s){const i=s instanceof Ln?new $n(s,e):s;if(void 0===t)throw new Error(e+"contains undefined "+Kn(i));if("function"==typeof t)throw new Error(e+"contains a function "+Kn(i)+" with contents = "+t.toString());if(Wi(t))throw new Error(e+"contains "+t.toString()+" "+Kn(i));if("string"==typeof t&&t.length>qo/3&&et(t)>qo)throw new Error(e+"contains a string greater than "+qo+" utf8 bytes "+Kn(i)+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){let s=!1,n=!1;if(en(t,((t,r)=>{if(".value"===t)s=!0;else if(".priority"!==t&&".sv"!==t&&(n=!0,!Ho(t)))throw new Error(e+" contains an invalid key ("+t+") "+Kn(i)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');!function(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=et(t),Wn(e)}(i,t),$o(e,r,i),function(e){const t=e.parts_.pop();e.byteLength_-=et(t),e.parts_.length>0&&(e.byteLength_-=1)}(i)})),s&&n)throw new Error(e+' contains ".value" child '+Kn(i)+" in addition to actual children.")}},Wo=function(e,t,s,i){if(!(i&&void 0===s||Vo(s)))throw new Error(Qe(e,t)+'was an invalid path = "'+s+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Ko=function(e,t,s,i){s&&(s=s.replace(/^\/*\.info(\/|$)/,"/")),Wo(e,t,s,i)};class Go{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Yo(e,t){let s=null;for(let i=0;i<t.length;i++){const n=t[i],r=n.getPath();null===s||Hn(r,s.path)||(e.eventLists_.push(s),s=null),null===s&&(s={events:[],path:r}),s.events.push(n)}s&&e.eventLists_.push(s)}function Jo(e,t,s){Yo(e,s),function(e,t){e.recursionDepth_++;let s=!0;for(let i=0;i<e.eventLists_.length;i++){const n=e.eventLists_[i];n&&(t(n.path)?(Xo(e.eventLists_[i]),e.eventLists_[i]=null):s=!1)}s&&(e.eventLists_=[]),e.recursionDepth_--}(e,(e=>Vn(e,t)||Vn(t,e)))}function Xo(e){for(let t=0;t<e.events.length;t++){const s=e.events[t];if(null!==s){e.events[t]=null;const i=s.getEventRunner();ji&&zi("event: "+s.toString()),rn(i)}}}const Zo="repo_interrupt",Qo=25;class ec{constructor(e,t,s,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=s,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Go,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Ur(),this.transactionQueueTree_=new No,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function tc(e,t,s){if(e.stats_=_n(e.repoInfo_),e.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new Br(e.repoInfo_,((t,s,i,n)=>{nc(e,t,s,i,n)}),e.authTokenProvider_,e.appCheckProvider_),setTimeout((()=>rc(e,!0)),0);else{if(null!=s){if("object"!=typeof s)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Ve(s)}catch(e){throw new Error("Invalid authOverride provided: "+e)}}e.persistentConnection_=new Jn(e.repoInfo_,t,((t,s,i,n)=>{nc(e,t,s,i,n)}),(t=>{rc(e,t)}),(t=>{!function(e,t){en(t,((t,s)=>{ac(e,t,s)}))}(e,t)}),e.authTokenProvider_,e.appCheckProvider_,s),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener((t=>{e.server_.refreshAuthToken(t)})),e.appCheckProvider_.addTokenChangeListener((t=>{e.server_.refreshAppCheckToken(t.token)})),e.statsReporter_=function(t,s){const i=t.toString();return wn[i]||(wn[i]=new Vr(e.stats_,e.server_)),wn[i]}(e.repoInfo_),e.infoData_=new jr,e.infoSyncTree_=new io({startListening:(t,s,i,n)=>{let r=[];const a=e.infoData_.getNode(t._path);return a.isEmpty()||(r=ao(e.infoSyncTree_,t._path,a),setTimeout((()=>{n("ok")}),0)),r},stopListening:()=>{}}),ac(e,"connected",!1),e.serverSyncTree_=new io({startListening:(t,s,i,n)=>(e.server_.listen(t,i,s,((s,i)=>{const r=n(s,i);Jo(e.eventQueue_,t._path,r)})),[]),stopListening:(t,s)=>{e.server_.unlisten(t,s)}})}function sc(e){const t=e.infoData_.getNode(new Ln(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function ic(e){return Po({timestamp:sc(e)})}function nc(e,t,s,i,n){e.dataUpdateCount++;const r=new Ln(t);s=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,s):s;let a=[];if(n)if(i){const t=Ye(s,(e=>kr(e)));a=function(e,t,s,i){const n=bo(e,i);if(n){const i=wo(n),r=i.path,a=i.queryId,o=qn(r,t),c=aa.fromObject(s);return _o(e,r,new Jr(Wr(a),o,c))}return[]}(e.serverSyncTree_,r,t,n)}else{const t=kr(s);a=co(e.serverSyncTree_,r,t,n)}else if(i){const t=Ye(s,(e=>kr(e)));a=function(e,t,s){const i=aa.fromObject(s);return po(e,new Jr({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,i))}(e.serverSyncTree_,r,t)}else{const t=kr(s);a=ao(e.serverSyncTree_,r,t)}let o=r;a.length>0&&(o=dc(e,r)),Jo(e.eventQueue_,o,a)}function rc(e,t){ac(e,"connected",t),!1===t&&function(e){lc(e,"onDisconnectEvents");const t=ic(e),s=Ur();qr(e.onDisconnect_,Dn(),((i,n)=>{const r=Ao(i,n,e.serverSyncTree_,t);zr(s,i,r)}));let i=[];qr(s,Dn(),((t,s)=>{i=i.concat(ao(e.serverSyncTree_,t,s));const n=bc(e,t);dc(e,n)})),e.onDisconnect_=Ur(),Jo(e.eventQueue_,Dn(),i)}(e)}function ac(e,t,s){const i=new Ln("/.info/"+t),n=kr(s);e.infoData_.updateSnapshot(i,n);const r=ao(e.infoSyncTree_,i,n);Jo(e.eventQueue_,i,r)}function oc(e){return e.nextWriteId_++}function cc(e,t,s,i,n){lc(e,"set",{path:t.toString(),value:s,priority:i});const r=ic(e),a=kr(s,i),o=lo(e.serverSyncTree_,t),c=So(a,o,r),h=oc(e),l=no(e.serverSyncTree_,t,c,h,!0);Yo(e.eventQueue_,l),e.server_.put(t.toString(),a.val(!0),((s,i)=>{const r="ok"===s;r||$i("set at "+t+" failed: "+s);const a=ro(e.serverSyncTree_,h,!r);Jo(e.eventQueue_,t,a),function(e,t,s,i){t&&rn((()=>{if("ok"===s)t(null);else{const e=(s||"error").toUpperCase();let n=e;i&&(n+=": "+i);const r=new Error(n);r.code=e,t(r)}}))}(0,n,s,i)}));const p=bc(e,t);dc(e,p),Jo(e.eventQueue_,p,[])}function hc(e){e.persistentConnection_&&e.persistentConnection_.interrupt(Zo)}function lc(e,...t){let s="";e.persistentConnection_&&(s=e.persistentConnection_.id+":"),zi(s,...t)}function pc(e,t,s){return lo(e.serverSyncTree_,t,s)||vr.EMPTY_NODE}function uc(e,t=e.transactionQueueTree_){if(t||gc(e,t),Do(t)){const s=mc(e,t);Pe(s.length>0,"Sending zero length transaction queue"),s.every((e=>0===e.status))&&function(e,t,s){const i=s.map((e=>e.currentWriteId)),n=pc(e,t,i);let r=n;const a=n.hash();for(let e=0;e<s.length;e++){const i=s[e];Pe(0===i.status,"tryToSendTransactionQueue_: items in queue should all be run."),i.status=1,i.retryCount++;const n=qn(t,i.path);r=r.updateChild(n,i.currentOutputSnapshotRaw)}const o=r.val(!0),c=t;e.server_.put(c.toString(),o,(i=>{lc(e,"transaction put response",{path:c.toString(),status:i});let n=[];if("ok"===i){const i=[];for(let t=0;t<s.length;t++)s[t].status=2,n=n.concat(ro(e.serverSyncTree_,s[t].currentWriteId)),s[t].onComplete&&i.push((()=>s[t].onComplete(null,!0,s[t].currentOutputSnapshotResolved))),s[t].unwatcher();gc(e,Lo(e.transactionQueueTree_,t)),uc(e,e.transactionQueueTree_),Jo(e.eventQueue_,t,n);for(let e=0;e<i.length;e++)rn(i[e])}else{if("datastale"===i)for(let e=0;e<s.length;e++)3===s[e].status?s[e].status=4:s[e].status=0;else{$i("transaction at "+c.toString()+" failed: "+i);for(let e=0;e<s.length;e++)s[e].status=4,s[e].abortReason=i}dc(e,t)}}),a)}(e,Bo(t),s)}else Mo(t)&&Ro(t,(t=>{uc(e,t)}))}function dc(e,t){const s=fc(e,t),i=Bo(s);return function(e,t,s){if(0===t.length)return;const i=[];let n=[];const r=t.filter((e=>0===e.status)).map((e=>e.currentWriteId));for(let o=0;o<t.length;o++){const c=t[o],h=qn(s,c.path);let l,p=!1;if(Pe(null!==h,"rerunTransactionsUnderNode_: relativePath should not be null."),4===c.status)p=!0,l=c.abortReason,n=n.concat(ro(e.serverSyncTree_,c.currentWriteId,!0));else if(0===c.status)if(c.retryCount>=Qo)p=!0,l="maxretry",n=n.concat(ro(e.serverSyncTree_,c.currentWriteId,!0));else{const s=pc(e,c.path,r);c.currentInputSnapshot=s;const i=t[o].update(s.val());if(void 0!==i){$o("transaction failed: Data returned ",i,c.path);let t=kr(i);"object"==typeof i&&null!=i&&We(i,".priority")||(t=t.updatePriority(s.getPriority()));const a=c.currentWriteId,o=ic(e),h=So(t,s,o);c.currentOutputSnapshotRaw=t,c.currentOutputSnapshotResolved=h,c.currentWriteId=oc(e),r.splice(r.indexOf(a),1),n=n.concat(no(e.serverSyncTree_,c.path,h,c.currentWriteId,c.applyLocally)),n=n.concat(ro(e.serverSyncTree_,a,!0))}else p=!0,l="nodata",n=n.concat(ro(e.serverSyncTree_,c.currentWriteId,!0))}Jo(e.eventQueue_,s,n),n=[],p&&(t[o].status=2,a=t[o].unwatcher,setTimeout(a,Math.floor(0)),t[o].onComplete&&("nodata"===l?i.push((()=>t[o].onComplete(null,!1,t[o].currentInputSnapshot))):i.push((()=>t[o].onComplete(new Error(l),!1,null)))))}var a;gc(e,e.transactionQueueTree_);for(let e=0;e<i.length;e++)rn(i[e]);uc(e,e.transactionQueueTree_)}(e,mc(e,s),i),i}function fc(e,t){let s,i=e.transactionQueueTree_;for(s=On(t);null!==s&&void 0===Do(i);)i=Lo(i,s),s=On(t=Rn(t));return i}function mc(e,t){const s=[];return yc(e,t,s),s.sort(((e,t)=>e.order-t.order)),s}function yc(e,t,s){const i=Do(t);if(i)for(let e=0;e<i.length;e++)s.push(i[e]);Ro(t,(t=>{yc(e,t,s)}))}function gc(e,t){const s=Do(t);if(s){let e=0;for(let t=0;t<s.length;t++)2!==s[t].status&&(s[e]=s[t],e++);s.length=e,Oo(t,s.length>0?s:void 0)}Ro(t,(t=>{gc(e,t)}))}function bc(e,t){const s=Bo(fc(e,t)),i=Lo(e.transactionQueueTree_,t);return function(e,t,s){let i=e.parent;for(;null!==i;){if(t(i))return!0;i=i.parent}}(i,(t=>{wc(e,t)})),wc(e,i),Fo(i,(t=>{wc(e,t)})),s}function wc(e,t){const s=Do(t);if(s){const i=[];let n=[],r=-1;for(let t=0;t<s.length;t++)3===s[t].status||(1===s[t].status?(Pe(r===t-1,"All SENT items should be at beginning of queue."),r=t,s[t].status=3,s[t].abortReason="set"):(Pe(0===s[t].status,"Unexpected transaction status in abort"),s[t].unwatcher(),n=n.concat(ro(e.serverSyncTree_,s[t].currentWriteId,!0)),s[t].onComplete&&i.push(s[t].onComplete.bind(null,new Error("set"),!1,null))));-1===r?Oo(t,void 0):s.length=r+1,Jo(e.eventQueue_,Bo(t),n);for(let e=0;e<i.length;e++)rn(i[e])}}const _c=function(e,t){const s=xc(e),i=s.namespace;"firebase.com"===s.domain&&Vi(s.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),i&&"undefined"!==i||"localhost"===s.domain||Vi("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),s.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&$i("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");const n="ws"===s.scheme||"wss"===s.scheme;return{repoInfo:new mn(s.host,s.secure,i,n,t,"",i!==s.subdomain),path:new Ln(s.pathString)}},xc=function(e){let t="",s="",i="",n="",r="",a=!0,o="https",c=443;if("string"==typeof e){let h=e.indexOf("//");h>=0&&(o=e.substring(0,h-1),e=e.substring(h+2));let l=e.indexOf("/");-1===l&&(l=e.length);let p=e.indexOf("?");-1===p&&(p=e.length),t=e.substring(0,Math.min(l,p)),l<p&&(n=function(e){let t="";const s=e.split("/");for(let e=0;e<s.length;e++)if(s[e].length>0){let i=s[e];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(e){}t+="/"+i}return t}(e.substring(l,p)));const u=function(e){const t={};"?"===e.charAt(0)&&(e=e.substring(1));for(const s of e.split("&")){if(0===s.length)continue;const i=s.split("=");2===i.length?t[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):$i(`Invalid query segment '${s}' in query '${e}'`)}return t}(e.substring(Math.min(e.length,p)));h=t.indexOf(":"),h>=0?(a="https"===o||"wss"===o,c=parseInt(t.substring(h+1),10)):h=t.length;const d=t.slice(0,h);if("localhost"===d.toLowerCase())s="localhost";else if(d.split(".").length<=2)s=d;else{const e=t.indexOf(".");i=t.substring(0,e).toLowerCase(),s=t.substring(e+1),r=i}"ns"in u&&(r=u.ns)}return{host:t,port:c,domain:s,subdomain:i,secure:a,scheme:o,pathString:n,namespace:r}};class vc{constructor(e,t,s,i){this.eventType=e,this.eventRegistration=t,this.snapshot=s,this.prevName=i}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Ve(this.snapshot.exportVal())}}class Tc{constructor(e,t,s){this.eventRegistration=e,this.error=t,this.path=s}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class Pc{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return Pe(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class kc{constructor(e,t,s,i){this._repo=e,this._path=t,this._queryParams=s,this._orderByCalled=i}get key(){return zn(this._path)?null:Fn(this._path)}get ref(){return new Cc(this._repo,this._path)}get _queryIdentifier(){const e=Fr(this._queryParams),t=Zi(e);return"{}"===t?"default":t}get _queryObject(){return Fr(this._queryParams)}isEqual(e){if(!((e=at(e))instanceof kc))return!1;const t=this._repo===e._repo,s=Hn(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&s&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+function(e){let t="";for(let s=e.pieceNum_;s<e.pieces_.length;s++)""!==e.pieces_[s]&&(t+="/"+encodeURIComponent(String(e.pieces_[s])));return t||"/"}(this._path)}}class Cc extends kc{constructor(e,t){super(e,t,new Mr,!1)}get parent(){const e=jn(this._path);return null===e?null:new Cc(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class Ec{constructor(e,t,s){this._node=e,this.ref=t,this._index=s}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new Ln(e),s=Sc(this.ref,e);return new Ec(this._node.getChild(t),s,fr)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,((t,s)=>e(new Ec(s,Sc(this.ref,t),fr))))}hasChild(e){const t=new Ln(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Ac(e,t){return(e=at(e))._checkNotDeleted("ref"),void 0!==t?Sc(e._root,t):e._root}function Sc(e,t){return null===On((e=at(e))._path)?Ko("child","path",t,!1):Wo("child","path",t,!1),new Cc(e._repo,Un(e._path,t))}function Ic(e,t){(function(e,t){if(".info"===On(t))throw new Error(e+" failed = Can't modify data under /.info/")})("set",(e=at(e))._path),function(e,t,s,i){i&&void 0===t||$o(Qe(e,"value"),t,s)}("set",t,e._path,!1);const s=new Re;return cc(e._repo,e._path,t,null,s.wrapCallback((()=>{}))),s.promise}function Nc(e){e=at(e);const t=new Pc((()=>{})),s=new Lc(t);return function(e,t,s){const i=function(e,t){const s=t._path;let i=null;e.syncPointTree_.foreachOnPath(s,((e,t)=>{const n=qn(e,s);i=i||Xa(t,n)}));let n=e.syncPointTree_.get(s);n?i=i||Xa(n,Dn()):(n=new Ka,e.syncPointTree_=e.syncPointTree_.set(s,n));const r=null!=i,a=r?new Xr(i,!0,!1):null;return ia(Ya(n,t,ba(e.pendingWriteTree_,t._path),r?a.getNode():vr.EMPTY_NODE,r).viewCache_)}(e.serverSyncTree_,t);return null!=i?Promise.resolve(i):e.server_.get(t).then((i=>{const n=kr(i).withIndex(t._queryParams.getIndex());let r;if(ho(e.serverSyncTree_,t,s,!0),t._queryParams.loadsAllData())r=ao(e.serverSyncTree_,t._path,n);else{const s=yo(e.serverSyncTree_,t);r=co(e.serverSyncTree_,t._path,n,s)}return Jo(e.eventQueue_,t._path,r),oo(e.serverSyncTree_,t,s,null,!0),n}),(s=>(lc(e,"get for query "+Ve(t)+" failed: "+s),Promise.reject(new Error(s)))))}(e._repo,e,s).then((t=>new Ec(t,new Cc(e._repo,e._path),e._queryParams.getIndex())))}class Lc{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const s=t._queryParams.getIndex();return new vc("value",this,new Ec(e.snapshotNode,new Cc(t._repo,t._path),s))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Tc(this,e,t):null}matches(e){return e instanceof Lc&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}!function(e){Pe(!$a,"__referenceConstructor has already been defined"),$a=e}(Cc),function(e){Pe(!Wa,"__referenceConstructor has already been defined"),Wa=e}(Cc);const Dc={};function Oc(e,t,s,i,n){let r=i||e.options.databaseURL;void 0===r&&(e.options.projectId||Vi("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),zi("Using default host for project ",e.options.projectId),r=`${e.options.projectId}-default-rtdb.firebaseio.com`);let a,o,c=_c(r,n),h=c.repoInfo;"undefined"!=typeof process&&process.env&&(o=process.env.FIREBASE_DATABASE_EMULATOR_HOST),o?(a=!0,r=`http://${o}?ns=${h.namespace}`,c=_c(r,n),h=c.repoInfo):a=!c.repoInfo.secure;const l=n&&a?new hn(hn.OWNER):new cn(e.name,e.options,t);(function(e,t){const s=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!Ho(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==s.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),Vo(e)}(s))throw new Error(Qe(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')})("Invalid Firebase Database URL",c),zn(c.path)||Vi("Database URL must point to the root of a Firebase Database (not including a child path).");const p=function(e,t,s,i){let n=Dc[t.name];n||(n={},Dc[t.name]=n);let r=n[e.toURLString()];return r&&Vi("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),r=new ec(e,false,s,i),n[e.toURLString()]=r,r}(h,e,l,new on(e.name,s));return new Mc(p,e)}class Mc{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(tc(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Cc(this._repo,Dn())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function(e,t){const s=Dc[t];s&&s[e.key]===e||Vi(`Database ${t}(${e.repoInfo_}) has already been deleted.`),hc(e),delete s[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&Vi("Cannot call "+e+" on a deleted database.")}}function Rc(e){(e=at(e))._checkNotDeleted("goOffline"),hc(e._repo)}function Fc(e){const t=Object.create(Storage.prototype);return t.getItem=t=>e.get(t),t.setItem=(t,s)=>e.set(t,s),t.removeItem=t=>{e.delete(t)},t.clear=()=>e.clear(),t.key=t=>e.keys()[t]||null,Object.defineProperty(t,"length",{get:()=>e.size,enumerable:!1,configurable:!1}),Object.freeze(t)}function Bc(e){const t=Object.create(null);return t.has=t=>t in e,t.get=t=>e[t]||null,t.set=(t,s)=>{e[t]=s},t.delete=t=>delete e[t],t.clear=()=>{for(const t of Object.keys(e))delete e[t]},t.keys=()=>Object.keys(e),t.values=()=>{const t=[];for(const s of Object.keys(e))t.push(e[s]);return t},t.entries=()=>{const t=[];for(const s of Object.keys(e))t.push([s,e[s]]);return t},Object.defineProperties(t,{size:{get:()=>Object.keys(e).length,enumerable:!1,configurable:!1}}),Object.freeze(t)}function jc(e){const t=Object.create(null);return t.has=t=>null!==e.getItem(t),t.get=t=>e.getItem(t),t.set=(t,s)=>e.setItem(t,s),t.clear=()=>e.clear(),t.delete=t=>(e.removeItem(t),!0),t.keys=()=>{const t=e.length,s=new Array(t);for(let i=0;i<t;i++)s[i]=e.key(i);return s},t.values=()=>{const t=e.length,s=new Array(t);for(let i=0;i<t;i++)s[i]=e.getItem(e.key(i));return s},t.entries=()=>{const t=e.length,s=new Array(t);for(let i=0;i<t;i++){const t=e.key(i);s[i]=[t,e.getItem(t)]}return s},Object.defineProperties(t,{size:{get:()=>e.length,enumerable:!1,configurable:!1}}),Object.freeze(t)}Jn.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},Jn.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)},Si="10.11.1",Wt(new ot("database",((e,{instanceIdentifier:t})=>Oc(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t)),"PUBLIC").setMultipleInstances(!0)),Zt(Ei,Ai,void 0),Zt(Ei,Ai,"esm2017");const Uc=function(...e){if(1!==e.length)throw new Error("Invalid arguments");const t=e[0];if("object"!=typeof t)throw new Error("Invalid arguments");const s=Object.create(zc);try{const e=t.localStorage,i=t.sessionStorage;if("object"!=typeof e||"object"!=typeof i)throw void 0;s.storageEnabled=!0,s.localStorage=jc(e),s.sessionStorage=jc(i)}catch(e){s.storageEnabled=!1,s.localStorage=Bc(Object.create(null)),s.sessionStorage=Bc(Object.create(null))}return Object.defineProperties(t,{localStorage:{value:Fc(s.localStorage),writable:!1,enumerable:!1,configurable:!1},sessionStorage:{value:Fc(s.sessionStorage),writable:!1,enumerable:!1,configurable:!1}}),Object.freeze(s)},zc=Object.freeze(Object.create(null));Object.defineProperty(Uc,"prototype",{value:zc,writable:!1,enumerable:!1,configurable:!1}),Object.setPrototypeOf(Uc,null),Object.freeze(Uc);const qc=Uc;var Hc=s(602);function Vc(e,t){let s="";switch(t.type){case"VariableDeclaration":switch(t.kind){case"var":case"let":for(const i of t.declarations){s+='window["'+i.id.name+'"] = ';const t=i.init;if(null!=t){const i=e.slice(t.start,t.end).trim();";"!==i[i.length-1]?s+=i+";\n":s+=i+"\n"}else s+="void 0;\n"}break;case"const":for(const i of t.declarations){s+='Object.defineProperty(window, "'+i.id.name+'", { value: ';const t=i.init;if(null!=t){const i=e.slice(t.start,t.end).trim(),n=i.length-1;";"===i[n]?s+=i.slice(0,n):s+=i}else s+="void 0";s+=", writable: false, enumerable: false, configurable: false });\n"}break;default:s+="// invalid expression\n"}break;case"InterfaceDeclaration":case"FunctionDeclaration":case"ClassDeclaration":case"EnumDeclaration":{const i=t.id;null!=i&&(s+='window["'+i.name+'"] = ');const n=e.slice(t.start,t.end).trim();";"!==n[n.length-1]?s+=n+";\n":s+=n+"\n"}break;case"EmptyStatement":case"DebuggerStatement":break;case"ExpressionStatement":{const i=t.expression;switch(i.type){case"AwaitExpression":case"YieldExpression":{const t=i.argument;if(null!=t){const i=e.slice(t.start,t.end).trim();";"!==i[i.length-1]?s+="await "+i+";\n":s+="await "+i+"\n"}}}}break;default:{const i=e.slice(t.start,t.end).trim();";"!==i[i.length-1]?s+=i+";\n":s+=i+"\n"}}return s}const $c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Wc=new Uint8Array(new ArrayBuffer(256));for(let e=0;e<64;e++)Wc[$c.charCodeAt(e)]=e;const Kc={encode:function(e){let t="",s="";const i=new Uint8Array(e);for(let e=0;e<i.length;e+=3){const s=i[e]<<16|i[e+1]<<8|i[e+2];t+=$c[s>>18&63]+$c[s>>12&63]+$c[s>>6&63]+$c[63&s]}const n=i.length%3;return 1===n?(s="==",t=t.slice(0,-2)):2===n&&(s="=",t=t.slice(0,-1)),t+s},decode:function(e){let t=0;e.endsWith("==")?t=2:e.endsWith("=")&&(t=1);const s=.75*e.length-t,i=new ArrayBuffer(s),n=new Uint8Array(i);let r=0;for(let t=0;t<e.length;t+=4){const s=Wc[e.charCodeAt(t)]<<18|Wc[e.charCodeAt(t+1)]<<12|Wc[e.charCodeAt(t+2)]<<6|Wc[e.charCodeAt(t+3)];n[r++]=s>>16&255,n[r++]=s>>8&255,n[r++]=255&s}return i}};Object.setPrototypeOf(Kc,null),Object.freeze(Kc);const Gc=Kc,Yc={encode:function(e){const t=Array.from(e).map((e=>e.codePointAt(0)||0)),s=[];for(const e of t)e<=127?s.push(e):e<=2047?(s.push(e>>6|192),s.push(63&e|128)):e<=65535?(s.push(e>>12|224),s.push(e>>6&63|128),s.push(63&e|128)):e<=1114111&&(s.push(e>>18|240),s.push(e>>12&63|128),s.push(e>>6&63|128),s.push(63&e|128));return new Uint8Array(s).buffer},decode:function(e){const t=new Uint8Array(e);let s="",i=0;for(;i<t.length;){const e=t[i];if(0==(128&e))s+=String.fromCharCode(e),i+=1;else if(192==(224&e)){const n=t[i+1];s+=String.fromCharCode((31&e)<<6|63&n),i+=2}else if(224==(240&e)){const n=t[i+1],r=t[i+2];s+=String.fromCharCode((15&e)<<12|(63&n)<<6|63&r),i+=3}else if(240==(248&e)){const n=(7&e)<<18|(63&t[i+1])<<12|(63&t[i+2])<<6|63&t[i+3];s+=n<=1114111?String.fromCodePoint(n):"�",i+=4}else s+="�",i+=1}return s}};Object.setPrototypeOf(Yc,null),Object.freeze(Yc);const Jc=Yc;function Xc(e){if("string"!=typeof e||!e)throw new Error("expected a non-empty string, got: "+e)}function Zc(e){if("number"!=typeof e)throw new Error("expected a number, got: "+e)}const Qc="emoji",eh="keyvalue",th="favorites",sh="tokens",ih="count",nh="group-order",rh="eTag",ah="url",oh="skinTone",ch="readonly",hh="readwrite",lh="skinUnicodes";function ph(e){return function(e,t){const s=new Set,i=[];for(const n of e){const e=t(n);s.has(e)||(s.add(e),i.push(n))}return i}(e,(e=>e.unicode))}const uh={},dh={},fh={};function mh(e,t,s){s.onerror=()=>t(s.error),s.onblocked=()=>t(new Error("IDB blocked")),s.onsuccess=()=>e(s.result)}function yh(e,t,s,i){return new Promise(((n,r)=>{const a=e.transaction(t,s,{durability:"relaxed"}),o="string"==typeof t?a.objectStore(t):t.map((e=>a.objectStore(e)));let c;i(o,a,(e=>{c=e})),a.oncomplete=()=>n(c),a.onerror=()=>r(a.error)}))}function gh(e){const t=uh[e],s=t&&t.result;if(s){s.close();const t=fh[e];if(t)for(const e of t)e()}delete uh[e],delete dh[e],delete fh[e]}const bh=new Set([":D","XD",":'D","O:)",":X",":P",";P","XP",":L",":Z",":j","8D","XO","8)",":B",":O",":S",":'o","Dx","X(","D:",":C",">0)",":3","</3","<3","\\M/",":E","8#"]);function wh(e){return e.split(/[\s_]+/).map((e=>!e.match(/\w/)||bh.has(e)?e.toLowerCase():e.replace(/[)(:,]/g,"").replace(/’/g,"'").toLowerCase())).filter(Boolean)}const _h=2;function xh(e){return e.filter(Boolean).map((e=>e.toLowerCase())).filter((e=>e.length>=_h))}function vh(e,t,s,i){e[t](s).onsuccess=e=>i&&i(e.target.result)}function Th(e,t,s){vh(e,"get",t,s)}function Ph(e,t,s){vh(e,"getAll",t,s)}function kh(e){e.commit&&e.commit()}function Ch(e,t){const s=function(e,t){let s=e[0];for(let i=1;i<e.length;i++){const n=e[i];t(s)>t(n)&&(s=n)}return s}(e,(e=>e.length)),i=[];for(const n of s)e.some((e=>-1===e.findIndex((e=>t(e)===t(n)))))||i.push(n);return i}async function Eh(e,t,s,i){try{const n=function(e){return e.map((({annotation:e,emoticon:t,group:s,order:i,shortcodes:n,skins:r,tags:a,emoji:o,version:c})=>{const h=[...new Set(xh([...(n||[]).map(wh).flat(),...a.map(wh).flat(),...wh(e),t]))].sort(),l={annotation:e,group:s,order:i,tags:a,tokens:h,unicode:o,version:c};if(t&&(l.emoticon=t),n&&(l.shortcodes=n),r){l.skinTones=[],l.skinUnicodes=[],l.skinVersions=[];for(const{tone:e,emoji:t,version:s}of r)l.skinTones.push(e),l.skinUnicodes.push(t),l.skinVersions.push(s)}return l}))}(t);await yh(e,[Qc,eh],hh,(([e,t],r)=>{let a,o,c=0;function h(){2==++c&&function(){if(a!==i||o!==s){e.clear();for(const t of n)e.put(t);t.put(i,rh),t.put(s,ah),kh(r)}}()}Th(t,rh,(e=>{a=e,h()})),Th(t,ah,(e=>{o=e,h()}))}))}finally{}}async function Ah(e,t){const s=xh(wh(t));return s.length?yh(e,Qc,ch,((e,t,i)=>{const n=[],r=()=>{const e=Ch(n,(e=>e.unicode));i(e.sort(((e,t)=>e.order<t.order?-1:1)))};for(let t=0;t<s.length;t++){const i=s[t],a=t===s.length-1?IDBKeyRange.bound(i,i+"￿",!1,!0):IDBKeyRange.only(i);Ph(e.index(sh),a,(e=>{n.push(e),n.length===s.length&&r()}))}})):[]}function Sh(e,t,s){return yh(e,t,ch,((e,t,i)=>Th(e,s,i)))}const Ih=["name","url"];function Nh(e){!function(e){const t=e&&Array.isArray(e),s=t&&e.length&&(!e[0]||Ih.some((t=>!(t in e[0]))));if(!t||s)throw new Error("Custom emojis are in the wrong format")}(e);const t=(e,t)=>e.name.toLowerCase()<t.name.toLowerCase()?-1:1,s=e.sort(t),i=function(e,t){const s=new Map;for(const t of e){const e=[...new Set((t.shortcodes||[]).map((e=>wh(e))).flat())];for(const i of e){let e=s;for(let t=0;t<i.length;t++){const s=i.charAt(t);let n=e.get(s);n||(n=new Map,e.set(s,n)),e=n}let n=e.get("");n||(n=[],e.set("",n)),n.push(t)}}return(e,t)=>{let i=s;for(let t=0;t<e.length;t++){const s=e.charAt(t),n=i.get(s);if(!n)return[];i=n}if(t)return i.get("")||[];const n=[],r=[i];for(;r.length;){const e=[...r.shift().entries()].sort(((e,t)=>e[0]<t[0]?-1:1));for(const[t,s]of e)""===t?n.push(...s):r.push(s)}return n}}(e),n=e=>i(e,!0),r=e=>i(e,!1),a=new Map,o=new Map;for(const t of e){o.set(t.name.toLowerCase(),t);for(const e of t.shortcodes||[])a.set(e.toLowerCase(),t)}return{all:s,search:e=>{const s=wh(e),i=s.map(((e,t)=>(t<s.length-1?n:r)(e)));return Ch(i,(e=>e.name)).sort(t)},byShortcode:e=>a.get(e.toLowerCase()),byName:e=>o.get(e.toLowerCase())}}const Lh="undefined"!=typeof wrappedJSObject;function Dh(e){if(!e)return e;if(Lh&&(e=structuredClone(e)),delete e.tokens,e.skinTones){const t=e.skinTones.length;e.skins=Array(t);for(let s=0;s<t;s++)e.skins[s]={tone:e.skinTones[s],unicode:e.skinUnicodes[s],version:e.skinVersions[s]};delete e.skinTones,delete e.skinUnicodes,delete e.skinVersions}return e}function Oh(e){e||console.warn("emoji-picker-element is more efficient if the dataSource server exposes an ETag header.")}const Mh=["annotation","emoji","group","order","tags","version"];function Rh(e,t){if(2!==Math.floor(e.status/100))throw new Error("Failed to fetch: "+t+":  "+e.status)}async function Fh(e){const t=await fetch(e);Rh(t,e);const s=t.headers.get("etag");Oh(s);const i=await t.json();return function(e){if(!e||!Array.isArray(e)||!e[0]||"object"!=typeof e[0]||Mh.some((t=>!(t in e[0]))))throw new Error("Emoji data is in the wrong format")}(i),[s,i]}async function Bh(e){let t=function(e){for(var t=e.length,s=new ArrayBuffer(t),i=new Uint8Array(s),n=-1;++n<t;)i[n]=e.charCodeAt(n);return s}(JSON.stringify(e));const s=function(e){for(var t="",s=new Uint8Array(e),i=s.byteLength,n=-1;++n<i;)t+=String.fromCharCode(s[n]);return t}(await crypto.subtle.digest("SHA-1",t));return btoa(s)}class jh{constructor({dataSource:e="https://cdn.jsdelivr.net/npm/emoji-picker-element-data@^1/en/emojibase/data.json",locale:t="en",customEmoji:s=[]}={}){this.dataSource=e,this.locale=t,this._dbName=`emoji-picker-element-${this.locale}`,this._db=void 0,this._lazyUpdate=void 0,this._custom=Nh(s),this._clear=this._clear.bind(this),this._ready=this._init()}async _init(){const e=this._db=await(t=this._dbName,dh[t]||(dh[t]=async function(e){const t=await new Promise(((t,s)=>{const i=indexedDB.open(e,1);uh[e]=i,i.onupgradeneeded=e=>{e.oldVersion<1&&function(e){function t(t,s,i){const n=s?e.createObjectStore(t,{keyPath:s}):e.createObjectStore(t);if(i)for(const[e,[t,s]]of Object.entries(i))n.createIndex(e,t,{multiEntry:s});return n}t(eh),t(Qc,"unicode",{[sh]:["tokens",!0],[nh]:[["group","order"]],[lh]:["skinUnicodes",!0]}),t(th,void 0,{[ih]:[""]})}(i.result)},mh(t,s,i)}));return t.onclose=()=>gh(e),t}(t)),dh[t]);var t;!function(e,t){let s=fh[e];s||(s=fh[e]=[]),s.push(t)}(this._dbName,this._clear);const s=this.dataSource,i=await async function(e){return!await Sh(e,eh,ah)}(e);i?await async function(e,t){let[s,i]=await Fh(t);s||(s=await Bh(i)),await Eh(e,i,t,s)}(e,s):this._lazyUpdate=async function(e,t){let s,i=await async function(e){const t=await fetch(e,{method:"HEAD"});Rh(t,e);const s=t.headers.get("etag");return Oh(s),s}(t);if(!i){const e=await Fh(t);i=e[0],s=e[1],i||(i=await Bh(s))}await async function(e,t,s){const[i,n]=await Promise.all([rh,ah].map((t=>Sh(e,eh,t))));return i===s&&n===t}(e,t,i)||(s||(s=(await Fh(t))[1]),await Eh(e,s,t,i))}(e,s)}async ready(){const e=async()=>(this._ready||(this._ready=this._init()),this._ready);await e(),this._db||await e()}async getEmojiByGroup(e){return Zc(e),await this.ready(),ph(await async function(e,t){return yh(e,Qc,ch,((e,s,i)=>{const n=IDBKeyRange.bound([t,0],[t+1,0],!1,!0);Ph(e.index(nh),n,i)}))}(this._db,e)).map(Dh)}async getEmojiBySearchQuery(e){return Xc(e),await this.ready(),[...this._custom.search(e),...ph(await Ah(this._db,e)).map(Dh)]}async getEmojiByShortcode(e){Xc(e),await this.ready();return this._custom.byShortcode(e)||Dh(await async function(e,t){const s=await Ah(e,t);if(!s.length){const s=e=>(e.shortcodes||[]).includes(t.toLowerCase());return await async function(e,t){return yh(e,Qc,ch,((e,s,i)=>{let n;const r=()=>{e.getAll(n&&IDBKeyRange.lowerBound(n,!0),50).onsuccess=e=>{const s=e.target.result;for(const e of s)if(n=e.unicode,t(e))return i(e);if(s.length<50)return i();r()}};r()}))}(e,s)||null}return s.filter((e=>{const s=(e.shortcodes||[]).map((e=>e.toLowerCase()));return s.includes(t.toLowerCase())}))[0]||null}(this._db,e))}async getEmojiByUnicodeOrName(e){Xc(e),await this.ready();return this._custom.byName(e)||Dh(await async function(e,t){return yh(e,Qc,ch,((e,s,i)=>Th(e,t,(s=>{if(s)return i(s);Th(e.index(lh),t,(e=>i(e||null)))}))))}(this._db,e))}async getPreferredSkinTone(){return await this.ready(),await Sh(this._db,eh,oh)||0}async setPreferredSkinTone(e){return Zc(e),await this.ready(),function(e,t,s,i){return yh(e,t,hh,((e,t)=>{e.put(i,s),kh(t)}))}(this._db,eh,oh,e)}async incrementFavoriteEmojiCount(e){return Xc(e),await this.ready(),t=this._db,s=e,yh(t,th,hh,((e,t)=>Th(e,s,(i=>{e.put((i||0)+1,s),kh(t)}))));var t,s}async getTopFavoriteEmoji(e){return Zc(e),await this.ready(),(await function(e,t,s){return 0===s?[]:yh(e,[th,Qc],ch,(([e,i],n,r)=>{const a=[];e.index(ih).openCursor(void 0,"prev").onsuccess=e=>{const n=e.target.result;if(!n)return r(a);function o(e){if(a.push(e),a.length===s)return r(a);n.continue()}const c=n.primaryKey,h=t.byName(c);if(h)return o(h);Th(i,c,(e=>{if(e)return o(e);n.continue()}))}}))}(this._db,this._custom,e)).map(Dh)}set customEmoji(e){this._custom=Nh(e)}get customEmoji(){return this._custom.all}async _shutdown(){await this.ready();try{await this._lazyUpdate}catch(e){}}_clear(){this._db=this._ready=this._lazyUpdate=void 0}async close(){await this._shutdown(),await gh(this._dbName)}async delete(){var e;await this._shutdown(),await(e=this._dbName,new Promise(((t,s)=>{gh(e),mh(t,s,indexedDB.deleteDatabase(e))})))}}const Uh=[[-1,"✨","custom"],[0,"😀","smileys-emotion"],[1,"👋","people-body"],[3,"🐱","animals-nature"],[4,"🍎","food-drink"],[5,"🏠️","travel-places"],[6,"⚽","activities"],[7,"📝","objects"],[8,"⛔️","symbols"],[9,"🏁","flags"]].map((([e,t,s])=>({id:e,emoji:t,name:s}))),zh=Uh.slice(1),qh="function"==typeof requestIdleCallback?requestIdleCallback:setTimeout;function Hh(e){return e.unicode.includes("‍")}const Vh={"🫨":15.1,"🫠":14,"🥲":13.1,"🥻":12.1,"🥰":11,"🤩":5,"👱‍♀️":4,"🤣":3,"👁️‍🗨️":2,"😀":1,"😐️":.7,"😃":.6},$h=["😊","😒","❤️","👍️","😍","😂","😭","☺️","😔","😩","😏","💕","🙌","😘"],Wh='"Twemoji Mozilla","Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji","EmojiOne Color","Android Emoji",sans-serif',Kh=(e,t)=>e<t?-1:e>t?1:0,Gh=(e,t)=>{const s=document.createElement("canvas");s.width=s.height=1;const i=s.getContext("2d");return i.textBaseline="top",i.font=`100px ${Wh}`,i.fillStyle=t,i.scale(.01,.01),i.fillText(e,0,0),i.getImageData(0,0,1,1).data};function Yh(e){const t=Gh(e,"#000"),s=Gh(e,"#fff");return t&&s&&((e,t)=>{const s=[...e].join(",");return s===[...t].join(",")&&!s.startsWith("0,0,0,")})(t,s)}let Jh;const Xh=()=>(Jh||(Jh=new Promise((e=>qh((()=>e(function(){const e=Object.entries(Vh);try{for(const[t,s]of e)if(Yh(t))return s}catch(e){}return e[0][1]}())))))),Jh),Zh=new Map;function Qh(e){e.preventDefault(),e.stopPropagation()}function el(e,t,s){return(t+=e?-1:1)<0?t=s.length-1:t>=s.length&&(t=0),t}function tl(e,t){const s=new Set,i=[];for(const n of e){const e=t(n);s.has(e)||(s.add(e),i.push(n))}return i}const sl=requestAnimationFrame;let il,nl="function"==typeof ResizeObserver;function rl(e){{const t=document.createRange();return t.selectNode(e.firstChild),t.getBoundingClientRect().width}}function al(e,t,s){let i=e.get(t);return i||(i=s(),e.set(t,i)),i}function ol(e){return""+e}const cl=new WeakMap,hl=new WeakMap,ll=Symbol("un-keyed"),pl="replaceChildren"in Element.prototype;function ul(e,t){const{targetNode:s}=t;let{targetParentNode:i}=t,n=!1;i?n=function(e,t){let s=e.firstChild,i=0;for(;s;){if(t[i]!==s)return!0;s=s.nextSibling,i++}return i!==t.length}(i,e):(n=!0,t.targetNode=void 0,t.targetParentNode=i=s.parentNode),n&&function(e,t){pl?e.replaceChildren(...t):(e.innerHTML="",e.append(...t))}(i,e)}function dl(e){const{template:t,elementsToBindings:s}=al(cl,e,(()=>function(e){let t="",s=!1,i=!1,n=-1;const r=new Map,a=[];for(let o=0,c=e.length;o<c;o++){const h=e[o];if(t+=h,o===c-1)break;for(let e=0;e<h.length;e++)switch(h.charAt(e)){case"<":"/"===h.charAt(e+1)?a.pop():(s=!0,a.push(++n));break;case">":s=!1,i=!1;break;case"=":i=!0}const l=al(r,a[a.length-1],(()=>[]));let p,u,d;if(i){const t=/(\S+)="?([^"=]*)$/.exec(h);p=t[1],u=t[2],d=/^[^">]*/.exec(e[o+1])[0]}const f={attributeName:p,attributeValuePre:u,attributeValuePost:d,expressionIndex:o};l.push(f),s||i||(t+=" ")}const o=function(e){const t=document.createElement("template");return t.innerHTML=e,t}(t);return{template:o,elementsToBindings:r}}(e))),i=t.cloneNode(!0).content.firstElementChild,n=function(e,t){const s=[],i=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT);let n=e,r=-1;do{const e=t.get(++r);if(e)for(let t=0;t<e.length;t++){const i=e[t],r={binding:i,targetNode:i.attributeName?n:n.firstChild,targetParentNode:void 0,currentExpression:void 0};s.push(r)}}while(n=i.nextNode());return s}(i,s);return function(e){return function(e,t){for(const s of t){const{targetNode:t,currentExpression:i,binding:{expressionIndex:n,attributeName:r,attributeValuePre:a,attributeValuePost:o}}=s,c=e[n];if(i!==c)if(s.currentExpression=c,r)t.setAttribute(r,a+ol(c)+o);else{let e;Array.isArray(c)?ul(c,s):c instanceof Element?(e=c,t.replaceWith(e)):t.nodeValue=ol(c),e&&(s.targetNode=e)}}}(e,n),i}}const fl="function"==typeof queueMicrotask?queueMicrotask:e=>Promise.resolve().then(e);function ml(e,t,s){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!s(e[i],t[i]))return!1;return!0}const yl=[],{assign:gl}=Object;function bl(e,t){const s={},i=new AbortController,n=i.signal,{state:r,createEffect:a}=function(e){let t,s=!1;const i=new Map,n=new Set;let r;const a=()=>{if(s)return;const e=[...n];n.clear();try{for(const t of e)t()}finally{r=!1,n.size&&(r=!0,fl(a))}},o=new Proxy({},{get(e,s){if(t){let e=i.get(s);e||(e=new Set,i.set(s,e)),e.add(t)}return e[s]},set(e,t,s){e[t]=s;const o=i.get(t);if(o){for(const e of o)n.add(e);r||(r=!0,fl(a))}return!0}});return e.addEventListener("abort",(()=>{s=!0})),{state:o,createEffect:e=>{const s=()=>{const i=t;t=s;try{return e()}finally{t=i}};return s()}}}(n);gl(r,{skinToneEmoji:void 0,i18n:void 0,database:void 0,customEmoji:void 0,customCategorySorting:void 0,emojiVersion:void 0}),gl(r,t),gl(r,{initialLoad:!0,currentEmojis:[],currentEmojisWithCategories:[],rawSearchText:"",searchText:"",searchMode:!1,activeSearchItem:-1,message:void 0,skinTonePickerExpanded:!1,skinTonePickerExpandedAfterAnimation:!1,currentSkinTone:0,activeSkinTone:0,skinToneButtonText:void 0,pickerStyle:void 0,skinToneButtonLabel:"",skinTones:[],currentFavorites:[],defaultFavoriteEmojis:void 0,numColumns:8,isRtl:!1,scrollbarWidth:0,currentGroupIndex:0,groups:zh,databaseLoaded:!1,activeSearchItemId:void 0}),a((()=>{r.currentGroup!==r.groups[r.currentGroupIndex]&&(r.currentGroup=r.groups[r.currentGroupIndex])}));const o=t=>{e.getElementById(t).focus()},c=t=>e.getElementById(`emo-${t.id}`),h=(e,t)=>{s.rootElement.dispatchEvent(new CustomEvent(e,{detail:t,bubbles:!0,composed:!0}))},l=(e,t)=>e.id===t.id,p=(e,t)=>{const{category:s,emojis:i}=e,{category:n,emojis:r}=t;return s===n&&ml(i,r,l)},u=e=>{ml(r.currentEmojis,e,l)||(r.currentEmojis=e)},d=e=>{r.searchMode!==e&&(r.searchMode=e)},f=(e,t)=>t&&e.skins&&e.skins[t]||e.unicode,m={labelWithSkin:(e,t)=>{return(s=[e.name||f(e,t),e.annotation,...e.shortcodes||yl].filter(Boolean),tl(s,(e=>e))).join(", ");var s},titleForEmoji:e=>e.annotation||(e.shortcodes||yl).join(", "),unicodeWithSkin:f},y={onClickSkinToneButton:function(e){r.skinTonePickerExpanded=!r.skinTonePickerExpanded,r.activeSkinTone=r.currentSkinTone,r.skinTonePickerExpanded&&(Qh(e),sl((()=>o("skintone-list"))))},onEmojiClick:async function(e){const{target:t}=e;t.classList.contains("emoji")&&(Qh(e),T(t.id.substring(4)))},onNavClick:function(e){const{target:t}=e,i=t.closest(".nav-button");if(!i)return;const n=parseInt(i.dataset.groupId,10);s.searchElement.value="",r.rawSearchText="",r.searchText="",r.activeSearchItem=-1,r.currentGroupIndex=r.groups.findIndex((e=>e.id===n))},onNavKeydown:function(e){const{target:t,key:s}=e,i=t=>{t&&(Qh(e),t.focus())};switch(s){case"ArrowLeft":return i(t.previousElementSibling);case"ArrowRight":return i(t.nextElementSibling);case"Home":return i(t.parentElement.firstElementChild);case"End":return i(t.parentElement.lastElementChild)}},onSearchKeydown:function(e){if(!r.searchMode||!r.currentEmojis.length)return;const t=t=>{Qh(e),r.activeSearchItem=el(t,r.activeSearchItem,r.currentEmojis)};switch(e.key){case"ArrowDown":return t(!1);case"ArrowUp":return t(!0);case"Enter":if(-1!==r.activeSearchItem)return Qh(e),T(r.currentEmojis[r.activeSearchItem].id);r.activeSearchItem=0}},onSkinToneOptionsClick:function(e){const{target:{id:t}}=e,s=t&&t.match(/^skintone-(\d)/);s&&(Qh(e),P(parseInt(s[1],10)))},onSkinToneOptionsFocusOut:async function(e){const{relatedTarget:t}=e;t&&"skintone-list"===t.id||(r.skinTonePickerExpanded=!1)},onSkinToneOptionsKeydown:function(e){if(!r.skinTonePickerExpanded)return;const t=async t=>{Qh(e),r.activeSkinTone=t};switch(e.key){case"ArrowUp":return t(el(!0,r.activeSkinTone,r.skinTones));case"ArrowDown":return t(el(!1,r.activeSkinTone,r.skinTones));case"Home":return t(0);case"End":return t(r.skinTones.length-1);case"Enter":return Qh(e),P(r.activeSkinTone);case"Escape":return Qh(e),r.skinTonePickerExpanded=!1,o("skintone-button")}},onSkinToneOptionsKeyup:function(e){if(r.skinTonePickerExpanded)return" "===e.key?(Qh(e),P(r.activeSkinTone)):void 0},onSearchInput:function(e){r.rawSearchText=e.target.value}},g={calculateEmojiGridStyle:function(e){!function(e,t,s){let i;nl?(i=new ResizeObserver((e=>s(e[0].contentRect.width))),i.observe(e)):sl((()=>s(e.getBoundingClientRect().width))),t.addEventListener("abort",(()=>{i&&i.disconnect()}))}(e,n,(t=>{{const i=getComputedStyle(s.rootElement),n=parseInt(i.getPropertyValue("--num-columns"),10),a="rtl"===i.getPropertyValue("direction"),o=e.parentElement.getBoundingClientRect().width-t;r.numColumns=n,r.scrollbarWidth=o,r.isRtl=a}}))}};let b=!0;function w(){r.database.customEmoji=r.customEmoji||yl}function _(e){return!e.unicode||!Hh(e)||Zh.get(e.unicode)}async function x(e){const t=r.emojiVersion||await Xh();return e.filter((({version:e})=>!e||e<=t))}async function v(e){return function(e,t){const s=e=>{const s={};for(const i of e)"number"==typeof i.tone&&i.version<=t&&(s[i.tone]=i.unicode);return s};return e.map((({unicode:e,skins:t,shortcodes:i,url:n,name:r,category:a,annotation:o})=>({unicode:e,name:r,shortcodes:i,url:n,category:a,annotation:o,id:e||r,skins:t&&s(t)})))}(e,r.emojiVersion||await Xh())}async function T(e){const t=await r.database.getEmojiByUnicodeOrName(e),s=[...r.currentEmojis,...r.currentFavorites].find((t=>t.id===e)),i=s.unicode&&f(s,r.currentSkinTone);await r.database.incrementFavoriteEmojiCount(e),h("emoji-click",{emoji:t,skinTone:r.currentSkinTone,...i&&{unicode:i},...s.name&&{name:s.name}})}function P(e){r.currentSkinTone=e,r.skinTonePickerExpanded=!1,o("skintone-button"),h("skin-tone-change",{skinTone:e}),r.database.setPreferredSkinTone(e)}return a((()=>{(function(e,t,s,i,n,r,a,o){const{labelWithSkin:c,titleForEmoji:h,unicodeWithSkin:l}=s,{html:p,map:u}=function(e){const t=al(hl,e,(()=>new Map));let s=ll;return{map:function(e,t,i){return e.map(((e,n)=>{const r=s;s=i(e);try{return t(e,n)}finally{s=r}}))},html:function(e,...i){const n=al(t,e,(()=>new Map));return al(n,s,(()=>dl(e)))(i)}}}(t);function d(e,s,i){return u(e,((e,n)=>p`<button role="${s?"option":"menuitem"}" aria-selected="${t.searchMode?n===t.activeSearchItem:""}" aria-label="${c(e,t.currentSkinTone)}" title="${h(e)}" class="emoji ${s&&n===t.activeSearchItem?"active":""}" id="${`${i}-${e.id}`}">${e.unicode?l(e,t.currentSkinTone):p`<img class="custom-emoji" src="${e.url}" alt="" loading="lazy">`}</button>`),(e=>`${i}-${e.id}`))}const f=p`<section data-ref="rootElement" class="picker" aria-label="${t.i18n.regionLabel}" style="${t.pickerStyle}"><div class="pad-top"></div><div class="search-row"><div class="search-wrapper"><input id="search" class="search" type="search" role="combobox" enterkeyhint="search" placeholder="${t.i18n.searchLabel}" autocapitalize="none" autocomplete="off" spellcheck="true" aria-expanded="${!(!t.searchMode||!t.currentEmojis.length)}" aria-controls="search-results" aria-describedby="search-description" aria-autocomplete="list" aria-activedescendant="${t.activeSearchItemId?`emo-${t.activeSearchItemId}`:""}" data-ref="searchElement" data-on-input="onSearchInput" data-on-keydown="onSearchKeydown"><label class="sr-only" for="search">${t.i18n.searchLabel}</label> <span id="search-description" class="sr-only">${t.i18n.searchDescription}</span></div><div class="skintone-button-wrapper ${t.skinTonePickerExpandedAfterAnimation?"expanded":""}"><button id="skintone-button" class="emoji ${t.skinTonePickerExpanded?"hide-focus":""}" aria-label="${t.skinToneButtonLabel}" title="${t.skinToneButtonLabel}" aria-describedby="skintone-description" aria-haspopup="listbox" aria-expanded="${t.skinTonePickerExpanded}" aria-controls="skintone-list" data-on-click="onClickSkinToneButton">${t.skinToneButtonText}</button></div><span id="skintone-description" class="sr-only">${t.i18n.skinToneDescription}</span><div data-ref="skinToneDropdown" id="skintone-list" class="skintone-list hide-focus ${t.skinTonePickerExpanded?"":"hidden no-animate"}" style="transform:translateY(${t.skinTonePickerExpanded?0:"calc(-1 * var(--num-skintones) * var(--total-emoji-size))"})" role="listbox" aria-label="${t.i18n.skinTonesLabel}" aria-activedescendant="skintone-${t.activeSkinTone}" aria-hidden="${!t.skinTonePickerExpanded}" tabIndex="-1" data-on-focusout="onSkinToneOptionsFocusOut" data-on-click="onSkinToneOptionsClick" data-on-keydown="onSkinToneOptionsKeydown" data-on-keyup="onSkinToneOptionsKeyup">${u(t.skinTones,((e,s)=>p`<div id="skintone-${s}" class="emoji ${s===t.activeSkinTone?"active":""}" aria-selected="${s===t.activeSkinTone}" role="option" title="${t.i18n.skinTones[s]}" aria-label="${t.i18n.skinTones[s]}">${e}</div>`),(e=>e))}</div></div><div class="nav" role="tablist" style="grid-template-columns:repeat(${t.groups.length},1fr)" aria-label="${t.i18n.categoriesLabel}" data-on-keydown="onNavKeydown" data-on-click="onNavClick">${u(t.groups,(e=>p`<button role="tab" class="nav-button" aria-controls="tab-${e.id}" aria-label="${t.i18n.categories[e.name]}" aria-selected="${!t.searchMode&&t.currentGroup.id===e.id}" title="${t.i18n.categories[e.name]}" data-group-id="${e.id}"><div class="nav-emoji emoji">${e.emoji}</div></button>`),(e=>e.id))}</div><div class="indicator-wrapper"><div class="indicator" style="transform:translateX(${(t.isRtl?-1:1)*t.currentGroupIndex*100}%)"></div></div><div class="message ${t.message?"":"gone"}" role="alert" aria-live="polite">${t.message}</div><div data-ref="tabpanelElement" class="tabpanel ${!t.databaseLoaded||t.message?"gone":""}" role="${t.searchMode?"region":"tabpanel"}" aria-label="${t.searchMode?t.i18n.searchResultsLabel:t.i18n.categories[t.currentGroup.name]}" id="${t.searchMode?"":`tab-${t.currentGroup.id}`}" tabIndex="0" data-on-click="onEmojiClick"><div data-action="calculateEmojiGridStyle">${u(t.currentEmojisWithCategories,((e,s)=>p`<div><div id="menu-label-${s}" class="category ${1===t.currentEmojisWithCategories.length&&""===t.currentEmojisWithCategories[0].category?"gone":""}" aria-hidden="true">${t.searchMode?t.i18n.searchResultsLabel:e.category?e.category:t.currentEmojisWithCategories.length>1?t.i18n.categories.custom:t.i18n.categories[t.currentGroup.name]}</div><div class="emoji-menu" role="${t.searchMode?"listbox":"menu"}" aria-labelledby="menu-label-${s}" id="${t.searchMode?"search-results":""}">${d(e.emojis,t.searchMode,"emo")}</div></div>`),(e=>e.category))}</div></div><div class="favorites emoji-menu ${t.message?"gone":""}" role="menu" aria-label="${t.i18n.favoritesLabel}" style="padding-inline-end:${`${t.scrollbarWidth}px`}" data-on-click="onEmojiClick">${d(t.currentFavorites,!1,"fav")}</div><button data-ref="baselineEmoji" aria-hidden="true" tabindex="-1" class="abs-pos hidden emoji baseline-emoji">😀</button></section>`;if(o){e.appendChild(f);const t=(t,s)=>{for(const i of e.querySelectorAll(`[${t}]`))s(i,i.getAttribute(t))};for(const e of["click","focusout","input","keydown","keyup"])t(`data-on-${e}`,((t,s)=>{t.addEventListener(e,i[s])}));t("data-ref",((e,t)=>{r[t]=e})),t("data-action",((e,t)=>{n[t](e)})),a.addEventListener("abort",(()=>{e.removeChild(f)}))}})(e,r,m,y,g,s,n,b),b=!1})),r.emojiVersion||Xh().then((e=>{e||(r.message=r.i18n.emojiUnsupportedMessage)})),a((()=>{r.database&&async function(){let e=!1;const t=setTimeout((()=>{e=!0,r.message=r.i18n.loadingMessage}),1e3);try{await r.database.ready(),r.databaseLoaded=!0}catch(e){console.error(e),r.message=r.i18n.networkErrorMessage}finally{clearTimeout(t),e&&(e=!1,r.message="")}}()})),a((()=>{r.pickerStyle=`\n      --num-groups: ${r.groups.length}; \n      --indicator-opacity: ${r.searchMode?0:1}; \n      --num-skintones: 6;`})),a((()=>{r.customEmoji&&r.database&&w()})),a((()=>{r.customEmoji&&r.customEmoji.length?r.groups!==Uh&&(r.groups=Uh):r.groups!==zh&&(r.currentGroupIndex&&r.currentGroupIndex--,r.groups=zh)})),a((()=>{!async function(){r.databaseLoaded&&(r.currentSkinTone=await r.database.getPreferredSkinTone())}()})),a((()=>{r.skinTones=Array(6).fill().map(((e,t)=>function(e,t){if(0===t)return e;const s=e.indexOf("‍");return-1!==s?e.substring(0,s)+String.fromCodePoint(127995+t-1)+e.substring(s):(e.endsWith("️")&&(e=e.substring(0,e.length-1)),e+"\ud83c"+String.fromCodePoint(57339+t-1))}(r.skinToneEmoji,t)))})),a((()=>{r.skinToneButtonText=r.skinTones[r.currentSkinTone]})),a((()=>{r.skinToneButtonLabel=r.i18n.skinToneLabel.replace("{skinTone}",r.i18n.skinTones[r.currentSkinTone])})),a((()=>{r.databaseLoaded&&async function(){const{database:e}=r,t=(await Promise.all($h.map((t=>e.getEmojiByUnicodeOrName(t))))).filter(Boolean);r.defaultFavoriteEmojis=t}()})),a((()=>{r.databaseLoaded&&r.defaultFavoriteEmojis&&async function(){w();const{database:e,defaultFavoriteEmojis:t,numColumns:s}=r,i=await e.getTopFavoriteEmoji(s),n=await v(tl([...i,...t],(e=>e.unicode||e.name)).slice(0,s));r.currentFavorites=n}()})),a((()=>{!async function(){const{searchText:e,currentGroup:t,databaseLoaded:s,customEmoji:i}=r;if(s)if(e.length>=2){const t=await async function(e){return v(await x(await r.database.getEmojiBySearchQuery(e)))}(e);r.searchText===e&&(u(t),d(!0))}else{const{id:e}=t;if(-1!==e||i&&i.length){const t=await async function(e){const t=-1===e?r.customEmoji:await r.database.getEmojiByGroup(e);return v(await x(t))}(e);r.currentGroup.id===e&&(u(t),d(!1))}}else r.currentEmojis=[],r.searchMode=!1}()})),a((()=>{const{currentEmojis:e,emojiVersion:t}=r,i=e.filter((e=>e.unicode)).filter((e=>Hh(e)&&!Zh.has(e.unicode)));if(!t&&i.length)u(e),sl((()=>function(e){(function(e,t,s){for(const i of e){const e=rl(s(i));void 0===il&&(il=rl(t));const n=e/1.8<il;Zh.set(i.unicode,n)}})(e,s.baselineEmoji,c),r.currentEmojis=r.currentEmojis}(i)));else{const i=t?e:e.filter(_);u(i),sl((()=>{var e;(e=s.tabpanelElement)&&(e.scrollTop=0)}))}})),a((()=>{})),a((()=>{var e;e=function(){const{searchMode:e,currentEmojis:t}=r;if(e)return[{category:"",emojis:t}];const s=new Map;for(const e of t){const t=e.category||"";let i=s.get(t);i||(i=[],s.set(t,i)),i.push(e)}return[...s.entries()].map((([e,t])=>({category:e,emojis:t}))).sort(((e,t)=>r.customCategorySorting(e.category,t.category)))}(),ml(r.currentEmojisWithCategories,e,p)||(r.currentEmojisWithCategories=e)})),a((()=>{r.activeSearchItemId=-1!==r.activeSearchItem&&r.currentEmojis[r.activeSearchItem].id})),a((()=>{const{rawSearchText:e}=r;qh((()=>{r.searchText=(e||"").trim(),r.activeSearchItem=-1}))})),a((()=>{r.skinTonePickerExpanded?s.skinToneDropdown.addEventListener("transitionend",(()=>{r.skinTonePickerExpandedAfterAnimation=!0}),{once:!0}):r.skinTonePickerExpandedAfterAnimation=!1})),{$set(e){gl(r,e)},$destroy(){i.abort()}}}var wl={categoriesLabel:"Categories",emojiUnsupportedMessage:"Your browser does not support color emoji.",favoritesLabel:"Favorites",loadingMessage:"Loading…",networkErrorMessage:"Could not load emoji.",regionLabel:"Emoji picker",searchDescription:"When search results are available, press up or down to select and enter to choose.",searchLabel:"Search",searchResultsLabel:"Search results",skinToneDescription:"When expanded, press up or down to select and enter to choose.",skinToneLabel:"Choose a skin tone (currently {skinTone})",skinTonesLabel:"Skin tones",skinTones:["Default","Light","Medium-Light","Medium","Medium-Dark","Dark"],categories:{custom:"Custom","smileys-emotion":"Smileys and emoticons","people-body":"People and body","animals-nature":"Animals and nature","food-drink":"Food and drink","travel-places":"Travel and places",activities:"Activities",objects:"Objects",symbols:"Symbols",flags:"Flags"}};const _l=["customEmoji","customCategorySorting","database","dataSource","i18n","locale","skinToneEmoji","emojiVersion"],xl=`:host{--emoji-font-family:${Wh}}`;class vl extends HTMLElement{constructor(e){super(),this.attachShadow({mode:"open"});const t=document.createElement("style");t.textContent=":host{--emoji-size:1.375rem;--emoji-padding:0.5rem;--category-emoji-size:var(--emoji-size);--category-emoji-padding:var(--emoji-padding);--indicator-height:3px;--input-border-radius:0.5rem;--input-border-size:1px;--input-font-size:1rem;--input-line-height:1.5;--input-padding:0.25rem;--num-columns:8;--outline-size:2px;--border-size:1px;--skintone-border-radius:1rem;--category-font-size:1rem;display:flex;width:min-content;height:400px}:host,:host(.light){color-scheme:light;--background:#fff;--border-color:#e0e0e0;--indicator-color:#385ac1;--input-border-color:#999;--input-font-color:#111;--input-placeholder-color:#999;--outline-color:#999;--category-font-color:#111;--button-active-background:#e6e6e6;--button-hover-background:#d9d9d9}:host(.dark){color-scheme:dark;--background:#222;--border-color:#444;--indicator-color:#5373ec;--input-border-color:#ccc;--input-font-color:#efefef;--input-placeholder-color:#ccc;--outline-color:#fff;--category-font-color:#efefef;--button-active-background:#555555;--button-hover-background:#484848}@media (prefers-color-scheme:dark){:host{color-scheme:dark;--background:#222;--border-color:#444;--indicator-color:#5373ec;--input-border-color:#ccc;--input-font-color:#efefef;--input-placeholder-color:#ccc;--outline-color:#fff;--category-font-color:#efefef;--button-active-background:#555555;--button-hover-background:#484848}}:host([hidden]){display:none}button{margin:0;padding:0;border:0;background:0 0;box-shadow:none;-webkit-tap-highlight-color:transparent}button::-moz-focus-inner{border:0}input{padding:0;margin:0;line-height:1.15;font-family:inherit}input[type=search]{-webkit-appearance:none}:focus{outline:var(--outline-color) solid var(--outline-size);outline-offset:calc(-1*var(--outline-size))}:host([data-js-focus-visible]) :focus:not([data-focus-visible-added]){outline:0}:focus:not(:focus-visible){outline:0}.hide-focus{outline:0}*{box-sizing:border-box}.picker{contain:content;display:flex;flex-direction:column;background:var(--background);border:var(--border-size) solid var(--border-color);width:100%;height:100%;overflow:hidden;--total-emoji-size:calc(var(--emoji-size) + (2 * var(--emoji-padding)));--total-category-emoji-size:calc(var(--category-emoji-size) + (2 * var(--category-emoji-padding)))}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.hidden{opacity:0;pointer-events:none}.abs-pos{position:absolute;left:0;top:0}.gone{display:none!important}.skintone-button-wrapper,.skintone-list{background:var(--background);z-index:3}.skintone-button-wrapper.expanded{z-index:1}.skintone-list{position:absolute;inset-inline-end:0;top:0;z-index:2;overflow:visible;border-bottom:var(--border-size) solid var(--border-color);border-radius:0 0 var(--skintone-border-radius) var(--skintone-border-radius);will-change:transform;transition:transform .2s ease-in-out;transform-origin:center 0}@media (prefers-reduced-motion:reduce){.skintone-list{transition-duration:.001s}}@supports not (inset-inline-end:0){.skintone-list{right:0}}.skintone-list.no-animate{transition:none}.tabpanel{overflow-y:auto;-webkit-overflow-scrolling:touch;will-change:transform;min-height:0;flex:1;contain:content}.emoji-menu{display:grid;grid-template-columns:repeat(var(--num-columns),var(--total-emoji-size));justify-content:space-around;align-items:flex-start;width:100%}.category{padding:var(--emoji-padding);font-size:var(--category-font-size);color:var(--category-font-color)}.custom-emoji,.emoji,button.emoji{height:var(--total-emoji-size);width:var(--total-emoji-size)}.emoji,button.emoji{font-size:var(--emoji-size);display:flex;align-items:center;justify-content:center;border-radius:100%;line-height:1;overflow:hidden;font-family:var(--emoji-font-family);cursor:pointer}@media (hover:hover) and (pointer:fine){.emoji:hover,button.emoji:hover{background:var(--button-hover-background)}}.emoji.active,.emoji:active,button.emoji.active,button.emoji:active{background:var(--button-active-background)}.custom-emoji{padding:var(--emoji-padding);object-fit:contain;pointer-events:none;background-repeat:no-repeat;background-position:center center;background-size:var(--emoji-size) var(--emoji-size)}.nav,.nav-button{align-items:center}.nav{display:grid;justify-content:space-between;contain:content}.nav-button{display:flex;justify-content:center}.nav-emoji{font-size:var(--category-emoji-size);width:var(--total-category-emoji-size);height:var(--total-category-emoji-size)}.indicator-wrapper{display:flex;border-bottom:1px solid var(--border-color)}.indicator{width:calc(100%/var(--num-groups));height:var(--indicator-height);opacity:var(--indicator-opacity);background-color:var(--indicator-color);will-change:transform,opacity;transition:opacity .1s linear,transform .25s ease-in-out}@media (prefers-reduced-motion:reduce){.indicator{will-change:opacity;transition:opacity .1s linear}}.pad-top,input.search{background:var(--background);width:100%}.pad-top{height:var(--emoji-padding);z-index:3}.search-row{display:flex;align-items:center;position:relative;padding-inline-start:var(--emoji-padding);padding-bottom:var(--emoji-padding)}.search-wrapper{flex:1;min-width:0}input.search{padding:var(--input-padding);border-radius:var(--input-border-radius);border:var(--input-border-size) solid var(--input-border-color);color:var(--input-font-color);font-size:var(--input-font-size);line-height:var(--input-line-height)}input.search::placeholder{color:var(--input-placeholder-color)}.favorites{display:flex;flex-direction:row;border-top:var(--border-size) solid var(--border-color);contain:content}.message{padding:var(--emoji-padding)}"+xl,this.shadowRoot.appendChild(t),this._ctx={locale:"en",dataSource:"https://cdn.jsdelivr.net/npm/emoji-picker-element-data@^1/en/emojibase/data.json",skinToneEmoji:"🖐️",customCategorySorting:Kh,customEmoji:null,i18n:wl,emojiVersion:null,...e};for(const e of _l)"database"!==e&&Object.prototype.hasOwnProperty.call(this,e)&&(this._ctx[e]=this[e],delete this[e]);this._dbFlush()}connectedCallback(){this._cmp||(this._cmp=bl(this.shadowRoot,this._ctx))}disconnectedCallback(){fl((()=>{if(!this.isConnected&&this._cmp){this._cmp.$destroy(),this._cmp=void 0;const{database:e}=this._ctx;e.close().catch((e=>console.error(e)))}}))}static get observedAttributes(){return["locale","data-source","skin-tone-emoji","emoji-version"]}attributeChangedCallback(e,t,s){this._set(e.replace(/-([a-z])/g,((e,t)=>t.toUpperCase())),"emoji-version"===e?parseFloat(s):s)}_set(e,t){this._ctx[e]=t,this._cmp&&this._cmp.$set({[e]:t}),["locale","dataSource"].includes(e)&&this._dbFlush()}_dbCreate(){const{locale:e,dataSource:t,database:s}=this._ctx;s&&s.locale===e&&s.dataSource===t||this._set("database",new jh({locale:e,dataSource:t}))}_dbFlush(){fl((()=>this._dbCreate()))}}const Tl={};for(const e of _l)Tl[e]={get(){return"database"===e&&this._dbCreate(),this._ctx[e]},set(t){if("database"===e)throw new Error("database is read-only");this._set(e,t)}};Object.defineProperties(vl.prototype,Tl),customElements.get("emoji-picker")||customElements.define("emoji-picker",vl);const Pl={}.constructor,kl="".constructor,Cl=[].constructor,El=(async()=>{}).constructor;function Al(e){let t=e.length;for(;--t>=0;)e[t]=0}const Sl=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Il=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Nl=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Ll=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Dl=new Array(576);Al(Dl);const Ol=new Array(60);Al(Ol);const Ml=new Array(512);Al(Ml);const Rl=new Array(256);Al(Rl);const Fl=new Array(29);Al(Fl);const Bl=new Array(30);function jl(e,t,s,i,n){this.static_tree=e,this.extra_bits=t,this.extra_base=s,this.elems=i,this.max_length=n,this.has_stree=e&&e.length}let Ul,zl,ql;function Hl(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}Al(Bl);const Vl=e=>e<256?Ml[e]:Ml[256+(e>>>7)],$l=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},Wl=(e,t,s)=>{e.bi_valid>16-s?(e.bi_buf|=t<<e.bi_valid&65535,$l(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=s-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=s)},Kl=(e,t,s)=>{Wl(e,s[2*t],s[2*t+1])},Gl=(e,t)=>{let s=0;do{s|=1&e,e>>>=1,s<<=1}while(--t>0);return s>>>1},Yl=(e,t,s)=>{const i=new Array(16);let n,r,a=0;for(n=1;n<=15;n++)a=a+s[n-1]<<1,i[n]=a;for(r=0;r<=t;r++){let t=e[2*r+1];0!==t&&(e[2*r]=Gl(i[t]++,t))}},Jl=e=>{let t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},Xl=e=>{e.bi_valid>8?$l(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},Zl=(e,t,s,i)=>{const n=2*t,r=2*s;return e[n]<e[r]||e[n]===e[r]&&i[t]<=i[s]},Ql=(e,t,s)=>{const i=e.heap[s];let n=s<<1;for(;n<=e.heap_len&&(n<e.heap_len&&Zl(t,e.heap[n+1],e.heap[n],e.depth)&&n++,!Zl(t,i,e.heap[n],e.depth));)e.heap[s]=e.heap[n],s=n,n<<=1;e.heap[s]=i},ep=(e,t,s)=>{let i,n,r,a,o=0;if(0!==e.sym_next)do{i=255&e.pending_buf[e.sym_buf+o++],i+=(255&e.pending_buf[e.sym_buf+o++])<<8,n=e.pending_buf[e.sym_buf+o++],0===i?Kl(e,n,t):(r=Rl[n],Kl(e,r+256+1,t),a=Sl[r],0!==a&&(n-=Fl[r],Wl(e,n,a)),i--,r=Vl(i),Kl(e,r,s),a=Il[r],0!==a&&(i-=Bl[r],Wl(e,i,a)))}while(o<e.sym_next);Kl(e,256,t)},tp=(e,t)=>{const s=t.dyn_tree,i=t.stat_desc.static_tree,n=t.stat_desc.has_stree,r=t.stat_desc.elems;let a,o,c,h=-1;for(e.heap_len=0,e.heap_max=573,a=0;a<r;a++)0!==s[2*a]?(e.heap[++e.heap_len]=h=a,e.depth[a]=0):s[2*a+1]=0;for(;e.heap_len<2;)c=e.heap[++e.heap_len]=h<2?++h:0,s[2*c]=1,e.depth[c]=0,e.opt_len--,n&&(e.static_len-=i[2*c+1]);for(t.max_code=h,a=e.heap_len>>1;a>=1;a--)Ql(e,s,a);c=r;do{a=e.heap[1],e.heap[1]=e.heap[e.heap_len--],Ql(e,s,1),o=e.heap[1],e.heap[--e.heap_max]=a,e.heap[--e.heap_max]=o,s[2*c]=s[2*a]+s[2*o],e.depth[c]=(e.depth[a]>=e.depth[o]?e.depth[a]:e.depth[o])+1,s[2*a+1]=s[2*o+1]=c,e.heap[1]=c++,Ql(e,s,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const s=t.dyn_tree,i=t.max_code,n=t.stat_desc.static_tree,r=t.stat_desc.has_stree,a=t.stat_desc.extra_bits,o=t.stat_desc.extra_base,c=t.stat_desc.max_length;let h,l,p,u,d,f,m=0;for(u=0;u<=15;u++)e.bl_count[u]=0;for(s[2*e.heap[e.heap_max]+1]=0,h=e.heap_max+1;h<573;h++)l=e.heap[h],u=s[2*s[2*l+1]+1]+1,u>c&&(u=c,m++),s[2*l+1]=u,l>i||(e.bl_count[u]++,d=0,l>=o&&(d=a[l-o]),f=s[2*l],e.opt_len+=f*(u+d),r&&(e.static_len+=f*(n[2*l+1]+d)));if(0!==m){do{for(u=c-1;0===e.bl_count[u];)u--;e.bl_count[u]--,e.bl_count[u+1]+=2,e.bl_count[c]--,m-=2}while(m>0);for(u=c;0!==u;u--)for(l=e.bl_count[u];0!==l;)p=e.heap[--h],p>i||(s[2*p+1]!==u&&(e.opt_len+=(u-s[2*p+1])*s[2*p],s[2*p+1]=u),l--)}})(e,t),Yl(s,h,e.bl_count)},sp=(e,t,s)=>{let i,n,r=-1,a=t[1],o=0,c=7,h=4;for(0===a&&(c=138,h=3),t[2*(s+1)+1]=65535,i=0;i<=s;i++)n=a,a=t[2*(i+1)+1],++o<c&&n===a||(o<h?e.bl_tree[2*n]+=o:0!==n?(n!==r&&e.bl_tree[2*n]++,e.bl_tree[32]++):o<=10?e.bl_tree[34]++:e.bl_tree[36]++,o=0,r=n,0===a?(c=138,h=3):n===a?(c=6,h=3):(c=7,h=4))},ip=(e,t,s)=>{let i,n,r=-1,a=t[1],o=0,c=7,h=4;for(0===a&&(c=138,h=3),i=0;i<=s;i++)if(n=a,a=t[2*(i+1)+1],!(++o<c&&n===a)){if(o<h)do{Kl(e,n,e.bl_tree)}while(0!=--o);else 0!==n?(n!==r&&(Kl(e,n,e.bl_tree),o--),Kl(e,16,e.bl_tree),Wl(e,o-3,2)):o<=10?(Kl(e,17,e.bl_tree),Wl(e,o-3,3)):(Kl(e,18,e.bl_tree),Wl(e,o-11,7));o=0,r=n,0===a?(c=138,h=3):n===a?(c=6,h=3):(c=7,h=4)}};let np=!1;const rp=(e,t,s,i)=>{Wl(e,0+(i?1:0),3),Xl(e),$l(e,s),$l(e,~s),s&&e.pending_buf.set(e.window.subarray(t,t+s),e.pending),e.pending+=s};var ap={_tr_init:e=>{np||((()=>{let e,t,s,i,n;const r=new Array(16);for(s=0,i=0;i<28;i++)for(Fl[i]=s,e=0;e<1<<Sl[i];e++)Rl[s++]=i;for(Rl[s-1]=i,n=0,i=0;i<16;i++)for(Bl[i]=n,e=0;e<1<<Il[i];e++)Ml[n++]=i;for(n>>=7;i<30;i++)for(Bl[i]=n<<7,e=0;e<1<<Il[i]-7;e++)Ml[256+n++]=i;for(t=0;t<=15;t++)r[t]=0;for(e=0;e<=143;)Dl[2*e+1]=8,e++,r[8]++;for(;e<=255;)Dl[2*e+1]=9,e++,r[9]++;for(;e<=279;)Dl[2*e+1]=7,e++,r[7]++;for(;e<=287;)Dl[2*e+1]=8,e++,r[8]++;for(Yl(Dl,287,r),e=0;e<30;e++)Ol[2*e+1]=5,Ol[2*e]=Gl(e,5);Ul=new jl(Dl,Sl,257,286,15),zl=new jl(Ol,Il,0,30,15),ql=new jl(new Array(0),Nl,0,19,7)})(),np=!0),e.l_desc=new Hl(e.dyn_ltree,Ul),e.d_desc=new Hl(e.dyn_dtree,zl),e.bl_desc=new Hl(e.bl_tree,ql),e.bi_buf=0,e.bi_valid=0,Jl(e)},_tr_stored_block:rp,_tr_flush_block:(e,t,s,i)=>{let n,r,a=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,s=4093624447;for(t=0;t<=31;t++,s>>>=1)if(1&s&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),tp(e,e.l_desc),tp(e,e.d_desc),a=(e=>{let t;for(sp(e,e.dyn_ltree,e.l_desc.max_code),sp(e,e.dyn_dtree,e.d_desc.max_code),tp(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*Ll[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),n=e.opt_len+3+7>>>3,r=e.static_len+3+7>>>3,r<=n&&(n=r)):n=r=s+5,s+4<=n&&-1!==t?rp(e,t,s,i):4===e.strategy||r===n?(Wl(e,2+(i?1:0),3),ep(e,Dl,Ol)):(Wl(e,4+(i?1:0),3),((e,t,s,i)=>{let n;for(Wl(e,t-257,5),Wl(e,s-1,5),Wl(e,i-4,4),n=0;n<i;n++)Wl(e,e.bl_tree[2*Ll[n]+1],3);ip(e,e.dyn_ltree,t-1),ip(e,e.dyn_dtree,s-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),ep(e,e.dyn_ltree,e.dyn_dtree)),Jl(e),i&&Xl(e)},_tr_tally:(e,t,s)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=s,0===t?e.dyn_ltree[2*s]++:(e.matches++,t--,e.dyn_ltree[2*(Rl[s]+256+1)]++,e.dyn_dtree[2*Vl(t)]++),e.sym_next===e.sym_end),_tr_align:e=>{Wl(e,2,3),Kl(e,256,Dl),(e=>{16===e.bi_valid?($l(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)}},op=(e,t,s,i)=>{let n=65535&e|0,r=e>>>16&65535|0,a=0;for(;0!==s;){a=s>2e3?2e3:s,s-=a;do{n=n+t[i++]|0,r=r+n|0}while(--a);n%=65521,r%=65521}return n|r<<16|0};const cp=new Uint32Array((()=>{let e,t=[];for(var s=0;s<256;s++){e=s;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[s]=e}return t})());var hp=(e,t,s,i)=>{const n=cp,r=i+s;e^=-1;for(let s=i;s<r;s++)e=e>>>8^n[255&(e^t[s])];return-1^e},lp={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},pp={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:up,_tr_stored_block:dp,_tr_flush_block:fp,_tr_tally:mp,_tr_align:yp}=ap,{Z_NO_FLUSH:gp,Z_PARTIAL_FLUSH:bp,Z_FULL_FLUSH:wp,Z_FINISH:_p,Z_BLOCK:xp,Z_OK:vp,Z_STREAM_END:Tp,Z_STREAM_ERROR:Pp,Z_DATA_ERROR:kp,Z_BUF_ERROR:Cp,Z_DEFAULT_COMPRESSION:Ep,Z_FILTERED:Ap,Z_HUFFMAN_ONLY:Sp,Z_RLE:Ip,Z_FIXED:Np,Z_DEFAULT_STRATEGY:Lp,Z_UNKNOWN:Dp,Z_DEFLATED:Op}=pp,Mp=258,Rp=262,Fp=42,Bp=113,jp=666,Up=(e,t)=>(e.msg=lp[t],t),zp=e=>2*e-(e>4?9:0),qp=e=>{let t=e.length;for(;--t>=0;)e[t]=0},Hp=e=>{let t,s,i,n=e.w_size;t=e.hash_size,i=t;do{s=e.head[--i],e.head[i]=s>=n?s-n:0}while(--t);t=n,i=t;do{s=e.prev[--i],e.prev[i]=s>=n?s-n:0}while(--t)};let Vp=(e,t,s)=>(t<<e.hash_shift^s)&e.hash_mask;const $p=e=>{const t=e.state;let s=t.pending;s>e.avail_out&&(s=e.avail_out),0!==s&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+s),e.next_out),e.next_out+=s,t.pending_out+=s,e.total_out+=s,e.avail_out-=s,t.pending-=s,0===t.pending&&(t.pending_out=0))},Wp=(e,t)=>{fp(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,$p(e.strm)},Kp=(e,t)=>{e.pending_buf[e.pending++]=t},Gp=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},Yp=(e,t,s,i)=>{let n=e.avail_in;return n>i&&(n=i),0===n?0:(e.avail_in-=n,t.set(e.input.subarray(e.next_in,e.next_in+n),s),1===e.state.wrap?e.adler=op(e.adler,t,n,s):2===e.state.wrap&&(e.adler=hp(e.adler,t,n,s)),e.next_in+=n,e.total_in+=n,n)},Jp=(e,t)=>{let s,i,n=e.max_chain_length,r=e.strstart,a=e.prev_length,o=e.nice_match;const c=e.strstart>e.w_size-Rp?e.strstart-(e.w_size-Rp):0,h=e.window,l=e.w_mask,p=e.prev,u=e.strstart+Mp;let d=h[r+a-1],f=h[r+a];e.prev_length>=e.good_match&&(n>>=2),o>e.lookahead&&(o=e.lookahead);do{if(s=t,h[s+a]===f&&h[s+a-1]===d&&h[s]===h[r]&&h[++s]===h[r+1]){r+=2,s++;do{}while(h[++r]===h[++s]&&h[++r]===h[++s]&&h[++r]===h[++s]&&h[++r]===h[++s]&&h[++r]===h[++s]&&h[++r]===h[++s]&&h[++r]===h[++s]&&h[++r]===h[++s]&&r<u);if(i=Mp-(u-r),r=u-Mp,i>a){if(e.match_start=t,a=i,i>=o)break;d=h[r+a-1],f=h[r+a]}}}while((t=p[t&l])>c&&0!=--n);return a<=e.lookahead?a:e.lookahead},Xp=e=>{const t=e.w_size;let s,i,n;do{if(i=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-Rp)&&(e.window.set(e.window.subarray(t,t+t-i),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),Hp(e),i+=t),0===e.strm.avail_in)break;if(s=Yp(e.strm,e.window,e.strstart+e.lookahead,i),e.lookahead+=s,e.lookahead+e.insert>=3)for(n=e.strstart-e.insert,e.ins_h=e.window[n],e.ins_h=Vp(e,e.ins_h,e.window[n+1]);e.insert&&(e.ins_h=Vp(e,e.ins_h,e.window[n+3-1]),e.prev[n&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=n,n++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<Rp&&0!==e.strm.avail_in)},Zp=(e,t)=>{let s,i,n,r=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,a=0,o=e.strm.avail_in;do{if(s=65535,n=e.bi_valid+42>>3,e.strm.avail_out<n)break;if(n=e.strm.avail_out-n,i=e.strstart-e.block_start,s>i+e.strm.avail_in&&(s=i+e.strm.avail_in),s>n&&(s=n),s<r&&(0===s&&t!==_p||t===gp||s!==i+e.strm.avail_in))break;a=t===_p&&s===i+e.strm.avail_in?1:0,dp(e,0,0,a),e.pending_buf[e.pending-4]=s,e.pending_buf[e.pending-3]=s>>8,e.pending_buf[e.pending-2]=~s,e.pending_buf[e.pending-1]=~s>>8,$p(e.strm),i&&(i>s&&(i=s),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+i),e.strm.next_out),e.strm.next_out+=i,e.strm.avail_out-=i,e.strm.total_out+=i,e.block_start+=i,s-=i),s&&(Yp(e.strm,e.strm.output,e.strm.next_out,s),e.strm.next_out+=s,e.strm.avail_out-=s,e.strm.total_out+=s)}while(0===a);return o-=e.strm.avail_in,o&&(o>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=o&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-o,e.strm.next_in),e.strstart),e.strstart+=o,e.insert+=o>e.w_size-e.insert?e.w_size-e.insert:o),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),a?4:t!==gp&&t!==_p&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(n=e.window_size-e.strstart,e.strm.avail_in>n&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,n+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),n>e.strm.avail_in&&(n=e.strm.avail_in),n&&(Yp(e.strm,e.window,e.strstart,n),e.strstart+=n,e.insert+=n>e.w_size-e.insert?e.w_size-e.insert:n),e.high_water<e.strstart&&(e.high_water=e.strstart),n=e.bi_valid+42>>3,n=e.pending_buf_size-n>65535?65535:e.pending_buf_size-n,r=n>e.w_size?e.w_size:n,i=e.strstart-e.block_start,(i>=r||(i||t===_p)&&t!==gp&&0===e.strm.avail_in&&i<=n)&&(s=i>n?n:i,a=t===_p&&0===e.strm.avail_in&&s===i?1:0,dp(e,e.block_start,s,a),e.block_start+=s,$p(e.strm)),a?3:1)},Qp=(e,t)=>{let s,i;for(;;){if(e.lookahead<Rp){if(Xp(e),e.lookahead<Rp&&t===gp)return 1;if(0===e.lookahead)break}if(s=0,e.lookahead>=3&&(e.ins_h=Vp(e,e.ins_h,e.window[e.strstart+3-1]),s=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==s&&e.strstart-s<=e.w_size-Rp&&(e.match_length=Jp(e,s)),e.match_length>=3)if(i=mp(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=Vp(e,e.ins_h,e.window[e.strstart+3-1]),s=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=Vp(e,e.ins_h,e.window[e.strstart+1]);else i=mp(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(Wp(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===_p?(Wp(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Wp(e,!1),0===e.strm.avail_out)?1:2},eu=(e,t)=>{let s,i,n;for(;;){if(e.lookahead<Rp){if(Xp(e),e.lookahead<Rp&&t===gp)return 1;if(0===e.lookahead)break}if(s=0,e.lookahead>=3&&(e.ins_h=Vp(e,e.ins_h,e.window[e.strstart+3-1]),s=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==s&&e.prev_length<e.max_lazy_match&&e.strstart-s<=e.w_size-Rp&&(e.match_length=Jp(e,s),e.match_length<=5&&(e.strategy===Ap||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){n=e.strstart+e.lookahead-3,i=mp(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=n&&(e.ins_h=Vp(e,e.ins_h,e.window[e.strstart+3-1]),s=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,i&&(Wp(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(i=mp(e,0,e.window[e.strstart-1]),i&&Wp(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=mp(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===_p?(Wp(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Wp(e,!1),0===e.strm.avail_out)?1:2};function tu(e,t,s,i,n){this.good_length=e,this.max_lazy=t,this.nice_length=s,this.max_chain=i,this.func=n}const su=[new tu(0,0,0,0,Zp),new tu(4,4,8,4,Qp),new tu(4,5,16,8,Qp),new tu(4,6,32,32,Qp),new tu(4,4,16,16,eu),new tu(8,16,32,32,eu),new tu(8,16,128,128,eu),new tu(8,32,128,256,eu),new tu(32,128,258,1024,eu),new tu(32,258,258,4096,eu)];function iu(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Op,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),qp(this.dyn_ltree),qp(this.dyn_dtree),qp(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),qp(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),qp(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const nu=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==Fp&&57!==t.status&&69!==t.status&&73!==t.status&&91!==t.status&&103!==t.status&&t.status!==Bp&&t.status!==jp?1:0},ru=e=>{if(nu(e))return Up(e,Pp);e.total_in=e.total_out=0,e.data_type=Dp;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?Fp:Bp,e.adler=2===t.wrap?0:1,t.last_flush=-2,up(t),vp},au=e=>{const t=ru(e);var s;return t===vp&&((s=e.state).window_size=2*s.w_size,qp(s.head),s.max_lazy_match=su[s.level].max_lazy,s.good_match=su[s.level].good_length,s.nice_match=su[s.level].nice_length,s.max_chain_length=su[s.level].max_chain,s.strstart=0,s.block_start=0,s.lookahead=0,s.insert=0,s.match_length=s.prev_length=2,s.match_available=0,s.ins_h=0),t},ou=(e,t,s,i,n,r)=>{if(!e)return Pp;let a=1;if(t===Ep&&(t=6),i<0?(a=0,i=-i):i>15&&(a=2,i-=16),n<1||n>9||s!==Op||i<8||i>15||t<0||t>9||r<0||r>Np||8===i&&1!==a)return Up(e,Pp);8===i&&(i=9);const o=new iu;return e.state=o,o.strm=e,o.status=Fp,o.wrap=a,o.gzhead=null,o.w_bits=i,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=n+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+3-1)/3),o.window=new Uint8Array(2*o.w_size),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<n+6,o.pending_buf_size=4*o.lit_bufsize,o.pending_buf=new Uint8Array(o.pending_buf_size),o.sym_buf=o.lit_bufsize,o.sym_end=3*(o.lit_bufsize-1),o.level=t,o.strategy=r,o.method=s,au(e)};var cu={deflateInit:(e,t)=>ou(e,t,Op,15,8,Lp),deflateInit2:ou,deflateReset:au,deflateResetKeep:ru,deflateSetHeader:(e,t)=>nu(e)||2!==e.state.wrap?Pp:(e.state.gzhead=t,vp),deflate:(e,t)=>{if(nu(e)||t>xp||t<0)return e?Up(e,Pp):Pp;const s=e.state;if(!e.output||0!==e.avail_in&&!e.input||s.status===jp&&t!==_p)return Up(e,0===e.avail_out?Cp:Pp);const i=s.last_flush;if(s.last_flush=t,0!==s.pending){if($p(e),0===e.avail_out)return s.last_flush=-1,vp}else if(0===e.avail_in&&zp(t)<=zp(i)&&t!==_p)return Up(e,Cp);if(s.status===jp&&0!==e.avail_in)return Up(e,Cp);if(s.status===Fp&&0===s.wrap&&(s.status=Bp),s.status===Fp){let t=Op+(s.w_bits-8<<4)<<8,i=-1;if(i=s.strategy>=Sp||s.level<2?0:s.level<6?1:6===s.level?2:3,t|=i<<6,0!==s.strstart&&(t|=32),t+=31-t%31,Gp(s,t),0!==s.strstart&&(Gp(s,e.adler>>>16),Gp(s,65535&e.adler)),e.adler=1,s.status=Bp,$p(e),0!==s.pending)return s.last_flush=-1,vp}if(57===s.status)if(e.adler=0,Kp(s,31),Kp(s,139),Kp(s,8),s.gzhead)Kp(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(s.gzhead.extra?4:0)+(s.gzhead.name?8:0)+(s.gzhead.comment?16:0)),Kp(s,255&s.gzhead.time),Kp(s,s.gzhead.time>>8&255),Kp(s,s.gzhead.time>>16&255),Kp(s,s.gzhead.time>>24&255),Kp(s,9===s.level?2:s.strategy>=Sp||s.level<2?4:0),Kp(s,255&s.gzhead.os),s.gzhead.extra&&s.gzhead.extra.length&&(Kp(s,255&s.gzhead.extra.length),Kp(s,s.gzhead.extra.length>>8&255)),s.gzhead.hcrc&&(e.adler=hp(e.adler,s.pending_buf,s.pending,0)),s.gzindex=0,s.status=69;else if(Kp(s,0),Kp(s,0),Kp(s,0),Kp(s,0),Kp(s,0),Kp(s,9===s.level?2:s.strategy>=Sp||s.level<2?4:0),Kp(s,3),s.status=Bp,$p(e),0!==s.pending)return s.last_flush=-1,vp;if(69===s.status){if(s.gzhead.extra){let t=s.pending,i=(65535&s.gzhead.extra.length)-s.gzindex;for(;s.pending+i>s.pending_buf_size;){let n=s.pending_buf_size-s.pending;if(s.pending_buf.set(s.gzhead.extra.subarray(s.gzindex,s.gzindex+n),s.pending),s.pending=s.pending_buf_size,s.gzhead.hcrc&&s.pending>t&&(e.adler=hp(e.adler,s.pending_buf,s.pending-t,t)),s.gzindex+=n,$p(e),0!==s.pending)return s.last_flush=-1,vp;t=0,i-=n}let n=new Uint8Array(s.gzhead.extra);s.pending_buf.set(n.subarray(s.gzindex,s.gzindex+i),s.pending),s.pending+=i,s.gzhead.hcrc&&s.pending>t&&(e.adler=hp(e.adler,s.pending_buf,s.pending-t,t)),s.gzindex=0}s.status=73}if(73===s.status){if(s.gzhead.name){let t,i=s.pending;do{if(s.pending===s.pending_buf_size){if(s.gzhead.hcrc&&s.pending>i&&(e.adler=hp(e.adler,s.pending_buf,s.pending-i,i)),$p(e),0!==s.pending)return s.last_flush=-1,vp;i=0}t=s.gzindex<s.gzhead.name.length?255&s.gzhead.name.charCodeAt(s.gzindex++):0,Kp(s,t)}while(0!==t);s.gzhead.hcrc&&s.pending>i&&(e.adler=hp(e.adler,s.pending_buf,s.pending-i,i)),s.gzindex=0}s.status=91}if(91===s.status){if(s.gzhead.comment){let t,i=s.pending;do{if(s.pending===s.pending_buf_size){if(s.gzhead.hcrc&&s.pending>i&&(e.adler=hp(e.adler,s.pending_buf,s.pending-i,i)),$p(e),0!==s.pending)return s.last_flush=-1,vp;i=0}t=s.gzindex<s.gzhead.comment.length?255&s.gzhead.comment.charCodeAt(s.gzindex++):0,Kp(s,t)}while(0!==t);s.gzhead.hcrc&&s.pending>i&&(e.adler=hp(e.adler,s.pending_buf,s.pending-i,i))}s.status=103}if(103===s.status){if(s.gzhead.hcrc){if(s.pending+2>s.pending_buf_size&&($p(e),0!==s.pending))return s.last_flush=-1,vp;Kp(s,255&e.adler),Kp(s,e.adler>>8&255),e.adler=0}if(s.status=Bp,$p(e),0!==s.pending)return s.last_flush=-1,vp}if(0!==e.avail_in||0!==s.lookahead||t!==gp&&s.status!==jp){let i=0===s.level?Zp(s,t):s.strategy===Sp?((e,t)=>{let s;for(;;){if(0===e.lookahead&&(Xp(e),0===e.lookahead)){if(t===gp)return 1;break}if(e.match_length=0,s=mp(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,s&&(Wp(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===_p?(Wp(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Wp(e,!1),0===e.strm.avail_out)?1:2})(s,t):s.strategy===Ip?((e,t)=>{let s,i,n,r;const a=e.window;for(;;){if(e.lookahead<=Mp){if(Xp(e),e.lookahead<=Mp&&t===gp)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(n=e.strstart-1,i=a[n],i===a[++n]&&i===a[++n]&&i===a[++n])){r=e.strstart+Mp;do{}while(i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&n<r);e.match_length=Mp-(r-n),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(s=mp(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(s=mp(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),s&&(Wp(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===_p?(Wp(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Wp(e,!1),0===e.strm.avail_out)?1:2})(s,t):su[s.level].func(s,t);if(3!==i&&4!==i||(s.status=jp),1===i||3===i)return 0===e.avail_out&&(s.last_flush=-1),vp;if(2===i&&(t===bp?yp(s):t!==xp&&(dp(s,0,0,!1),t===wp&&(qp(s.head),0===s.lookahead&&(s.strstart=0,s.block_start=0,s.insert=0))),$p(e),0===e.avail_out))return s.last_flush=-1,vp}return t!==_p?vp:s.wrap<=0?Tp:(2===s.wrap?(Kp(s,255&e.adler),Kp(s,e.adler>>8&255),Kp(s,e.adler>>16&255),Kp(s,e.adler>>24&255),Kp(s,255&e.total_in),Kp(s,e.total_in>>8&255),Kp(s,e.total_in>>16&255),Kp(s,e.total_in>>24&255)):(Gp(s,e.adler>>>16),Gp(s,65535&e.adler)),$p(e),s.wrap>0&&(s.wrap=-s.wrap),0!==s.pending?vp:Tp)},deflateEnd:e=>{if(nu(e))return Pp;const t=e.state.status;return e.state=null,t===Bp?Up(e,kp):vp},deflateSetDictionary:(e,t)=>{let s=t.length;if(nu(e))return Pp;const i=e.state,n=i.wrap;if(2===n||1===n&&i.status!==Fp||i.lookahead)return Pp;if(1===n&&(e.adler=op(e.adler,t,s,0)),i.wrap=0,s>=i.w_size){0===n&&(qp(i.head),i.strstart=0,i.block_start=0,i.insert=0);let e=new Uint8Array(i.w_size);e.set(t.subarray(s-i.w_size,s),0),t=e,s=i.w_size}const r=e.avail_in,a=e.next_in,o=e.input;for(e.avail_in=s,e.next_in=0,e.input=t,Xp(i);i.lookahead>=3;){let e=i.strstart,t=i.lookahead-2;do{i.ins_h=Vp(i,i.ins_h,i.window[e+3-1]),i.prev[e&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=e,e++}while(--t);i.strstart=e,i.lookahead=2,Xp(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,e.next_in=a,e.input=o,e.avail_in=r,i.wrap=n,vp},deflateInfo:"pako deflate (from Nodeca project)"};const hu=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var lu={assign:function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const s=t.shift();if(s){if("object"!=typeof s)throw new TypeError(s+"must be non-object");for(const t in s)hu(s,t)&&(e[t]=s[t])}}return e},flattenChunks:e=>{let t=0;for(let s=0,i=e.length;s<i;s++)t+=e[s].length;const s=new Uint8Array(t);for(let t=0,i=0,n=e.length;t<n;t++){let n=e[t];s.set(n,i),i+=n.length}return s}};let pu=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(tf){pu=!1}const uu=new Uint8Array(256);for(let e=0;e<256;e++)uu[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;uu[254]=uu[254]=1;var du={string2buf:e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,s,i,n,r,a=e.length,o=0;for(n=0;n<a;n++)s=e.charCodeAt(n),55296==(64512&s)&&n+1<a&&(i=e.charCodeAt(n+1),56320==(64512&i)&&(s=65536+(s-55296<<10)+(i-56320),n++)),o+=s<128?1:s<2048?2:s<65536?3:4;for(t=new Uint8Array(o),r=0,n=0;r<o;n++)s=e.charCodeAt(n),55296==(64512&s)&&n+1<a&&(i=e.charCodeAt(n+1),56320==(64512&i)&&(s=65536+(s-55296<<10)+(i-56320),n++)),s<128?t[r++]=s:s<2048?(t[r++]=192|s>>>6,t[r++]=128|63&s):s<65536?(t[r++]=224|s>>>12,t[r++]=128|s>>>6&63,t[r++]=128|63&s):(t[r++]=240|s>>>18,t[r++]=128|s>>>12&63,t[r++]=128|s>>>6&63,t[r++]=128|63&s);return t},buf2string:(e,t)=>{const s=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let i,n;const r=new Array(2*s);for(n=0,i=0;i<s;){let t=e[i++];if(t<128){r[n++]=t;continue}let a=uu[t];if(a>4)r[n++]=65533,i+=a-1;else{for(t&=2===a?31:3===a?15:7;a>1&&i<s;)t=t<<6|63&e[i++],a--;a>1?r[n++]=65533:t<65536?r[n++]=t:(t-=65536,r[n++]=55296|t>>10&1023,r[n++]=56320|1023&t)}}return((e,t)=>{if(t<65534&&e.subarray&&pu)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let s="";for(let i=0;i<t;i++)s+=String.fromCharCode(e[i]);return s})(r,n)},utf8border:(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let s=t-1;for(;s>=0&&128==(192&e[s]);)s--;return s<0||0===s?t:s+uu[e[s]]>t?s:t}},fu=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const mu=Object.prototype.toString,{Z_NO_FLUSH:yu,Z_SYNC_FLUSH:gu,Z_FULL_FLUSH:bu,Z_FINISH:wu,Z_OK:_u,Z_STREAM_END:xu,Z_DEFAULT_COMPRESSION:vu,Z_DEFAULT_STRATEGY:Tu,Z_DEFLATED:Pu}=pp;function ku(e){this.options=lu.assign({level:vu,method:Pu,chunkSize:16384,windowBits:15,memLevel:8,strategy:Tu},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new fu,this.strm.avail_out=0;let s=cu.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(s!==_u)throw new Error(lp[s]);if(t.header&&cu.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?du.string2buf(t.dictionary):"[object ArrayBuffer]"===mu.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,s=cu.deflateSetDictionary(this.strm,e),s!==_u)throw new Error(lp[s]);this._dict_set=!0}}function Cu(e,t){const s=new ku(t);if(s.push(e,!0),s.err)throw s.msg||lp[s.err];return s.result}ku.prototype.push=function(e,t){const s=this.strm,i=this.options.chunkSize;let n,r;if(this.ended)return!1;for(r=t===~~t?t:!0===t?wu:yu,"string"==typeof e?s.input=du.string2buf(e):"[object ArrayBuffer]"===mu.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;;)if(0===s.avail_out&&(s.output=new Uint8Array(i),s.next_out=0,s.avail_out=i),(r===gu||r===bu)&&s.avail_out<=6)this.onData(s.output.subarray(0,s.next_out)),s.avail_out=0;else{if(n=cu.deflate(s,r),n===xu)return s.next_out>0&&this.onData(s.output.subarray(0,s.next_out)),n=cu.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===_u;if(0!==s.avail_out){if(r>0&&s.next_out>0)this.onData(s.output.subarray(0,s.next_out)),s.avail_out=0;else if(0===s.avail_in)break}else this.onData(s.output)}return!0},ku.prototype.onData=function(e){this.chunks.push(e)},ku.prototype.onEnd=function(e){e===_u&&(this.result=lu.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Eu={Deflate:ku,deflate:Cu,deflateRaw:function(e,t){return(t=t||{}).raw=!0,Cu(e,t)},gzip:function(e,t){return(t=t||{}).gzip=!0,Cu(e,t)},constants:pp};const Au=16209;var Su=function(e,t){let s,i,n,r,a,o,c,h,l,p,u,d,f,m,y,g,b,w,_,x,v,T,P,k;const C=e.state;s=e.next_in,P=e.input,i=s+(e.avail_in-5),n=e.next_out,k=e.output,r=n-(t-e.avail_out),a=n+(e.avail_out-257),o=C.dmax,c=C.wsize,h=C.whave,l=C.wnext,p=C.window,u=C.hold,d=C.bits,f=C.lencode,m=C.distcode,y=(1<<C.lenbits)-1,g=(1<<C.distbits)-1;e:do{d<15&&(u+=P[s++]<<d,d+=8,u+=P[s++]<<d,d+=8),b=f[u&y];t:for(;;){if(w=b>>>24,u>>>=w,d-=w,w=b>>>16&255,0===w)k[n++]=65535&b;else{if(!(16&w)){if(0==(64&w)){b=f[(65535&b)+(u&(1<<w)-1)];continue t}if(32&w){C.mode=16191;break e}e.msg="invalid literal/length code",C.mode=Au;break e}_=65535&b,w&=15,w&&(d<w&&(u+=P[s++]<<d,d+=8),_+=u&(1<<w)-1,u>>>=w,d-=w),d<15&&(u+=P[s++]<<d,d+=8,u+=P[s++]<<d,d+=8),b=m[u&g];s:for(;;){if(w=b>>>24,u>>>=w,d-=w,w=b>>>16&255,!(16&w)){if(0==(64&w)){b=m[(65535&b)+(u&(1<<w)-1)];continue s}e.msg="invalid distance code",C.mode=Au;break e}if(x=65535&b,w&=15,d<w&&(u+=P[s++]<<d,d+=8,d<w&&(u+=P[s++]<<d,d+=8)),x+=u&(1<<w)-1,x>o){e.msg="invalid distance too far back",C.mode=Au;break e}if(u>>>=w,d-=w,w=n-r,x>w){if(w=x-w,w>h&&C.sane){e.msg="invalid distance too far back",C.mode=Au;break e}if(v=0,T=p,0===l){if(v+=c-w,w<_){_-=w;do{k[n++]=p[v++]}while(--w);v=n-x,T=k}}else if(l<w){if(v+=c+l-w,w-=l,w<_){_-=w;do{k[n++]=p[v++]}while(--w);if(v=0,l<_){w=l,_-=w;do{k[n++]=p[v++]}while(--w);v=n-x,T=k}}}else if(v+=l-w,w<_){_-=w;do{k[n++]=p[v++]}while(--w);v=n-x,T=k}for(;_>2;)k[n++]=T[v++],k[n++]=T[v++],k[n++]=T[v++],_-=3;_&&(k[n++]=T[v++],_>1&&(k[n++]=T[v++]))}else{v=n-x;do{k[n++]=k[v++],k[n++]=k[v++],k[n++]=k[v++],_-=3}while(_>2);_&&(k[n++]=k[v++],_>1&&(k[n++]=k[v++]))}break}}break}}while(s<i&&n<a);_=d>>3,s-=_,d-=_<<3,u&=(1<<d)-1,e.next_in=s,e.next_out=n,e.avail_in=s<i?i-s+5:5-(s-i),e.avail_out=n<a?a-n+257:257-(n-a),C.hold=u,C.bits=d};const Iu=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Nu=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Lu=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Du=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Ou=(e,t,s,i,n,r,a,o)=>{const c=o.bits;let h,l,p,u,d,f,m=0,y=0,g=0,b=0,w=0,_=0,x=0,v=0,T=0,P=0,k=null;const C=new Uint16Array(16),E=new Uint16Array(16);let A,S,I,N=null;for(m=0;m<=15;m++)C[m]=0;for(y=0;y<i;y++)C[t[s+y]]++;for(w=c,b=15;b>=1&&0===C[b];b--);if(w>b&&(w=b),0===b)return n[r++]=20971520,n[r++]=20971520,o.bits=1,0;for(g=1;g<b&&0===C[g];g++);for(w<g&&(w=g),v=1,m=1;m<=15;m++)if(v<<=1,v-=C[m],v<0)return-1;if(v>0&&(0===e||1!==b))return-1;for(E[1]=0,m=1;m<15;m++)E[m+1]=E[m]+C[m];for(y=0;y<i;y++)0!==t[s+y]&&(a[E[t[s+y]]++]=y);if(0===e?(k=N=a,f=20):1===e?(k=Iu,N=Nu,f=257):(k=Lu,N=Du,f=0),P=0,y=0,m=g,d=r,_=w,x=0,p=-1,T=1<<w,u=T-1,1===e&&T>852||2===e&&T>592)return 1;for(;;){A=m-x,a[y]+1<f?(S=0,I=a[y]):a[y]>=f?(S=N[a[y]-f],I=k[a[y]-f]):(S=96,I=0),h=1<<m-x,l=1<<_,g=l;do{l-=h,n[d+(P>>x)+l]=A<<24|S<<16|I|0}while(0!==l);for(h=1<<m-1;P&h;)h>>=1;if(0!==h?(P&=h-1,P+=h):P=0,y++,0==--C[m]){if(m===b)break;m=t[s+a[y]]}if(m>w&&(P&u)!==p){for(0===x&&(x=w),d+=g,_=m-x,v=1<<_;_+x<b&&(v-=C[_+x],!(v<=0));)_++,v<<=1;if(T+=1<<_,1===e&&T>852||2===e&&T>592)return 1;p=P&u,n[p]=w<<24|_<<16|d-r|0}}return 0!==P&&(n[d+P]=m-x<<24|64<<16|0),o.bits=w,0};const{Z_FINISH:Mu,Z_BLOCK:Ru,Z_TREES:Fu,Z_OK:Bu,Z_STREAM_END:ju,Z_NEED_DICT:Uu,Z_STREAM_ERROR:zu,Z_DATA_ERROR:qu,Z_MEM_ERROR:Hu,Z_BUF_ERROR:Vu,Z_DEFLATED:$u}=pp,Wu=16180,Ku=16190,Gu=16191,Yu=16192,Ju=16194,Xu=16199,Zu=16200,Qu=16206,ed=16209,td=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function sd(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const id=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<Wu||t.mode>16211?1:0},nd=e=>{if(id(e))return zu;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=Wu,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,Bu},rd=e=>{if(id(e))return zu;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,nd(e)},ad=(e,t)=>{let s;if(id(e))return zu;const i=e.state;return t<0?(s=0,t=-t):(s=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?zu:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=s,i.wbits=t,rd(e))},od=(e,t)=>{if(!e)return zu;const s=new sd;e.state=s,s.strm=e,s.window=null,s.mode=Wu;const i=ad(e,t);return i!==Bu&&(e.state=null),i};let cd,hd,ld=!0;const pd=e=>{if(ld){cd=new Int32Array(512),hd=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Ou(1,e.lens,0,288,cd,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Ou(2,e.lens,0,32,hd,0,e.work,{bits:5}),ld=!1}e.lencode=cd,e.lenbits=9,e.distcode=hd,e.distbits=5},ud=(e,t,s,i)=>{let n;const r=e.state;return null===r.window&&(r.wsize=1<<r.wbits,r.wnext=0,r.whave=0,r.window=new Uint8Array(r.wsize)),i>=r.wsize?(r.window.set(t.subarray(s-r.wsize,s),0),r.wnext=0,r.whave=r.wsize):(n=r.wsize-r.wnext,n>i&&(n=i),r.window.set(t.subarray(s-i,s-i+n),r.wnext),(i-=n)?(r.window.set(t.subarray(s-i,s),0),r.wnext=i,r.whave=r.wsize):(r.wnext+=n,r.wnext===r.wsize&&(r.wnext=0),r.whave<r.wsize&&(r.whave+=n))),0};var dd={inflateReset:rd,inflateReset2:ad,inflateResetKeep:nd,inflateInit:e=>od(e,15),inflateInit2:od,inflate:(e,t)=>{let s,i,n,r,a,o,c,h,l,p,u,d,f,m,y,g,b,w,_,x,v,T,P=0;const k=new Uint8Array(4);let C,E;const A=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(id(e)||!e.output||!e.input&&0!==e.avail_in)return zu;s=e.state,s.mode===Gu&&(s.mode=Yu),a=e.next_out,n=e.output,c=e.avail_out,r=e.next_in,i=e.input,o=e.avail_in,h=s.hold,l=s.bits,p=o,u=c,T=Bu;e:for(;;)switch(s.mode){case Wu:if(0===s.wrap){s.mode=Yu;break}for(;l<16;){if(0===o)break e;o--,h+=i[r++]<<l,l+=8}if(2&s.wrap&&35615===h){0===s.wbits&&(s.wbits=15),s.check=0,k[0]=255&h,k[1]=h>>>8&255,s.check=hp(s.check,k,2,0),h=0,l=0,s.mode=16181;break}if(s.head&&(s.head.done=!1),!(1&s.wrap)||(((255&h)<<8)+(h>>8))%31){e.msg="incorrect header check",s.mode=ed;break}if((15&h)!==$u){e.msg="unknown compression method",s.mode=ed;break}if(h>>>=4,l-=4,v=8+(15&h),0===s.wbits&&(s.wbits=v),v>15||v>s.wbits){e.msg="invalid window size",s.mode=ed;break}s.dmax=1<<s.wbits,s.flags=0,e.adler=s.check=1,s.mode=512&h?16189:Gu,h=0,l=0;break;case 16181:for(;l<16;){if(0===o)break e;o--,h+=i[r++]<<l,l+=8}if(s.flags=h,(255&s.flags)!==$u){e.msg="unknown compression method",s.mode=ed;break}if(57344&s.flags){e.msg="unknown header flags set",s.mode=ed;break}s.head&&(s.head.text=h>>8&1),512&s.flags&&4&s.wrap&&(k[0]=255&h,k[1]=h>>>8&255,s.check=hp(s.check,k,2,0)),h=0,l=0,s.mode=16182;case 16182:for(;l<32;){if(0===o)break e;o--,h+=i[r++]<<l,l+=8}s.head&&(s.head.time=h),512&s.flags&&4&s.wrap&&(k[0]=255&h,k[1]=h>>>8&255,k[2]=h>>>16&255,k[3]=h>>>24&255,s.check=hp(s.check,k,4,0)),h=0,l=0,s.mode=16183;case 16183:for(;l<16;){if(0===o)break e;o--,h+=i[r++]<<l,l+=8}s.head&&(s.head.xflags=255&h,s.head.os=h>>8),512&s.flags&&4&s.wrap&&(k[0]=255&h,k[1]=h>>>8&255,s.check=hp(s.check,k,2,0)),h=0,l=0,s.mode=16184;case 16184:if(1024&s.flags){for(;l<16;){if(0===o)break e;o--,h+=i[r++]<<l,l+=8}s.length=h,s.head&&(s.head.extra_len=h),512&s.flags&&4&s.wrap&&(k[0]=255&h,k[1]=h>>>8&255,s.check=hp(s.check,k,2,0)),h=0,l=0}else s.head&&(s.head.extra=null);s.mode=16185;case 16185:if(1024&s.flags&&(d=s.length,d>o&&(d=o),d&&(s.head&&(v=s.head.extra_len-s.length,s.head.extra||(s.head.extra=new Uint8Array(s.head.extra_len)),s.head.extra.set(i.subarray(r,r+d),v)),512&s.flags&&4&s.wrap&&(s.check=hp(s.check,i,d,r)),o-=d,r+=d,s.length-=d),s.length))break e;s.length=0,s.mode=16186;case 16186:if(2048&s.flags){if(0===o)break e;d=0;do{v=i[r+d++],s.head&&v&&s.length<65536&&(s.head.name+=String.fromCharCode(v))}while(v&&d<o);if(512&s.flags&&4&s.wrap&&(s.check=hp(s.check,i,d,r)),o-=d,r+=d,v)break e}else s.head&&(s.head.name=null);s.length=0,s.mode=16187;case 16187:if(4096&s.flags){if(0===o)break e;d=0;do{v=i[r+d++],s.head&&v&&s.length<65536&&(s.head.comment+=String.fromCharCode(v))}while(v&&d<o);if(512&s.flags&&4&s.wrap&&(s.check=hp(s.check,i,d,r)),o-=d,r+=d,v)break e}else s.head&&(s.head.comment=null);s.mode=16188;case 16188:if(512&s.flags){for(;l<16;){if(0===o)break e;o--,h+=i[r++]<<l,l+=8}if(4&s.wrap&&h!==(65535&s.check)){e.msg="header crc mismatch",s.mode=ed;break}h=0,l=0}s.head&&(s.head.hcrc=s.flags>>9&1,s.head.done=!0),e.adler=s.check=0,s.mode=Gu;break;case 16189:for(;l<32;){if(0===o)break e;o--,h+=i[r++]<<l,l+=8}e.adler=s.check=td(h),h=0,l=0,s.mode=Ku;case Ku:if(0===s.havedict)return e.next_out=a,e.avail_out=c,e.next_in=r,e.avail_in=o,s.hold=h,s.bits=l,Uu;e.adler=s.check=1,s.mode=Gu;case Gu:if(t===Ru||t===Fu)break e;case Yu:if(s.last){h>>>=7&l,l-=7&l,s.mode=Qu;break}for(;l<3;){if(0===o)break e;o--,h+=i[r++]<<l,l+=8}switch(s.last=1&h,h>>>=1,l-=1,3&h){case 0:s.mode=16193;break;case 1:if(pd(s),s.mode=Xu,t===Fu){h>>>=2,l-=2;break e}break;case 2:s.mode=16196;break;case 3:e.msg="invalid block type",s.mode=ed}h>>>=2,l-=2;break;case 16193:for(h>>>=7&l,l-=7&l;l<32;){if(0===o)break e;o--,h+=i[r++]<<l,l+=8}if((65535&h)!=(h>>>16^65535)){e.msg="invalid stored block lengths",s.mode=ed;break}if(s.length=65535&h,h=0,l=0,s.mode=Ju,t===Fu)break e;case Ju:s.mode=16195;case 16195:if(d=s.length,d){if(d>o&&(d=o),d>c&&(d=c),0===d)break e;n.set(i.subarray(r,r+d),a),o-=d,r+=d,c-=d,a+=d,s.length-=d;break}s.mode=Gu;break;case 16196:for(;l<14;){if(0===o)break e;o--,h+=i[r++]<<l,l+=8}if(s.nlen=257+(31&h),h>>>=5,l-=5,s.ndist=1+(31&h),h>>>=5,l-=5,s.ncode=4+(15&h),h>>>=4,l-=4,s.nlen>286||s.ndist>30){e.msg="too many length or distance symbols",s.mode=ed;break}s.have=0,s.mode=16197;case 16197:for(;s.have<s.ncode;){for(;l<3;){if(0===o)break e;o--,h+=i[r++]<<l,l+=8}s.lens[A[s.have++]]=7&h,h>>>=3,l-=3}for(;s.have<19;)s.lens[A[s.have++]]=0;if(s.lencode=s.lendyn,s.lenbits=7,C={bits:s.lenbits},T=Ou(0,s.lens,0,19,s.lencode,0,s.work,C),s.lenbits=C.bits,T){e.msg="invalid code lengths set",s.mode=ed;break}s.have=0,s.mode=16198;case 16198:for(;s.have<s.nlen+s.ndist;){for(;P=s.lencode[h&(1<<s.lenbits)-1],y=P>>>24,g=P>>>16&255,b=65535&P,!(y<=l);){if(0===o)break e;o--,h+=i[r++]<<l,l+=8}if(b<16)h>>>=y,l-=y,s.lens[s.have++]=b;else{if(16===b){for(E=y+2;l<E;){if(0===o)break e;o--,h+=i[r++]<<l,l+=8}if(h>>>=y,l-=y,0===s.have){e.msg="invalid bit length repeat",s.mode=ed;break}v=s.lens[s.have-1],d=3+(3&h),h>>>=2,l-=2}else if(17===b){for(E=y+3;l<E;){if(0===o)break e;o--,h+=i[r++]<<l,l+=8}h>>>=y,l-=y,v=0,d=3+(7&h),h>>>=3,l-=3}else{for(E=y+7;l<E;){if(0===o)break e;o--,h+=i[r++]<<l,l+=8}h>>>=y,l-=y,v=0,d=11+(127&h),h>>>=7,l-=7}if(s.have+d>s.nlen+s.ndist){e.msg="invalid bit length repeat",s.mode=ed;break}for(;d--;)s.lens[s.have++]=v}}if(s.mode===ed)break;if(0===s.lens[256]){e.msg="invalid code -- missing end-of-block",s.mode=ed;break}if(s.lenbits=9,C={bits:s.lenbits},T=Ou(1,s.lens,0,s.nlen,s.lencode,0,s.work,C),s.lenbits=C.bits,T){e.msg="invalid literal/lengths set",s.mode=ed;break}if(s.distbits=6,s.distcode=s.distdyn,C={bits:s.distbits},T=Ou(2,s.lens,s.nlen,s.ndist,s.distcode,0,s.work,C),s.distbits=C.bits,T){e.msg="invalid distances set",s.mode=ed;break}if(s.mode=Xu,t===Fu)break e;case Xu:s.mode=Zu;case Zu:if(o>=6&&c>=258){e.next_out=a,e.avail_out=c,e.next_in=r,e.avail_in=o,s.hold=h,s.bits=l,Su(e,u),a=e.next_out,n=e.output,c=e.avail_out,r=e.next_in,i=e.input,o=e.avail_in,h=s.hold,l=s.bits,s.mode===Gu&&(s.back=-1);break}for(s.back=0;P=s.lencode[h&(1<<s.lenbits)-1],y=P>>>24,g=P>>>16&255,b=65535&P,!(y<=l);){if(0===o)break e;o--,h+=i[r++]<<l,l+=8}if(g&&0==(240&g)){for(w=y,_=g,x=b;P=s.lencode[x+((h&(1<<w+_)-1)>>w)],y=P>>>24,g=P>>>16&255,b=65535&P,!(w+y<=l);){if(0===o)break e;o--,h+=i[r++]<<l,l+=8}h>>>=w,l-=w,s.back+=w}if(h>>>=y,l-=y,s.back+=y,s.length=b,0===g){s.mode=16205;break}if(32&g){s.back=-1,s.mode=Gu;break}if(64&g){e.msg="invalid literal/length code",s.mode=ed;break}s.extra=15&g,s.mode=16201;case 16201:if(s.extra){for(E=s.extra;l<E;){if(0===o)break e;o--,h+=i[r++]<<l,l+=8}s.length+=h&(1<<s.extra)-1,h>>>=s.extra,l-=s.extra,s.back+=s.extra}s.was=s.length,s.mode=16202;case 16202:for(;P=s.distcode[h&(1<<s.distbits)-1],y=P>>>24,g=P>>>16&255,b=65535&P,!(y<=l);){if(0===o)break e;o--,h+=i[r++]<<l,l+=8}if(0==(240&g)){for(w=y,_=g,x=b;P=s.distcode[x+((h&(1<<w+_)-1)>>w)],y=P>>>24,g=P>>>16&255,b=65535&P,!(w+y<=l);){if(0===o)break e;o--,h+=i[r++]<<l,l+=8}h>>>=w,l-=w,s.back+=w}if(h>>>=y,l-=y,s.back+=y,64&g){e.msg="invalid distance code",s.mode=ed;break}s.offset=b,s.extra=15&g,s.mode=16203;case 16203:if(s.extra){for(E=s.extra;l<E;){if(0===o)break e;o--,h+=i[r++]<<l,l+=8}s.offset+=h&(1<<s.extra)-1,h>>>=s.extra,l-=s.extra,s.back+=s.extra}if(s.offset>s.dmax){e.msg="invalid distance too far back",s.mode=ed;break}s.mode=16204;case 16204:if(0===c)break e;if(d=u-c,s.offset>d){if(d=s.offset-d,d>s.whave&&s.sane){e.msg="invalid distance too far back",s.mode=ed;break}d>s.wnext?(d-=s.wnext,f=s.wsize-d):f=s.wnext-d,d>s.length&&(d=s.length),m=s.window}else m=n,f=a-s.offset,d=s.length;d>c&&(d=c),c-=d,s.length-=d;do{n[a++]=m[f++]}while(--d);0===s.length&&(s.mode=Zu);break;case 16205:if(0===c)break e;n[a++]=s.length,c--,s.mode=Zu;break;case Qu:if(s.wrap){for(;l<32;){if(0===o)break e;o--,h|=i[r++]<<l,l+=8}if(u-=c,e.total_out+=u,s.total+=u,4&s.wrap&&u&&(e.adler=s.check=s.flags?hp(s.check,n,u,a-u):op(s.check,n,u,a-u)),u=c,4&s.wrap&&(s.flags?h:td(h))!==s.check){e.msg="incorrect data check",s.mode=ed;break}h=0,l=0}s.mode=16207;case 16207:if(s.wrap&&s.flags){for(;l<32;){if(0===o)break e;o--,h+=i[r++]<<l,l+=8}if(4&s.wrap&&h!==(4294967295&s.total)){e.msg="incorrect length check",s.mode=ed;break}h=0,l=0}s.mode=16208;case 16208:T=ju;break e;case ed:T=qu;break e;case 16210:return Hu;default:return zu}return e.next_out=a,e.avail_out=c,e.next_in=r,e.avail_in=o,s.hold=h,s.bits=l,(s.wsize||u!==e.avail_out&&s.mode<ed&&(s.mode<Qu||t!==Mu))&&ud(e,e.output,e.next_out,u-e.avail_out),p-=e.avail_in,u-=e.avail_out,e.total_in+=p,e.total_out+=u,s.total+=u,4&s.wrap&&u&&(e.adler=s.check=s.flags?hp(s.check,n,u,e.next_out-u):op(s.check,n,u,e.next_out-u)),e.data_type=s.bits+(s.last?64:0)+(s.mode===Gu?128:0)+(s.mode===Xu||s.mode===Ju?256:0),(0===p&&0===u||t===Mu)&&T===Bu&&(T=Vu),T},inflateEnd:e=>{if(id(e))return zu;let t=e.state;return t.window&&(t.window=null),e.state=null,Bu},inflateGetHeader:(e,t)=>{if(id(e))return zu;const s=e.state;return 0==(2&s.wrap)?zu:(s.head=t,t.done=!1,Bu)},inflateSetDictionary:(e,t)=>{const s=t.length;let i,n,r;return id(e)?zu:(i=e.state,0!==i.wrap&&i.mode!==Ku?zu:i.mode===Ku&&(n=1,n=op(n,t,s,0),n!==i.check)?qu:(r=ud(e,t,s,s),r?(i.mode=16210,Hu):(i.havedict=1,Bu)))},inflateInfo:"pako inflate (from Nodeca project)"},fd=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const md=Object.prototype.toString,{Z_NO_FLUSH:yd,Z_FINISH:gd,Z_OK:bd,Z_STREAM_END:wd,Z_NEED_DICT:_d,Z_STREAM_ERROR:xd,Z_DATA_ERROR:vd,Z_MEM_ERROR:Td}=pp;function Pd(e){this.options=lu.assign({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new fu,this.strm.avail_out=0;let s=dd.inflateInit2(this.strm,t.windowBits);if(s!==bd)throw new Error(lp[s]);if(this.header=new fd,dd.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=du.string2buf(t.dictionary):"[object ArrayBuffer]"===md.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(s=dd.inflateSetDictionary(this.strm,t.dictionary),s!==bd)))throw new Error(lp[s])}function kd(e,t){const s=new Pd(t);if(s.push(e),s.err)throw s.msg||lp[s.err];return s.result}Pd.prototype.push=function(e,t){const s=this.strm,i=this.options.chunkSize,n=this.options.dictionary;let r,a,o;if(this.ended)return!1;for(a=t===~~t?t:!0===t?gd:yd,"[object ArrayBuffer]"===md.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;;){for(0===s.avail_out&&(s.output=new Uint8Array(i),s.next_out=0,s.avail_out=i),r=dd.inflate(s,a),r===_d&&n&&(r=dd.inflateSetDictionary(s,n),r===bd?r=dd.inflate(s,a):r===vd&&(r=_d));s.avail_in>0&&r===wd&&s.state.wrap>0&&0!==e[s.next_in];)dd.inflateReset(s),r=dd.inflate(s,a);switch(r){case xd:case vd:case _d:case Td:return this.onEnd(r),this.ended=!0,!1}if(o=s.avail_out,s.next_out&&(0===s.avail_out||r===wd))if("string"===this.options.to){let e=du.utf8border(s.output,s.next_out),t=s.next_out-e,n=du.buf2string(s.output,e);s.next_out=t,s.avail_out=i-t,t&&s.output.set(s.output.subarray(e,e+t),0),this.onData(n)}else this.onData(s.output.length===s.next_out?s.output:s.output.subarray(0,s.next_out));if(r!==bd||0!==o){if(r===wd)return r=dd.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,!0;if(0===s.avail_in)break}}return!0},Pd.prototype.onData=function(e){this.chunks.push(e)},Pd.prototype.onEnd=function(e){e===bd&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=lu.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Cd={Inflate:Pd,inflate:kd,inflateRaw:function(e,t){return(t=t||{}).raw=!0,kd(e,t)},ungzip:kd,constants:pp};const{Deflate:Ed,deflate:Ad,deflateRaw:Sd,gzip:Id}=Eu,{Inflate:Nd,inflate:Ld,inflateRaw:Dd,ungzip:Od}=Cd;var Md=Ad,Rd=Ld;const Fd={encode:e=>{const t=Array.from(e).map((e=>e.codePointAt(0)||0)),s=[];for(const e of t)e<=127?s.push(e):e<=2047?(s.push(e>>6|192),s.push(63&e|128)):e<=65535?(s.push(e>>12|224),s.push(e>>6&63|128),s.push(63&e|128)):e<=1114111&&(s.push(e>>18|240),s.push(e>>12&63|128),s.push(e>>6&63|128),s.push(63&e|128));return Uint8Array.from(s).buffer},decode:e=>{const t=new Uint8Array(e);let s="",i=0;for(;i<t.length;){const e=t[i];if(0==(128&e))s+=String.fromCharCode(e),i+=1;else if(192==(224&e)){const n=t[i+1];s+=String.fromCharCode((31&e)<<6|63&n),i+=2}else if(224==(240&e)){const n=t[i+1],r=t[i+2];s+=String.fromCharCode((15&e)<<12|(63&n)<<6|63&r),i+=3}else if(240==(248&e)){const n=(7&e)<<18|(63&t[i+1])<<12|(63&t[i+2])<<6|63&t[i+3];s+=n<=1114111?String.fromCodePoint(n):"�",i+=4}else s+="�",i+=1}return s}},Bd=Fd;var jd,Ud,zd=function(e,t,s,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,s):n?n.value=s:t.set(e,s),s},qd=function(e,t,s,i){if("a"===s&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?i:"a"===s?i.call(e):i?i.value:t.get(e)};jd=new WeakMap,Ud=new WeakMap;const Hd=class{constructor(e){jd.set(this,void 0),Ud.set(this,0),ArrayBuffer.isView(e)?zd(this,jd,e.buffer,"f"):zd(this,jd,new DataView(e,0,0).buffer,"f")}read(){var e,t;return new Uint8Array(qd(this,jd,"f"))[(zd(this,Ud,(t=qd(this,Ud,"f"),e=t++,t),"f"),e)]}readNBytes(e){const t=qd(this,jd,"f"),s=t.byteLength,i=qd(this,Ud,"f");if(i>=s)return new ArrayBuffer(0);const n=zd(this,Ud,qd(this,Ud,"f")+e,"f");return n>s?t.slice(i,s):t.slice(i,n)}};var Vd,$d=function(e,t,s,i){if("a"===s&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?i:"a"===s?i.call(e):i?i.value:t.get(e)};Vd=new WeakMap;const Wd=class{constructor(){Vd.set(this,[])}write(e){const t=$d(this,Vd,"f");switch(typeof e){case"number":t.push(e);break;case"object":Array.isArray(e)?t.push(Uint8Array.from(e).buffer):ArrayBuffer.isView(e)?t.push(e.buffer):t.push(new DataView(e,0,0).buffer);break;default:throw new Error("Invalid value: "+e)}}toArrayBuffer(e){const t=$d(this,Vd,"f");if((e||(e=0))<=0)for(const s of t)e+="number"==typeof s?1:s.byteLength;const s=new Uint8Array(new ArrayBuffer(e),0,e);e=0;for(const i of t){if("number"==typeof i){s[e++]=i;continue}const t=i.byteLength;s.set(new Uint8Array(i,0,t),e),e+=t}return s.buffer}};function Kd(e){try{return new DataView(e,0,0),!0}catch(e){return!1}}function Gd(e){const t=e.buffer,s=e.byteOffset,i=e.byteLength;return 0===s&&i===t.byteLength?t:t.slice(s,s+i)}function Yd(e,t){const s=Bd.encode(t),i=new DataView(new ArrayBuffer(4),0,4);i.setUint32(0,s.byteLength,!0),e.write(i),e.write(s)}function Jd(e,t){const s=new DataView(new ArrayBuffer(5),0,5);s.setUint8(0,102),s.setUint32(1,t.byteLength,!0),e.write(s),e.write(t)}function Xd(e,t){switch(typeof t){case"string":e.write(101),Yd(e,t);break;case"boolean":e.write([10,t?1:0]);break;case"undefined":e.write(0);break;case"number":{if(Number.isSafeInteger(t))if(t>=0){if(t<=255){const s=new DataView(new ArrayBuffer(2),0,2);return s.setUint8(0,10),s.setUint8(1,t),void e.write(s)}if(t<=65535){const s=new DataView(new ArrayBuffer(3),0,3);return s.setUint8(0,11),s.setUint16(1,t,!0),void e.write(s)}if(t<=4294967295){const s=new DataView(new ArrayBuffer(5),0,5);return s.setUint8(0,12),s.setUint32(1,t,!0),void e.write(s)}}else{if(t>=-128&&t<128){const s=new DataView(new ArrayBuffer(2),0,2);return s.setUint8(0,20),s.setInt8(1,t),void e.write(s)}if(t>=-32768&&t<32768){const s=new DataView(new ArrayBuffer(3),0,3);return s.setUint8(0,21),s.setInt16(1,t,!0),void e.write(s)}if(t>=-2147483648&&t<2147483648){const s=new DataView(new ArrayBuffer(5),0,5);return s.setUint8(0,22),s.setInt32(1,t,!0),void e.write(s)}}const s=new DataView(new ArrayBuffer(9),0,9);s.setUint8(0,33),s.setFloat64(1,t,!0),e.write(s)}break;case"bigint":{const s=new DataView(new ArrayBuffer(9),0,9);t>=0n?(s.setUint8(0,13),s.setBigUint64(1,t,!0)):(s.setUint8(0,23),s.setBigUint64(1,t,!0)),e.write(s)}break;case"object":null===t?e.write(255):Array.isArray(t)?function(e,t){const s=new DataView(new ArrayBuffer(5),0,5);s.setUint8(0,99),s.setUint32(1,t.length,!0),e.write(s);for(const s of t)Xd(e,s)}(e,t):Kd(t)?Jd(e,t):ArrayBuffer.isView(t)?Jd(e,Gd(t)):function(e,t){if("function"==typeof t.toJSON)return void Xd(e,t.toJSON());const s=Object.keys(t);{const t=new DataView(new ArrayBuffer(5),0,5);t.setUint8(0,100),t.setUint32(1,s.length,!0),e.write(t)}for(const i of s){const s=t[i];switch(typeof s){case"boolean":case"bigint":case"number":case"object":case"string":case"undefined":Yd(e,i),Xd(e,s)}}}(e,t)}}function Zd(e,t){if("object"!=typeof e||null==e)throw new Error("Data must be a non-null object or array.");if("object"!=typeof(t||(t={})))throw new Error("The options parameter must be an object.");{const t=new Wd;Xd(t,e),e=t.toArrayBuffer()}const s=t.compressMethod||0,i=t.compressLevel||5;switch(s){case 0:break;case 1:e=Md(e,{raw:!0,level:i,memLevel:9,chunkSize:8192,windowBits:15});break;case 3:e=Md(e,{gzip:!0,level:i,memLevel:9,chunkSize:8192,windowBits:15});break;case 2:case 4:case 5:case 6:throw new Error("Not implemented");default:throw new Error("Unknown compress method: "+s)}const n=new Uint8Array(new ArrayBuffer(e.byteLength+7));return n[0]=128,n[1]=99,n[2]=98,n[3]=106,n[4]=102,n[5]=1,n[6]=s,n.set(new Uint8Array(e),7),n.buffer}function Qd(e){const t=e.read();switch(t){case 0:return;case 255:return null;case 10:return e.read();case 11:return new DataView(e.readNBytes(2),0,2).getUint16(0,!0);case 12:return new DataView(e.readNBytes(4),0,4).getUint32(0,!0);case 13:return new DataView(e.readNBytes(8),0,8).getBigUint64(0,!0);case 20:return e.read()<<8>>8;case 21:return new DataView(e.readNBytes(2),0,2).getInt16(0,!0);case 22:return new DataView(e.readNBytes(4),0,4).getInt32(0,!0);case 23:return new DataView(e.readNBytes(8),0,8).getBigInt64(0,!0);case 32:return new DataView(e.readNBytes(4),0,4).getFloat32(0,!0);case 33:return new DataView(e.readNBytes(8),0,8).getFloat64(0,!0);case 99:return function(e){const t=new DataView(e.readNBytes(4),0,4).getUint32(0,!0),s=new Array(t);for(let i=0;i<t;i++)s[i]=Qd(e);return s}(e);case 100:return function(e){const t=new DataView(e.readNBytes(4),0,4).getUint32(0,!0),s=Object.create(null);for(let i=0;i<t;i++)s[Bd.decode(e.readNBytes(new DataView(e.readNBytes(4),0,4).getUint32(0,!0)))]=Qd(e);return s}(e);case 101:return Bd.decode(e.readNBytes(new DataView(e.readNBytes(4),0,4).getUint32(0,!0)));case 102:return e.readNBytes(new DataView(e.readNBytes(4),0,4).getUint32(0,!0));default:throw new Error("Parse Error: Invalid data ID: "+t)}}function ef(e,t){if("object"!=typeof(t||{}))throw new Error("The options parameter must be an object.");if(ArrayBuffer.isView(e)&&(e=Gd(e)),!Kd(e))throw new Error("The data parameter must be an ArrayBuffer.");{const t=new Uint8Array(e,0,e.byteLength);if(128!==t[0]||99!==t[1]||98!==t[2]||106!==t[3]||102!==t[4]||1!==t[5])throw new Error("Parse Error: Input data is not valid.");switch(t[6]){case 0:e=e.slice(7);break;case 1:e=Rd(e.slice(7),{raw:!0,chunkSize:8192,windowBits:15}).buffer;break;case 3:e=Rd(e.slice(7),{chunkSize:8192,windowBits:15}).buffer;break;case 2:case 4:case 5:case 6:throw new Error("Not implemented");default:throw new Error("Parse Error: Unknown compress method.")}}return Qd(new Hd(e))}Object.seal(Object.setPrototypeOf(t,null));const tf=Object.freeze(Zd),sf=Object.freeze(ef),nf=sf(Gc.decode("gGNiamYBAYVUbW/jRBAuSCAUgQCBEB+3PiEhcY7jpO21dtKqtJVAuoPqLnCgEzqt12N74/Wus7uOk/4X/iK/gdl1eneg4/gQ7c7LM3l2nhnnXx0cHIzw1zxqxdH6SCidv793sdWj47Zk9RrgAs2VuetPznZ5p7KiXJcnR9PjzbRr1ez4jm6KFS1EwYo66ytdr4sVyDjLdmvDasPjFprMVeTbaT1tmxNRw6dojjuZccUs75oxU82H6Go1FHwLH+G1srY1SRQ5Oi8pfI7HN+x5xS08a3kOepzDxscy+MshleGWK5loENTyDaQ5N62guyQTitVpz3NbJQW3IVPSgrRpBbys7D9cLc1zLsvkuN2mDdUll0k8abeEdlalTGF3kgdFUaQZtgl0MsOQUYLn5MFkckpPaVpgodDwO0imR1hjMO1OQCKVbqhIM8rqUqtO5gliZnS2x/QDmZPJJBVcQrgn56sIsBZ0aFrKHDkklPqHM/gSD0yvX+CjFwGjUknOqAh8OIc/8ZjnfHN+SQpqqSCgtdJEMdZpDTnpKy6A7PuEpYmtgOx7YYgq0OaGtLSE8TxydUa+2q0AaoBYvSOdcTCKNYoCNMJIplVvAP9EEwm2V7p+6O4umZaUS4LqoHhDPc8TYOS1/fUJuQaaH3pnAV+/MQO9k928kn2YidKPyY1/UvKtd1XwhUNhlfMMKb6ocJwWQRT84aMc3IhZ1BWsd6zgYzzQurRW86yz4N01tG78X8v9WtX4/1UtUMJ3SRq/S1LhKb7MBJW1dzTwGR7rDvTuGQhgVulLIXxI+lzDNG+H5yj45N+53t/CIR50343/6ukwNGv47i25JbdVl7klfRMWImxAafjAdZZbMXRwA/V7OHoX20aQDWiDe7kI4vEkICCZciu2CDpbhKcBucChOrz++Wr5++0NqSwCbn/5/vGPVyQIo+j57CqKrpfX5Lcflk8ek3gcR9HNTwHxxNwb+n7cz8ZKl9HyabR18Dh2gPv7OLd5gP/gCyMbaRZvwcZnZ2cDIsDxdORAepQbpNG8AUsJq6g2YF/xju4DkjawCDYc+lZpG9zvzyLwX5wF9ogzCL3xkEv8RlERGlxSWMRDFd+281vcMrJ013k0eEbzaE8gU/nufOQzrobqGBucmIO0h0XqvQpPAXftbw=="));Object.setPrototypeOf(nf,null),Object.preventExtensions(nf);const rf=nf,{ix2k2pm6lk:af,cj75pgckqe:of}=rf.m7pl4q4lor;if("string"!=typeof af||"string"!=typeof of)throw new Error("Error: Key file corrupted.");delete rf.m7pl4q4lor;const cf=rf.prefix+of+af,hf=Jt({apiKey:"AIzaSyCPXTy7dt3fpcLd8kVTBtXy0xuBdeuhbFc",authDomain:"whitespider.firebaseapp.com",databaseURL:"https://whitespider-default-rtdb.firebaseio.com",projectId:"whitespider",storageBucket:"whitespider.appspot.com",messagingSenderId:"176227430389",appId:"1:176227430389:web:94270de43b7eb971c03abc",measurementId:"G-F72WBJT57S"}),lf=(function(e=Xt()){const t=Kt(e=at(e),Xs);t.isInitialized()?t.getImmediate():function(e,t={}){const s=Kt(e,Xs);if(s.isInitialized()){const e=s.getImmediate();if(Je(t,s.getOptions()))return e;throw ni.create("already-initialized")}s.initialize({options:t})}(e)}(hf),function(e=Xt(),t){const s=Kt(e,"database").getImmediate({identifier:t});if(!s._instanceStarted){const e=(e=>{const t=(e=>{var t,s;return null===(s=null===(t=Oe())||void 0===t?void 0:t.emulatorHosts)||void 0===s?void 0:s[e]})(e);if(!t)return;const s=t.lastIndexOf(":");if(s<=0||s+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const i=parseInt(t.substring(s+1),10);return"["===t[0]?[t.substring(1,s-1),i]:[t.substring(0,s),i]})("database");e&&function(e,t,s,i={}){(e=at(e))._checkNotDeleted("useEmulator"),e._instanceStarted&&Vi("Cannot call useEmulator() after instance has already been initialized.");const n=e._repoInternal;let r;if(n.repoInfo_.nodeAdmin)i.mockUserToken&&Vi('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),r=new hn(hn.OWNER);else if(i.mockUserToken){const t="string"==typeof i.mockUserToken?i.mockUserToken:function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const s=t||"demo-project",i=e.iat||0,n=e.sub||e.user_id;if(!n)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const r=Object.assign({iss:`https://securetoken.google.com/${s}`,aud:s,iat:i,exp:i+3600,auth_time:i,sub:n,user_id:n,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Ie(JSON.stringify({alg:"none",type:"JWT"})),Ie(JSON.stringify(r)),""].join(".")}(i.mockUserToken,e.app.options.projectId);r=new hn(t)}!function(e,t,s,i){e.repoInfo_=new mn(`${t}:${s}`,!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams,!0),i&&(e.authTokenProvider_=i)}(n,t,s,r)}(s,...e)}return s}(hf));(async({window:e,document:t})=>{var s;function i(e){const s=t.getElementById(e);if(null==s)throw new Error("Element does not exist: "+e);return s}function n(e){const s=t.querySelector(e);if(s instanceof HTMLElement)return s;throw new Error("Failed to query selector: "+e)}const r=e.location,a=e.history,o=r.pathname,c=i("error"),h=new DOMParser,l=(...t)=>e.console.log(...t);e.onerror=(e,t,s,i,n)=>{let r="Unhandled error at "+(t||"unknown source ");null!=s&&(r+=s),null!=i&&(r+=":"+i),null!=n&&(r+="\n\n"+n),c.textContent=r,c.style.display="block"},e.onkeydown=e=>{if(e.ctrlKey&&!e.altKey&&!e.metaKey&&!e.shiftKey)switch(e.key){case"q":e.preventDefault(),e.stopPropagation(),r.replace("https://www.google.com/webhp?igu=1");break;case"b":e.preventDefault(),e.stopPropagation();const{body:s}=t;s.hasAttribute("style")?s.removeAttribute("style"):s.setAttribute("style","filter: blur(15px);");break;case"h":e.preventDefault(),e.stopPropagation(),"WhiteSpider"===t.title?(t.title="Google",n("link[rel*='icon']").href="/res/google.ico"):(t.title="WhiteSpider",n("link[rel*='icon']").href="/favicon.ico")}};const p=i("frame"),u=i("frame-view"),d=i("status"),f=n('link[rel="canonical"]');function m(e){null!=e?(c.textContent=e,c.style.display="block"):c.style.display="none"}function y(e){p.appendChild(g(e)),u.style.display="block"}function g(s){if(e.crossOriginIsolated){const i=t.createElement("iframe");return i.setAttribute("width","1024"),i.setAttribute("height","768"),i.setAttribute("allowfullscreen","true"),i.setAttribute("allowpaymentrequest","true"),i.setAttribute("name","Frame"),i.setAttribute("allow","fullscreen payment"),i.setAttribute("loading","lazy"),i.setAttribute("frameborder","0"),i.setAttribute("credentialless","true"),i.setAttribute("referrerpolicy","no-referrer"),i.onload=()=>{i.onload=null,i.setAttribute("src","data:application/xhtml+xml;base64,"+Gc.encode(Jc.encode(`<?xml version="1.0" encoding="utf-8" ?>\n<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">\n<html xmlns="http://www.w3.org/1999/xhtml" lang="en">\n\t<head>\n\t\t<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />\n\t\t<meta http-equiv="Referrer-Policy" content="no-referrer" />\n\t\t<meta name="referrer" content="no-referrer" />\n\t\t<meta name="viewport" content="width=device-width,initial-scale=1" />\n\t\t<base href="${e.origin}" target="_blank" />\n\t\t<link rel="icon" type="image/x-icon" href="res/google.ico" />\n\t\t<title>Google</title>\n\t\t<style type="text/css">\nbody, embed, iframe {\n\tposition: absolute;\n\tdisplay: block;\n\twidth: 100%;\n\theight: 100%;\n\tmargin: 0px;\n\tpadding: 0px;\n\tborder: none;\n\toverflow: hidden;\n}\n\t\t</style>\n\t</head>\n\t<body>\n\t\t<embed type="text/plain" width="1024" height="768" src="${s.replace(/\&/g,"&amp;")}" />\n\t</body>\n</html>`)))},i}const i=t.createElement("embed");return i.setAttribute("type","text/plain"),i.setAttribute("width","1024"),i.setAttribute("height","768"),i.setAttribute("src",s),i}function b(e){try{return new URL(e)}catch(e){return null}}function w(t){const s=e.open(void 0,"_blank","");if(null==s)return void m("Please allow popups in your browser settings and try again.");s.focus();const i=h.parseFromString(`<?xml version="1.0" encoding="utf-8" ?>\n<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">\n<html xmlns="http://www.w3.org/1999/xhtml" lang="en">\n\t<head>\n\t\t<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />\n\t\t<meta http-equiv="Referrer-Policy" content="no-referrer" />\n\t\t<meta name="referrer" content="no-referrer" />\n\t\t<meta name="viewport" content="width=device-width,initial-scale=1" />\n\t\t<base href="${e.origin}" target="_blank" />\n\t\t<link rel="icon" type="image/x-icon" href="res/google.ico" />\n\t\t<style type="text/css">\nbody, embed, iframe {\n\tposition: absolute;\n\tdisplay: block;\n\twidth: 100%;\n\theight: 100%;\n\tmargin: 0px;\n\tpadding: 0px;\n\tborder: none;\n\toverflow: hidden;\n}\n\t\t</style>\n\t\t<title>Google</title>\n\t</head>\n\t<body>\n\t\t\x3c!-- dummy --\x3e\n\t</body>\n</html>`,"application/xml");t.remove(),i.body.appendChild(t),s.document.documentElement.replaceWith(i.documentElement)}async function _(t,s){try{const i=await e.fetch(t,{cache:s||"force-cache",method:"GET"});return i.ok?await i.text():null}catch(e){return null}}function x(e,t){return new Promise(((s,i)=>{const n=Date.now().toString(36),r=(e,t,a)=>{e===n&&(A.off("res",r),null!=a?i(a):s(t))};A.on("res",r),A.emit("fetch",n,e,t)}))}"complete"!==t.readyState&&await new Promise((e=>{const s=()=>{"complete"===t.readyState&&(t.removeEventListener("readystatechange",s),e())};t.addEventListener("readystatechange",s,{passive:!0})})),e.stop(),e.focus();{const{_a:z,_b:q,_d:H,_e:V,_f:$,_g:W,_h:K,_i:G,_j:Y,_k:J,_l:X,_m:Z,_n:Q,_o:ee,_v:te,_w:se,_p:ie,_q:ne,_r:re}=rf;if((()=>{l(z,q);const e=new URL(r.href),s=e.hostname,i=e.origin;switch(e.protocol){case"http:":if("localhost"!==s)return e.protocol="https:",e.pathname="/",e.host=s,r.replace(e.href),!1;break;case"https:":break;default:return!0}switch(s){case"whitespider.cf":case"whitespider.tk":case"whitespider.web.app":case"whitespider.pages.dev":case"whitespider.firebaseapp.com":return e.host="whitespider.dev",e.pathname="/",r.replace(e.href),!1}{const e=t[ee](K);if(null==e||e[Y](G)!==X)return!0}for(const e of t[Z](Q)){switch(e[Y]("type")||""){case"":case"text/javascript":case"application/javascript":break;default:return e.remove(),!0}const t=e[Y]("src");if(!t||e.textContent)return e.remove(),!0;const s=new URL(t.startsWith("//")?"https:"+t:t,i);if(s.origin!==i){if("https:"===s.protocol){const e=s.host.split("."),t=e.length;if("com"===e[t-1]){const s=e[t-2];if(s.indexOf("google")>=0||s.indexOf("firebase")>=0)continue}}return e.remove(),!0}}return f[Y]("href")!==$||null==t[ee](ie)||null==t[ee](ne)||t[re]!==z.slice(2,13)})()){l(V,J);const ae=h.parseFromString(te,"application/xhtml+xml");ae.title=W;const oe=ae.body;oe.innerHTML=H;{const ce=ae.createElement("button");ce.innerHTML=se,ce.setAttribute("type","button"),ce.addEventListener("click",(()=>{r.replace($)}),{passive:!0}),oe.appendChild(ce)}return void t.documentElement.replaceWith(ae.documentElement)}for(const he of Pl.getOwnPropertyNames(rf))2===he.length&&delete rf[he]}if(e!==e.top){if("null"===(null===(s=r.ancestorOrigins)||void 0===s?void 0:s.item(0))){const le=t.createElement("div");return le.textContent="Click here to continue",le.onclick=()=>w(g("https://whitespider.dev/")),le.setAttribute("style","padding: 15px;"),t.body.innerHTML="",void t.body.appendChild(le)}if("https://whitespider.dev"!==r.origin)return void r.replace("https://whitespider.dev/")}a.scrollRestoration="manual",a.replaceState(void 0,"","/"),f.setAttribute("href","https://whitespider.dev/");const v=qc(e),T=Ac(lf,"gamelist_v2/data"),P=t.documentElement.clientWidth<800,k=Ac(lf,"playcount"),{localStorage:C}=v;let E,A,S,I,N,L=null,D=null;const O=[],M=[],R=[];if(v.storageEnabled)try{const pe=await _("/manifest.json","no-cache");if(null!=pe){const ue=JSON.parse(pe).version;if(ue!==C.get("__mf_version")){t.body.innerHTML="Updating contents...";const de=e.caches;for(const fe of await de.keys())await de.delete(fe);return C.delete("__new_read"),C.set("__mf_version",ue),void r.reload()}i("version").textContent="v"+ue}E=C.get("__secrets_")||void 0}catch(me){}else m("Warning: Cookies are blocked by your browser. Some features might not work properly, and your game data will NOT be saved.");try{const ye=e.navigator.serviceWorker;null!=ye&&(await ye.register("/sw.js",{type:"classic",scope:"/",updateViaCache:"none"}),await ye.ready)}catch(ge){}try{const be=await e.fetch("/d/index.json",{mode:"same-origin",cache:"no-cache",method:"GET"});if(!be.ok)throw new Error("Remote returned error status code: "+be.status);const we=sf(await be.arrayBuffer());for(const _e of we)O.push(_e);for(const xe of we.sort(((e,t)=>t.date-e.date)).slice(0,200))M.push(xe)}catch(ve){return m("Error: Failed to initialize local game list."),void console.error(ve)}try{{const Pe=await Nc(T);if(null!=Pe&&Pe.exists()){const ke=Pe.val();if(Cl.isArray(ke))for(const Ce of ke)null!=Ce&&"object"==typeof Ce&&O.push({name:Ce[0],path:Ce[2],type:"",tags:"",desc:"",date:0})}}{const Ee=await Nc(k);if(null!=Ee&&Ee.exists()){const Ae=Ee.val();if(null!=Ae&&"object"==typeof Ae)for(const Se of Pl.keys(Ae).map((e=>({k:Jc.decode(Gc.decode(e)),v:Ae[e]}))).sort(((e,t)=>t.v-e.v)).slice(0,100))for(const Ie of O)if(Ie.path===Se.k&&""!==Ie.type){R.push(Ie);break}}}Rc(lf)}catch(Ne){m("Warning: Failed to fetch remote game list."),console.error(Ne)}c.onclick=()=>{c.innerHTML="",c.style.display="none"},i("frame-close").onclick=()=>{p.innerHTML="",u.style.display="none",a.replaceState(void 0,"","/"),f.setAttribute("href","https://whitespider.dev/")},i("frame-newtab").onclick=()=>{const e=p.firstElementChild;null!=e&&(p.innerHTML="",u.style.display="none",w(e))};{const Le=n("link[rel*='icon']"),De=i("backend-url"),Oe=i("theme"),Me=i("tab-cloaking");let Re;function Fe(e){null!=A&&(A.disconnect(),A.close()),A=Te(e||cf,{path:"/_api_/",secure:!0,upgrade:!0,timeout:1e4,forceNew:!0,multiplex:!1,transports:["polling"],autoConnect:!0,reconnection:!0,rememberUpgrade:!0,reconnectionDelay:5e3,closeOnBeforeunload:!0}),d.innerHTML="Connecting...",d.style.color="#808000",A.io.on("open",(()=>{d.innerHTML="✓Connected",d.style.color="#008000"})),A.io.on("close",(()=>{d.innerHTML="✕Disconnected",d.style.color="#ff0000"})),A.io.on("reconnect_attempt",(()=>{d.innerHTML="Connecting...",d.style.color="#808000"})),A.io.on("reconnect_error",(()=>{d.innerHTML="✕Disconnected",d.style.color="#ff0000"})),A.io.on("reconnect",(()=>{d.innerHTML="✓Connected",d.style.color="#008000",null!=L&&L()}))}function Be(e){switch(null==Re&&(Re=t.createElement("link"),Re.rel="stylesheet",Re.type="text/css",Re.href="index.dark.css",t.head.appendChild(Re)),e){case"light":Re.disabled=!0,Re.removeAttribute("media");break;case"dark":Re.disabled=!1,Re.removeAttribute("media");break;default:Re.media="all and (prefers-color-scheme: dark)",Re.disabled=!1}}function je(e){switch(e){case"empty":S=!0,t.title="⁠",Le.type="image/x-icon",Le.href="/res/empty.ico";break;case"google":S=!0,t.title="Google",Le.type="image/x-icon",Le.href="/res/google.ico";break;case"classroom":S=!0,t.title="Home",Le.type="image/png",Le.href="/res/classroom.png";break;default:S=!1,t.title="WhiteSpider",Le.type="image/x-icon",Le.href="/favicon.ico"}}De.onblur=()=>{const e=b(De.value.trim());if(null!=e){const t=e.href;C.set("__backendURL_",t),Fe(De.value=t)}else C.delete("__backendURL_"),Fe(De.value="")},Oe.onchange=()=>{const e=Oe.value;Be(e),C.set("__set_theme",e)},Me.onchange=()=>{const e=Me.value;je(e),C.set("__set_tabc",e)};{const Ue=C.get("__backendURL_")||"";Fe(Ue),De.value=Ue}{const ze=C.get("__set_theme")||"default";Be(ze),Oe.value=ze}{const qe=C.get("__set_tabc")||"disabled";je(qe),Me.value=qe}}{const He=i("game-container"),Ve=i("game-frame"),$e=i("player"),We=i("name"),Ke=i("type"),Ge=i("tags"),Ye=i("date"),Je=i("user"),Xe=i("desc"),Ze=i("gnav-back"),Qe=i("gnav-forward"),et=i("gnav-page-no"),tt=i("gnav-page-count"),st=[];let it=0,nt="all",rt="";{const pt=i("game-search"),ut=n("#game-search>input");let dt=0;function ft(){rt=ut.value.toLowerCase().trim(),ct()}pt.onsubmit=e=>{e.preventDefault(),e.stopPropagation(),clearTimeout(dt),ft()},ut.onblur=()=>{clearTimeout(dt),ft()},ut.oninput=()=>{clearTimeout(dt),dt=setTimeout((()=>{ft()}),1e3)}}{const mt=t.querySelectorAll("#game-category>button");for(const yt of mt)yt.onclick=()=>{for(const e of mt)e.removeAttribute("current");yt.setAttribute("current","true"),nt=yt.getAttribute("match")||"all",ct()}}{const gt=n('#game-category>button[match="new"]');C.has("__new_read")||(gt.setAttribute("unread","true"),gt.addEventListener("click",(()=>{gt.removeAttribute("unread"),C.set("__new_read","1")}),{once:!0,passive:!0}))}function ot(){switch(nt){case"all":return rt.length>0?O.filter((e=>e.name.toLowerCase().indexOf(rt)>=0||e.tags.indexOf(rt)>=0)):O;case"new":return rt.length>0?M.filter((e=>e.name.toLowerCase().indexOf(rt)>=0||e.tags.indexOf(rt)>=0)):M;case"hot":return rt.length>0?R.filter((e=>e.name.toLowerCase().indexOf(rt)>=0||e.tags.indexOf(rt)>=0)):R;case"html5":return O.filter((e=>"html5"===e.type&&(0===rt.length||e.name.toLowerCase().indexOf(rt)>=0||e.tags.indexOf(rt)>=0)));case"flash":return O.filter((e=>"flash"===e.type&&(0===rt.length||e.name.toLowerCase().indexOf(rt)>=0||e.tags.indexOf(rt)>=0)));case"dos":return O.filter((e=>"dos"===e.type&&(0===rt.length||e.name.toLowerCase().indexOf(rt)>=0||e.tags.indexOf(rt)>=0)));default:return O.filter((e=>e.tags.split(",").indexOf(nt)>=0&&(0===rt.length||e.name.toLowerCase().indexOf(rt)>=0)))}}function ct(){it=0,st.length=0;const e=ot();if(0===e.length)Ze.disabled=!0,Qe.disabled=!0,He.innerHTML="No results found :(";else{for(let t=0;t<e.length;t+=100)st.push(e.slice(t,t+100));ht()}}function ht(){He.innerHTML="",et.value=kl(it+1),et.min="1",et.max=tt.innerHTML=kl(st.length),Ze.disabled=it<1,it>=st.length-1?Qe.disabled=!0:Qe.disabled=!1;for(const e of st[it]){const{name:s,prev:i,date:n}=e,r=t.createElement("a");r.href=n>0?"/g/"+n.toString(36):"#",r.title="Play "+s,r.target="_self",r.onclick=t=>{t.ctrlKey||(t.preventDefault(),t.stopPropagation(),I(e))},r.style.backgroundImage=null!=i?'url("'+i+'"), url("/res/preview.svg")':'url("/d/'+encodeURIComponent(s)+'.jpg"), url("/res/preview.svg")';{const e=t.createElement("div");e.textContent=s,r.appendChild(e)}switch(e.type){case"html5":{const e=t.createElement("span");e.textContent="HTML5",e.style.background="#ff9933",r.appendChild(e)}break;case"flash":{const e=t.createElement("span");e.textContent="Flash",e.style.background="#00cc99",r.appendChild(e)}break;case"dos":{const e=t.createElement("span");e.textContent="Dos",e.style.background="#80bfff",r.appendChild(e)}break;default:r.style.backgroundImage='url("/res/preview.svg")'}He.appendChild(r)}}function lt(){$e.innerHTML="",Ve.style.display="none",S||(t.title="WhiteSpider"),a.replaceState(void 0,"","/"),f.setAttribute("href","https://whitespider.dev/")}I=async({name:e,type:s,tags:i,date:n,path:o,desc:c,user:h})=>{if($e.appendChild(g("/ext/emu/?name="+e+"&type="+s+"&url="+encodeURIComponent(o))),Je.innerHTML="",We.textContent=e,Ke.textContent=s.toUpperCase(),Ge.textContent=i.replace(/\,/g,", ")||"None",Ye.textContent=new Date(n).toLocaleDateString("POSIX",{month:"2-digit",day:"2-digit",year:"numeric"}),Xe.textContent=c||"No information provided by the uploader.",Ve.style.display="block",n>0){S||(t.title=e+" - WhiteSpider");const s="/g/"+n.toString(36);a.replaceState(void 0,"",s),f.setAttribute("href","https://whitespider.dev"+s)}{const e=await x(1,h||"anonymous");{const s=t.createElement("img");s.alt="Avatar",s.width=40,s.height=40,s.loading="eager",s.decoding="sync",s.draggable=!1,Je.appendChild(s);{const t=URL.createObjectURL(new Blob([e.avatar],{type:"image/jpeg",endings:"native"}));s.src=t,await s.decode(),URL.revokeObjectURL(t)}}{const s=t.createElement("div");switch(s.className="user",s.textContent=e.id,e.vip){case 3:s.setAttribute("vip","gold");break;case 4:s.setAttribute("vip","diamond")}Je.appendChild(s)}Je.onclick=()=>{lt(),N(e.uid)}}if("localhost"!==r.hostname&&""!==s){(l=at(l=lf))._checkNotDeleted("goOnline"),(p=l._repo).persistentConnection_&&p.persistentConnection_.resume(Zo);const e=Sc(k,Gc.encode(Jc.encode(o)));await Ic(e,((await Nc(e)).val()||0)+1),Rc(lf)}var l,p},Ze.onclick=()=>{it--,ht(),He.scrollIntoView({behavior:"instant",inline:"start",block:"start"})},Qe.onclick=()=>{it++,ht(),He.scrollIntoView({behavior:"instant",inline:"start",block:"start"})},et.onblur=()=>{const e=parseInt(et.value.trim(),10)||0;it+1!==e&&(e<1||e>st.length?(et.value="1",it=0):it=e-1,ht(),He.scrollIntoView({behavior:"instant",inline:"start",block:"start"}))},et.onchange=()=>{et.blur()},i("game-close").onclick=()=>lt(),i("game-newtab").onclick=()=>{const e=$e.firstElementChild;null!=e&&(lt(),w(e))},ct(),He.style.height="fit-content",He.style.display="flex"}{const bt=i("tabs"),wt=i("mode-select"),_t=i("u-frame"),xt=i("address"),vt=i("message"),Tt=i("container"),Pt=[],kt=["left","middle","right","back","forward"],Ct=_t.getContext("bitmaprenderer",{alpha:!1}),Et={width:t.documentElement.clientWidth,height:t.documentElement.clientHeight-120,touch:e.navigator.maxTouchPoints>0},At=bt.children;let St=-1;{const Ut=i("prox-btn"),zt=i("unbl-content");wt.value=C.get("__unbl_mode_")||"puppeteer",Ut.onclick=()=>{null!=D&&D();for(const e of j)e.removeAttribute("current");if(U.checked=!1,Ut.setAttribute("current","true"),zt.setAttribute("current","true"),"puppeteer"===wt.value){if(null==Ct)return void m("Error: Failed to initialize canvas context.");L=()=>{It("Restoring session..."),jt()},D=()=>{It(null),L=null,D=null,St=-1,Pt.length=0,bt.innerHTML="",A.emit("end_session"),A.offAny(Bt)},It("Requesting new session..."),jt()}},wt.onchange=()=>{"puppeteer"===wt.value?(C.set("__unbl_mode_","puppeteer"),Ut.click()):(null!=D&&D(),C.set("__unbl_mode_","raw-embed"))}}function It(e){null!=e?(vt.textContent=e,vt.style.display="block"):vt.style.display="none"}function Nt(e){return e.preventDefault(),e.stopPropagation(),e.returnValue=!1,A.emit("event",{type:e.type,x:e.offsetX,y:e.offsetY,button:kt[e.button]}),!1}function Lt(e){e.preventDefault(),e.stopPropagation(),e.returnValue=!1;const{type:t,touches:s}=e;if(s.length>0){const e=_t.getBoundingClientRect();for(const i of s)A.emit("event",{type:t,x:i.clientX-e.x,y:i.clientY-e.y})}else A.emit("event",{type:t});return!1}function Dt(e){return e.preventDefault(),e.stopPropagation(),e.returnValue=!1,A.emit("event",{type:e.type,deltaX:e.deltaX,deltaY:e.deltaY}),!1}function Ot(e){return e.preventDefault(),e.stopPropagation(),e.returnValue=!1,A.emit("event",{type:e.type,key:e.key}),!1}function Mt(e){return e.preventDefault(),e.stopPropagation(),e.returnValue=!1,_t.focus({preventScroll:!0}),!1}function Rt(e){e=e.toLowerCase();for(let t=0;t<e.length;t++){const s=e.charCodeAt(t);if((s<48||s>57)&&(s<97||s>122)&&45!==s&&46!==s)return!1}return!0}function Ft(e,t){const s=b(e=e.replace(/\s+/g," ").trim());if(null!=s)return s.href;if(e.includes(" "))return t+encodeURIComponent(e);const i=e.indexOf("/");if(0===i)return t+encodeURIComponent(e);if(i>0){if(Rt(e.substring(0,i)))return"https://"+e}else if(Rt(e)&&e.includes("."))return"https://"+e;return t+encodeURIComponent(e)}function Bt(e,...s){switch(e){case"url":{const e=s[0];if("string"==typeof e){const s=Pt[St];null!=s&&(s.url=e),t.activeElement!==xt&&(xt.value=e)}}break;case"frame":createImageBitmap(new Blob(s,{type:"image/jpeg",endings:"native"}),0,0,_t.width,_t.height,{resizeQuality:"pixelated",imageOrientation:"none",premultiplyAlpha:"none",colorSpaceConversion:"none"}).then((e=>{Ct.transferFromImageBitmap(e),e.close()}));break;case"tabinfo":{const e=(s=s[0]).id,t=At[e],i=Pt[e];i.title=t.querySelector("div").textContent=s.title||"Untitled",i.favicon=t.querySelector("img").src=s.favicon||"/res/empty.ico"}break;case"tabopen":const e=t.createElement("div");e.innerHTML='<img src="res/empty.ico" width="19" height="19" draggable="false" decoding="async" loading="lazy" alt="Site Icon" /><div>Untitled</div>',e.onclick=()=>{for(const e of At)e.removeAttribute("current");e.setAttribute("current","true"),A.emit("focustab",St=Pt.indexOf(n))};const i=t.createElement("button");i.type="button",i.title="Close",i.onclick=()=>{A.emit("closetab",Pt.indexOf(n))},e.appendChild(i);for(const e of At)e.removeAttribute("current");e.setAttribute("current","true");const n={url:"",title:"",favicon:""};Pl.setPrototypeOf(n,null),Pl.preventExtensions(n),St=Pt.length,Pt.push(n),bt.appendChild(e);break;case"tabclose":const r=s[0];r>=0&&r<Pt.length&&(r===St&&(r>1?At[St=r-1].setAttribute("current","true"):At[St=0].setAttribute("current","true")),At[r].remove(),Pt.splice(r,1))}}async function jt(){A.offAny(Bt),A.emit("ns",Et);{const{width:e,height:t}=await new Promise((e=>{A.once("session_ready",e)}));Tt.style.width=e+"px",Tt.style.height=t+"px",Et.width=e,Et.height=t,_t.width=e,_t.height=t}for(const e of Pt)A.emit("newtab"),await new Promise((e=>{A.once("tabopen",e)})),A.emit("navigate",e.url),await new Promise((t=>{A.once("tabinfo",(s=>{const i=bt.children[s.id];e.title=i.querySelector("div").textContent=s.title||"Untitled",e.favicon=i.querySelector("img").src=s.favicon||"/res/empty.ico",t()}))}));A.onAny(Bt),-1===St?A.emit("newtab"):A.emit("focustab",St),It(null),_t.autofocus=!0,_t.focus({preventScroll:!0})}i("back").onclick=()=>A.emit("goback"),i("forward").onclick=()=>A.emit("goforward"),i("refresh").onclick=()=>A.emit("refresh"),i("new-tab").onclick=()=>A.emit("newtab"),xt.onfocus=()=>{xt.select()},xt.onblur=()=>{const e=Pt[St];null!=e&&(xt.value=e.url)},xt.onkeydown=e=>{if("Enter"===e.key){e.preventDefault(),e.stopPropagation();const t=xt.value.trim();t.length>0&&("puppeteer"===wt.value?(_t.focus({preventScroll:!0}),A.emit("navigate",Ft(t,"https://www.google.com/search?q="))):y(Ft(t,"https://www.bing.com/search?q=")))}},xt.ondragstart=e=>{e.preventDefault(),e.stopPropagation(),xt.selectionEnd=xt.selectionStart||(xt.selectionStart=0)},_t.addEventListener("mousedown",Nt,{passive:!1}),_t.addEventListener("mouseup",Nt,{passive:!1}),_t.addEventListener("mousemove",Nt,{passive:!1}),_t.addEventListener("touchstart",Lt,{passive:!1}),_t.addEventListener("touchend",Lt,{passive:!1}),_t.addEventListener("touchmove",Lt,{passive:!1}),_t.addEventListener("wheel",Dt,{passive:!1}),_t.addEventListener("keydown",Ot,{passive:!1}),_t.addEventListener("keyup",Ot,{passive:!1}),_t.addEventListener("click",Mt,{passive:!1}),_t.addEventListener("contextmenu",Mt,{passive:!1})}{const qt=n("#history>div"),Ht=i("cg-messages"),Vt=n("#chatgpt>input"),$t=n("#chatgpt>button");{const Xt=i("history"),Zt=i("cg-chat"),Qt=i("cg-menu");Qt.onclick=()=>{Qt.style.display="none",Xt.removeAttribute("style"),Zt.removeAttribute("style")},i("cg-close").onclick=()=>{Qt.style.display="block",Xt.style.display="none",Zt.style.width="100%"},P&&(Qt.style.display="block",Xt.style.display="none",Zt.style.width="100%")}let Wt=null;const Kt=JSON.parse(C.get("__chats")||"[]");function Gt(e,s){const i=t.createElement("div");{const s=t.createElement("img");s.width=32,s.height=32,s.loading="lazy",s.decoding="async",s.draggable=!1,"u"===e?(s.src="/res/user.svg",s.alt="User"):(s.src="/res/bot.svg",s.alt="Assistant"),i.appendChild(s)}{const e=t.createElement("div");e.textContent=s,i.appendChild(e)}return Ht.appendChild(i),i}function Yt(e){const s=t.createElement("div");s.onclick=()=>{for(const e of qt.children)e.removeAttribute("current");s.setAttribute("current","true"),Ht.innerHTML="",Wt=e.msgs;for(const e of Wt)Gt(e.role,e.text);Ht.scrollIntoView({behavior:"instant",block:"end",inline:"end"})};const i=t.createElement("div");i.textContent=e.title,s.appendChild(i);const n=t.createElement("button");n.type="button",n.title="Delete",n.onclick=t=>{t.preventDefault(),t.stopPropagation();const i=Kt.indexOf(e);i>=0&&(Wt=null,s.remove(),Kt.splice(i,1),Ht.innerHTML="",C.set("__chats",JSON.stringify(Kt,void 0,0)))},s.appendChild(n),qt.prepend(s)}function Jt(){Vt.disabled=!1,$t.disabled=!1,A.removeAllListeners("gptres"),A.removeAllListeners("gptend"),A.removeAllListeners("gpterr")}for(const es of Kt)Yt(es);i("chatgpt").onsubmit=e=>{e.preventDefault(),e.stopPropagation();const t=Vt.value.trim();if(t.length<2)return void m("The message must contain at least 2 characters.");if(!A.connected)return void m("Error: Disconnected from the backend server.");if(Vt.value="",Vt.disabled=!0,$t.disabled=!0,Gt("u",t),null==Wt){const e={title:t.slice(0,100),msgs:Wt=[]};Yt(e),Kt.push(e)}Wt.push({role:"u",text:t});const s=Gt("a","Processing..."),i=s.lastElementChild;let n;A.on("gptres",(e=>{i.textContent=n=e,i.scrollIntoView({behavior:"instant",block:"end",inline:"end"})})),A.on("gptend",(()=>{Jt(),Wt.push({role:"a",text:i.textContent=n}),C.set("__chats",JSON.stringify(Kt,void 0,0))})),A.on("gpterr",(e=>{Jt(),Wt.pop(),s.remove(),m("Failed to process the request. Message: "+e)})),A.emit("gptreq",Wt)},i("new-chat").onclick=()=>{for(const e of qt.children)e.removeAttribute("current");Wt=null,Ht.innerHTML=""}}{const ts=i("yt-search"),ss=n("#yt-search>input"),is=n("#yt-search>button"),ns=i("yt-api-key"),rs=i("yt-order"),as=i("yt-results"),os=i("yt-load-more"),cs=i("yt-max-results");let hs;function ls(s){const i=t.createElement("iframe");i.setAttribute("width","1024"),i.setAttribute("height","768"),i.setAttribute("allowfullscreen","true"),i.setAttribute("allowpaymentrequest","true"),i.setAttribute("name","Frame"),i.setAttribute("allow","fullscreen payment"),i.setAttribute("loading","lazy"),i.setAttribute("scrolling","no"),i.setAttribute("frameborder","0"),i.setAttribute("credentialless","true"),i.setAttribute("referrerpolicy","no-referrer"),i.setAttribute("src","data:application/xhtml+xml;base64,"+Gc.encode(Jc.encode(`<?xml version="1.0" encoding="utf-8" ?>\n<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">\n<html xmlns="http://www.w3.org/1999/xhtml" lang="en">\n\t<head>\n\t\t<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />\n\t\t<meta http-equiv="Referrer-Policy" content="no-referrer" />\n\t\t<meta name="referrer" content="no-referrer" />\n\t\t<meta name="viewport" content="width=device-width,initial-scale=1" />\n\t\t<base href="${e.origin}" target="_blank" />\n\t\t<link rel="icon" type="image/x-icon" href="res/google.ico" />\n\t\t<style type="text/css">\nbody, embed, iframe {\n\tposition: absolute;\n\tdisplay: block;\n\twidth: 100%;\n\theight: 100%;\n\tmargin: 0px;\n\tpadding: 0px;\n\tborder: none;\n\toverflow: hidden;\n}\n\t\t</style>\n\t\t<title>Google</title>\n\t</head>\n\t<body>\n\t\t<embed type="text/plain" width="1024" height="768" src="${s.replace(/\&/g,"&amp;")}" />\n\t</body>\n</html>`))),p.appendChild(i),u.style.display="block"}function ps(e){switch(e.host){case"youtube.com":case"youtube-nocookie.com":case"www.youtube.com":case"www.youtube-nocookie.com":const t=e.pathname;return"/watch"===t?e.searchParams.get("v")||null:t.startsWith("/embed/")&&t.substring(7)||null;case"youtu.be":return e.pathname.substring(1)||null;default:return null}}async function us(){const t=new URL("https://youtube.googleapis.com/youtube/v3/search"),s=t.searchParams;s.set("q",ss.value),s.set("key",ns.value||"AIzaSyARuwknsJhvP-ysM8-DwbqqJ5e-EaTL-UY"),s.set("type","video"),s.set("part","snippet"),s.set("order",rs.value),s.set("maxResults",cs.value),s.set("safeSearch","none"),s.set("videoEmbeddable","true"),null!=hs&&s.set("pageToken",hs);const i=await e.fetch(t,{cache:"no-cache",method:"GET",headers:{Accept:"application/json"}});return"application/json"===(i.headers.get("content-type")||"").split(";",2)[0].trim()?await i.json():null}async function ds(){m(null),is.disabled=!0,ss.disabled=!0,os.style.display="none";const e=await us();if(null==e)return void m("API server returned invalid data.");if("error"in e){const{message:t,code:s}=e.error;return void m(t+" (Code: "+s+")")}const s=e.items;if(0==s.length)return void m("No results match your search.");for(const e of s){const s=e.id.videoId,i=e.snippet,n=t.createElement("div");n.onclick=()=>ls("https://www.youtube-nocookie.com/embed/"+s+"?autoplay=1&controls=1&rel=0&color=white");const r=t.createElement("img");r.width=160,r.height=90,r.title="Video Preview",r.draggable=!1,r.src=i.thumbnails.medium.url,n.appendChild(r);const a=t.createElement("div");n.appendChild(a);const o=t.createElement("div");o.className="title",o.textContent=i.title,a.appendChild(o);const c=t.createElement("div");c.className="desc",c.textContent=i.description,a.appendChild(c);const h=t.createElement("div");h.className="time",h.textContent=i.publishTime,a.appendChild(h),as.appendChild(n)}const i=e.nextPageToken;null!=i&&(os.style.display="block",os.onclick=()=>{hs=i,ds().then((()=>{is.disabled=!1,ss.disabled=!1}))})}ns.value=C.get("__yt_apikey")||"",ts.onsubmit=e=>{e.preventDefault(),e.stopPropagation(),hs=null,as.innerHTML="";const t=b(ss.value);if(null==t)return void ds().then((()=>{is.disabled=!1,ss.disabled=!1}));m(null),os.style.display="none";const s=ps(t);null!=s?ls("https://www.youtube-nocookie.com/embed/"+s+"?autoplay=1&controls=1&rel=0&color=white"):m("Error: Failed to parse YouTube video ID from the provided URL.")},ns.onblur=()=>{const e=ns.value.trim();return 0===e.length?(C.delete("__yt_apikey"),void(ns.value="")):e.length<30?(m("Invalid API key."),void(ns.value="")):void C.set("__yt_apikey",ns.value=e)},cs.onblur=()=>{const e=parseInt(cs.value.trim(),10);isNaN(e)?cs.value="10":e<1?cs.value="1":e>30&&(cs.value="30")}}{const fs=i("emulator"),ms=i("core"),ys=i("bios"),gs=i("game-rom");fs.onchange=()=>{switch(fs.value){case"flash":ms.disabled=!0,ys.disabled=!0,gs.accept=".swf";break;case"dos":ms.disabled=!0,ys.disabled=!0,gs.accept=".jsdos, .zip";break;default:fs.value="emu",ms.disabled=!1,ys.disabled=!1,gs.accept="*/*"}},i("startemu").onclick=()=>{var e,t;const s=null===(e=gs.files)||void 0===e?void 0:e.item(0);if(null==s)return void m("Please choose a valid game ROM file.");const i=fs.value,n=new URLSearchParams("");if(n.set("name",s.name),n.set("type",i),n.set("url",URL.createObjectURL(s)),"emu"===i){n.set("core",ms.value);const e=null===(t=ys.files)||void 0===t?void 0:t.item(0);null!=e&&n.set("bios",URL.createObjectURL(e))}y("player.html?"+n.toString())}}{const bs=i("game-name"),ws=i("game-type"),_s=i("game-file"),xs=i("game-labels"),vs=i("game-description"),Ts=i("upload"),Ps=i("upload-message");ws.onchange=()=>{switch(ws.value){case"html5":_s.accept=".zip";break;case"flash":_s.accept=".swf";break;case"dos":_s.accept=".jsdos";break;default:_s.accept="*/*"}},Ps.onclick=()=>{Ps.innerHTML="",Ps.style.display="none"},Ts.onclick=async()=>{var t;const s=bs.value.replace(/\s+/g," ").trim();if(0===s.length)return void m("Game name must not be empty.");if(s.length>256)return void m("Game name must be less than 256 characters.");const i=null===(t=_s.files)||void 0===t?void 0:t.item(0);if(null==i)return void m("Please choose a valid game file.");if(0===i.size)return void m("Uploading empty game files is not allowed.");if(i.size>25e6)return void m("Uploading files larger than 25MB is not supported currently.");if(null==E)return void m("Invalid session. Please refresh this page and try again.");if(!A.connected)return void m("Error: Disconnected from the backend server.");Ts.disabled=!0,Ps.innerHTML="Processing...",Ps.style.color="#808080",Ps.style.display="block";const n=vs.value.replace(/\s+/g," ").trim(),r=xs.value.trim().toLowerCase().split(",").map((e=>e.replace(/\s+/g," ").trim())).join(",");if(r.length>300)m("The game tags list must be less than 300 characters in total.");else if(n.length>5e3)m("The game description text must be less than 5000 characters.");else{try{const t=await e.fetch("https://wwwfuck.whitespi.eu.org",{body:tf({user:E,name:s,type:ws.value,tags:r,desc:n,file:await i.arrayBuffer()},{compressLevel:9}),mode:"cors",cache:"no-cache",method:"POST",duplex:"half",headers:{"Content-Type":"application/octet-stream","X-Sec-Key":Math.floor(Date.now()/6e4).toString(36)}});if(!t.ok||"9Q9AGoNF4pmWRGw4La+Y9w=="!==await t.text())throw new Error("Remote returned error response. (Status: "+t.status+")");Ps.innerHTML="✓Success!",Ps.style.color="#008000",Ps.style.display="block"}catch(e){Ps.innerHTML="✕Error",Ps.style.color="#ff0000",Ps.style.display="block",m("Failed to upload the game. Message: "+e)}bs.value="",_s.value="",xs.value="",vs.value="",Ts.disabled=!1}}}{const ks=i("picker"),Cs=i("ufile"),Es=i("messages"),As=t.querySelectorAll("#channels>div"),Ss=i("sendmsg");let Is="";{const Ds=i("chat"),Os=i("menu"),Ms=i("sidemenu");Os.onclick=()=>{Ds.removeAttribute("style"),Os.style.display="none",Ms.style.display="block"},i("close-sm").onclick=()=>{Ds.style.width="100%",Os.style.display="block",Ms.style.display="none"},P&&(Ds.style.width="100%",Os.style.display="block",Ms.style.display="none")}{const Rs=i("chat-btn"),Fs=i("community-page");Rs.onclick=()=>{null!=D&&D();for(const e of j)e.removeAttribute("current");U.checked=!1,Rs.setAttribute("current","true"),Fs.setAttribute("current","true"),A.on("msg",((e,t)=>{if(e===Is){const e=Ns(t),s=Es.scrollHeight-Es.clientHeight;Es.appendChild(e),s===Es.scrollTop&&e.scrollIntoView({behavior:"instant",block:"end",inline:"end"})}})),A.on("msgdel",((e,t)=>{if(e===Is)for(const e of Es.children)if(e.getAttribute("_id")===t){e.remove();break}})),A.on("msgupd",((e,t,s)=>{if(e===Is)for(const e of Es.children)if(e.getAttribute("_id")===t){const i=e.querySelector("div>span");null!=i?i.textContent=s:m("Failed to update message: "+t);break}})),D=()=>{D=null,A.emit("end_session"),A.removeAllListeners("msg"),A.removeAllListeners("msgdel"),A.removeAllListeners("msgupd")},A.emit("ncs"),As[0].dispatchEvent(new Event("click"))}}function Ns({id:e,msg:s,uid:i,vip:n,user:r,icon:a,files:o}){const c=t.createElement("div");c.setAttribute("_id",e);const h=t.createElement("img");if(h.alt="Avatar",h.width=32,h.height=32,h.loading="lazy",h.decoding="async",h.draggable=!1,"string"!=typeof a){const e=URL.createObjectURL(new Blob([a],{type:"image/jpeg",endings:"native"}));h.addEventListener("load",(()=>URL.revokeObjectURL(e)),{once:!0,passive:!0}),h.src=e}else h.crossOrigin="anonymous",h.src=a;const l=t.createElement("div");switch(l.className="user",l.textContent=r,n){case 3:l.setAttribute("vip","gold");break;case 4:l.setAttribute("vip","diamond")}null!=i&&(h.style.cursor="pointer",l.style.cursor="pointer",h.onclick=l.onclick=()=>{N(i)});{const e=t.createElement("div"),i=t.createElement("span");i.textContent=s,e.appendChild(l),e.appendChild(i);for(const{name:s,type:i,url:n}of o)if(i.startsWith("image/")){const s=t.createElement("img");s.src=n,s.alt="Attachment",s.width=500,s.height=500,s.loading="eager",s.decoding="sync",s.draggable=!1,s.crossOrigin="anonymous",s.onclick=()=>y(n),e.appendChild(s)}else if(i.startsWith("audio/")){const s=t.createElement("audio");s.src=n,s.muted=!1,s.preload="metadata",s.controls=!0,e.appendChild(s)}else if(i.startsWith("video/")){const s=t.createElement("video");s.src=n,s.muted=!0,s.width=500,s.height=500,s.autoplay=!0,s.controls=!0,e.appendChild(s)}else{const i=t.createElement("a");i.rel="noopener nofollow",i.href=n,i.target="_blank",i.download="",i.textContent=s,e.appendChild(i)}c.appendChild(h),c.appendChild(e)}return c}async function Ls(e){var t;const s=await x(7,[Is=e]);let i=null===(t=s[s.length-1])||void 0===t?void 0:t.id,n=!1;Es.innerHTML="",Es.onscroll=async()=>{if(0===Es.scrollTop&&!n){n=!0;try{const t=await x(7,[e,i]);if(t.length>0){const e=Es.scrollHeight;for(const e of t)Es.prepend(Ns(e));i=t[t.length-1].id,Es.scrollTo({behavior:"instant",left:0,top:Es.scrollHeight-e})}}catch(e){m("Error: Failed to fetch messages."),console.error(e)}n=!1}};for(const e of s)Es.prepend(Ns(e));Es.scrollTo({behavior:"instant",left:0,top:Es.scrollHeight})}{const Bs=i("channel-name");let js=!1;for(const Us of As){const zs=Us.getAttribute("id")||"";Us.onclick=async()=>{if(!js){js=!0;try{await Ls(zs)}catch(e){console.error(e),m("Error: Failed to initialize channel.")}for(const e of As)e.removeAttribute("current");Us.hasAttribute("q")?Cs.style.display="block":Cs.style.display="none",Us.setAttribute("current","true"),Bs.innerHTML=Us.innerHTML,js=!1}}}}Ss.onfocus=()=>{null==E&&(Ss.blur(),F.click())},Ss.onkeydown=e=>{if("Enter"===e.key){if(e.preventDefault(),e.stopPropagation(),null==E)return void F.click();const t=Ss.value.trim();if(t.length<2)return void m("The message must contain at least 2 characters.");if(t.length>1e3)return void m("The message should not be longer than 1000 characters.");if(!A.connected)return void m("Error: Disconnected from the backend server.");Ss.value="",Ss.disabled=!0,x(8,[E,Is,t]).then((()=>{Ss.disabled=!1})).catch((e=>{m("Failed to post text message. Message: "+e),Ss.disabled=!1}))}},i("emoji").onclick=()=>{if("block"!==ks.style.display){if(null==ks.firstElementChild){const e=new vl({locale:"POSIX",emojiVersion:1e3});e.addEventListener("emoji-click",(e=>{e.preventDefault(),e.stopPropagation();const t=e.detail.unicode;null!=t&&Ss.setRangeText(t,Ss.selectionStart||0,Ss.selectionEnd||0,"end")})),ks.appendChild(e)}ks.style.display="block"}else ks.style.display="none"},Cs.onclick=()=>{const e=t.createElement("input");e.type="file",e.accept="*/*",e.multiple=!0,e.onchange=async()=>{const t=e.files;if(null!=t&&t.length>0){if(t.length>10)return void m("Uploading more than 10 files at once is not supported.");if(!A.connected)return void m("Error: Disconnected from the backend server.");const e=[];for(const s of t){if(s.size<1)return void m("Uploading empty files is not allowed.");if(s.size>1e7)return void m("Uploading files larger than 10MB is not supported.");e.push({name:s.name,attachment:await s.arrayBuffer()})}Cs.disabled=!0;try{await x(12,[E,Is,e])}catch(e){m("Failed to upload file. Message: "+e)}Cs.disabled=!1}},e.click()},i("discord").onclick=async()=>{const t=await _("https://discord.com/api/guilds/998658232207814667/widget.json","no-cache");null!=t?e.location.href=JSON.parse(t).instant_invite:m("Error: Failed to fetch invite link.")}}const F=i("accn-btn"),B=i("chat-profile"),j=t.querySelectorAll("#nav-bar>button, #content>div:not(#footer), #unbl-content"),U=i("side-menu");{const qs=i("home-btn"),Hs=i("unbl-btn"),Vs=i("apps-btn"),$s=i("settings"),Ws=i("home-page"),Ks=i("site-blocked-page"),Gs=i("services-page"),Ys=i("uploadgames-page"),Js=i("accountinfo-page"),Xs=i("profile-page"),Zs=i("settings-page");i("logo").onclick=qs.onclick=()=>{null!=D&&D();for(const e of j)e.removeAttribute("current");U.checked=!1,qs.setAttribute("current","true"),Ws.setAttribute("current","true")},Vs.onclick=()=>{null!=D&&D();for(const e of j)e.removeAttribute("current");U.checked=!1,Vs.setAttribute("current","true"),Gs.setAttribute("current","true")},Hs.onclick=()=>{null!=D&&D();for(const e of j)e.removeAttribute("current");U.checked=!1,Hs.setAttribute("current","true"),Ks.setAttribute("current","true")},i("ug").onclick=()=>{null!=D&&D();for(const e of j)e.removeAttribute("current");U.checked=!1,Ys.setAttribute("current","true")},i("chat-login").onclick=B.onclick=F.onclick=()=>{null!=D&&D();for(const e of j)e.removeAttribute("current");U.checked=!1,F.setAttribute("current","true"),Js.setAttribute("current","true")},$s.onclick=e=>{if(e.preventDefault(),e.stopPropagation(),null!=D&&D(),Zs.hasAttribute("current")){for(const e of j)e.removeAttribute("current");qs.setAttribute("current","true"),Ws.setAttribute("current","true")}else{for(const e of j)e.removeAttribute("current");Zs.setAttribute("current","true")}U.checked=!1};{const Qs=i("avatar"),ei=i("userid"),ti=i("af"),si=i("dm");N=async e=>{try{e=await x(1,e)}catch(t){return m("Failed to open user profile: "+e),void console.error(t)}{const t="/u/"+e.uid;ei.textContent=e.id,a.replaceState(void 0,"",t),f.setAttribute("href","https://whitespider.dev"+t)}switch(e.vip){case 3:ei.setAttribute("vip","gold");break;case 4:ei.setAttribute("vip","diamond");break;default:ei.removeAttribute("vip")}ti.onclick=si.onclick=()=>{m("Function not yet implemented.")},null!=D&&D();for(const e of j)e.removeAttribute("current");U.checked=!1,Xs.setAttribute("current","true");{const t=URL.createObjectURL(new Blob([e.avatar],{type:"image/jpeg",endings:"native"}));Qs.src=t,await Qs.decode(),URL.revokeObjectURL(t)}}}switch(o.slice(0,3)){case"/g/":{const ii=parseInt(o.slice(3),36);if(Number.isSafeInteger(ii)&&ii>0)for(const ni of O)if(ni.date===ii){I(ni);break}}break;case"/u/":{const ri=o.slice(3);ri.length>0&&ri.length<30&&N(ri)}}i("loading").remove(),i("content").style.display="block"}{const ai=async()=>{F.innerHTML="My Account",i("ac-prof").style.display="block",i("chat-login").remove(),i("login-dialog").remove();const e=i("ac-un"),s=i("ac-edit"),n=i("ac-link"),r=i("ch-avatar"),a=r.firstElementChild,o=t.createElement("img");o.alt="Avatar",o.title="Change avatar",o.width=40,o.height=40,o.loading="eager",o.decoding="sync",o.draggable=!1,B.appendChild(o);const c=t.createElement("div");c.className="user",B.appendChild(c),B.style.display="block";const h=await x(2,E);switch(i("ac-un").textContent=c.textContent=h.id,i("ac-uid").textContent=h.uid,i("ac-name").textContent=h.name||"Not set",i("ac-email").textContent=h.email||"Not set",i("account-settings").style.display="block",h.vip){case 3:i("ac-membership").textContent="Gold 👑",e.setAttribute("vip","gold"),c.setAttribute("vip","gold");break;case 4:i("ac-membership").textContent="Diamond 💎",e.setAttribute("vip","diamond"),c.setAttribute("vip","diamond");break;default:i("ac-membership").textContent="None"}{const e=URL.createObjectURL(new Blob([h.avatar],{type:"image/jpeg",endings:"native"}));a.src=o.src=e,await a.decode(),await o.decode(),URL.revokeObjectURL(e)}r.onclick=()=>{const e=t.createElement("input");e.type="file",e.accept="image/*",e.onchange=async()=>{var t;const s=null===(t=e.files)||void 0===t?void 0:t.item(0);if(null!=s){const e=URL.createObjectURL(s),t=new Image(512,512);t.src=e,t.loading="eager",t.decoding="sync";try{await t.decode(),URL.revokeObjectURL(e)}catch(e){return void m("Error: Failed to decode the image file.")}const i=Math.min(t.naturalWidth,t.naturalHeight),n=Math.min(i,512),r=new OffscreenCanvas(n,n),c=r.getContext("2d",{alpha:!1});if(null==c)throw new Error("Internal Error: Canvas context is null before accessing.");c.imageSmoothingEnabled=!0,c.imageSmoothingQuality="high",c.fillStyle="#ffffff",c.fillRect(0,0,n,n),c.drawImage(t,0,0,i,i,0,0,n,n);try{const e=await r.convertToBlob({type:"image/jpeg",quality:100});await x(4,[E,await e.arrayBuffer()]);const t=URL.createObjectURL(e);a.src=o.src=t,await a.decode(),await o.decode(),URL.revokeObjectURL(t)}catch(e){m("Error: Failed to upload the image file. (See console logs for details)"),console.error(e)}}},e.click()},s.onclick=()=>{const i=t.createElement("div"),n=t.createElement("input");n.type="text",n.value=e.innerHTML,n.minLength=4,n.maxLength=20,n.spellcheck=!1,n.placeholder="Username",n.autocomplete="off",n.setAttribute("style","position:relative;display:inline-block;width:fit-content;height:fit-content;margin:0px 10px;padding:5px;"),i.appendChild(n);const r=t.createElement("button");r.type="button",r.title="Save",r.textContent="✓",i.appendChild(r);const a=t.createElement("button");a.type="button",a.title="Cancel",a.textContent="✕",i.appendChild(a),n.onblur=()=>{n.value=n.value.trim().toLowerCase()},r.onclick=()=>{const t=n.value.trim().toLowerCase();t.length<4||t.length>20?m("The username must have 4 to 20 characters."):/^[\-a-z0-9]+$/.test(t)?x(3,[E,t]).then((()=>{i.replaceWith(e),e.textContent=t,c.textContent=t,s.removeAttribute("style")})).catch((e=>{m("Error: Failed to change username. Message: "+e)})):m("The username must contain only hyphens, a-z, 0-9")},a.onclick=()=>{i.replaceWith(e),s.removeAttribute("style")},s.style.display="none",e.replaceWith(i),n.select()},n.onclick=()=>{const e=t.createElement("span"),s=origin+"/u/"+h.uid;e.textContent=s,n.replaceWith(e),navigator.clipboard.writeText(s)}};{const oi=i("cp");oi.onclick=()=>{const e=t.createElement("div"),s=t.createElement("div");s.setAttribute("style","position:relative;display:block;width:fit-content;height:fit-content;margin:10px 0px;padding:5px;"),s.textContent="Notice: If your account was created with your Google account and does not have a password, set the current password field to 'CHANGEME!'.",e.appendChild(s);const i=t.createElement("input");i.type="password",i.minLength=8,i.maxLength=30,i.spellcheck=!1,i.placeholder="Current password",i.autocomplete="off",i.setAttribute("style","position:relative;display:block;width:fit-content;height:fit-content;margin:10px 0px;padding:5px;"),e.appendChild(i);const n=t.createElement("input");n.type="password",n.minLength=8,n.maxLength=30,n.spellcheck=!1,n.placeholder="New password",n.autocomplete="off",n.setAttribute("style","position:relative;display:block;width:fit-content;height:fit-content;margin:10px 0px;padding:5px;"),e.appendChild(n);const r=t.createElement("input");r.type="password",r.minLength=8,r.maxLength=30,r.spellcheck=!1,r.placeholder="Confirm password",r.autocomplete="off",r.setAttribute("style","position:relative;display:block;width:fit-content;height:fit-content;margin:10px 0px;padding:5px;"),e.appendChild(r);const a=t.createElement("button");a.type="button",a.title="Change",a.textContent="✓",e.appendChild(a);const o=t.createElement("button");o.type="button",o.title="Cancel",o.textContent="✕",e.appendChild(o),a.onclick=()=>{const t=i.value;if(t.length<8||t.length>30)return void m("The current password must have 8 to 30 characters.");const s=n.value;s.length<8||s.length>30?m("The new password must have 8 to 30 characters."):s===r.value?x(9,[E,t,s]).then((()=>{e.replaceWith(oi)})).catch((e=>{m("Error: Failed to change password. Message: "+e)})):m("The new password does not match the confirm password.")},o.onclick=()=>{e.replaceWith(oi)},oi.replaceWith(e)}}if(i("fa").onclick=()=>{m("Function not yet implemented.")},i("so").onclick=()=>{C.delete("__secrets_"),setTimeout((()=>r.reload()),200)},i("da").onclick=()=>{m("Error: Operation not permitted.")},null==E){const ci=n("#login-dialog>h3"),hi=i("login"),li=i("register"),pi=i("username"),ui=i("password"),di=i("2fa-otp"),fi=i("c-password");di.style.display="none",fi.style.display="none",li.onclick=()=>{"Register"===ci.innerHTML?(ci.innerHTML="Login",hi.innerHTML="Login",li.innerHTML="Register",fi.style.display="none"):(ci.innerHTML="Register",hi.innerHTML="Register",li.innerHTML="Login",fi.style.display="block")},pi.onblur=()=>{pi.value=pi.value.trim().toLowerCase()},hi.onclick=()=>{const e=pi.value.trim().toLowerCase();if(e.length<4||e.length>20)return void m("The username must have 4 to 20 characters.");if(!/^[\-a-z0-9]+$/.test(e))return void m("The username must contain only hyphens, a-z, 0-9");const t=ui.value;if(t.length<8||t.length>30)m("The password must have 8 to 30 characters.");else if("Register"===ci.innerHTML){if(t!==fi.value)return void m("Confirm password does not match.");x(11,[e,t]).then((e=>{C.set("__secrets_",E=e),ai()})).catch((e=>{m("Error: Failed to register. Message: "+e)}))}else x(10,[e,t]).then((e=>{C.set("__secrets_",E=e),ai()})).catch((e=>{m("Error: Failed to login. Message: "+e)}))},i("login-google").onclick=()=>{const t=e.open(void 0,"_blank","width="+screen.availWidth+",height="+screen.availHeight+",left=0,top=0,popup");if(null==t)return void m("Please allow popups in your browser settings and try again.");t.stop(),t.focus();const s=new URLSearchParams;s.set("client_id","176227430389-qkdboctmfhe9jnvnk2vmarafc5p8amuf.apps.googleusercontent.com"),s.set("redirect_uri",e.origin+"/auth.xht"),s.set("response_type","token"),s.set("state","12"),s.set("scope","email profile"),s.set("include_granted_scopes","true"),s.set("enable_granular_consent","true"),t.location.replace("https://accounts.google.com/o/oauth2/v2/auth?"+s.toString())};{const mi=e=>{(e=new URLSearchParams(e).get("access_token")||"").length>0&&x(0,e).then((e=>{C.set("__secrets_",E=e),ai()})).catch((e=>{console.error(e),m("Failed to retrieve login tokens. (See console logs for details)")}))},yi=C.get("_cre_");null==yi?e.addEventListener("message",(t=>{if(t.origin===e.origin){const e=t.data;"string"==typeof e&&e.length>0&&mi(e)}}),{once:!1,passive:!0}):(mi(yi),C.delete("_cre_"))}}else await ai()}{const gi=n("#console-input>input"),bi=i("console-output"),wi=[];let _i=0;function xi(e,s,i){const n=t.createElement("span");return n.style.color=s||"",n.style.whiteSpace="pre-wrap",n.style.overflowWrap="break-word",n.textContent=e,(i||bi).appendChild(n),n.scrollIntoView({behavior:"instant",block:"start",inline:"start"}),n}function vi(){const e=t.createElement("hr");bi.appendChild(e),e.scrollIntoView({behavior:"instant",block:"start",inline:"start"})}function Ti(e,s,i){const n=s?100:1e3,r=e.length;if(r>n){const s=xi('"'+Ii(e.slice(0,n))+"\n..."+(r-n)+" more characters","#008000",i),a=t.createElement("button");a.type="button",a.textContent="Expand",a.onclick=()=>{s.textContent='"'+Ii(e)+'"',a.remove()},bi.appendChild(a)}else xi('"'+Ii(e)+'"',"#008000",i)}function Pi(e,t,s){xi("[\n",void 0,t);for(const s of e)xi("\t",void 0,t),Ai(s,!0,t),xi(",\n",void 0,t);xi(s||"]",void 0,t)}function ki(e,s,i){const n=e.length;if(0!==n)if(s)xi("[...]",void 0,i);else if(n>20){const s=t.createElement("span");Pi(e.slice(0,20),s,"\t..."+(n-20)+" more items");const r=t.createElement("button");r.type="button",r.textContent="Expand",r.onclick=()=>{s.innerHTML="",Pi(e,s)},s.appendChild(r),(i||bi).appendChild(s)}else Pi(e,i);else xi("[]",void 0,i)}function Ci(e,t,s,i){var n,r,a,o,c,h;const l=Si(e);l.length>0?xi(l+" {\n",void 0,s):xi("{\n",void 0,s);const p=Pl.getPrototypeOf(e);null!=p&&(xi("\t[[prototype]]: ",void 0,s),Ei(p,!0,s),xi(",\n",void 0,s));for(const i of t){xi("\t",void 0,s);const t=Pl.getOwnPropertyDescriptor(e,i)||{value:void 0};"value"in t?(null===(n=t.writable)||void 0===n||n||xi("readonly ","#000080",s),null===(r=t.configurable)||void 0===r||r||xi("final ","#000080",s),xi("string"==typeof i?i:"["+i.toString()+"]",null===(a=t.enumerable)||void 0===a||a?"#008000":"#808080",s),xi(": ",void 0,s),Ai(t.value,!0,s),xi(",\n",void 0,s)):(null===(o=t.configurable)||void 0===o||o||xi("final ","#000080",s),"get"in t&&(xi("get ","#000080",s),xi("string"==typeof i?i:"["+i.toString()+"]",null===(c=t.enumerable)||void 0===c||c?"#008000":"#808080",s),xi("() { ... }, ",void 0,s)),"set"in t&&(xi("set ","#000080",s),xi("string"==typeof i?i:"["+i.toString()+"]",null===(h=t.enumerable)||void 0===h||h?"#008000":"#808080",s),xi("(v) { ... }, ",void 0,s)),xi("\n",void 0,s))}xi(i||"}",void 0,s)}function Ei(e,s,i){if(null==e)return void xi("null","#000080",i);if(Cl.isArray(e))return void ki(e,s);if(s){const t=Si(e);return void xi((t.length>0?t+" {":"{")+(Pl.keys(e).length>0?"...":"")+"}",void 0,i)}const n=Pl.getOwnPropertyNames(e).sort();if(n.push.apply(n,Pl.getOwnPropertySymbols(e)),n.length>20){const s=t.createElement("span");Ci(e,n.slice(0,20),s,"\t...\n}");const r=t.createElement("button");r.type="button",r.textContent="Expand",r.onclick=()=>{s.innerHTML="",Ci(e,n,s)},s.appendChild(r),(i||bi).appendChild(s)}else Ci(e,n,i)}function Ai(e,t,s){switch(typeof e){case"boolean":xi(e?"true":"false","#000080",s);break;case"number":xi(e.toString(10),"#0000ff",s);break;case"bigint":xi(kl(e)+"n","#0000ff",s);break;case"symbol":xi(e.toString(),"#800080",s);break;case"function":xi(kl(e),void 0,s);break;case"undefined":xi("undefined","#000080",s);break;case"string":Ti(e,t,s);break;default:Ei(e,t,s)}}function Si(e){try{const t=e[Symbol.toStringTag];if("string"==typeof t)return t;const s=e.constructor;if("function"==typeof s){const{name:e}=s;if("string"==typeof e)return e}}catch(e){}return""}function Ii(e){return e.replace(/[\"\'\n\r\\]/g,(e=>{switch(e){case"\n":return"\\n";case"\r":return"\\r";case'"':return'\\"';case"'":return"\\'";case"\\":return"\\\\";default:return""}}))}async function Ni(s){if(xi("->  ","#808080"),xi(s=s.trim(),"#303030"),vi(),"/"===s[0]){const e=s.slice(1).replace(/\s+/g," ").split(" ");switch(s=e[0]){case"clear":if(e.length>1)return xi("Invalid arguments. Try '/help' for more information.\n","#ff0000"),void vi();bi.innerHTML="";break;case"help":xi("Embedded JSConsole version 0.1.1 by WhiteSpider Dev\n\n","#0000ff"),xi("All inputs that starts with '/' will be treated as a built-in command.\n","#808000"),xi("All other inputs will be executed as JavaScript code with 'eval(code)'.\n\n","#808000"),xi("Built-in commands:\n","#008000"),xi("\t/clear\t\t\t\t- Clear the console.\n","#008000"),xi("\t/help\t\t\t\t- Show version info and built-in command list.\n\n","#008000"),vi();break;default:xi(s+": command not found. \nTry '/help' for a list of built-in commands.\n","#ff0000"),vi()}return}try{s=function(e){const{body:t}=(0,Hc.qg)(e,{ranges:!0,tokens:!1,strictMode:!0,sourceType:"script",attachComment:!1,allowAwaitOutsideFunction:!0,allowReturnOutsideFunction:!0}).program,s=t.pop();let i="";for(const s of t)i+=Vc(e,s);return null!=s&&("ExpressionStatement"===s.type?i+="return "+e.slice(s.start,s.end):i+=Vc(e,s)),i}(s)}catch(e){return xi(kl(e)+"\n","#ff0000"),void vi()}let i;try{i=await new El("window","document",'"use strict;"\n'+s).apply(e,[e,t])}catch(e){return xi("Uncaught "+kl(e)+"\n","#ff0000"),void vi()}Ai(i,!1),vi()}gi.onkeydown=e=>{switch(e.key){case"Enter":e.preventDefault(),e.stopPropagation();const t=gi.value.trim();t.length>0&&(wi.push(t),_i=wi.length,gi.blur(),gi.value="",gi.disabled=!0,Ni(t).then((()=>{gi.disabled=!1,gi.focus({preventScroll:!0})})));break;case"ArrowUp":e.preventDefault(),e.stopPropagation(),_i>0&&(gi.value=wi[--_i]);break;case"ArrowDown":e.preventDefault(),e.stopPropagation(),_i<wi.length&&(gi.value=wi[++_i]||"")}}}})(window)})()})();