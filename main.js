/*! Copyright (C) 2024 WhiteSpider Dev. All rights reserved. Source: https://whitespider.dev/ !*/
"use strict"; / Created by WhiteSpider Dev. DO NOT remove this comment!!! This will break integrity checks! /;
/*! For license information please see out.js.LICENSE.txt */
(()=>{"use strict";var e={602:(e,t)=>{function s(e,t){if(null==e)return{};var s,i,r={},n=Object.keys(e);for(i=0;i<n.length;i++)s=n[i],t.indexOf(s)>=0||(r[s]=e[s]);return r}class i{constructor(e,t,s){this.line=void 0,this.column=void 0,this.index=void 0,this.line=e,this.column=t,this.index=s}}class r{constructor(e,t){this.start=void 0,this.end=void 0,this.filename=void 0,this.identifierName=void 0,this.start=e,this.end=t}}function n(e,t){const{line:s,column:r,index:n}=e;return new i(s,r+t,n+t)}const a="BABEL_PARSER_SOURCETYPE_MODULE_REQUIRED";var o={ImportMetaOutsideModule:{message:"import.meta may appear only with 'sourceType: \"module\"'",code:a},ImportOutsideModule:{message:"'import' and 'export' may appear only with 'sourceType: \"module\"'",code:a}};const h={ArrayPattern:"array destructuring pattern",AssignmentExpression:"assignment expression",AssignmentPattern:"assignment expression",ArrowFunctionExpression:"arrow function expression",ConditionalExpression:"conditional expression",CatchClause:"catch clause",ForOfStatement:"for-of statement",ForInStatement:"for-in statement",ForStatement:"for-loop",FormalParameters:"function parameter list",Identifier:"identifier",ImportSpecifier:"import specifier",ImportDefaultSpecifier:"import default specifier",ImportNamespaceSpecifier:"import namespace specifier",ObjectPattern:"object destructuring pattern",ParenthesizedExpression:"parenthesized expression",RestElement:"rest element",UpdateExpression:{true:"prefix operation",false:"postfix operation"},VariableDeclarator:"variable declaration",YieldExpression:"yield expression"},c=({type:e,prefix:t})=>"UpdateExpression"===e?h.UpdateExpression[String(t)]:h[e];var l={AccessorIsGenerator:({kind:e})=>`A ${e}ter cannot be a generator.`,ArgumentsInClass:"'arguments' is only allowed in functions and class methods.",AsyncFunctionInSingleStatementContext:"Async functions can only be declared at the top level or inside a block.",AwaitBindingIdentifier:"Can not use 'await' as identifier inside an async function.",AwaitBindingIdentifierInStaticBlock:"Can not use 'await' as identifier inside a static block.",AwaitExpressionFormalParameter:"'await' is not allowed in async function parameters.",AwaitUsingNotInAsyncContext:"'await using' is only allowed within async functions and at the top levels of modules.",AwaitNotInAsyncContext:"'await' is only allowed within async functions and at the top levels of modules.",AwaitNotInAsyncFunction:"'await' is only allowed within async functions.",BadGetterArity:"A 'get' accessor must not have any formal parameters.",BadSetterArity:"A 'set' accessor must have exactly one formal parameter.",BadSetterRestParameter:"A 'set' accessor function argument must not be a rest parameter.",ConstructorClassField:"Classes may not have a field named 'constructor'.",ConstructorClassPrivateField:"Classes may not have a private field named '#constructor'.",ConstructorIsAccessor:"Class constructor may not be an accessor.",ConstructorIsAsync:"Constructor can't be an async function.",ConstructorIsGenerator:"Constructor can't be a generator.",DeclarationMissingInitializer:({kind:e})=>`Missing initializer in ${e} declaration.`,DecoratorArgumentsOutsideParentheses:"Decorator arguments must be moved inside parentheses: use '@(decorator(args))' instead of '@(decorator)(args)'.",DecoratorBeforeExport:"Decorators must be placed *before* the 'export' keyword. Remove the 'decoratorsBeforeExport: true' option to use the 'export @decorator class {}' syntax.",DecoratorsBeforeAfterExport:"Decorators can be placed *either* before or after the 'export' keyword, but not in both locations at the same time.",DecoratorConstructor:"Decorators can't be used with a constructor. Did you mean '@dec class { ... }'?",DecoratorExportClass:"Decorators must be placed *after* the 'export' keyword. Remove the 'decoratorsBeforeExport: false' option to use the '@decorator export class {}' syntax.",DecoratorSemicolon:"Decorators must not be followed by a semicolon.",DecoratorStaticBlock:"Decorators can't be used with a static block.",DeferImportRequiresNamespace:'Only `import defer * as x from "./module"` is valid.',DeletePrivateField:"Deleting a private field is not allowed.",DestructureNamedImport:"ES2015 named imports do not destructure. Use another statement for destructuring after the import.",DuplicateConstructor:"Duplicate constructor in the same class.",DuplicateDefaultExport:"Only one default export allowed per module.",DuplicateExport:({exportName:e})=>`\`${e}\` has already been exported. Exported identifiers must be unique.`,DuplicateProto:"Redefinition of __proto__ property.",DuplicateRegExpFlags:"Duplicate regular expression flag.",DynamicImportPhaseRequiresImportExpressions:({phase:e})=>`'import.${e}(...)' can only be parsed when using the 'createImportExpressions' option.`,ElementAfterRest:"Rest element must be last element.",EscapedCharNotAnIdentifier:"Invalid Unicode escape.",ExportBindingIsString:({localName:e,exportName:t})=>`A string literal cannot be used as an exported binding without \`from\`.\n- Did you mean \`export { '${e}' as '${t}' } from 'some-module'\`?`,ExportDefaultFromAsIdentifier:"'from' is not allowed as an identifier after 'export default'.",ForInOfLoopInitializer:({type:e})=>`'${"ForInStatement"===e?"for-in":"for-of"}' loop variable declaration may not have an initializer.`,ForInUsing:"For-in loop may not start with 'using' declaration.",ForOfAsync:"The left-hand side of a for-of loop may not be 'async'.",ForOfLet:"The left-hand side of a for-of loop may not start with 'let'.",GeneratorInSingleStatementContext:"Generators can only be declared at the top level or inside a block.",IllegalBreakContinue:({type:e})=>`Unsyntactic ${"BreakStatement"===e?"break":"continue"}.`,IllegalLanguageModeDirective:"Illegal 'use strict' directive in function with non-simple parameter list.",IllegalReturn:"'return' outside of function.",ImportAttributesUseAssert:"The `assert` keyword in import attributes is deprecated and it has been replaced by the `with` keyword. You can enable the `deprecatedAssertSyntax: true` option in the import attributes plugin to suppress this error.",ImportBindingIsString:({importName:e})=>`A string literal cannot be used as an imported binding.\n- Did you mean \`import { "${e}" as foo }\`?`,ImportCallArgumentTrailingComma:"Trailing comma is disallowed inside import(...) arguments.",ImportCallArity:({maxArgumentCount:e})=>`\`import()\` requires exactly ${1===e?"one argument":"one or two arguments"}.`,ImportCallNotNewExpression:"Cannot use new with import(...).",ImportCallSpreadArgument:"`...` is not allowed in `import()`.",ImportJSONBindingNotDefault:"A JSON module can only be imported with `default`.",ImportReflectionHasAssertion:"`import module x` cannot have assertions.",ImportReflectionNotBinding:'Only `import module x from "./module"` is valid.',IncompatibleRegExpUVFlags:"The 'u' and 'v' regular expression flags cannot be enabled at the same time.",InvalidBigIntLiteral:"Invalid BigIntLiteral.",InvalidCodePoint:"Code point out of bounds.",InvalidCoverInitializedName:"Invalid shorthand property initializer.",InvalidDecimal:"Invalid decimal.",InvalidDigit:({radix:e})=>`Expected number in radix ${e}.`,InvalidEscapeSequence:"Bad character escape sequence.",InvalidEscapeSequenceTemplate:"Invalid escape sequence in template.",InvalidEscapedReservedWord:({reservedWord:e})=>`Escape sequence in keyword ${e}.`,InvalidIdentifier:({identifierName:e})=>`Invalid identifier ${e}.`,InvalidLhs:({ancestor:e})=>`Invalid left-hand side in ${c(e)}.`,InvalidLhsBinding:({ancestor:e})=>`Binding invalid left-hand side in ${c(e)}.`,InvalidLhsOptionalChaining:({ancestor:e})=>`Invalid optional chaining in the left-hand side of ${c(e)}.`,InvalidNumber:"Invalid number.",InvalidOrMissingExponent:"Floating-point numbers require a valid exponent after the 'e'.",InvalidOrUnexpectedToken:({unexpected:e})=>`Unexpected character '${e}'.`,InvalidParenthesizedAssignment:"Invalid parenthesized assignment pattern.",InvalidPrivateFieldResolution:({identifierName:e})=>`Private name #${e} is not defined.`,InvalidPropertyBindingPattern:"Binding member expression.",InvalidRecordProperty:"Only properties and spread elements are allowed in record definitions.",InvalidRestAssignmentPattern:"Invalid rest operator's argument.",LabelRedeclaration:({labelName:e})=>`Label '${e}' is already declared.`,LetInLexicalBinding:"'let' is disallowed as a lexically bound name.",LineTerminatorBeforeArrow:"No line break is allowed before '=>'.",MalformedRegExpFlags:"Invalid regular expression flag.",MissingClassName:"A class name is required.",MissingEqInAssignment:"Only '=' operator can be used for specifying default value.",MissingSemicolon:"Missing semicolon.",MissingPlugin:({missingPlugin:e})=>`This experimental syntax requires enabling the parser plugin: ${e.map((e=>JSON.stringify(e))).join(", ")}.`,MissingOneOfPlugins:({missingPlugin:e})=>`This experimental syntax requires enabling one of the following parser plugin(s): ${e.map((e=>JSON.stringify(e))).join(", ")}.`,MissingUnicodeEscape:"Expecting Unicode escape sequence \\uXXXX.",MixingCoalesceWithLogical:"Nullish coalescing operator(??) requires parens when mixing with logical operators.",ModuleAttributeDifferentFromType:"The only accepted module attribute is `type`.",ModuleAttributeInvalidValue:"Only string literals are allowed as module attribute values.",ModuleAttributesWithDuplicateKeys:({key:e})=>`Duplicate key "${e}" is not allowed in module attributes.`,ModuleExportNameHasLoneSurrogate:({surrogateCharCode:e})=>`An export name cannot include a lone surrogate, found '\\u${e.toString(16)}'.`,ModuleExportUndefined:({localName:e})=>`Export '${e}' is not defined.`,MultipleDefaultsInSwitch:"Multiple default clauses.",NewlineAfterThrow:"Illegal newline after throw.",NoCatchOrFinally:"Missing catch or finally clause.",NumberIdentifier:"Identifier directly after number.",NumericSeparatorInEscapeSequence:"Numeric separators are not allowed inside unicode escape sequences or hex escape sequences.",ObsoleteAwaitStar:"'await*' has been removed from the async functions proposal. Use Promise.all() instead.",OptionalChainingNoNew:"Constructors in/after an Optional Chain are not allowed.",OptionalChainingNoTemplate:"Tagged Template Literals are not allowed in optionalChain.",OverrideOnConstructor:"'override' modifier cannot appear on a constructor declaration.",ParamDupe:"Argument name clash.",PatternHasAccessor:"Object pattern can't contain getter or setter.",PatternHasMethod:"Object pattern can't contain methods.",PrivateInExpectedIn:({identifierName:e})=>`Private names are only allowed in property accesses (\`obj.#${e}\`) or in \`in\` expressions (\`#${e} in obj\`).`,PrivateNameRedeclaration:({identifierName:e})=>`Duplicate private name #${e}.`,RecordExpressionBarIncorrectEndSyntaxType:"Record expressions ending with '|}' are only allowed when the 'syntaxType' option of the 'recordAndTuple' plugin is set to 'bar'.",RecordExpressionBarIncorrectStartSyntaxType:"Record expressions starting with '{|' are only allowed when the 'syntaxType' option of the 'recordAndTuple' plugin is set to 'bar'.",RecordExpressionHashIncorrectStartSyntaxType:"Record expressions starting with '#{' are only allowed when the 'syntaxType' option of the 'recordAndTuple' plugin is set to 'hash'.",RecordNoProto:"'__proto__' is not allowed in Record expressions.",RestTrailingComma:"Unexpected trailing comma after rest element.",SloppyFunction:"In non-strict mode code, functions can only be declared at top level or inside a block.",SloppyFunctionAnnexB:"In non-strict mode code, functions can only be declared at top level, inside a block, or as the body of an if statement.",SourcePhaseImportRequiresDefault:'Only `import source x from "./module"` is valid.',StaticPrototype:"Classes may not have static property named prototype.",SuperNotAllowed:"`super()` is only valid inside a class constructor of a subclass. Maybe a typo in the method name ('constructor') or not extending another class?",SuperPrivateField:"Private fields can't be accessed on super.",TrailingDecorator:"Decorators must be attached to a class element.",TupleExpressionBarIncorrectEndSyntaxType:"Tuple expressions ending with '|]' are only allowed when the 'syntaxType' option of the 'recordAndTuple' plugin is set to 'bar'.",TupleExpressionBarIncorrectStartSyntaxType:"Tuple expressions starting with '[|' are only allowed when the 'syntaxType' option of the 'recordAndTuple' plugin is set to 'bar'.",TupleExpressionHashIncorrectStartSyntaxType:"Tuple expressions starting with '#[' are only allowed when the 'syntaxType' option of the 'recordAndTuple' plugin is set to 'hash'.",UnexpectedArgumentPlaceholder:"Unexpected argument placeholder.",UnexpectedAwaitAfterPipelineBody:'Unexpected "await" after pipeline body; await must have parentheses in minimal proposal.',UnexpectedDigitAfterHash:"Unexpected digit after hash token.",UnexpectedImportExport:"'import' and 'export' may only appear at the top level.",UnexpectedKeyword:({keyword:e})=>`Unexpected keyword '${e}'.`,UnexpectedLeadingDecorator:"Leading decorators must be attached to a class declaration.",UnexpectedLexicalDeclaration:"Lexical declaration cannot appear in a single-statement context.",UnexpectedNewTarget:"`new.target` can only be used in functions or class properties.",UnexpectedNumericSeparator:"A numeric separator is only allowed between two digits.",UnexpectedPrivateField:"Unexpected private name.",UnexpectedReservedWord:({reservedWord:e})=>`Unexpected reserved word '${e}'.`,UnexpectedSuper:"'super' is only allowed in object methods and classes.",UnexpectedToken:({expected:e,unexpected:t})=>`Unexpected token${t?` '${t}'.`:""}${e?`, expected "${e}"`:""}`,UnexpectedTokenUnaryExponentiation:"Illegal expression. Wrap left hand side or entire exponentiation in parentheses.",UnexpectedUsingDeclaration:"Using declaration cannot appear in the top level when source type is `script`.",UnsupportedBind:"Binding should be performed on object property.",UnsupportedDecoratorExport:"A decorated export must export a class declaration.",UnsupportedDefaultExport:"Only expressions, functions or classes are allowed as the `default` export.",UnsupportedImport:"`import` can only be used in `import()` or `import.meta`.",UnsupportedMetaProperty:({target:e,onlyValidPropertyName:t})=>`The only valid meta property for ${e} is ${e}.${t}.`,UnsupportedParameterDecorator:"Decorators cannot be used to decorate parameters.",UnsupportedPropertyDecorator:"Decorators cannot be used to decorate object literal properties.",UnsupportedSuper:"'super' can only be used with function calls (i.e. super()) or in property accesses (i.e. super.prop or super[prop]).",UnterminatedComment:"Unterminated comment.",UnterminatedRegExp:"Unterminated regular expression.",UnterminatedString:"Unterminated string constant.",UnterminatedTemplate:"Unterminated template.",UsingDeclarationHasBindingPattern:"Using declaration cannot have destructuring patterns.",VarRedeclaration:({identifierName:e})=>`Identifier '${e}' has already been declared.`,YieldBindingIdentifier:"Can not use 'yield' as identifier inside a generator.",YieldInParameter:"Yield expression is not allowed in formal parameters.",ZeroDigitNumericSeparator:"Numeric separator can not be used after leading 0."};const p=new Set(["ArrowFunctionExpression","AssignmentExpression","ConditionalExpression","YieldExpression"]);var u={PipeBodyIsTighter:"Unexpected yield after pipeline body; any yield expression acting as Hack-style pipe body must be parenthesized due to its loose operator precedence.",PipeTopicRequiresHackPipes:'Topic reference is used, but the pipelineOperator plugin was not passed a "proposal": "hack" or "smart" option.',PipeTopicUnbound:"Topic reference is unbound; it must be inside a pipe body.",PipeTopicUnconfiguredToken:({token:e})=>`Invalid topic token ${e}. In order to use ${e} as a topic reference, the pipelineOperator plugin must be configured with { "proposal": "hack", "topicToken": "${e}" }.`,PipeTopicUnused:"Hack-style pipe body does not contain a topic reference; Hack-style pipes must use topic at least once.",PipeUnparenthesizedBody:({type:e})=>`Hack-style pipe body cannot be an unparenthesized ${c({type:e})}; please wrap it in parentheses.`,PipelineBodyNoArrow:'Unexpected arrow "=>" after pipeline body; arrow function in pipeline body must be parenthesized.',PipelineBodySequenceExpression:"Pipeline body may not be a comma-separated sequence expression.",PipelineHeadSequenceExpression:"Pipeline head should not be a comma-separated sequence expression.",PipelineTopicUnused:"Pipeline is in topic style but does not use topic reference.",PrimaryTopicNotAllowed:"Topic reference was used in a lexical context without topic binding.",PrimaryTopicRequiresSmartPipeline:'Topic reference is used, but the pipelineOperator plugin was not passed a "proposal": "hack" or "smart" option.'};const d=["toMessage"],f=["message"];function m(e,t,s){Object.defineProperty(e,t,{enumerable:!1,configurable:!0,value:s})}function y(e){let{toMessage:t}=e,r=s(e,d);return function e(s,n){const a=new SyntaxError;return Object.assign(a,r,{loc:s,pos:s.index}),"missingPlugin"in n&&Object.assign(a,{missingPlugin:n.missingPlugin}),m(a,"clone",(function(t={}){var r;const{line:a,column:o,index:h}=null!=(r=t.loc)?r:s;return e(new i(a,o,h),Object.assign({},n,t.details))})),m(a,"details",n),Object.defineProperty(a,"message",{configurable:!0,get(){const e=`${t(n)} (${s.line}:${s.column})`;return this.message=e,e},set(e){Object.defineProperty(this,"message",{value:e,writable:!0})}}),a}}function g(e,t){if(Array.isArray(e))return t=>g(t,e[0]);const i={};for(const r of Object.keys(e)){const n=e[r],a="string"==typeof n?{message:()=>n}:"function"==typeof n?{message:n}:n,{message:o}=a,h=s(a,f),c="string"==typeof o?()=>o:o;i[r]=y(Object.assign({code:"BABEL_PARSER_SYNTAX_ERROR",reasonCode:r,toMessage:c},t?{syntaxPlugin:t}:{},h))}return i}const b=Object.assign({},g(o),g(l),g({StrictDelete:"Deleting local variable in strict mode.",StrictEvalArguments:({referenceName:e})=>`Assigning to '${e}' in strict mode.`,StrictEvalArgumentsBinding:({bindingName:e})=>`Binding '${e}' in strict mode.`,StrictFunction:"In strict mode code, functions can only be declared at top level or inside a block.",StrictNumericEscape:"The only valid numeric escape in strict mode is '\\0'.",StrictOctalLiteral:"Legacy octal literals are not allowed in strict mode.",StrictWith:"'with' in strict mode."}),g`pipelineOperator`(u)),{defineProperty:w}=Object,_=(e,t)=>w(e,t,{enumerable:!1,value:e[t]});function x(e){return e.loc.start&&_(e.loc.start,"index"),e.loc.end&&_(e.loc.end,"index"),e}class v{constructor(e,t){this.token=void 0,this.preserveSpace=void 0,this.token=e,this.preserveSpace=!!t}}const P={brace:new v("{"),j_oTag:new v("<tag"),j_cTag:new v("</tag"),j_expr:new v("<tag>...</tag>",!0)};P.template=new v("`",!0);const T=!0,C=!0,E=!0,k=!0,A=!0;class S{constructor(e,t={}){this.label=void 0,this.keyword=void 0,this.beforeExpr=void 0,this.startsExpr=void 0,this.rightAssociative=void 0,this.isLoop=void 0,this.isAssign=void 0,this.prefix=void 0,this.postfix=void 0,this.binop=void 0,this.label=e,this.keyword=t.keyword,this.beforeExpr=!!t.beforeExpr,this.startsExpr=!!t.startsExpr,this.rightAssociative=!!t.rightAssociative,this.isLoop=!!t.isLoop,this.isAssign=!!t.isAssign,this.prefix=!!t.prefix,this.postfix=!!t.postfix,this.binop=null!=t.binop?t.binop:null,this.updateContext=null}}const I=new Map;function N(e,t={}){t.keyword=e;const s=j(e,t);return I.set(e,s),s}function L(e,t){return j(e,{beforeExpr:T,binop:t})}let D=-1;const O=[],M=[],R=[],F=[],B=[],U=[];function j(e,t={}){var s,i,r,n;return++D,M.push(e),R.push(null!=(s=t.binop)?s:-1),F.push(null!=(i=t.beforeExpr)&&i),B.push(null!=(r=t.startsExpr)&&r),U.push(null!=(n=t.prefix)&&n),O.push(new S(e,t)),D}function z(e,t={}){var s,i,r,n;return++D,I.set(e,D),M.push(e),R.push(null!=(s=t.binop)?s:-1),F.push(null!=(i=t.beforeExpr)&&i),B.push(null!=(r=t.startsExpr)&&r),U.push(null!=(n=t.prefix)&&n),O.push(new S("name",t)),D}const q={bracketL:j("[",{beforeExpr:T,startsExpr:C}),bracketHashL:j("#[",{beforeExpr:T,startsExpr:C}),bracketBarL:j("[|",{beforeExpr:T,startsExpr:C}),bracketR:j("]"),bracketBarR:j("|]"),braceL:j("{",{beforeExpr:T,startsExpr:C}),braceBarL:j("{|",{beforeExpr:T,startsExpr:C}),braceHashL:j("#{",{beforeExpr:T,startsExpr:C}),braceR:j("}"),braceBarR:j("|}"),parenL:j("(",{beforeExpr:T,startsExpr:C}),parenR:j(")"),comma:j(",",{beforeExpr:T}),semi:j(";",{beforeExpr:T}),colon:j(":",{beforeExpr:T}),doubleColon:j("::",{beforeExpr:T}),dot:j("."),question:j("?",{beforeExpr:T}),questionDot:j("?."),arrow:j("=>",{beforeExpr:T}),template:j("template"),ellipsis:j("...",{beforeExpr:T}),backQuote:j("`",{startsExpr:C}),dollarBraceL:j("${",{beforeExpr:T,startsExpr:C}),templateTail:j("...`",{startsExpr:C}),templateNonTail:j("...${",{beforeExpr:T,startsExpr:C}),at:j("@"),hash:j("#",{startsExpr:C}),interpreterDirective:j("#!..."),eq:j("=",{beforeExpr:T,isAssign:k}),assign:j("_=",{beforeExpr:T,isAssign:k}),slashAssign:j("_=",{beforeExpr:T,isAssign:k}),xorAssign:j("_=",{beforeExpr:T,isAssign:k}),moduloAssign:j("_=",{beforeExpr:T,isAssign:k}),incDec:j("++/--",{prefix:A,postfix:!0,startsExpr:C}),bang:j("!",{beforeExpr:T,prefix:A,startsExpr:C}),tilde:j("~",{beforeExpr:T,prefix:A,startsExpr:C}),doubleCaret:j("^^",{startsExpr:C}),doubleAt:j("@@",{startsExpr:C}),pipeline:L("|>",0),nullishCoalescing:L("??",1),logicalOR:L("||",1),logicalAND:L("&&",2),bitwiseOR:L("|",3),bitwiseXOR:L("^",4),bitwiseAND:L("&",5),equality:L("==/!=/===/!==",6),lt:L("</>/<=/>=",7),gt:L("</>/<=/>=",7),relational:L("</>/<=/>=",7),bitShift:L("<</>>/>>>",8),bitShiftL:L("<</>>/>>>",8),bitShiftR:L("<</>>/>>>",8),plusMin:j("+/-",{beforeExpr:T,binop:9,prefix:A,startsExpr:C}),modulo:j("%",{binop:10,startsExpr:C}),star:j("*",{binop:10}),slash:L("/",10),exponent:j("**",{beforeExpr:T,binop:11,rightAssociative:!0}),_in:N("in",{beforeExpr:T,binop:7}),_instanceof:N("instanceof",{beforeExpr:T,binop:7}),_break:N("break"),_case:N("case",{beforeExpr:T}),_catch:N("catch"),_continue:N("continue"),_debugger:N("debugger"),_default:N("default",{beforeExpr:T}),_else:N("else",{beforeExpr:T}),_finally:N("finally"),_function:N("function",{startsExpr:C}),_if:N("if"),_return:N("return",{beforeExpr:T}),_switch:N("switch"),_throw:N("throw",{beforeExpr:T,prefix:A,startsExpr:C}),_try:N("try"),_var:N("var"),_const:N("const"),_with:N("with"),_new:N("new",{beforeExpr:T,startsExpr:C}),_this:N("this",{startsExpr:C}),_super:N("super",{startsExpr:C}),_class:N("class",{startsExpr:C}),_extends:N("extends",{beforeExpr:T}),_export:N("export"),_import:N("import",{startsExpr:C}),_null:N("null",{startsExpr:C}),_true:N("true",{startsExpr:C}),_false:N("false",{startsExpr:C}),_typeof:N("typeof",{beforeExpr:T,prefix:A,startsExpr:C}),_void:N("void",{beforeExpr:T,prefix:A,startsExpr:C}),_delete:N("delete",{beforeExpr:T,prefix:A,startsExpr:C}),_do:N("do",{isLoop:E,beforeExpr:T}),_for:N("for",{isLoop:E}),_while:N("while",{isLoop:E}),_as:z("as",{startsExpr:C}),_assert:z("assert",{startsExpr:C}),_async:z("async",{startsExpr:C}),_await:z("await",{startsExpr:C}),_defer:z("defer",{startsExpr:C}),_from:z("from",{startsExpr:C}),_get:z("get",{startsExpr:C}),_let:z("let",{startsExpr:C}),_meta:z("meta",{startsExpr:C}),_of:z("of",{startsExpr:C}),_sent:z("sent",{startsExpr:C}),_set:z("set",{startsExpr:C}),_source:z("source",{startsExpr:C}),_static:z("static",{startsExpr:C}),_using:z("using",{startsExpr:C}),_yield:z("yield",{startsExpr:C}),_asserts:z("asserts",{startsExpr:C}),_checks:z("checks",{startsExpr:C}),_exports:z("exports",{startsExpr:C}),_global:z("global",{startsExpr:C}),_implements:z("implements",{startsExpr:C}),_intrinsic:z("intrinsic",{startsExpr:C}),_infer:z("infer",{startsExpr:C}),_is:z("is",{startsExpr:C}),_mixins:z("mixins",{startsExpr:C}),_proto:z("proto",{startsExpr:C}),_require:z("require",{startsExpr:C}),_satisfies:z("satisfies",{startsExpr:C}),_keyof:z("keyof",{startsExpr:C}),_readonly:z("readonly",{startsExpr:C}),_unique:z("unique",{startsExpr:C}),_abstract:z("abstract",{startsExpr:C}),_declare:z("declare",{startsExpr:C}),_enum:z("enum",{startsExpr:C}),_module:z("module",{startsExpr:C}),_namespace:z("namespace",{startsExpr:C}),_interface:z("interface",{startsExpr:C}),_type:z("type",{startsExpr:C}),_opaque:z("opaque",{startsExpr:C}),name:j("name",{startsExpr:C}),string:j("string",{startsExpr:C}),num:j("num",{startsExpr:C}),bigint:j("bigint",{startsExpr:C}),decimal:j("decimal",{startsExpr:C}),regexp:j("regexp",{startsExpr:C}),privateName:j("#name",{startsExpr:C}),eof:j("eof"),jsxName:j("jsxName"),jsxText:j("jsxText",{beforeExpr:!0}),jsxTagStart:j("jsxTagStart",{startsExpr:!0}),jsxTagEnd:j("jsxTagEnd"),placeholder:j("%%",{startsExpr:!0})};function H(e){return e>=93&&e<=132}function V(e){return e>=58&&e<=132}function W(e){return e>=58&&e<=136}function $(e){return B[e]}function K(e){return e>=129&&e<=131}function G(e){return e>=58&&e<=92}function Y(e){return M[e]}function J(e){return R[e]}function Z(e){return e>=24&&e<=25}function X(e){return O[e]}O[8].updateContext=e=>{e.pop()},O[5].updateContext=O[7].updateContext=O[23].updateContext=e=>{e.push(P.brace)},O[22].updateContext=e=>{e[e.length-1]===P.template?e.pop():e.push(P.template)},O[142].updateContext=e=>{e.push(P.j_expr,P.j_oTag)};let Q="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙՠ-ֈא-תׯ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࡠ-ࡪࡰ-ࢇࢉ-ࢎࢠ-ࣉऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱৼਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౝౠౡಀಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೝೞೠೡೱೲഄ-ഌഎ-ഐഒ-ഺഽൎൔ-ൖൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄຆ-ຊຌ-ຣລວ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛸᜀ-ᜑᜟ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡸᢀ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭌᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᲀ-ᲈᲐ-ᲺᲽ-Ჿᳩ-ᳬᳮ-ᳳᳵᳶᳺᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕ℘-ℝℤΩℨK-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞ々-〇〡-〩〱-〵〸-〼ぁ-ゖ゛-ゟァ-ヺー-ヿㄅ-ㄯㄱ-ㆎㆠ-ㆿㇰ-ㇿ㐀-䶿一-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꟊꟐꟑꟓꟕ-ꟙꟲ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꣾꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭩꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",ee="‌‍·̀-ͯ·҃-֑҇-ׇֽֿׁׂׅׄؐ-ًؚ-٩ٰۖ-ۜ۟-۪ۤۧۨ-ۭ۰-۹ܑܰ-݊ަ-ް߀-߉߫-߽߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛࢘-࢟࣊-ࣣ࣡-ःऺ-़ा-ॏ॑-ॗॢॣ०-९ঁ-ঃ়া-ৄেৈো-্ৗৢৣ০-৯৾ਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢૣ૦-૯ૺ-૿ଁ-ଃ଼ା-ୄେୈୋ-୍୕-ୗୢୣ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఀ-ఄ఼ా-ౄె-ైొ-్ౕౖౢౣ౦-౯ಁ-ಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢೣ೦-೯ೳഀ-ഃ഻഼ാ-ൄെ-ൈൊ-്ൗൢൣ൦-൯ඁ-ඃ්ා-ුූෘ-ෟ෦-෯ෲෳัิ-ฺ็-๎๐-๙ັິ-ຼ່-໎໐-໙༘༙༠-༩༹༵༷༾༿ཱ-྄྆྇ྍ-ྗྙ-ྼ࿆ါ-ှ၀-၉ၖ-ၙၞ-ၠၢ-ၤၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟፩-፱ᜒ-᜕ᜲ-᜴ᝒᝓᝲᝳ឴-៓៝០-៩᠋-᠍᠏-᠙ᢩᤠ-ᤫᤰ-᤻᥆-᥏᧐-᧚ᨗ-ᨛᩕ-ᩞ᩠-᩿᩼-᪉᪐-᪙᪰-᪽ᪿ-ᫎᬀ-ᬄ᬴-᭄᭐-᭙᭫-᭳ᮀ-ᮂᮡ-ᮭ᮰-᮹᯦-᯳ᰤ-᰷᱀-᱉᱐-᱙᳐-᳔᳒-᳨᳭᳴᳷-᳹᷀-᷿‌‍‿⁀⁔⃐-⃥⃜⃡-⃰⳯-⵿⳱ⷠ-〪ⷿ-゙゚〯・꘠-꘩꙯ꙴ-꙽ꚞꚟ꛰꛱ꠂ꠆ꠋꠣ-ꠧ꠬ꢀꢁꢴ-ꣅ꣐-꣙꣠-꣱ꣿ-꤉ꤦ-꤭ꥇ-꥓ꦀ-ꦃ꦳-꧀꧐-꧙ꧥ꧰-꧹ꨩ-ꨶꩃꩌꩍ꩐-꩙ꩻ-ꩽꪰꪲ-ꪴꪷꪸꪾ꪿꫁ꫫ-ꫯꫵ꫶ꯣ-ꯪ꯬꯭꯰-꯹ﬞ︀-️︠-︯︳︴﹍-﹏０-９＿･";const te=new RegExp("["+Q+"]"),se=new RegExp("["+Q+ee+"]");Q=ee=null;const ie=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,13,10,2,14,2,6,2,1,2,10,2,14,2,6,2,1,68,310,10,21,11,7,25,5,2,41,2,8,70,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,349,41,7,1,79,28,11,0,9,21,43,17,47,20,28,22,13,52,58,1,3,0,14,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,20,1,64,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,38,6,186,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,19,72,264,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,16,0,2,12,2,33,125,0,80,921,103,110,18,195,2637,96,16,1071,18,5,4026,582,8634,568,8,30,18,78,18,29,19,47,17,3,32,20,6,18,689,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,43,8,8936,3,2,6,2,1,2,290,16,0,30,2,3,0,15,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,1845,30,7,5,262,61,147,44,11,6,17,0,322,29,19,43,485,27,757,6,2,3,2,1,2,14,2,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42719,33,4153,7,221,3,5761,15,7472,16,621,2467,541,1507,4938,6,4191],re=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,370,1,81,2,71,10,50,3,123,2,54,14,32,10,3,1,11,3,46,10,8,0,46,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,3,0,158,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,406,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,10,1,2,0,49,6,4,4,14,9,5351,0,7,14,13835,9,87,9,39,4,60,6,26,9,1014,0,2,54,8,3,82,0,12,1,19628,1,4706,45,3,22,543,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,101,0,161,6,10,9,357,0,62,13,499,13,983,6,110,6,6,9,4759,9,787719,239];function ne(e,t){let s=65536;for(let i=0,r=t.length;i<r;i+=2){if(s+=t[i],s>e)return!1;if(s+=t[i+1],s>=e)return!0}return!1}function ae(e){return e<65?36===e:e<=90||(e<97?95===e:e<=122||(e<=65535?e>=170&&te.test(String.fromCharCode(e)):ne(e,ie)))}function oe(e){return e<48?36===e:e<58||!(e<65)&&(e<=90||(e<97?95===e:e<=122||(e<=65535?e>=170&&se.test(String.fromCharCode(e)):ne(e,ie)||ne(e,re))))}const he=new Set(["break","case","catch","continue","debugger","default","do","else","finally","for","function","if","return","switch","throw","try","var","const","while","with","new","this","super","class","extends","export","import","null","true","false","in","instanceof","typeof","void","delete"]),ce=new Set(["implements","interface","let","package","private","protected","public","static","yield"]),le=new Set(["eval","arguments"]);function pe(e,t){return t&&"await"===e||"enum"===e}function ue(e,t){return pe(e,t)||ce.has(e)}function de(e){return le.has(e)}function fe(e,t){return ue(e,t)||de(e)}const me=new Set(["break","case","catch","continue","debugger","default","do","else","finally","for","function","if","return","switch","throw","try","var","const","while","with","new","this","super","class","extends","export","import","null","true","false","in","instanceof","typeof","void","delete","implements","interface","let","package","private","protected","public","static","yield","eval","arguments","enum","await"]);class ye{constructor(e){this.flags=0,this.names=new Map,this.firstLexicalName="",this.flags=e}}class ge{constructor(e,t){this.parser=void 0,this.scopeStack=[],this.inModule=void 0,this.undefinedExports=new Map,this.parser=e,this.inModule=t}get inTopLevel(){return(1&this.currentScope().flags)>0}get inFunction(){return(2&this.currentVarScopeFlags())>0}get allowSuper(){return(16&this.currentThisScopeFlags())>0}get allowDirectSuper(){return(32&this.currentThisScopeFlags())>0}get inClass(){return(64&this.currentThisScopeFlags())>0}get inClassAndNotInNonArrowFunction(){const e=this.currentThisScopeFlags();return(64&e)>0&&0==(2&e)}get inStaticBlock(){for(let e=this.scopeStack.length-1;;e--){const{flags:t}=this.scopeStack[e];if(128&t)return!0;if(451&t)return!1}}get inNonArrowFunction(){return(2&this.currentThisScopeFlags())>0}get treatFunctionsAsVar(){return this.treatFunctionsAsVarInScope(this.currentScope())}createScope(e){return new ye(e)}enter(e){this.scopeStack.push(this.createScope(e))}exit(){return this.scopeStack.pop().flags}treatFunctionsAsVarInScope(e){return!!(130&e.flags||!this.parser.inModule&&1&e.flags)}declareName(e,t,s){let i=this.currentScope();if(8&t||16&t){this.checkRedeclarationInScope(i,e,t,s);let r=i.names.get(e)||0;16&t?r|=4:(i.firstLexicalName||(i.firstLexicalName=e),r|=2),i.names.set(e,r),8&t&&this.maybeExportDefined(i,e)}else if(4&t)for(let r=this.scopeStack.length-1;r>=0&&(i=this.scopeStack[r],this.checkRedeclarationInScope(i,e,t,s),i.names.set(e,1|(i.names.get(e)||0)),this.maybeExportDefined(i,e),!(387&i.flags));--r);this.parser.inModule&&1&i.flags&&this.undefinedExports.delete(e)}maybeExportDefined(e,t){this.parser.inModule&&1&e.flags&&this.undefinedExports.delete(t)}checkRedeclarationInScope(e,t,s,i){this.isRedeclaredInScope(e,t,s)&&this.parser.raise(b.VarRedeclaration,i,{identifierName:t})}isRedeclaredInScope(e,t,s){if(!(1&s))return!1;if(8&s)return e.names.has(t);const i=e.names.get(t);return 16&s?(2&i)>0||!this.treatFunctionsAsVarInScope(e)&&(1&i)>0:(2&i)>0&&!(8&e.flags&&e.firstLexicalName===t)||!this.treatFunctionsAsVarInScope(e)&&(4&i)>0}checkLocalExport(e){const{name:t}=e;this.scopeStack[0].names.has(t)||this.undefinedExports.set(t,e.loc.start)}currentScope(){return this.scopeStack[this.scopeStack.length-1]}currentVarScopeFlags(){for(let e=this.scopeStack.length-1;;e--){const{flags:t}=this.scopeStack[e];if(387&t)return t}}currentThisScopeFlags(){for(let e=this.scopeStack.length-1;;e--){const{flags:t}=this.scopeStack[e];if(451&t&&!(4&t))return t}}}class be extends ye{constructor(...e){super(...e),this.declareFunctions=new Set}}class we extends ge{createScope(e){return new be(e)}declareName(e,t,s){const i=this.currentScope();if(2048&t)return this.checkRedeclarationInScope(i,e,t,s),this.maybeExportDefined(i,e),void i.declareFunctions.add(e);super.declareName(e,t,s)}isRedeclaredInScope(e,t,s){if(super.isRedeclaredInScope(e,t,s))return!0;if(2048&s&&!e.declareFunctions.has(t)){const s=e.names.get(t);return(4&s)>0||(2&s)>0}return!1}checkLocalExport(e){this.scopeStack[0].declareFunctions.has(e.name)||super.checkLocalExport(e)}}class _e{constructor(){this.sawUnambiguousESM=!1,this.ambiguousScriptDifferentAst=!1}hasPlugin(e){if("string"==typeof e)return this.plugins.has(e);{const[t,s]=e;if(!this.hasPlugin(t))return!1;const i=this.plugins.get(t);for(const e of Object.keys(s))if((null==i?void 0:i[e])!==s[e])return!1;return!0}}getPluginOption(e,t){var s;return null==(s=this.plugins.get(e))?void 0:s[t]}}function xe(e,t){void 0===e.trailingComments?e.trailingComments=t:e.trailingComments.unshift(...t)}function ve(e,t){void 0===e.innerComments?e.innerComments=t:e.innerComments.unshift(...t)}function Pe(e,t,s){let i=null,r=t.length;for(;null===i&&r>0;)i=t[--r];null===i||i.start>s.start?ve(e,s.comments):xe(i,s.comments)}class Te extends _e{addComment(e){this.filename&&(e.loc.filename=this.filename);const{commentsLen:t}=this.state;this.comments.length!=t&&(this.comments.length=t),this.comments.push(e),this.state.commentsLen++}processComment(e){const{commentStack:t}=this.state,s=t.length;if(0===s)return;let i=s-1;const r=t[i];r.start===e.end&&(r.leadingNode=e,i--);const{start:n}=e;for(;i>=0;i--){const s=t[i],r=s.end;if(!(r>n)){r===n&&(s.trailingNode=e);break}s.containingNode=e,this.finalizeComment(s),t.splice(i,1)}}finalizeComment(e){const{comments:t}=e;if(null!==e.leadingNode||null!==e.trailingNode)null!==e.leadingNode&&xe(e.leadingNode,t),null!==e.trailingNode&&function(e,t){void 0===e.leadingComments?e.leadingComments=t:e.leadingComments.unshift(...t)}(e.trailingNode,t);else{const{containingNode:s,start:i}=e;if(44===this.input.charCodeAt(i-1))switch(s.type){case"ObjectExpression":case"ObjectPattern":case"RecordExpression":Pe(s,s.properties,e);break;case"CallExpression":case"OptionalCallExpression":Pe(s,s.arguments,e);break;case"FunctionDeclaration":case"FunctionExpression":case"ArrowFunctionExpression":case"ObjectMethod":case"ClassMethod":case"ClassPrivateMethod":Pe(s,s.params,e);break;case"ArrayExpression":case"ArrayPattern":case"TupleExpression":Pe(s,s.elements,e);break;case"ExportNamedDeclaration":case"ImportDeclaration":Pe(s,s.specifiers,e);break;default:ve(s,t)}else ve(s,t)}}finalizeRemainingComments(){const{commentStack:e}=this.state;for(let t=e.length-1;t>=0;t--)this.finalizeComment(e[t]);this.state.commentStack=[]}resetPreviousNodeTrailingComments(e){const{commentStack:t}=this.state,{length:s}=t;if(0===s)return;const i=t[s-1];i.leadingNode===e&&(i.leadingNode=null)}resetPreviousIdentifierLeadingComments(e){const{commentStack:t}=this.state,{length:s}=t;0!==s&&(t[s-1].trailingNode===e?t[s-1].trailingNode=null:s>=2&&t[s-2].trailingNode===e&&(t[s-2].trailingNode=null))}takeSurroundingComments(e,t,s){const{commentStack:i}=this.state,r=i.length;if(0===r)return;let n=r-1;for(;n>=0;n--){const r=i[n],a=r.end;if(r.start===s)r.leadingNode=e;else if(a===t)r.trailingNode=e;else if(a<t)break}}}const Ce=/\r\n?|[\n\u2028\u2029]/,Ee=new RegExp(Ce.source,"g");function ke(e){switch(e){case 10:case 13:case 8232:case 8233:return!0;default:return!1}}const Ae=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,Se=/(?:[^\S\n\r\u2028\u2029]|\/\/.*|\/\*.*?\*\/)*/g,Ie=new RegExp("(?=("+Se.source+"))\\1"+/(?=[\n\r\u2028\u2029]|\/\*(?!.*?\*\/)|$)/.source,"y");function Ne(e){switch(e){case 9:case 11:case 12:case 32:case 160:case 5760:case 8192:case 8193:case 8194:case 8195:case 8196:case 8197:case 8198:case 8199:case 8200:case 8201:case 8202:case 8239:case 8287:case 12288:case 65279:return!0;default:return!1}}class Le{constructor(){this.flags=1024,this.curLine=void 0,this.lineStart=void 0,this.startLoc=void 0,this.endLoc=void 0,this.errors=[],this.potentialArrowAt=-1,this.noArrowAt=[],this.noArrowParamsConversionAt=[],this.topicContext={maxNumOfResolvableTopics:0,maxTopicIndex:null},this.labels=[],this.commentsLen=0,this.commentStack=[],this.pos=0,this.type=139,this.value=null,this.start=0,this.end=0,this.lastTokEndLoc=null,this.lastTokStartLoc=null,this.context=[P.brace],this.firstInvalidTemplateEscapePos=null,this.strictErrors=new Map,this.tokensLength=0}get strict(){return(1&this.flags)>0}set strict(e){e?this.flags|=1:this.flags&=-2}init({strictMode:e,sourceType:t,startLine:s,startColumn:r}){this.strict=!1!==e&&(!0===e||"module"===t),this.curLine=s,this.lineStart=-r,this.startLoc=this.endLoc=new i(s,r,0)}get maybeInArrowParameters(){return(2&this.flags)>0}set maybeInArrowParameters(e){e?this.flags|=2:this.flags&=-3}get inType(){return(4&this.flags)>0}set inType(e){e?this.flags|=4:this.flags&=-5}get noAnonFunctionType(){return(8&this.flags)>0}set noAnonFunctionType(e){e?this.flags|=8:this.flags&=-9}get hasFlowComment(){return(16&this.flags)>0}set hasFlowComment(e){e?this.flags|=16:this.flags&=-17}get isAmbientContext(){return(32&this.flags)>0}set isAmbientContext(e){e?this.flags|=32:this.flags&=-33}get inAbstractClass(){return(64&this.flags)>0}set inAbstractClass(e){e?this.flags|=64:this.flags&=-65}get inDisallowConditionalTypesContext(){return(128&this.flags)>0}set inDisallowConditionalTypesContext(e){e?this.flags|=128:this.flags&=-129}get soloAwait(){return(256&this.flags)>0}set soloAwait(e){e?this.flags|=256:this.flags&=-257}get inFSharpPipelineDirectBody(){return(512&this.flags)>0}set inFSharpPipelineDirectBody(e){e?this.flags|=512:this.flags&=-513}get canStartJSXElement(){return(1024&this.flags)>0}set canStartJSXElement(e){e?this.flags|=1024:this.flags&=-1025}get containsEsc(){return(2048&this.flags)>0}set containsEsc(e){e?this.flags|=2048:this.flags&=-2049}curPosition(){return new i(this.curLine,this.pos-this.lineStart,this.pos)}clone(){const e=new Le;return e.flags=this.flags,e.curLine=this.curLine,e.lineStart=this.lineStart,e.startLoc=this.startLoc,e.endLoc=this.endLoc,e.errors=this.errors.slice(),e.potentialArrowAt=this.potentialArrowAt,e.noArrowAt=this.noArrowAt.slice(),e.noArrowParamsConversionAt=this.noArrowParamsConversionAt.slice(),e.topicContext=this.topicContext,e.labels=this.labels.slice(),e.commentsLen=this.commentsLen,e.commentStack=this.commentStack.slice(),e.pos=this.pos,e.type=this.type,e.value=this.value,e.start=this.start,e.end=this.end,e.lastTokEndLoc=this.lastTokEndLoc,e.lastTokStartLoc=this.lastTokStartLoc,e.context=this.context.slice(),e.firstInvalidTemplateEscapePos=this.firstInvalidTemplateEscapePos,e.strictErrors=this.strictErrors,e.tokensLength=this.tokensLength,e}}var De=function(e){return e>=48&&e<=57};const Oe={decBinOct:new Set([46,66,69,79,95,98,101,111]),hex:new Set([46,88,95,120])},Me={bin:e=>48===e||49===e,oct:e=>e>=48&&e<=55,dec:e=>e>=48&&e<=57,hex:e=>e>=48&&e<=57||e>=65&&e<=70||e>=97&&e<=102};function Re(e,t,s,i,r,n){const a=s,o=i,h=r;let c="",l=null,p=s;const{length:u}=t;for(;;){if(s>=u){n.unterminated(a,o,h),c+=t.slice(p,s);break}const d=t.charCodeAt(s);if(Fe(e,d,t,s)){c+=t.slice(p,s);break}if(92===d){c+=t.slice(p,s);const a=Be(t,s,i,r,"template"===e,n);null!==a.ch||l?c+=a.ch:l={pos:s,lineStart:i,curLine:r},({pos:s,lineStart:i,curLine:r}=a),p=s}else 8232===d||8233===d?(++r,i=++s):10===d||13===d?"template"===e?(c+=t.slice(p,s)+"\n",++s,13===d&&10===t.charCodeAt(s)&&++s,++r,p=i=s):n.unterminated(a,o,h):++s}return{pos:s,str:c,firstInvalidLoc:l,lineStart:i,curLine:r,containsInvalid:!!l}}function Fe(e,t,s,i){return"template"===e?96===t||36===t&&123===s.charCodeAt(i+1):t===("double"===e?34:39)}function Be(e,t,s,i,r,n){const a=!r;t++;const o=e=>({pos:t,ch:e,lineStart:s,curLine:i}),h=e.charCodeAt(t++);switch(h){case 110:return o("\n");case 114:return o("\r");case 120:{let r;return({code:r,pos:t}=Ue(e,t,s,i,2,!1,a,n)),o(null===r?null:String.fromCharCode(r))}case 117:{let r;return({code:r,pos:t}=ze(e,t,s,i,a,n)),o(null===r?null:String.fromCodePoint(r))}case 116:return o("\t");case 98:return o("\b");case 118:return o("\v");case 102:return o("\f");case 13:10===e.charCodeAt(t)&&++t;case 10:s=t,++i;case 8232:case 8233:return o("");case 56:case 57:if(r)return o(null);n.strictNumericEscape(t-1,s,i);default:if(h>=48&&h<=55){const a=t-1;let h=e.slice(a,t+2).match(/^[0-7]+/)[0],c=parseInt(h,8);c>255&&(h=h.slice(0,-1),c=parseInt(h,8)),t+=h.length-1;const l=e.charCodeAt(t);if("0"!==h||56===l||57===l){if(r)return o(null);n.strictNumericEscape(a,s,i)}return o(String.fromCharCode(c))}return o(String.fromCharCode(h))}}function Ue(e,t,s,i,r,n,a,o){const h=t;let c;return({n:c,pos:t}=je(e,t,s,i,16,r,n,!1,o,!a)),null===c&&(a?o.invalidEscapeSequence(h,s,i):t=h-1),{code:c,pos:t}}function je(e,t,s,i,r,n,a,o,h,c){const l=t,p=16===r?Oe.hex:Oe.decBinOct,u=16===r?Me.hex:10===r?Me.dec:8===r?Me.oct:Me.bin;let d=!1,f=0;for(let l=0,m=null==n?1/0:n;l<m;++l){const n=e.charCodeAt(t);let l;if(95!==n||"bail"===o){if(l=n>=97?n-97+10:n>=65?n-65+10:De(n)?n-48:1/0,l>=r){if(l<=9&&c)return{n:null,pos:t};if(l<=9&&h.invalidDigit(t,s,i,r))l=0;else{if(!a)break;l=0,d=!0}}++t,f=f*r+l}else{const r=e.charCodeAt(t-1),n=e.charCodeAt(t+1);if(o){if(Number.isNaN(n)||!u(n)||p.has(r)||p.has(n)){if(c)return{n:null,pos:t};h.unexpectedNumericSeparator(t,s,i)}}else{if(c)return{n:null,pos:t};h.numericSeparatorInEscapeSequence(t,s,i)}++t}}return t===l||null!=n&&t-l!==n||d?{n:null,pos:t}:{n:f,pos:t}}function ze(e,t,s,i,r,n){let a;if(123===e.charCodeAt(t)){if(++t,({code:a,pos:t}=Ue(e,t,s,i,e.indexOf("}",t)-t,!0,r,n)),++t,null!==a&&a>1114111){if(!r)return{code:null,pos:t};n.invalidCodePoint(t,s,i)}}else({code:a,pos:t}=Ue(e,t,s,i,4,!1,r,n));return{code:a,pos:t}}function qe(e,t,s){return new i(s,e-t,e)}const He=new Set([103,109,115,105,121,117,100,118]);class Ve{constructor(e){this.type=e.type,this.value=e.value,this.start=e.start,this.end=e.end,this.loc=new r(e.startLoc,e.endLoc)}}class We extends Te{constructor(e,t){super(),this.isLookahead=void 0,this.tokens=[],this.errorHandlers_readInt={invalidDigit:(e,t,s,i)=>!!this.options.errorRecovery&&(this.raise(b.InvalidDigit,qe(e,t,s),{radix:i}),!0),numericSeparatorInEscapeSequence:this.errorBuilder(b.NumericSeparatorInEscapeSequence),unexpectedNumericSeparator:this.errorBuilder(b.UnexpectedNumericSeparator)},this.errorHandlers_readCodePoint=Object.assign({},this.errorHandlers_readInt,{invalidEscapeSequence:this.errorBuilder(b.InvalidEscapeSequence),invalidCodePoint:this.errorBuilder(b.InvalidCodePoint)}),this.errorHandlers_readStringContents_string=Object.assign({},this.errorHandlers_readCodePoint,{strictNumericEscape:(e,t,s)=>{this.recordStrictModeErrors(b.StrictNumericEscape,qe(e,t,s))},unterminated:(e,t,s)=>{throw this.raise(b.UnterminatedString,qe(e-1,t,s))}}),this.errorHandlers_readStringContents_template=Object.assign({},this.errorHandlers_readCodePoint,{strictNumericEscape:this.errorBuilder(b.StrictNumericEscape),unterminated:(e,t,s)=>{throw this.raise(b.UnterminatedTemplate,qe(e,t,s))}}),this.state=new Le,this.state.init(e),this.input=t,this.length=t.length,this.comments=[],this.isLookahead=!1}pushToken(e){this.tokens.length=this.state.tokensLength,this.tokens.push(e),++this.state.tokensLength}next(){this.checkKeywordEscapes(),this.options.tokens&&this.pushToken(new Ve(this.state)),this.state.lastTokEndLoc=this.state.endLoc,this.state.lastTokStartLoc=this.state.startLoc,this.nextToken()}eat(e){return!!this.match(e)&&(this.next(),!0)}match(e){return this.state.type===e}createLookaheadState(e){return{pos:e.pos,value:null,type:e.type,start:e.start,end:e.end,context:[this.curContext()],inType:e.inType,startLoc:e.startLoc,lastTokEndLoc:e.lastTokEndLoc,curLine:e.curLine,lineStart:e.lineStart,curPosition:e.curPosition}}lookahead(){const e=this.state;this.state=this.createLookaheadState(e),this.isLookahead=!0,this.nextToken(),this.isLookahead=!1;const t=this.state;return this.state=e,t}nextTokenStart(){return this.nextTokenStartSince(this.state.pos)}nextTokenStartSince(e){return Ae.lastIndex=e,Ae.test(this.input)?Ae.lastIndex:e}lookaheadCharCode(){return this.input.charCodeAt(this.nextTokenStart())}nextTokenInLineStart(){return this.nextTokenInLineStartSince(this.state.pos)}nextTokenInLineStartSince(e){return Se.lastIndex=e,Se.test(this.input)?Se.lastIndex:e}lookaheadInLineCharCode(){return this.input.charCodeAt(this.nextTokenInLineStart())}codePointAtPos(e){let t=this.input.charCodeAt(e);if(55296==(64512&t)&&++e<this.input.length){const s=this.input.charCodeAt(e);56320==(64512&s)&&(t=65536+((1023&t)<<10)+(1023&s))}return t}setStrict(e){this.state.strict=e,e&&(this.state.strictErrors.forEach((([e,t])=>this.raise(e,t))),this.state.strictErrors.clear())}curContext(){return this.state.context[this.state.context.length-1]}nextToken(){this.skipSpace(),this.state.start=this.state.pos,this.isLookahead||(this.state.startLoc=this.state.curPosition()),this.state.pos>=this.length?this.finishToken(139):this.getTokenFromCode(this.codePointAtPos(this.state.pos))}skipBlockComment(e){let t;this.isLookahead||(t=this.state.curPosition());const s=this.state.pos,i=this.input.indexOf(e,s+2);if(-1===i)throw this.raise(b.UnterminatedComment,this.state.curPosition());for(this.state.pos=i+e.length,Ee.lastIndex=s+2;Ee.test(this.input)&&Ee.lastIndex<=i;)++this.state.curLine,this.state.lineStart=Ee.lastIndex;if(this.isLookahead)return;const n={type:"CommentBlock",value:this.input.slice(s+2,i),start:s,end:i+e.length,loc:new r(t,this.state.curPosition())};return this.options.tokens&&this.pushToken(n),n}skipLineComment(e){const t=this.state.pos;let s;this.isLookahead||(s=this.state.curPosition());let i=this.input.charCodeAt(this.state.pos+=e);if(this.state.pos<this.length)for(;!ke(i)&&++this.state.pos<this.length;)i=this.input.charCodeAt(this.state.pos);if(this.isLookahead)return;const n=this.state.pos,a={type:"CommentLine",value:this.input.slice(t+e,n),start:t,end:n,loc:new r(s,this.state.curPosition())};return this.options.tokens&&this.pushToken(a),a}skipSpace(){const e=this.state.pos,t=[];e:for(;this.state.pos<this.length;){const s=this.input.charCodeAt(this.state.pos);switch(s){case 32:case 160:case 9:++this.state.pos;break;case 13:10===this.input.charCodeAt(this.state.pos+1)&&++this.state.pos;case 10:case 8232:case 8233:++this.state.pos,++this.state.curLine,this.state.lineStart=this.state.pos;break;case 47:switch(this.input.charCodeAt(this.state.pos+1)){case 42:{const e=this.skipBlockComment("*/");void 0!==e&&(this.addComment(e),this.options.attachComment&&t.push(e));break}case 47:{const e=this.skipLineComment(2);void 0!==e&&(this.addComment(e),this.options.attachComment&&t.push(e));break}default:break e}break;default:if(Ne(s))++this.state.pos;else if(45===s&&!this.inModule&&this.options.annexB){const s=this.state.pos;if(45!==this.input.charCodeAt(s+1)||62!==this.input.charCodeAt(s+2)||!(0===e||this.state.lineStart>e))break e;{const e=this.skipLineComment(3);void 0!==e&&(this.addComment(e),this.options.attachComment&&t.push(e))}}else{if(60!==s||this.inModule||!this.options.annexB)break e;{const e=this.state.pos;if(33!==this.input.charCodeAt(e+1)||45!==this.input.charCodeAt(e+2)||45!==this.input.charCodeAt(e+3))break e;{const e=this.skipLineComment(4);void 0!==e&&(this.addComment(e),this.options.attachComment&&t.push(e))}}}}}if(t.length>0){const s={start:e,end:this.state.pos,comments:t,leadingNode:null,trailingNode:null,containingNode:null};this.state.commentStack.push(s)}}finishToken(e,t){this.state.end=this.state.pos,this.state.endLoc=this.state.curPosition();const s=this.state.type;this.state.type=e,this.state.value=t,this.isLookahead||this.updateContext(s)}replaceToken(e){this.state.type=e,this.updateContext()}readToken_numberSign(){if(0===this.state.pos&&this.readToken_interpreter())return;const e=this.state.pos+1,t=this.codePointAtPos(e);if(t>=48&&t<=57)throw this.raise(b.UnexpectedDigitAfterHash,this.state.curPosition());if(123===t||91===t&&this.hasPlugin("recordAndTuple")){if(this.expectPlugin("recordAndTuple"),"bar"===this.getPluginOption("recordAndTuple","syntaxType"))throw this.raise(123===t?b.RecordExpressionHashIncorrectStartSyntaxType:b.TupleExpressionHashIncorrectStartSyntaxType,this.state.curPosition());this.state.pos+=2,123===t?this.finishToken(7):this.finishToken(1)}else ae(t)?(++this.state.pos,this.finishToken(138,this.readWord1(t))):92===t?(++this.state.pos,this.finishToken(138,this.readWord1())):this.finishOp(27,1)}readToken_dot(){const e=this.input.charCodeAt(this.state.pos+1);e>=48&&e<=57?this.readNumber(!0):46===e&&46===this.input.charCodeAt(this.state.pos+2)?(this.state.pos+=3,this.finishToken(21)):(++this.state.pos,this.finishToken(16))}readToken_slash(){61===this.input.charCodeAt(this.state.pos+1)?this.finishOp(31,2):this.finishOp(56,1)}readToken_interpreter(){if(0!==this.state.pos||this.length<2)return!1;let e=this.input.charCodeAt(this.state.pos+1);if(33!==e)return!1;const t=this.state.pos;for(this.state.pos+=1;!ke(e)&&++this.state.pos<this.length;)e=this.input.charCodeAt(this.state.pos);const s=this.input.slice(t+2,this.state.pos);return this.finishToken(28,s),!0}readToken_mult_modulo(e){let t=42===e?55:54,s=1,i=this.input.charCodeAt(this.state.pos+1);42===e&&42===i&&(s++,i=this.input.charCodeAt(this.state.pos+2),t=57),61!==i||this.state.inType||(s++,t=37===e?33:30),this.finishOp(t,s)}readToken_pipe_amp(e){const t=this.input.charCodeAt(this.state.pos+1);if(t!==e){if(124===e){if(62===t)return void this.finishOp(39,2);if(this.hasPlugin("recordAndTuple")&&125===t){if("bar"!==this.getPluginOption("recordAndTuple","syntaxType"))throw this.raise(b.RecordExpressionBarIncorrectEndSyntaxType,this.state.curPosition());return this.state.pos+=2,void this.finishToken(9)}if(this.hasPlugin("recordAndTuple")&&93===t){if("bar"!==this.getPluginOption("recordAndTuple","syntaxType"))throw this.raise(b.TupleExpressionBarIncorrectEndSyntaxType,this.state.curPosition());return this.state.pos+=2,void this.finishToken(4)}}61!==t?this.finishOp(124===e?43:45,1):this.finishOp(30,2)}else 61===this.input.charCodeAt(this.state.pos+2)?this.finishOp(30,3):this.finishOp(124===e?41:42,2)}readToken_caret(){const e=this.input.charCodeAt(this.state.pos+1);61!==e||this.state.inType?94===e&&this.hasPlugin(["pipelineOperator",{proposal:"hack",topicToken:"^^"}])?(this.finishOp(37,2),94===this.input.codePointAt(this.state.pos)&&this.unexpected()):this.finishOp(44,1):this.finishOp(32,2)}readToken_atSign(){64===this.input.charCodeAt(this.state.pos+1)&&this.hasPlugin(["pipelineOperator",{proposal:"hack",topicToken:"@@"}])?this.finishOp(38,2):this.finishOp(26,1)}readToken_plus_min(e){const t=this.input.charCodeAt(this.state.pos+1);t!==e?61===t?this.finishOp(30,2):this.finishOp(53,1):this.finishOp(34,2)}readToken_lt(){const{pos:e}=this.state,t=this.input.charCodeAt(e+1);if(60===t)return 61===this.input.charCodeAt(e+2)?void this.finishOp(30,3):void this.finishOp(51,2);61!==t?this.finishOp(47,1):this.finishOp(49,2)}readToken_gt(){const{pos:e}=this.state,t=this.input.charCodeAt(e+1);if(62===t){const t=62===this.input.charCodeAt(e+2)?3:2;return 61===this.input.charCodeAt(e+t)?void this.finishOp(30,t+1):void this.finishOp(52,t)}61!==t?this.finishOp(48,1):this.finishOp(49,2)}readToken_eq_excl(e){const t=this.input.charCodeAt(this.state.pos+1);if(61!==t)return 61===e&&62===t?(this.state.pos+=2,void this.finishToken(19)):void this.finishOp(61===e?29:35,1);this.finishOp(46,61===this.input.charCodeAt(this.state.pos+2)?3:2)}readToken_question(){const e=this.input.charCodeAt(this.state.pos+1),t=this.input.charCodeAt(this.state.pos+2);63===e?61===t?this.finishOp(30,3):this.finishOp(40,2):46!==e||t>=48&&t<=57?(++this.state.pos,this.finishToken(17)):(this.state.pos+=2,this.finishToken(18))}getTokenFromCode(e){switch(e){case 46:return void this.readToken_dot();case 40:return++this.state.pos,void this.finishToken(10);case 41:return++this.state.pos,void this.finishToken(11);case 59:return++this.state.pos,void this.finishToken(13);case 44:return++this.state.pos,void this.finishToken(12);case 91:if(this.hasPlugin("recordAndTuple")&&124===this.input.charCodeAt(this.state.pos+1)){if("bar"!==this.getPluginOption("recordAndTuple","syntaxType"))throw this.raise(b.TupleExpressionBarIncorrectStartSyntaxType,this.state.curPosition());this.state.pos+=2,this.finishToken(2)}else++this.state.pos,this.finishToken(0);return;case 93:return++this.state.pos,void this.finishToken(3);case 123:if(this.hasPlugin("recordAndTuple")&&124===this.input.charCodeAt(this.state.pos+1)){if("bar"!==this.getPluginOption("recordAndTuple","syntaxType"))throw this.raise(b.RecordExpressionBarIncorrectStartSyntaxType,this.state.curPosition());this.state.pos+=2,this.finishToken(6)}else++this.state.pos,this.finishToken(5);return;case 125:return++this.state.pos,void this.finishToken(8);case 58:return void(this.hasPlugin("functionBind")&&58===this.input.charCodeAt(this.state.pos+1)?this.finishOp(15,2):(++this.state.pos,this.finishToken(14)));case 63:return void this.readToken_question();case 96:return void this.readTemplateToken();case 48:{const e=this.input.charCodeAt(this.state.pos+1);if(120===e||88===e)return void this.readRadixNumber(16);if(111===e||79===e)return void this.readRadixNumber(8);if(98===e||66===e)return void this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return void this.readNumber(!1);case 34:case 39:return void this.readString(e);case 47:return void this.readToken_slash();case 37:case 42:return void this.readToken_mult_modulo(e);case 124:case 38:return void this.readToken_pipe_amp(e);case 94:return void this.readToken_caret();case 43:case 45:return void this.readToken_plus_min(e);case 60:return void this.readToken_lt();case 62:return void this.readToken_gt();case 61:case 33:return void this.readToken_eq_excl(e);case 126:return void this.finishOp(36,1);case 64:return void this.readToken_atSign();case 35:return void this.readToken_numberSign();case 92:return void this.readWord();default:if(ae(e))return void this.readWord(e)}throw this.raise(b.InvalidOrUnexpectedToken,this.state.curPosition(),{unexpected:String.fromCodePoint(e)})}finishOp(e,t){const s=this.input.slice(this.state.pos,this.state.pos+t);this.state.pos+=t,this.finishToken(e,s)}readRegexp(){const e=this.state.startLoc,t=this.state.start+1;let s,i,{pos:r}=this.state;for(;;++r){if(r>=this.length)throw this.raise(b.UnterminatedRegExp,n(e,1));const t=this.input.charCodeAt(r);if(ke(t))throw this.raise(b.UnterminatedRegExp,n(e,1));if(s)s=!1;else{if(91===t)i=!0;else if(93===t&&i)i=!1;else if(47===t&&!i)break;s=92===t}}const a=this.input.slice(t,r);++r;let o="";const h=()=>n(e,r+2-t);for(;r<this.length;){const e=this.codePointAtPos(r),t=String.fromCharCode(e);if(He.has(e))118===e?o.includes("u")&&this.raise(b.IncompatibleRegExpUVFlags,h()):117===e&&o.includes("v")&&this.raise(b.IncompatibleRegExpUVFlags,h()),o.includes(t)&&this.raise(b.DuplicateRegExpFlags,h());else{if(!oe(e)&&92!==e)break;this.raise(b.MalformedRegExpFlags,h())}++r,o+=t}this.state.pos=r,this.finishToken(137,{pattern:a,flags:o})}readInt(e,t,s=!1,i=!0){const{n:r,pos:n}=je(this.input,this.state.pos,this.state.lineStart,this.state.curLine,e,t,s,i,this.errorHandlers_readInt,!1);return this.state.pos=n,r}readRadixNumber(e){const t=this.state.curPosition();let s=!1;this.state.pos+=2;const i=this.readInt(e);null==i&&this.raise(b.InvalidDigit,n(t,2),{radix:e});const r=this.input.charCodeAt(this.state.pos);if(110===r)++this.state.pos,s=!0;else if(109===r)throw this.raise(b.InvalidDecimal,t);if(ae(this.codePointAtPos(this.state.pos)))throw this.raise(b.NumberIdentifier,this.state.curPosition());if(s){const e=this.input.slice(t.index,this.state.pos).replace(/[_n]/g,"");this.finishToken(135,e)}else this.finishToken(134,i)}readNumber(e){const t=this.state.pos,s=this.state.curPosition();let i=!1,r=!1,a=!1,o=!1,h=!1;e||null!==this.readInt(10)||this.raise(b.InvalidNumber,this.state.curPosition());const c=this.state.pos-t>=2&&48===this.input.charCodeAt(t);if(c){const e=this.input.slice(t,this.state.pos);if(this.recordStrictModeErrors(b.StrictOctalLiteral,s),!this.state.strict){const t=e.indexOf("_");t>0&&this.raise(b.ZeroDigitNumericSeparator,n(s,t))}h=c&&!/[89]/.test(e)}let l=this.input.charCodeAt(this.state.pos);if(46!==l||h||(++this.state.pos,this.readInt(10),i=!0,l=this.input.charCodeAt(this.state.pos)),69!==l&&101!==l||h||(l=this.input.charCodeAt(++this.state.pos),43!==l&&45!==l||++this.state.pos,null===this.readInt(10)&&this.raise(b.InvalidOrMissingExponent,s),i=!0,o=!0,l=this.input.charCodeAt(this.state.pos)),110===l&&((i||c)&&this.raise(b.InvalidBigIntLiteral,s),++this.state.pos,r=!0),109===l&&(this.expectPlugin("decimal",this.state.curPosition()),(o||c)&&this.raise(b.InvalidDecimal,s),++this.state.pos,a=!0),ae(this.codePointAtPos(this.state.pos)))throw this.raise(b.NumberIdentifier,this.state.curPosition());const p=this.input.slice(t,this.state.pos).replace(/[_mn]/g,"");if(r)return void this.finishToken(135,p);if(a)return void this.finishToken(136,p);const u=h?parseInt(p,8):parseFloat(p);this.finishToken(134,u)}readCodePoint(e){const{code:t,pos:s}=ze(this.input,this.state.pos,this.state.lineStart,this.state.curLine,e,this.errorHandlers_readCodePoint);return this.state.pos=s,t}readString(e){const{str:t,pos:s,curLine:i,lineStart:r}=Re(34===e?"double":"single",this.input,this.state.pos+1,this.state.lineStart,this.state.curLine,this.errorHandlers_readStringContents_string);this.state.pos=s+1,this.state.lineStart=r,this.state.curLine=i,this.finishToken(133,t)}readTemplateContinuation(){this.match(8)||this.unexpected(null,8),this.state.pos--,this.readTemplateToken()}readTemplateToken(){const e=this.input[this.state.pos],{str:t,firstInvalidLoc:s,pos:r,curLine:n,lineStart:a}=Re("template",this.input,this.state.pos+1,this.state.lineStart,this.state.curLine,this.errorHandlers_readStringContents_template);this.state.pos=r+1,this.state.lineStart=a,this.state.curLine=n,s&&(this.state.firstInvalidTemplateEscapePos=new i(s.curLine,s.pos-s.lineStart,s.pos)),96===this.input.codePointAt(r)?this.finishToken(24,s?null:e+t+"`"):(this.state.pos++,this.finishToken(25,s?null:e+t+"${"))}recordStrictModeErrors(e,t){const s=t.index;this.state.strict&&!this.state.strictErrors.has(s)?this.raise(e,t):this.state.strictErrors.set(s,[e,t])}readWord1(e){this.state.containsEsc=!1;let t="";const s=this.state.pos;let i=this.state.pos;for(void 0!==e&&(this.state.pos+=e<=65535?1:2);this.state.pos<this.length;){const e=this.codePointAtPos(this.state.pos);if(oe(e))this.state.pos+=e<=65535?1:2;else{if(92!==e)break;{this.state.containsEsc=!0,t+=this.input.slice(i,this.state.pos);const e=this.state.curPosition(),r=this.state.pos===s?ae:oe;if(117!==this.input.charCodeAt(++this.state.pos)){this.raise(b.MissingUnicodeEscape,this.state.curPosition()),i=this.state.pos-1;continue}++this.state.pos;const n=this.readCodePoint(!0);null!==n&&(r(n)||this.raise(b.EscapedCharNotAnIdentifier,e),t+=String.fromCodePoint(n)),i=this.state.pos}}}return t+this.input.slice(i,this.state.pos)}readWord(e){const t=this.readWord1(e),s=I.get(t);void 0!==s?this.finishToken(s,Y(s)):this.finishToken(132,t)}checkKeywordEscapes(){const{type:e}=this.state;G(e)&&this.state.containsEsc&&this.raise(b.InvalidEscapedReservedWord,this.state.startLoc,{reservedWord:Y(e)})}raise(e,t,s={}){const r=e(t instanceof i?t:t.loc.start,s);if(!this.options.errorRecovery)throw r;return this.isLookahead||this.state.errors.push(r),r}raiseOverwrite(e,t,s={}){const r=t instanceof i?t:t.loc.start,n=r.index,a=this.state.errors;for(let t=a.length-1;t>=0;t--){const i=a[t];if(i.loc.index===n)return a[t]=e(r,s);if(i.loc.index<n)break}return this.raise(e,t,s)}updateContext(e){}unexpected(e,t){throw this.raise(b.UnexpectedToken,null!=e?e:this.state.startLoc,{expected:t?Y(t):null})}expectPlugin(e,t){if(this.hasPlugin(e))return!0;throw this.raise(b.MissingPlugin,null!=t?t:this.state.startLoc,{missingPlugin:[e]})}expectOnePlugin(e){if(!e.some((e=>this.hasPlugin(e))))throw this.raise(b.MissingOneOfPlugins,this.state.startLoc,{missingPlugin:e})}errorBuilder(e){return(t,s,i)=>{this.raise(e,qe(t,s,i))}}}class $e{constructor(){this.privateNames=new Set,this.loneAccessors=new Map,this.undefinedPrivateNames=new Map}}class Ke{constructor(e){this.parser=void 0,this.stack=[],this.undefinedPrivateNames=new Map,this.parser=e}current(){return this.stack[this.stack.length-1]}enter(){this.stack.push(new $e)}exit(){const e=this.stack.pop(),t=this.current();for(const[s,i]of Array.from(e.undefinedPrivateNames))t?t.undefinedPrivateNames.has(s)||t.undefinedPrivateNames.set(s,i):this.parser.raise(b.InvalidPrivateFieldResolution,i,{identifierName:s})}declarePrivateName(e,t,s){const{privateNames:i,loneAccessors:r,undefinedPrivateNames:n}=this.current();let a=i.has(e);if(3&t){const s=a&&r.get(e);s?(a=(3&s)==(3&t)||(4&s)!=(4&t),a||r.delete(e)):a||r.set(e,t)}a&&this.parser.raise(b.PrivateNameRedeclaration,s,{identifierName:e}),i.add(e),n.delete(e)}usePrivateName(e,t){let s;for(s of this.stack)if(s.privateNames.has(e))return;s?s.undefinedPrivateNames.set(e,t):this.parser.raise(b.InvalidPrivateFieldResolution,t,{identifierName:e})}}class Ge{constructor(e=0){this.type=e}canBeArrowParameterDeclaration(){return 2===this.type||1===this.type}isCertainlyParameterDeclaration(){return 3===this.type}}class Ye extends Ge{constructor(e){super(e),this.declarationErrors=new Map}recordDeclarationError(e,t){const s=t.index;this.declarationErrors.set(s,[e,t])}clearDeclarationError(e){this.declarationErrors.delete(e)}iterateErrors(e){this.declarationErrors.forEach(e)}}class Je{constructor(e){this.parser=void 0,this.stack=[new Ge],this.parser=e}enter(e){this.stack.push(e)}exit(){this.stack.pop()}recordParameterInitializerError(e,t){const s=t.loc.start,{stack:i}=this;let r=i.length-1,n=i[r];for(;!n.isCertainlyParameterDeclaration();){if(!n.canBeArrowParameterDeclaration())return;n.recordDeclarationError(e,s),n=i[--r]}this.parser.raise(e,s)}recordArrowParameterBindingError(e,t){const{stack:s}=this,i=s[s.length-1],r=t.loc.start;if(i.isCertainlyParameterDeclaration())this.parser.raise(e,r);else{if(!i.canBeArrowParameterDeclaration())return;i.recordDeclarationError(e,r)}}recordAsyncArrowParametersError(e){const{stack:t}=this;let s=t.length-1,i=t[s];for(;i.canBeArrowParameterDeclaration();)2===i.type&&i.recordDeclarationError(b.AwaitBindingIdentifier,e),i=t[--s]}validateAsPattern(){const{stack:e}=this,t=e[e.length-1];t.canBeArrowParameterDeclaration()&&t.iterateErrors((([t,s])=>{this.parser.raise(t,s);let i=e.length-2,r=e[i];for(;r.canBeArrowParameterDeclaration();)r.clearDeclarationError(s.index),r=e[--i]}))}}function Ze(){return new Ge}class Xe{constructor(){this.stacks=[]}enter(e){this.stacks.push(e)}exit(){this.stacks.pop()}currentFlags(){return this.stacks[this.stacks.length-1]}get hasAwait(){return(2&this.currentFlags())>0}get hasYield(){return(1&this.currentFlags())>0}get hasReturn(){return(4&this.currentFlags())>0}get hasIn(){return(8&this.currentFlags())>0}}function Qe(e,t){return(e?2:0)|(t?1:0)}class et extends We{addExtra(e,t,s,i=!0){if(!e)return;const r=e.extra=e.extra||{};i?r[t]=s:Object.defineProperty(r,t,{enumerable:i,value:s})}isContextual(e){return this.state.type===e&&!this.state.containsEsc}isUnparsedContextual(e,t){const s=e+t.length;if(this.input.slice(e,s)===t){const e=this.input.charCodeAt(s);return!(oe(e)||55296==(64512&e))}return!1}isLookaheadContextual(e){const t=this.nextTokenStart();return this.isUnparsedContextual(t,e)}eatContextual(e){return!!this.isContextual(e)&&(this.next(),!0)}expectContextual(e,t){if(!this.eatContextual(e)){if(null!=t)throw this.raise(t,this.state.startLoc);this.unexpected(null,e)}}canInsertSemicolon(){return this.match(139)||this.match(8)||this.hasPrecedingLineBreak()}hasPrecedingLineBreak(){return Ce.test(this.input.slice(this.state.lastTokEndLoc.index,this.state.start))}hasFollowingLineBreak(){return Ie.lastIndex=this.state.end,Ie.test(this.input)}isLineTerminator(){return this.eat(13)||this.canInsertSemicolon()}semicolon(e=!0){(e?this.isLineTerminator():this.eat(13))||this.raise(b.MissingSemicolon,this.state.lastTokEndLoc)}expect(e,t){this.eat(e)||this.unexpected(t,e)}tryParse(e,t=this.state.clone()){const s={node:null};try{const i=e(((e=null)=>{throw s.node=e,s}));if(this.state.errors.length>t.errors.length){const e=this.state;return this.state=t,this.state.tokensLength=e.tokensLength,{node:i,error:e.errors[t.errors.length],thrown:!1,aborted:!1,failState:e}}return{node:i,error:null,thrown:!1,aborted:!1,failState:null}}catch(e){const i=this.state;if(this.state=t,e instanceof SyntaxError)return{node:null,error:e,thrown:!0,aborted:!1,failState:i};if(e===s)return{node:s.node,error:null,thrown:!1,aborted:!0,failState:i};throw e}}checkExpressionErrors(e,t){if(!e)return!1;const{shorthandAssignLoc:s,doubleProtoLoc:i,privateKeyLoc:r,optionalParametersLoc:n}=e;if(!t)return!!(s||i||n||r);null!=s&&this.raise(b.InvalidCoverInitializedName,s),null!=i&&this.raise(b.DuplicateProto,i),null!=r&&this.raise(b.UnexpectedPrivateField,r),null!=n&&this.unexpected(n)}isLiteralPropertyName(){return W(this.state.type)}isPrivateName(e){return"PrivateName"===e.type}getPrivateNameSV(e){return e.id.name}hasPropertyAsPrivateName(e){return("MemberExpression"===e.type||"OptionalMemberExpression"===e.type)&&this.isPrivateName(e.property)}isObjectProperty(e){return"ObjectProperty"===e.type}isObjectMethod(e){return"ObjectMethod"===e.type}initializeScopes(e="module"===this.options.sourceType){const t=this.state.labels;this.state.labels=[];const s=this.exportedIdentifiers;this.exportedIdentifiers=new Set;const i=this.inModule;this.inModule=e;const r=this.scope,n=this.getScopeHandler();this.scope=new n(this,e);const a=this.prodParam;this.prodParam=new Xe;const o=this.classScope;this.classScope=new Ke(this);const h=this.expressionScope;return this.expressionScope=new Je(this),()=>{this.state.labels=t,this.exportedIdentifiers=s,this.inModule=i,this.scope=r,this.prodParam=a,this.classScope=o,this.expressionScope=h}}enterInitialScopes(){let e=0;this.inModule&&(e|=2),this.scope.enter(1),this.prodParam.enter(e)}checkDestructuringPrivate(e){const{privateKeyLoc:t}=e;null!==t&&this.expectPlugin("destructuringPrivate",t)}}class tt{constructor(){this.shorthandAssignLoc=null,this.doubleProtoLoc=null,this.privateKeyLoc=null,this.optionalParametersLoc=null}}class st{constructor(e,t,s){this.type="",this.start=t,this.end=0,this.loc=new r(s),null!=e&&e.options.ranges&&(this.range=[t,0]),null!=e&&e.filename&&(this.loc.filename=e.filename)}}const it=st.prototype;function rt(e){const{type:t,start:s,end:i,loc:r,range:n,extra:a,name:o}=e,h=Object.create(it);return h.type=t,h.start=s,h.end=i,h.loc=r,h.range=n,h.extra=a,h.name=o,"Placeholder"===t&&(h.expectedNode=e.expectedNode),h}it.__clone=function(){const e=new st(void 0,this.start,this.loc.start),t=Object.keys(this);for(let s=0,i=t.length;s<i;s++){const i=t[s];"leadingComments"!==i&&"trailingComments"!==i&&"innerComments"!==i&&(e[i]=this[i])}return e};class nt extends et{startNode(){const e=this.state.startLoc;return new st(this,e.index,e)}startNodeAt(e){return new st(this,e.index,e)}startNodeAtNode(e){return this.startNodeAt(e.loc.start)}finishNode(e,t){return this.finishNodeAt(e,t,this.state.lastTokEndLoc)}finishNodeAt(e,t,s){return e.type=t,e.end=s.index,e.loc.end=s,this.options.ranges&&(e.range[1]=s.index),this.options.attachComment&&this.processComment(e),e}resetStartLocation(e,t){e.start=t.index,e.loc.start=t,this.options.ranges&&(e.range[0]=t.index)}resetEndLocation(e,t=this.state.lastTokEndLoc){e.end=t.index,e.loc.end=t,this.options.ranges&&(e.range[1]=t.index)}resetStartLocationFromNode(e,t){this.resetStartLocation(e,t.loc.start)}}const at=new Set(["_","any","bool","boolean","empty","extends","false","interface","mixed","null","number","static","string","true","typeof","void"]),ot=g`flow`({AmbiguousConditionalArrow:"Ambiguous expression: wrap the arrow functions in parentheses to disambiguate.",AmbiguousDeclareModuleKind:"Found both `declare module.exports` and `declare export` in the same module. Modules can only have 1 since they are either an ES module or they are a CommonJS module.",AssignReservedType:({reservedType:e})=>`Cannot overwrite reserved type ${e}.`,DeclareClassElement:"The `declare` modifier can only appear on class fields.",DeclareClassFieldInitializer:"Initializers are not allowed in fields with the `declare` modifier.",DuplicateDeclareModuleExports:"Duplicate `declare module.exports` statement.",EnumBooleanMemberNotInitialized:({memberName:e,enumName:t})=>`Boolean enum members need to be initialized. Use either \`${e} = true,\` or \`${e} = false,\` in enum \`${t}\`.`,EnumDuplicateMemberName:({memberName:e,enumName:t})=>`Enum member names need to be unique, but the name \`${e}\` has already been used before in enum \`${t}\`.`,EnumInconsistentMemberValues:({enumName:e})=>`Enum \`${e}\` has inconsistent member initializers. Either use no initializers, or consistently use literals (either booleans, numbers, or strings) for all member initializers.`,EnumInvalidExplicitType:({invalidEnumType:e,enumName:t})=>`Enum type \`${e}\` is not valid. Use one of \`boolean\`, \`number\`, \`string\`, or \`symbol\` in enum \`${t}\`.`,EnumInvalidExplicitTypeUnknownSupplied:({enumName:e})=>`Supplied enum type is not valid. Use one of \`boolean\`, \`number\`, \`string\`, or \`symbol\` in enum \`${e}\`.`,EnumInvalidMemberInitializerPrimaryType:({enumName:e,memberName:t,explicitType:s})=>`Enum \`${e}\` has type \`${s}\`, so the initializer of \`${t}\` needs to be a ${s} literal.`,EnumInvalidMemberInitializerSymbolType:({enumName:e,memberName:t})=>`Symbol enum members cannot be initialized. Use \`${t},\` in enum \`${e}\`.`,EnumInvalidMemberInitializerUnknownType:({enumName:e,memberName:t})=>`The enum member initializer for \`${t}\` needs to be a literal (either a boolean, number, or string) in enum \`${e}\`.`,EnumInvalidMemberName:({enumName:e,memberName:t,suggestion:s})=>`Enum member names cannot start with lowercase 'a' through 'z'. Instead of using \`${t}\`, consider using \`${s}\`, in enum \`${e}\`.`,EnumNumberMemberNotInitialized:({enumName:e,memberName:t})=>`Number enum members need to be initialized, e.g. \`${t} = 1\` in enum \`${e}\`.`,EnumStringMemberInconsistentlyInitialized:({enumName:e})=>`String enum members need to consistently either all use initializers, or use no initializers, in enum \`${e}\`.`,GetterMayNotHaveThisParam:"A getter cannot have a `this` parameter.",ImportReflectionHasImportType:"An `import module` declaration can not use `type` or `typeof` keyword.",ImportTypeShorthandOnlyInPureImport:"The `type` and `typeof` keywords on named imports can only be used on regular `import` statements. It cannot be used with `import type` or `import typeof` statements.",InexactInsideExact:"Explicit inexact syntax cannot appear inside an explicit exact object type.",InexactInsideNonObject:"Explicit inexact syntax cannot appear in class or interface definitions.",InexactVariance:"Explicit inexact syntax cannot have variance.",InvalidNonTypeImportInDeclareModule:"Imports within a `declare module` body must always be `import type` or `import typeof`.",MissingTypeParamDefault:"Type parameter declaration needs a default, since a preceding type parameter declaration has a default.",NestedDeclareModule:"`declare module` cannot be used inside another `declare module`.",NestedFlowComment:"Cannot have a flow comment inside another flow comment.",PatternIsOptional:Object.assign({message:"A binding pattern parameter cannot be optional in an implementation signature."},{reasonCode:"OptionalBindingPattern"}),SetterMayNotHaveThisParam:"A setter cannot have a `this` parameter.",SpreadVariance:"Spread properties cannot have variance.",ThisParamAnnotationRequired:"A type annotation is required for the `this` parameter.",ThisParamBannedInConstructor:"Constructors cannot have a `this` parameter; constructors don't bind `this` like other functions.",ThisParamMayNotBeOptional:"The `this` parameter cannot be optional.",ThisParamMustBeFirst:"The `this` parameter must be the first function parameter.",ThisParamNoDefault:"The `this` parameter may not have a default value.",TypeBeforeInitializer:"Type annotations must come before default assignments, e.g. instead of `age = 25: number` use `age: number = 25`.",TypeCastInPattern:"The type cast expression is expected to be wrapped with parenthesis.",UnexpectedExplicitInexactInObject:"Explicit inexact syntax must appear at the end of an inexact object.",UnexpectedReservedType:({reservedType:e})=>`Unexpected reserved type ${e}.`,UnexpectedReservedUnderscore:"`_` is only allowed as a type argument to call or new.",UnexpectedSpaceBetweenModuloChecks:"Spaces between `%` and `checks` are not allowed here.",UnexpectedSpreadType:"Spread operator cannot appear in class or interface definitions.",UnexpectedSubtractionOperand:'Unexpected token, expected "number" or "bigint".',UnexpectedTokenAfterTypeParameter:"Expected an arrow function after this type parameter declaration.",UnexpectedTypeParameterBeforeAsyncArrowFunction:"Type parameters must come after the async keyword, e.g. instead of `<T> async () => {}`, use `async <T>() => {}`.",UnsupportedDeclareExportKind:({unsupportedExportKind:e,suggestion:t})=>`\`declare export ${e}\` is not supported. Use \`${t}\` instead.`,UnsupportedStatementInDeclareModule:"Only declares and type imports are allowed inside declare module.",UnterminatedFlowComment:"Unterminated flow-comment."});function ht(e){return"type"===e.importKind||"typeof"===e.importKind}const ct={const:"declare export var",let:"declare export var",type:"export type",interface:"export interface"},lt=/\*?\s*@((?:no)?flow)\b/,pt={__proto__:null,quot:'"',amp:"&",apos:"'",lt:"<",gt:">",nbsp:" ",iexcl:"¡",cent:"¢",pound:"£",curren:"¤",yen:"¥",brvbar:"¦",sect:"§",uml:"¨",copy:"©",ordf:"ª",laquo:"«",not:"¬",shy:"­",reg:"®",macr:"¯",deg:"°",plusmn:"±",sup2:"²",sup3:"³",acute:"´",micro:"µ",para:"¶",middot:"·",cedil:"¸",sup1:"¹",ordm:"º",raquo:"»",frac14:"¼",frac12:"½",frac34:"¾",iquest:"¿",Agrave:"À",Aacute:"Á",Acirc:"Â",Atilde:"Ã",Auml:"Ä",Aring:"Å",AElig:"Æ",Ccedil:"Ç",Egrave:"È",Eacute:"É",Ecirc:"Ê",Euml:"Ë",Igrave:"Ì",Iacute:"Í",Icirc:"Î",Iuml:"Ï",ETH:"Ð",Ntilde:"Ñ",Ograve:"Ò",Oacute:"Ó",Ocirc:"Ô",Otilde:"Õ",Ouml:"Ö",times:"×",Oslash:"Ø",Ugrave:"Ù",Uacute:"Ú",Ucirc:"Û",Uuml:"Ü",Yacute:"Ý",THORN:"Þ",szlig:"ß",agrave:"à",aacute:"á",acirc:"â",atilde:"ã",auml:"ä",aring:"å",aelig:"æ",ccedil:"ç",egrave:"è",eacute:"é",ecirc:"ê",euml:"ë",igrave:"ì",iacute:"í",icirc:"î",iuml:"ï",eth:"ð",ntilde:"ñ",ograve:"ò",oacute:"ó",ocirc:"ô",otilde:"õ",ouml:"ö",divide:"÷",oslash:"ø",ugrave:"ù",uacute:"ú",ucirc:"û",uuml:"ü",yacute:"ý",thorn:"þ",yuml:"ÿ",OElig:"Œ",oelig:"œ",Scaron:"Š",scaron:"š",Yuml:"Ÿ",fnof:"ƒ",circ:"ˆ",tilde:"˜",Alpha:"Α",Beta:"Β",Gamma:"Γ",Delta:"Δ",Epsilon:"Ε",Zeta:"Ζ",Eta:"Η",Theta:"Θ",Iota:"Ι",Kappa:"Κ",Lambda:"Λ",Mu:"Μ",Nu:"Ν",Xi:"Ξ",Omicron:"Ο",Pi:"Π",Rho:"Ρ",Sigma:"Σ",Tau:"Τ",Upsilon:"Υ",Phi:"Φ",Chi:"Χ",Psi:"Ψ",Omega:"Ω",alpha:"α",beta:"β",gamma:"γ",delta:"δ",epsilon:"ε",zeta:"ζ",eta:"η",theta:"θ",iota:"ι",kappa:"κ",lambda:"λ",mu:"μ",nu:"ν",xi:"ξ",omicron:"ο",pi:"π",rho:"ρ",sigmaf:"ς",sigma:"σ",tau:"τ",upsilon:"υ",phi:"φ",chi:"χ",psi:"ψ",omega:"ω",thetasym:"ϑ",upsih:"ϒ",piv:"ϖ",ensp:" ",emsp:" ",thinsp:" ",zwnj:"‌",zwj:"‍",lrm:"‎",rlm:"‏",ndash:"–",mdash:"—",lsquo:"‘",rsquo:"’",sbquo:"‚",ldquo:"“",rdquo:"”",bdquo:"„",dagger:"†",Dagger:"‡",bull:"•",hellip:"…",permil:"‰",prime:"′",Prime:"″",lsaquo:"‹",rsaquo:"›",oline:"‾",frasl:"⁄",euro:"€",image:"ℑ",weierp:"℘",real:"ℜ",trade:"™",alefsym:"ℵ",larr:"←",uarr:"↑",rarr:"→",darr:"↓",harr:"↔",crarr:"↵",lArr:"⇐",uArr:"⇑",rArr:"⇒",dArr:"⇓",hArr:"⇔",forall:"∀",part:"∂",exist:"∃",empty:"∅",nabla:"∇",isin:"∈",notin:"∉",ni:"∋",prod:"∏",sum:"∑",minus:"−",lowast:"∗",radic:"√",prop:"∝",infin:"∞",ang:"∠",and:"∧",or:"∨",cap:"∩",cup:"∪",int:"∫",there4:"∴",sim:"∼",cong:"≅",asymp:"≈",ne:"≠",equiv:"≡",le:"≤",ge:"≥",sub:"⊂",sup:"⊃",nsub:"⊄",sube:"⊆",supe:"⊇",oplus:"⊕",otimes:"⊗",perp:"⊥",sdot:"⋅",lceil:"⌈",rceil:"⌉",lfloor:"⌊",rfloor:"⌋",lang:"〈",rang:"〉",loz:"◊",spades:"♠",clubs:"♣",hearts:"♥",diams:"♦"},ut=g`jsx`({AttributeIsEmpty:"JSX attributes must only be assigned a non-empty expression.",MissingClosingTagElement:({openingTagName:e})=>`Expected corresponding JSX closing tag for <${e}>.`,MissingClosingTagFragment:"Expected corresponding JSX closing tag for <>.",UnexpectedSequenceExpression:"Sequence expressions cannot be directly nested inside JSX. Did you mean to wrap it in parentheses (...)?",UnexpectedToken:({unexpected:e,HTMLEntity:t})=>`Unexpected token \`${e}\`. Did you mean \`${t}\` or \`{'${e}'}\`?`,UnsupportedJsxValue:"JSX value should be either an expression or a quoted JSX text.",UnterminatedJsxContent:"Unterminated JSX contents.",UnwrappedAdjacentJSXElements:"Adjacent JSX elements must be wrapped in an enclosing tag. Did you want a JSX fragment <>...</>?"});function dt(e){return!!e&&("JSXOpeningFragment"===e.type||"JSXClosingFragment"===e.type)}function ft(e){if("JSXIdentifier"===e.type)return e.name;if("JSXNamespacedName"===e.type)return e.namespace.name+":"+e.name.name;if("JSXMemberExpression"===e.type)return ft(e.object)+"."+ft(e.property);throw new Error("Node had unexpected type: "+e.type)}class mt extends ye{constructor(...e){super(...e),this.tsNames=new Map}}class yt extends ge{constructor(...e){super(...e),this.importsStack=[]}createScope(e){return this.importsStack.push(new Set),new mt(e)}enter(e){256==e&&this.importsStack.push(new Set),super.enter(e)}exit(){const e=super.exit();return 256==e&&this.importsStack.pop(),e}hasImport(e,t){const s=this.importsStack.length;if(this.importsStack[s-1].has(e))return!0;if(!t&&s>1)for(let t=0;t<s-1;t++)if(this.importsStack[t].has(e))return!0;return!1}declareName(e,t,s){if(4096&t)return this.hasImport(e,!0)&&this.parser.raise(b.VarRedeclaration,s,{identifierName:e}),void this.importsStack[this.importsStack.length-1].add(e);const i=this.currentScope();let r=i.tsNames.get(e)||0;if(1024&t)return this.maybeExportDefined(i,e),void i.tsNames.set(e,16|r);super.declareName(e,t,s),2&t&&(1&t||(this.checkRedeclarationInScope(i,e,t,s),this.maybeExportDefined(i,e)),r|=1),256&t&&(r|=2),512&t&&(r|=4),128&t&&(r|=8),r&&i.tsNames.set(e,r)}isRedeclaredInScope(e,t,s){const i=e.tsNames.get(t);return(2&i)>0?!(256&s)||!!(512&s)!=(4&i)>0:128&s&&(8&i)>0?!!(2&e.names.get(t))&&!!(1&s):!!(2&s&&(1&i)>0)||super.isRedeclaredInScope(e,t,s)}checkLocalExport(e){const{name:t}=e;if(!this.hasImport(t)){for(let e=this.scopeStack.length-1;e>=0;e--){const s=this.scopeStack[e].tsNames.get(t);if((1&s)>0||(16&s)>0)return}super.checkLocalExport(e)}}}const gt=e=>"ParenthesizedExpression"===e.type?gt(e.expression):e;class bt extends nt{toAssignable(e,t=!1){var s,i;let r;switch(("ParenthesizedExpression"===e.type||null!=(s=e.extra)&&s.parenthesized)&&(r=gt(e),t?"Identifier"===r.type?this.expressionScope.recordArrowParameterBindingError(b.InvalidParenthesizedAssignment,e):"MemberExpression"===r.type||this.isOptionalMemberExpression(r)||this.raise(b.InvalidParenthesizedAssignment,e):this.raise(b.InvalidParenthesizedAssignment,e)),e.type){case"Identifier":case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":break;case"ObjectExpression":e.type="ObjectPattern";for(let s=0,i=e.properties.length,r=i-1;s<i;s++){var n;const i=e.properties[s],a=s===r;this.toAssignableObjectExpressionProp(i,a,t),a&&"RestElement"===i.type&&null!=(n=e.extra)&&n.trailingCommaLoc&&this.raise(b.RestTrailingComma,e.extra.trailingCommaLoc)}break;case"ObjectProperty":{const{key:s,value:i}=e;this.isPrivateName(s)&&this.classScope.usePrivateName(this.getPrivateNameSV(s),s.loc.start),this.toAssignable(i,t);break}case"SpreadElement":throw new Error("Internal @babel/parser error (this is a bug, please report it). SpreadElement should be converted by .toAssignable's caller.");case"ArrayExpression":e.type="ArrayPattern",this.toAssignableList(e.elements,null==(i=e.extra)?void 0:i.trailingCommaLoc,t);break;case"AssignmentExpression":"="!==e.operator&&this.raise(b.MissingEqInAssignment,e.left.loc.end),e.type="AssignmentPattern",delete e.operator,this.toAssignable(e.left,t);break;case"ParenthesizedExpression":this.toAssignable(r,t)}}toAssignableObjectExpressionProp(e,t,s){if("ObjectMethod"===e.type)this.raise("get"===e.kind||"set"===e.kind?b.PatternHasAccessor:b.PatternHasMethod,e.key);else if("SpreadElement"===e.type){e.type="RestElement";const i=e.argument;this.checkToRestConversion(i,!1),this.toAssignable(i,s),t||this.raise(b.RestTrailingComma,e)}else this.toAssignable(e,s)}toAssignableList(e,t,s){const i=e.length-1;for(let r=0;r<=i;r++){const n=e[r];if(n){if("SpreadElement"===n.type){n.type="RestElement";const e=n.argument;this.checkToRestConversion(e,!0),this.toAssignable(e,s)}else this.toAssignable(n,s);"RestElement"===n.type&&(r<i?this.raise(b.RestTrailingComma,n):t&&this.raise(b.RestTrailingComma,t))}}}isAssignable(e,t){switch(e.type){case"Identifier":case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":return!0;case"ObjectExpression":{const t=e.properties.length-1;return e.properties.every(((e,s)=>"ObjectMethod"!==e.type&&(s===t||"SpreadElement"!==e.type)&&this.isAssignable(e)))}case"ObjectProperty":return this.isAssignable(e.value);case"SpreadElement":return this.isAssignable(e.argument);case"ArrayExpression":return e.elements.every((e=>null===e||this.isAssignable(e)));case"AssignmentExpression":return"="===e.operator;case"ParenthesizedExpression":return this.isAssignable(e.expression);case"MemberExpression":case"OptionalMemberExpression":return!t;default:return!1}}toReferencedList(e,t){return e}toReferencedListDeep(e,t){this.toReferencedList(e,t);for(const t of e)"ArrayExpression"===(null==t?void 0:t.type)&&this.toReferencedListDeep(t.elements)}parseSpread(e){const t=this.startNode();return this.next(),t.argument=this.parseMaybeAssignAllowIn(e,void 0),this.finishNode(t,"SpreadElement")}parseRestBinding(){const e=this.startNode();return this.next(),e.argument=this.parseBindingAtom(),this.finishNode(e,"RestElement")}parseBindingAtom(){switch(this.state.type){case 0:{const e=this.startNode();return this.next(),e.elements=this.parseBindingList(3,93,1),this.finishNode(e,"ArrayPattern")}case 5:return this.parseObjectLike(8,!0)}return this.parseIdentifier()}parseBindingList(e,t,s){const i=1&s,r=[];let n=!0;for(;!this.eat(e);)if(n?n=!1:this.expect(12),i&&this.match(12))r.push(null);else{if(this.eat(e))break;if(this.match(21)){if(r.push(this.parseAssignableListItemTypes(this.parseRestBinding(),s)),!this.checkCommaAfterRest(t)){this.expect(e);break}}else{const e=[];for(this.match(26)&&this.hasPlugin("decorators")&&this.raise(b.UnsupportedParameterDecorator,this.state.startLoc);this.match(26);)e.push(this.parseDecorator());r.push(this.parseAssignableListItem(s,e))}}return r}parseBindingRestProperty(e){return this.next(),e.argument=this.parseIdentifier(),this.checkCommaAfterRest(125),this.finishNode(e,"RestElement")}parseBindingProperty(){const e=this.startNode(),{type:t,startLoc:s}=this.state;return 21===t?this.parseBindingRestProperty(e):(138===t?(this.expectPlugin("destructuringPrivate",s),this.classScope.usePrivateName(this.state.value,s),e.key=this.parsePrivateName()):this.parsePropertyName(e),e.method=!1,this.parseObjPropValue(e,s,!1,!1,!0,!1))}parseAssignableListItem(e,t){const s=this.parseMaybeDefault();this.parseAssignableListItemTypes(s,e);const i=this.parseMaybeDefault(s.loc.start,s);return t.length&&(s.decorators=t),i}parseAssignableListItemTypes(e,t){return e}parseMaybeDefault(e,t){var s;if(null!=e||(e=this.state.startLoc),t=null!=(s=t)?s:this.parseBindingAtom(),!this.eat(29))return t;const i=this.startNodeAt(e);return i.left=t,i.right=this.parseMaybeAssignAllowIn(),this.finishNode(i,"AssignmentPattern")}isValidLVal(e,t,s){return i={AssignmentPattern:"left",RestElement:"argument",ObjectProperty:"value",ParenthesizedExpression:"expression",ArrayPattern:"elements",ObjectPattern:"properties"},r=e,hasOwnProperty.call(i,r)&&i[r];var i,r}isOptionalMemberExpression(e){return"OptionalMemberExpression"===e.type}checkLVal(e,{in:t,binding:s=64,checkClashes:i=!1,strictModeChanged:r=!1,hasParenthesizedAncestor:n=!1}){var a;const o=e.type;if(this.isObjectMethod(e))return;const h=this.isOptionalMemberExpression(e);if(h||"MemberExpression"===o)return h&&(this.expectPlugin("optionalChainingAssign",e.loc.start),"AssignmentExpression"!==t.type&&this.raise(b.InvalidLhsOptionalChaining,e,{ancestor:t})),void(64!==s&&this.raise(b.InvalidPropertyBindingPattern,e));if("Identifier"===o){this.checkIdentifier(e,s,r);const{name:t}=e;return void(i&&(i.has(t)?this.raise(b.ParamDupe,e):i.add(t)))}const c=this.isValidLVal(o,!(n||null!=(a=e.extra)&&a.parenthesized)&&"AssignmentExpression"===t.type,s);if(!0===c)return;if(!1===c){const i=64===s?b.InvalidLhs:b.InvalidLhsBinding;return void this.raise(i,e,{ancestor:t})}const[l,p]=Array.isArray(c)?c:[c,"ParenthesizedExpression"===o],u="ArrayPattern"===o||"ObjectPattern"===o?{type:o}:t;for(const t of[].concat(e[l]))t&&this.checkLVal(t,{in:u,binding:s,checkClashes:i,strictModeChanged:r,hasParenthesizedAncestor:p})}checkIdentifier(e,t,s=!1){this.state.strict&&(s?fe(e.name,this.inModule):de(e.name))&&(64===t?this.raise(b.StrictEvalArguments,e,{referenceName:e.name}):this.raise(b.StrictEvalArgumentsBinding,e,{bindingName:e.name})),8192&t&&"let"===e.name&&this.raise(b.LetInLexicalBinding,e),64&t||this.declareNameFromIdentifier(e,t)}declareNameFromIdentifier(e,t){this.scope.declareName(e.name,t,e.loc.start)}checkToRestConversion(e,t){switch(e.type){case"ParenthesizedExpression":this.checkToRestConversion(e.expression,t);break;case"Identifier":case"MemberExpression":break;case"ArrayExpression":case"ObjectExpression":if(t)break;default:this.raise(b.InvalidRestAssignmentPattern,e)}}checkCommaAfterRest(e){return!!this.match(12)&&(this.raise(this.lookaheadCharCode()===e?b.RestTrailingComma:b.ElementAfterRest,this.state.startLoc),!0)}}function wt(e){if(!e)throw new Error("Assert fail")}const _t=g`typescript`({AbstractMethodHasImplementation:({methodName:e})=>`Method '${e}' cannot have an implementation because it is marked abstract.`,AbstractPropertyHasInitializer:({propertyName:e})=>`Property '${e}' cannot have an initializer because it is marked abstract.`,AccesorCannotDeclareThisParameter:"'get' and 'set' accessors cannot declare 'this' parameters.",AccesorCannotHaveTypeParameters:"An accessor cannot have type parameters.",AccessorCannotBeOptional:"An 'accessor' property cannot be declared optional.",ClassMethodHasDeclare:"Class methods cannot have the 'declare' modifier.",ClassMethodHasReadonly:"Class methods cannot have the 'readonly' modifier.",ConstInitiailizerMustBeStringOrNumericLiteralOrLiteralEnumReference:"A 'const' initializer in an ambient context must be a string or numeric literal or literal enum reference.",ConstructorHasTypeParameters:"Type parameters cannot appear on a constructor declaration.",DeclareAccessor:({kind:e})=>`'declare' is not allowed in ${e}ters.`,DeclareClassFieldHasInitializer:"Initializers are not allowed in ambient contexts.",DeclareFunctionHasImplementation:"An implementation cannot be declared in ambient contexts.",DuplicateAccessibilityModifier:({modifier:e})=>"Accessibility modifier already seen.",DuplicateModifier:({modifier:e})=>`Duplicate modifier: '${e}'.`,EmptyHeritageClauseType:({token:e})=>`'${e}' list cannot be empty.`,EmptyTypeArguments:"Type argument list cannot be empty.",EmptyTypeParameters:"Type parameter list cannot be empty.",ExpectedAmbientAfterExportDeclare:"'export declare' must be followed by an ambient declaration.",ImportAliasHasImportType:"An import alias can not use 'import type'.",ImportReflectionHasImportType:"An `import module` declaration can not use `type` modifier",IncompatibleModifiers:({modifiers:e})=>`'${e[0]}' modifier cannot be used with '${e[1]}' modifier.`,IndexSignatureHasAbstract:"Index signatures cannot have the 'abstract' modifier.",IndexSignatureHasAccessibility:({modifier:e})=>`Index signatures cannot have an accessibility modifier ('${e}').`,IndexSignatureHasDeclare:"Index signatures cannot have the 'declare' modifier.",IndexSignatureHasOverride:"'override' modifier cannot appear on an index signature.",IndexSignatureHasStatic:"Index signatures cannot have the 'static' modifier.",InitializerNotAllowedInAmbientContext:"Initializers are not allowed in ambient contexts.",InvalidModifierOnTypeMember:({modifier:e})=>`'${e}' modifier cannot appear on a type member.`,InvalidModifierOnTypeParameter:({modifier:e})=>`'${e}' modifier cannot appear on a type parameter.`,InvalidModifierOnTypeParameterPositions:({modifier:e})=>`'${e}' modifier can only appear on a type parameter of a class, interface or type alias.`,InvalidModifiersOrder:({orderedModifiers:e})=>`'${e[0]}' modifier must precede '${e[1]}' modifier.`,InvalidPropertyAccessAfterInstantiationExpression:"Invalid property access after an instantiation expression. You can either wrap the instantiation expression in parentheses, or delete the type arguments.",InvalidTupleMemberLabel:"Tuple members must be labeled with a simple identifier.",MissingInterfaceName:"'interface' declarations must be followed by an identifier.",NonAbstractClassHasAbstractMethod:"Abstract methods can only appear within an abstract class.",NonClassMethodPropertyHasAbstractModifer:"'abstract' modifier can only appear on a class, method, or property declaration.",OptionalTypeBeforeRequired:"A required element cannot follow an optional element.",OverrideNotInSubClass:"This member cannot have an 'override' modifier because its containing class does not extend another class.",PatternIsOptional:"A binding pattern parameter cannot be optional in an implementation signature.",PrivateElementHasAbstract:"Private elements cannot have the 'abstract' modifier.",PrivateElementHasAccessibility:({modifier:e})=>`Private elements cannot have an accessibility modifier ('${e}').`,ReadonlyForMethodSignature:"'readonly' modifier can only appear on a property declaration or index signature.",ReservedArrowTypeParam:"This syntax is reserved in files with the .mts or .cts extension. Add a trailing comma, as in `<T,>() => ...`.",ReservedTypeAssertion:"This syntax is reserved in files with the .mts or .cts extension. Use an `as` expression instead.",SetAccesorCannotHaveOptionalParameter:"A 'set' accessor cannot have an optional parameter.",SetAccesorCannotHaveRestParameter:"A 'set' accessor cannot have rest parameter.",SetAccesorCannotHaveReturnType:"A 'set' accessor cannot have a return type annotation.",SingleTypeParameterWithoutTrailingComma:({typeParameterName:e})=>`Single type parameter ${e} should have a trailing comma. Example usage: <${e},>.`,StaticBlockCannotHaveModifier:"Static class blocks cannot have any modifier.",TupleOptionalAfterType:"A labeled tuple optional element must be declared using a question mark after the name and before the colon (`name?: type`), rather than after the type (`name: type?`).",TypeAnnotationAfterAssign:"Type annotations must come before default assignments, e.g. instead of `age = 25: number` use `age: number = 25`.",TypeImportCannotSpecifyDefaultAndNamed:"A type-only import can specify a default import or named bindings, but not both.",TypeModifierIsUsedInTypeExports:"The 'type' modifier cannot be used on a named export when 'export type' is used on its export statement.",TypeModifierIsUsedInTypeImports:"The 'type' modifier cannot be used on a named import when 'import type' is used on its import statement.",UnexpectedParameterModifier:"A parameter property is only allowed in a constructor implementation.",UnexpectedReadonly:"'readonly' type modifier is only permitted on array and tuple literal types.",UnexpectedTypeAnnotation:"Did not expect a type annotation here.",UnexpectedTypeCastInParameter:"Unexpected type cast in parameter position.",UnsupportedImportTypeArgument:"Argument in a type import must be a string literal.",UnsupportedParameterPropertyKind:"A parameter property may not be declared using a binding pattern.",UnsupportedSignatureParameterKind:({type:e})=>`Name in a signature must be an Identifier, ObjectPattern or ArrayPattern, instead got ${e}.`});function xt(e){return"private"===e||"public"===e||"protected"===e}function vt(e){return"in"===e||"out"===e}function Pt(e){if("MemberExpression"!==e.type)return!1;const{computed:t,property:s}=e;return(!t||"StringLiteral"===s.type||!("TemplateLiteral"!==s.type||s.expressions.length>0))&&Et(e.object)}function Tt(e,t){var s;const{type:i}=e;if(null!=(s=e.extra)&&s.parenthesized)return!1;if(t){if("Literal"===i){const{value:t}=e;if("string"==typeof t||"boolean"==typeof t)return!0}}else if("StringLiteral"===i||"BooleanLiteral"===i)return!0;return!(!Ct(e,t)&&!function(e,t){if("UnaryExpression"===e.type){const{operator:s,argument:i}=e;if("-"===s&&Ct(i,t))return!0}return!1}(e,t))||"TemplateLiteral"===i&&0===e.expressions.length||!!Pt(e)}function Ct(e,t){return t?"Literal"===e.type&&("number"==typeof e.value||"bigint"in e):"NumericLiteral"===e.type||"BigIntLiteral"===e.type}function Et(e){return"Identifier"===e.type||"MemberExpression"===e.type&&!e.computed&&Et(e.object)}const kt=g`placeholders`({ClassNameIsRequired:"A class name is required.",UnexpectedSpace:"Unexpected space in placeholder."});function At(e,t){const[s,i]="string"==typeof t?[t,{}]:t,r=Object.keys(i),n=0===r.length;return e.some((e=>{if("string"==typeof e)return n&&e===s;{const[t,n]=e;if(t!==s)return!1;for(const e of r)if(n[e]!==i[e])return!1;return!0}}))}function St(e,t,s){const i=e.find((e=>Array.isArray(e)?e[0]===t:e===t));return i&&Array.isArray(i)&&i.length>1?i[1][s]:null}const It=["minimal","fsharp","hack","smart"],Nt=["^^","@@","^","%","#"],Lt=["hash","bar"],Dt={estree:e=>class extends e{parse(){const e=x(super.parse());return this.options.tokens&&(e.tokens=e.tokens.map(x)),e}parseRegExpLiteral({pattern:e,flags:t}){let s=null;try{s=new RegExp(e,t)}catch(e){}const i=this.estreeParseLiteral(s);return i.regex={pattern:e,flags:t},i}parseBigIntLiteral(e){let t;try{t=BigInt(e)}catch(e){t=null}const s=this.estreeParseLiteral(t);return s.bigint=String(s.value||e),s}parseDecimalLiteral(e){const t=this.estreeParseLiteral(null);return t.decimal=String(t.value||e),t}estreeParseLiteral(e){return this.parseLiteral(e,"Literal")}parseStringLiteral(e){return this.estreeParseLiteral(e)}parseNumericLiteral(e){return this.estreeParseLiteral(e)}parseNullLiteral(){return this.estreeParseLiteral(null)}parseBooleanLiteral(e){return this.estreeParseLiteral(e)}directiveToStmt(e){const t=e.value;delete e.value,t.type="Literal",t.raw=t.extra.raw,t.value=t.extra.expressionValue;const s=e;return s.type="ExpressionStatement",s.expression=t,s.directive=t.extra.rawValue,delete t.extra,s}initFunction(e,t){super.initFunction(e,t),e.expression=!1}checkDeclaration(e){null!=e&&this.isObjectProperty(e)?this.checkDeclaration(e.value):super.checkDeclaration(e)}getObjectOrClassMethodParams(e){return e.value.params}isValidDirective(e){var t;return"ExpressionStatement"===e.type&&"Literal"===e.expression.type&&"string"==typeof e.expression.value&&!(null!=(t=e.expression.extra)&&t.parenthesized)}parseBlockBody(e,t,s,i,r){super.parseBlockBody(e,t,s,i,r);const n=e.directives.map((e=>this.directiveToStmt(e)));e.body=n.concat(e.body),delete e.directives}pushClassMethod(e,t,s,i,r,n){this.parseMethod(t,s,i,r,n,"ClassMethod",!0),t.typeParameters&&(t.value.typeParameters=t.typeParameters,delete t.typeParameters),e.body.push(t)}parsePrivateName(){const e=super.parsePrivateName();return this.getPluginOption("estree","classFeatures")?this.convertPrivateNameToPrivateIdentifier(e):e}convertPrivateNameToPrivateIdentifier(e){const t=super.getPrivateNameSV(e);return delete e.id,e.name=t,e.type="PrivateIdentifier",e}isPrivateName(e){return this.getPluginOption("estree","classFeatures")?"PrivateIdentifier"===e.type:super.isPrivateName(e)}getPrivateNameSV(e){return this.getPluginOption("estree","classFeatures")?e.name:super.getPrivateNameSV(e)}parseLiteral(e,t){const s=super.parseLiteral(e,t);return s.raw=s.extra.raw,delete s.extra,s}parseFunctionBody(e,t,s=!1){super.parseFunctionBody(e,t,s),e.expression="BlockStatement"!==e.body.type}parseMethod(e,t,s,i,r,n,a=!1){let o=this.startNode();return o.kind=e.kind,o=super.parseMethod(o,t,s,i,r,n,a),o.type="FunctionExpression",delete o.kind,e.value=o,"ClassPrivateMethod"===n&&(e.computed=!1),this.finishNode(e,"MethodDefinition")}parseClassProperty(...e){const t=super.parseClassProperty(...e);return this.getPluginOption("estree","classFeatures")?(t.type="PropertyDefinition",t):t}parseClassPrivateProperty(...e){const t=super.parseClassPrivateProperty(...e);return this.getPluginOption("estree","classFeatures")?(t.type="PropertyDefinition",t.computed=!1,t):t}parseObjectMethod(e,t,s,i,r){const n=super.parseObjectMethod(e,t,s,i,r);return n&&(n.type="Property","method"===n.kind&&(n.kind="init"),n.shorthand=!1),n}parseObjectProperty(e,t,s,i){const r=super.parseObjectProperty(e,t,s,i);return r&&(r.kind="init",r.type="Property"),r}isValidLVal(e,t,s){return"Property"===e?"value":super.isValidLVal(e,t,s)}isAssignable(e,t){return null!=e&&this.isObjectProperty(e)?this.isAssignable(e.value,t):super.isAssignable(e,t)}toAssignable(e,t=!1){if(null!=e&&this.isObjectProperty(e)){const{key:s,value:i}=e;this.isPrivateName(s)&&this.classScope.usePrivateName(this.getPrivateNameSV(s),s.loc.start),this.toAssignable(i,t)}else super.toAssignable(e,t)}toAssignableObjectExpressionProp(e,t,s){"get"===e.kind||"set"===e.kind?this.raise(b.PatternHasAccessor,e.key):e.method?this.raise(b.PatternHasMethod,e.key):super.toAssignableObjectExpressionProp(e,t,s)}finishCallExpression(e,t){const s=super.finishCallExpression(e,t);var i,r;"Import"===s.callee.type&&(s.type="ImportExpression",s.source=s.arguments[0],(this.hasPlugin("importAttributes")||this.hasPlugin("importAssertions"))&&(s.options=null!=(i=s.arguments[1])?i:null,s.attributes=null!=(r=s.arguments[1])?r:null),delete s.arguments,delete s.callee);return s}toReferencedArguments(e){"ImportExpression"!==e.type&&super.toReferencedArguments(e)}parseExport(e,t){const s=this.state.lastTokStartLoc,i=super.parseExport(e,t);switch(i.type){case"ExportAllDeclaration":i.exported=null;break;case"ExportNamedDeclaration":1===i.specifiers.length&&"ExportNamespaceSpecifier"===i.specifiers[0].type&&(i.type="ExportAllDeclaration",i.exported=i.specifiers[0].exported,delete i.specifiers);case"ExportDefaultDeclaration":{var r;const{declaration:e}=i;"ClassDeclaration"===(null==e?void 0:e.type)&&(null==(r=e.decorators)?void 0:r.length)>0&&e.start===i.start&&this.resetStartLocation(i,s)}}return i}parseSubscript(e,t,s,i){const r=super.parseSubscript(e,t,s,i);if(i.optionalChainMember){if("OptionalMemberExpression"!==r.type&&"OptionalCallExpression"!==r.type||(r.type=r.type.substring(8)),i.stop){const e=this.startNodeAtNode(r);return e.expression=r,this.finishNode(e,"ChainExpression")}}else"MemberExpression"!==r.type&&"CallExpression"!==r.type||(r.optional=!1);return r}isOptionalMemberExpression(e){return"ChainExpression"===e.type?"MemberExpression"===e.expression.type:super.isOptionalMemberExpression(e)}hasPropertyAsPrivateName(e){return"ChainExpression"===e.type&&(e=e.expression),super.hasPropertyAsPrivateName(e)}isObjectProperty(e){return"Property"===e.type&&"init"===e.kind&&!e.method}isObjectMethod(e){return e.method||"get"===e.kind||"set"===e.kind}finishNodeAt(e,t,s){return x(super.finishNodeAt(e,t,s))}resetStartLocation(e,t){super.resetStartLocation(e,t),x(e)}resetEndLocation(e,t=this.state.lastTokEndLoc){super.resetEndLocation(e,t),x(e)}},jsx:e=>class extends e{jsxReadToken(){let e="",t=this.state.pos;for(;;){if(this.state.pos>=this.length)throw this.raise(ut.UnterminatedJsxContent,this.state.startLoc);const s=this.input.charCodeAt(this.state.pos);switch(s){case 60:case 123:return this.state.pos===this.state.start?void(60===s&&this.state.canStartJSXElement?(++this.state.pos,this.finishToken(142)):super.getTokenFromCode(s)):(e+=this.input.slice(t,this.state.pos),void this.finishToken(141,e));case 38:e+=this.input.slice(t,this.state.pos),e+=this.jsxReadEntity(),t=this.state.pos;break;default:ke(s)?(e+=this.input.slice(t,this.state.pos),e+=this.jsxReadNewLine(!0),t=this.state.pos):++this.state.pos}}}jsxReadNewLine(e){const t=this.input.charCodeAt(this.state.pos);let s;return++this.state.pos,13===t&&10===this.input.charCodeAt(this.state.pos)?(++this.state.pos,s=e?"\n":"\r\n"):s=String.fromCharCode(t),++this.state.curLine,this.state.lineStart=this.state.pos,s}jsxReadString(e){let t="",s=++this.state.pos;for(;;){if(this.state.pos>=this.length)throw this.raise(b.UnterminatedString,this.state.startLoc);const i=this.input.charCodeAt(this.state.pos);if(i===e)break;38===i?(t+=this.input.slice(s,this.state.pos),t+=this.jsxReadEntity(),s=this.state.pos):ke(i)?(t+=this.input.slice(s,this.state.pos),t+=this.jsxReadNewLine(!1),s=this.state.pos):++this.state.pos}t+=this.input.slice(s,this.state.pos++),this.finishToken(133,t)}jsxReadEntity(){const e=++this.state.pos;if(35===this.codePointAtPos(this.state.pos)){++this.state.pos;let e=10;120===this.codePointAtPos(this.state.pos)&&(e=16,++this.state.pos);const t=this.readInt(e,void 0,!1,"bail");if(null!==t&&59===this.codePointAtPos(this.state.pos))return++this.state.pos,String.fromCodePoint(t)}else{let t=0,s=!1;for(;t++<10&&this.state.pos<this.length&&!(s=59==this.codePointAtPos(this.state.pos));)++this.state.pos;if(s){const t=this.input.slice(e,this.state.pos),s=pt[t];if(++this.state.pos,s)return s}}return this.state.pos=e,"&"}jsxReadWord(){let e;const t=this.state.pos;do{e=this.input.charCodeAt(++this.state.pos)}while(oe(e)||45===e);this.finishToken(140,this.input.slice(t,this.state.pos))}jsxParseIdentifier(){const e=this.startNode();return this.match(140)?e.name=this.state.value:G(this.state.type)?e.name=Y(this.state.type):this.unexpected(),this.next(),this.finishNode(e,"JSXIdentifier")}jsxParseNamespacedName(){const e=this.state.startLoc,t=this.jsxParseIdentifier();if(!this.eat(14))return t;const s=this.startNodeAt(e);return s.namespace=t,s.name=this.jsxParseIdentifier(),this.finishNode(s,"JSXNamespacedName")}jsxParseElementName(){const e=this.state.startLoc;let t=this.jsxParseNamespacedName();if("JSXNamespacedName"===t.type)return t;for(;this.eat(16);){const s=this.startNodeAt(e);s.object=t,s.property=this.jsxParseIdentifier(),t=this.finishNode(s,"JSXMemberExpression")}return t}jsxParseAttributeValue(){let e;switch(this.state.type){case 5:return e=this.startNode(),this.setContext(P.brace),this.next(),e=this.jsxParseExpressionContainer(e,P.j_oTag),"JSXEmptyExpression"===e.expression.type&&this.raise(ut.AttributeIsEmpty,e),e;case 142:case 133:return this.parseExprAtom();default:throw this.raise(ut.UnsupportedJsxValue,this.state.startLoc)}}jsxParseEmptyExpression(){const e=this.startNodeAt(this.state.lastTokEndLoc);return this.finishNodeAt(e,"JSXEmptyExpression",this.state.startLoc)}jsxParseSpreadChild(e){return this.next(),e.expression=this.parseExpression(),this.setContext(P.j_expr),this.state.canStartJSXElement=!0,this.expect(8),this.finishNode(e,"JSXSpreadChild")}jsxParseExpressionContainer(e,t){if(this.match(8))e.expression=this.jsxParseEmptyExpression();else{const t=this.parseExpression();e.expression=t}return this.setContext(t),this.state.canStartJSXElement=!0,this.expect(8),this.finishNode(e,"JSXExpressionContainer")}jsxParseAttribute(){const e=this.startNode();return this.match(5)?(this.setContext(P.brace),this.next(),this.expect(21),e.argument=this.parseMaybeAssignAllowIn(),this.setContext(P.j_oTag),this.state.canStartJSXElement=!0,this.expect(8),this.finishNode(e,"JSXSpreadAttribute")):(e.name=this.jsxParseNamespacedName(),e.value=this.eat(29)?this.jsxParseAttributeValue():null,this.finishNode(e,"JSXAttribute"))}jsxParseOpeningElementAt(e){const t=this.startNodeAt(e);return this.eat(143)?this.finishNode(t,"JSXOpeningFragment"):(t.name=this.jsxParseElementName(),this.jsxParseOpeningElementAfterName(t))}jsxParseOpeningElementAfterName(e){const t=[];for(;!this.match(56)&&!this.match(143);)t.push(this.jsxParseAttribute());return e.attributes=t,e.selfClosing=this.eat(56),this.expect(143),this.finishNode(e,"JSXOpeningElement")}jsxParseClosingElementAt(e){const t=this.startNodeAt(e);return this.eat(143)?this.finishNode(t,"JSXClosingFragment"):(t.name=this.jsxParseElementName(),this.expect(143),this.finishNode(t,"JSXClosingElement"))}jsxParseElementAt(e){const t=this.startNodeAt(e),s=[],i=this.jsxParseOpeningElementAt(e);let r=null;if(!i.selfClosing){e:for(;;)switch(this.state.type){case 142:if(e=this.state.startLoc,this.next(),this.eat(56)){r=this.jsxParseClosingElementAt(e);break e}s.push(this.jsxParseElementAt(e));break;case 141:s.push(this.parseExprAtom());break;case 5:{const e=this.startNode();this.setContext(P.brace),this.next(),this.match(21)?s.push(this.jsxParseSpreadChild(e)):s.push(this.jsxParseExpressionContainer(e,P.j_expr));break}default:this.unexpected()}dt(i)&&!dt(r)&&null!==r?this.raise(ut.MissingClosingTagFragment,r):!dt(i)&&dt(r)?this.raise(ut.MissingClosingTagElement,r,{openingTagName:ft(i.name)}):dt(i)||dt(r)||ft(r.name)!==ft(i.name)&&this.raise(ut.MissingClosingTagElement,r,{openingTagName:ft(i.name)})}if(dt(i)?(t.openingFragment=i,t.closingFragment=r):(t.openingElement=i,t.closingElement=r),t.children=s,this.match(47))throw this.raise(ut.UnwrappedAdjacentJSXElements,this.state.startLoc);return dt(i)?this.finishNode(t,"JSXFragment"):this.finishNode(t,"JSXElement")}jsxParseElement(){const e=this.state.startLoc;return this.next(),this.jsxParseElementAt(e)}setContext(e){const{context:t}=this.state;t[t.length-1]=e}parseExprAtom(e){return this.match(141)?this.parseLiteral(this.state.value,"JSXText"):this.match(142)?this.jsxParseElement():this.match(47)&&33!==this.input.charCodeAt(this.state.pos)?(this.replaceToken(142),this.jsxParseElement()):super.parseExprAtom(e)}skipSpace(){this.curContext().preserveSpace||super.skipSpace()}getTokenFromCode(e){const t=this.curContext();if(t!==P.j_expr){if(t===P.j_oTag||t===P.j_cTag){if(ae(e))return void this.jsxReadWord();if(62===e)return++this.state.pos,void this.finishToken(143);if((34===e||39===e)&&t===P.j_oTag)return void this.jsxReadString(e)}if(60===e&&this.state.canStartJSXElement&&33!==this.input.charCodeAt(this.state.pos+1))return++this.state.pos,void this.finishToken(142);super.getTokenFromCode(e)}else this.jsxReadToken()}updateContext(e){const{context:t,type:s}=this.state;if(56===s&&142===e)t.splice(-2,2,P.j_cTag),this.state.canStartJSXElement=!1;else if(142===s)t.push(P.j_oTag);else if(143===s){const s=t[t.length-1];s===P.j_oTag&&56===e||s===P.j_cTag?(t.pop(),this.state.canStartJSXElement=t[t.length-1]===P.j_expr):(this.setContext(P.j_expr),this.state.canStartJSXElement=!0)}else this.state.canStartJSXElement=F[s]}},flow:e=>class extends e{constructor(...e){super(...e),this.flowPragma=void 0}getScopeHandler(){return we}shouldParseTypes(){return this.getPluginOption("flow","all")||"flow"===this.flowPragma}shouldParseEnums(){return!!this.getPluginOption("flow","enums")}finishToken(e,t){133!==e&&13!==e&&28!==e&&void 0===this.flowPragma&&(this.flowPragma=null),super.finishToken(e,t)}addComment(e){if(void 0===this.flowPragma){const t=lt.exec(e.value);if(t)if("flow"===t[1])this.flowPragma="flow";else{if("noflow"!==t[1])throw new Error("Unexpected flow pragma");this.flowPragma="noflow"}}super.addComment(e)}flowParseTypeInitialiser(e){const t=this.state.inType;this.state.inType=!0,this.expect(e||14);const s=this.flowParseType();return this.state.inType=t,s}flowParsePredicate(){const e=this.startNode(),t=this.state.startLoc;return this.next(),this.expectContextual(110),this.state.lastTokStartLoc.index>t.index+1&&this.raise(ot.UnexpectedSpaceBetweenModuloChecks,t),this.eat(10)?(e.value=super.parseExpression(),this.expect(11),this.finishNode(e,"DeclaredPredicate")):this.finishNode(e,"InferredPredicate")}flowParseTypeAndPredicateInitialiser(){const e=this.state.inType;this.state.inType=!0,this.expect(14);let t=null,s=null;return this.match(54)?(this.state.inType=e,s=this.flowParsePredicate()):(t=this.flowParseType(),this.state.inType=e,this.match(54)&&(s=this.flowParsePredicate())),[t,s]}flowParseDeclareClass(e){return this.next(),this.flowParseInterfaceish(e,!0),this.finishNode(e,"DeclareClass")}flowParseDeclareFunction(e){this.next();const t=e.id=this.parseIdentifier(),s=this.startNode(),i=this.startNode();this.match(47)?s.typeParameters=this.flowParseTypeParameterDeclaration():s.typeParameters=null,this.expect(10);const r=this.flowParseFunctionTypeParams();return s.params=r.params,s.rest=r.rest,s.this=r._this,this.expect(11),[s.returnType,e.predicate]=this.flowParseTypeAndPredicateInitialiser(),i.typeAnnotation=this.finishNode(s,"FunctionTypeAnnotation"),t.typeAnnotation=this.finishNode(i,"TypeAnnotation"),this.resetEndLocation(t),this.semicolon(),this.scope.declareName(e.id.name,2048,e.id.loc.start),this.finishNode(e,"DeclareFunction")}flowParseDeclare(e,t){return this.match(80)?this.flowParseDeclareClass(e):this.match(68)?this.flowParseDeclareFunction(e):this.match(74)?this.flowParseDeclareVariable(e):this.eatContextual(127)?this.match(16)?this.flowParseDeclareModuleExports(e):(t&&this.raise(ot.NestedDeclareModule,this.state.lastTokStartLoc),this.flowParseDeclareModule(e)):this.isContextual(130)?this.flowParseDeclareTypeAlias(e):this.isContextual(131)?this.flowParseDeclareOpaqueType(e):this.isContextual(129)?this.flowParseDeclareInterface(e):this.match(82)?this.flowParseDeclareExportDeclaration(e,t):void this.unexpected()}flowParseDeclareVariable(e){return this.next(),e.id=this.flowParseTypeAnnotatableIdentifier(!0),this.scope.declareName(e.id.name,5,e.id.loc.start),this.semicolon(),this.finishNode(e,"DeclareVariable")}flowParseDeclareModule(e){this.scope.enter(0),this.match(133)?e.id=super.parseExprAtom():e.id=this.parseIdentifier();const t=e.body=this.startNode(),s=t.body=[];for(this.expect(5);!this.match(8);){let e=this.startNode();this.match(83)?(this.next(),this.isContextual(130)||this.match(87)||this.raise(ot.InvalidNonTypeImportInDeclareModule,this.state.lastTokStartLoc),super.parseImport(e)):(this.expectContextual(125,ot.UnsupportedStatementInDeclareModule),e=this.flowParseDeclare(e,!0)),s.push(e)}this.scope.exit(),this.expect(8),this.finishNode(t,"BlockStatement");let i=null,r=!1;return s.forEach((e=>{!function(e){return"DeclareExportAllDeclaration"===e.type||"DeclareExportDeclaration"===e.type&&(!e.declaration||"TypeAlias"!==e.declaration.type&&"InterfaceDeclaration"!==e.declaration.type)}(e)?"DeclareModuleExports"===e.type&&(r&&this.raise(ot.DuplicateDeclareModuleExports,e),"ES"===i&&this.raise(ot.AmbiguousDeclareModuleKind,e),i="CommonJS",r=!0):("CommonJS"===i&&this.raise(ot.AmbiguousDeclareModuleKind,e),i="ES")})),e.kind=i||"CommonJS",this.finishNode(e,"DeclareModule")}flowParseDeclareExportDeclaration(e,t){if(this.expect(82),this.eat(65))return this.match(68)||this.match(80)?e.declaration=this.flowParseDeclare(this.startNode()):(e.declaration=this.flowParseType(),this.semicolon()),e.default=!0,this.finishNode(e,"DeclareExportDeclaration");if(this.match(75)||this.isLet()||(this.isContextual(130)||this.isContextual(129))&&!t){const e=this.state.value;throw this.raise(ot.UnsupportedDeclareExportKind,this.state.startLoc,{unsupportedExportKind:e,suggestion:ct[e]})}return this.match(74)||this.match(68)||this.match(80)||this.isContextual(131)?(e.declaration=this.flowParseDeclare(this.startNode()),e.default=!1,this.finishNode(e,"DeclareExportDeclaration")):this.match(55)||this.match(5)||this.isContextual(129)||this.isContextual(130)||this.isContextual(131)?("ExportNamedDeclaration"===(e=this.parseExport(e,null)).type&&(e.type="ExportDeclaration",e.default=!1,delete e.exportKind),e.type="Declare"+e.type,e):void this.unexpected()}flowParseDeclareModuleExports(e){return this.next(),this.expectContextual(111),e.typeAnnotation=this.flowParseTypeAnnotation(),this.semicolon(),this.finishNode(e,"DeclareModuleExports")}flowParseDeclareTypeAlias(e){this.next();const t=this.flowParseTypeAlias(e);return t.type="DeclareTypeAlias",t}flowParseDeclareOpaqueType(e){this.next();const t=this.flowParseOpaqueType(e,!0);return t.type="DeclareOpaqueType",t}flowParseDeclareInterface(e){return this.next(),this.flowParseInterfaceish(e,!1),this.finishNode(e,"DeclareInterface")}flowParseInterfaceish(e,t){if(e.id=this.flowParseRestrictedIdentifier(!t,!0),this.scope.declareName(e.id.name,t?17:8201,e.id.loc.start),this.match(47)?e.typeParameters=this.flowParseTypeParameterDeclaration():e.typeParameters=null,e.extends=[],this.eat(81))do{e.extends.push(this.flowParseInterfaceExtends())}while(!t&&this.eat(12));if(t){if(e.implements=[],e.mixins=[],this.eatContextual(117))do{e.mixins.push(this.flowParseInterfaceExtends())}while(this.eat(12));if(this.eatContextual(113))do{e.implements.push(this.flowParseInterfaceExtends())}while(this.eat(12))}e.body=this.flowParseObjectType({allowStatic:t,allowExact:!1,allowSpread:!1,allowProto:t,allowInexact:!1})}flowParseInterfaceExtends(){const e=this.startNode();return e.id=this.flowParseQualifiedTypeIdentifier(),this.match(47)?e.typeParameters=this.flowParseTypeParameterInstantiation():e.typeParameters=null,this.finishNode(e,"InterfaceExtends")}flowParseInterface(e){return this.flowParseInterfaceish(e,!1),this.finishNode(e,"InterfaceDeclaration")}checkNotUnderscore(e){"_"===e&&this.raise(ot.UnexpectedReservedUnderscore,this.state.startLoc)}checkReservedType(e,t,s){at.has(e)&&this.raise(s?ot.AssignReservedType:ot.UnexpectedReservedType,t,{reservedType:e})}flowParseRestrictedIdentifier(e,t){return this.checkReservedType(this.state.value,this.state.startLoc,t),this.parseIdentifier(e)}flowParseTypeAlias(e){return e.id=this.flowParseRestrictedIdentifier(!1,!0),this.scope.declareName(e.id.name,8201,e.id.loc.start),this.match(47)?e.typeParameters=this.flowParseTypeParameterDeclaration():e.typeParameters=null,e.right=this.flowParseTypeInitialiser(29),this.semicolon(),this.finishNode(e,"TypeAlias")}flowParseOpaqueType(e,t){return this.expectContextual(130),e.id=this.flowParseRestrictedIdentifier(!0,!0),this.scope.declareName(e.id.name,8201,e.id.loc.start),this.match(47)?e.typeParameters=this.flowParseTypeParameterDeclaration():e.typeParameters=null,e.supertype=null,this.match(14)&&(e.supertype=this.flowParseTypeInitialiser(14)),e.impltype=null,t||(e.impltype=this.flowParseTypeInitialiser(29)),this.semicolon(),this.finishNode(e,"OpaqueType")}flowParseTypeParameter(e=!1){const t=this.state.startLoc,s=this.startNode(),i=this.flowParseVariance(),r=this.flowParseTypeAnnotatableIdentifier();return s.name=r.name,s.variance=i,s.bound=r.typeAnnotation,this.match(29)?(this.eat(29),s.default=this.flowParseType()):e&&this.raise(ot.MissingTypeParamDefault,t),this.finishNode(s,"TypeParameter")}flowParseTypeParameterDeclaration(){const e=this.state.inType,t=this.startNode();t.params=[],this.state.inType=!0,this.match(47)||this.match(142)?this.next():this.unexpected();let s=!1;do{const e=this.flowParseTypeParameter(s);t.params.push(e),e.default&&(s=!0),this.match(48)||this.expect(12)}while(!this.match(48));return this.expect(48),this.state.inType=e,this.finishNode(t,"TypeParameterDeclaration")}flowParseTypeParameterInstantiation(){const e=this.startNode(),t=this.state.inType;e.params=[],this.state.inType=!0,this.expect(47);const s=this.state.noAnonFunctionType;for(this.state.noAnonFunctionType=!1;!this.match(48);)e.params.push(this.flowParseType()),this.match(48)||this.expect(12);return this.state.noAnonFunctionType=s,this.expect(48),this.state.inType=t,this.finishNode(e,"TypeParameterInstantiation")}flowParseTypeParameterInstantiationCallOrNew(){const e=this.startNode(),t=this.state.inType;for(e.params=[],this.state.inType=!0,this.expect(47);!this.match(48);)e.params.push(this.flowParseTypeOrImplicitInstantiation()),this.match(48)||this.expect(12);return this.expect(48),this.state.inType=t,this.finishNode(e,"TypeParameterInstantiation")}flowParseInterfaceType(){const e=this.startNode();if(this.expectContextual(129),e.extends=[],this.eat(81))do{e.extends.push(this.flowParseInterfaceExtends())}while(this.eat(12));return e.body=this.flowParseObjectType({allowStatic:!1,allowExact:!1,allowSpread:!1,allowProto:!1,allowInexact:!1}),this.finishNode(e,"InterfaceTypeAnnotation")}flowParseObjectPropertyKey(){return this.match(134)||this.match(133)?super.parseExprAtom():this.parseIdentifier(!0)}flowParseObjectTypeIndexer(e,t,s){return e.static=t,14===this.lookahead().type?(e.id=this.flowParseObjectPropertyKey(),e.key=this.flowParseTypeInitialiser()):(e.id=null,e.key=this.flowParseType()),this.expect(3),e.value=this.flowParseTypeInitialiser(),e.variance=s,this.finishNode(e,"ObjectTypeIndexer")}flowParseObjectTypeInternalSlot(e,t){return e.static=t,e.id=this.flowParseObjectPropertyKey(),this.expect(3),this.expect(3),this.match(47)||this.match(10)?(e.method=!0,e.optional=!1,e.value=this.flowParseObjectTypeMethodish(this.startNodeAt(e.loc.start))):(e.method=!1,this.eat(17)&&(e.optional=!0),e.value=this.flowParseTypeInitialiser()),this.finishNode(e,"ObjectTypeInternalSlot")}flowParseObjectTypeMethodish(e){for(e.params=[],e.rest=null,e.typeParameters=null,e.this=null,this.match(47)&&(e.typeParameters=this.flowParseTypeParameterDeclaration()),this.expect(10),this.match(78)&&(e.this=this.flowParseFunctionTypeParam(!0),e.this.name=null,this.match(11)||this.expect(12));!this.match(11)&&!this.match(21);)e.params.push(this.flowParseFunctionTypeParam(!1)),this.match(11)||this.expect(12);return this.eat(21)&&(e.rest=this.flowParseFunctionTypeParam(!1)),this.expect(11),e.returnType=this.flowParseTypeInitialiser(),this.finishNode(e,"FunctionTypeAnnotation")}flowParseObjectTypeCallProperty(e,t){const s=this.startNode();return e.static=t,e.value=this.flowParseObjectTypeMethodish(s),this.finishNode(e,"ObjectTypeCallProperty")}flowParseObjectType({allowStatic:e,allowExact:t,allowSpread:s,allowProto:i,allowInexact:r}){const n=this.state.inType;this.state.inType=!0;const a=this.startNode();let o,h;a.callProperties=[],a.properties=[],a.indexers=[],a.internalSlots=[];let c=!1;for(t&&this.match(6)?(this.expect(6),o=9,h=!0):(this.expect(5),o=8,h=!1),a.exact=h;!this.match(o);){let t=!1,n=null,o=null;const l=this.startNode();if(i&&this.isContextual(118)){const t=this.lookahead();14!==t.type&&17!==t.type&&(this.next(),n=this.state.startLoc,e=!1)}if(e&&this.isContextual(106)){const e=this.lookahead();14!==e.type&&17!==e.type&&(this.next(),t=!0)}const p=this.flowParseVariance();if(this.eat(0))null!=n&&this.unexpected(n),this.eat(0)?(p&&this.unexpected(p.loc.start),a.internalSlots.push(this.flowParseObjectTypeInternalSlot(l,t))):a.indexers.push(this.flowParseObjectTypeIndexer(l,t,p));else if(this.match(10)||this.match(47))null!=n&&this.unexpected(n),p&&this.unexpected(p.loc.start),a.callProperties.push(this.flowParseObjectTypeCallProperty(l,t));else{let e="init";(this.isContextual(99)||this.isContextual(104))&&W(this.lookahead().type)&&(e=this.state.value,this.next());const i=this.flowParseObjectTypeProperty(l,t,n,p,e,s,null!=r?r:!h);null===i?(c=!0,o=this.state.lastTokStartLoc):a.properties.push(i)}this.flowObjectTypeSemicolon(),!o||this.match(8)||this.match(9)||this.raise(ot.UnexpectedExplicitInexactInObject,o)}this.expect(o),s&&(a.inexact=c);const l=this.finishNode(a,"ObjectTypeAnnotation");return this.state.inType=n,l}flowParseObjectTypeProperty(e,t,s,i,r,n,a){if(this.eat(21))return this.match(12)||this.match(13)||this.match(8)||this.match(9)?(n?a||this.raise(ot.InexactInsideExact,this.state.lastTokStartLoc):this.raise(ot.InexactInsideNonObject,this.state.lastTokStartLoc),i&&this.raise(ot.InexactVariance,i),null):(n||this.raise(ot.UnexpectedSpreadType,this.state.lastTokStartLoc),null!=s&&this.unexpected(s),i&&this.raise(ot.SpreadVariance,i),e.argument=this.flowParseType(),this.finishNode(e,"ObjectTypeSpreadProperty"));{e.key=this.flowParseObjectPropertyKey(),e.static=t,e.proto=null!=s,e.kind=r;let a=!1;return this.match(47)||this.match(10)?(e.method=!0,null!=s&&this.unexpected(s),i&&this.unexpected(i.loc.start),e.value=this.flowParseObjectTypeMethodish(this.startNodeAt(e.loc.start)),"get"!==r&&"set"!==r||this.flowCheckGetterSetterParams(e),!n&&"constructor"===e.key.name&&e.value.this&&this.raise(ot.ThisParamBannedInConstructor,e.value.this)):("init"!==r&&this.unexpected(),e.method=!1,this.eat(17)&&(a=!0),e.value=this.flowParseTypeInitialiser(),e.variance=i),e.optional=a,this.finishNode(e,"ObjectTypeProperty")}}flowCheckGetterSetterParams(e){const t="get"===e.kind?0:1,s=e.value.params.length+(e.value.rest?1:0);e.value.this&&this.raise("get"===e.kind?ot.GetterMayNotHaveThisParam:ot.SetterMayNotHaveThisParam,e.value.this),s!==t&&this.raise("get"===e.kind?b.BadGetterArity:b.BadSetterArity,e),"set"===e.kind&&e.value.rest&&this.raise(b.BadSetterRestParameter,e)}flowObjectTypeSemicolon(){this.eat(13)||this.eat(12)||this.match(8)||this.match(9)||this.unexpected()}flowParseQualifiedTypeIdentifier(e,t){null!=e||(e=this.state.startLoc);let s=t||this.flowParseRestrictedIdentifier(!0);for(;this.eat(16);){const t=this.startNodeAt(e);t.qualification=s,t.id=this.flowParseRestrictedIdentifier(!0),s=this.finishNode(t,"QualifiedTypeIdentifier")}return s}flowParseGenericType(e,t){const s=this.startNodeAt(e);return s.typeParameters=null,s.id=this.flowParseQualifiedTypeIdentifier(e,t),this.match(47)&&(s.typeParameters=this.flowParseTypeParameterInstantiation()),this.finishNode(s,"GenericTypeAnnotation")}flowParseTypeofType(){const e=this.startNode();return this.expect(87),e.argument=this.flowParsePrimaryType(),this.finishNode(e,"TypeofTypeAnnotation")}flowParseTupleType(){const e=this.startNode();for(e.types=[],this.expect(0);this.state.pos<this.length&&!this.match(3)&&(e.types.push(this.flowParseType()),!this.match(3));)this.expect(12);return this.expect(3),this.finishNode(e,"TupleTypeAnnotation")}flowParseFunctionTypeParam(e){let t=null,s=!1,i=null;const r=this.startNode(),n=this.lookahead(),a=78===this.state.type;return 14===n.type||17===n.type?(a&&!e&&this.raise(ot.ThisParamMustBeFirst,r),t=this.parseIdentifier(a),this.eat(17)&&(s=!0,a&&this.raise(ot.ThisParamMayNotBeOptional,r)),i=this.flowParseTypeInitialiser()):i=this.flowParseType(),r.name=t,r.optional=s,r.typeAnnotation=i,this.finishNode(r,"FunctionTypeParam")}reinterpretTypeAsFunctionTypeParam(e){const t=this.startNodeAt(e.loc.start);return t.name=null,t.optional=!1,t.typeAnnotation=e,this.finishNode(t,"FunctionTypeParam")}flowParseFunctionTypeParams(e=[]){let t=null,s=null;for(this.match(78)&&(s=this.flowParseFunctionTypeParam(!0),s.name=null,this.match(11)||this.expect(12));!this.match(11)&&!this.match(21);)e.push(this.flowParseFunctionTypeParam(!1)),this.match(11)||this.expect(12);return this.eat(21)&&(t=this.flowParseFunctionTypeParam(!1)),{params:e,rest:t,_this:s}}flowIdentToTypeAnnotation(e,t,s){switch(s.name){case"any":return this.finishNode(t,"AnyTypeAnnotation");case"bool":case"boolean":return this.finishNode(t,"BooleanTypeAnnotation");case"mixed":return this.finishNode(t,"MixedTypeAnnotation");case"empty":return this.finishNode(t,"EmptyTypeAnnotation");case"number":return this.finishNode(t,"NumberTypeAnnotation");case"string":return this.finishNode(t,"StringTypeAnnotation");case"symbol":return this.finishNode(t,"SymbolTypeAnnotation");default:return this.checkNotUnderscore(s.name),this.flowParseGenericType(e,s)}}flowParsePrimaryType(){const e=this.state.startLoc,t=this.startNode();let s,i,r=!1;const n=this.state.noAnonFunctionType;switch(this.state.type){case 5:return this.flowParseObjectType({allowStatic:!1,allowExact:!1,allowSpread:!0,allowProto:!1,allowInexact:!0});case 6:return this.flowParseObjectType({allowStatic:!1,allowExact:!0,allowSpread:!0,allowProto:!1,allowInexact:!1});case 0:return this.state.noAnonFunctionType=!1,i=this.flowParseTupleType(),this.state.noAnonFunctionType=n,i;case 47:return t.typeParameters=this.flowParseTypeParameterDeclaration(),this.expect(10),s=this.flowParseFunctionTypeParams(),t.params=s.params,t.rest=s.rest,t.this=s._this,this.expect(11),this.expect(19),t.returnType=this.flowParseType(),this.finishNode(t,"FunctionTypeAnnotation");case 10:if(this.next(),!this.match(11)&&!this.match(21))if(H(this.state.type)||this.match(78)){const e=this.lookahead().type;r=17!==e&&14!==e}else r=!0;if(r){if(this.state.noAnonFunctionType=!1,i=this.flowParseType(),this.state.noAnonFunctionType=n,this.state.noAnonFunctionType||!(this.match(12)||this.match(11)&&19===this.lookahead().type))return this.expect(11),i;this.eat(12)}return s=i?this.flowParseFunctionTypeParams([this.reinterpretTypeAsFunctionTypeParam(i)]):this.flowParseFunctionTypeParams(),t.params=s.params,t.rest=s.rest,t.this=s._this,this.expect(11),this.expect(19),t.returnType=this.flowParseType(),t.typeParameters=null,this.finishNode(t,"FunctionTypeAnnotation");case 133:return this.parseLiteral(this.state.value,"StringLiteralTypeAnnotation");case 85:case 86:return t.value=this.match(85),this.next(),this.finishNode(t,"BooleanLiteralTypeAnnotation");case 53:if("-"===this.state.value){if(this.next(),this.match(134))return this.parseLiteralAtNode(-this.state.value,"NumberLiteralTypeAnnotation",t);if(this.match(135))return this.parseLiteralAtNode(-this.state.value,"BigIntLiteralTypeAnnotation",t);throw this.raise(ot.UnexpectedSubtractionOperand,this.state.startLoc)}return void this.unexpected();case 134:return this.parseLiteral(this.state.value,"NumberLiteralTypeAnnotation");case 135:return this.parseLiteral(this.state.value,"BigIntLiteralTypeAnnotation");case 88:return this.next(),this.finishNode(t,"VoidTypeAnnotation");case 84:return this.next(),this.finishNode(t,"NullLiteralTypeAnnotation");case 78:return this.next(),this.finishNode(t,"ThisTypeAnnotation");case 55:return this.next(),this.finishNode(t,"ExistsTypeAnnotation");case 87:return this.flowParseTypeofType();default:if(G(this.state.type)){const e=Y(this.state.type);return this.next(),super.createIdentifier(t,e)}if(H(this.state.type))return this.isContextual(129)?this.flowParseInterfaceType():this.flowIdentToTypeAnnotation(e,t,this.parseIdentifier())}this.unexpected()}flowParsePostfixType(){const e=this.state.startLoc;let t=this.flowParsePrimaryType(),s=!1;for(;(this.match(0)||this.match(18))&&!this.canInsertSemicolon();){const i=this.startNodeAt(e),r=this.eat(18);s=s||r,this.expect(0),!r&&this.match(3)?(i.elementType=t,this.next(),t=this.finishNode(i,"ArrayTypeAnnotation")):(i.objectType=t,i.indexType=this.flowParseType(),this.expect(3),s?(i.optional=r,t=this.finishNode(i,"OptionalIndexedAccessType")):t=this.finishNode(i,"IndexedAccessType"))}return t}flowParsePrefixType(){const e=this.startNode();return this.eat(17)?(e.typeAnnotation=this.flowParsePrefixType(),this.finishNode(e,"NullableTypeAnnotation")):this.flowParsePostfixType()}flowParseAnonFunctionWithoutParens(){const e=this.flowParsePrefixType();if(!this.state.noAnonFunctionType&&this.eat(19)){const t=this.startNodeAt(e.loc.start);return t.params=[this.reinterpretTypeAsFunctionTypeParam(e)],t.rest=null,t.this=null,t.returnType=this.flowParseType(),t.typeParameters=null,this.finishNode(t,"FunctionTypeAnnotation")}return e}flowParseIntersectionType(){const e=this.startNode();this.eat(45);const t=this.flowParseAnonFunctionWithoutParens();for(e.types=[t];this.eat(45);)e.types.push(this.flowParseAnonFunctionWithoutParens());return 1===e.types.length?t:this.finishNode(e,"IntersectionTypeAnnotation")}flowParseUnionType(){const e=this.startNode();this.eat(43);const t=this.flowParseIntersectionType();for(e.types=[t];this.eat(43);)e.types.push(this.flowParseIntersectionType());return 1===e.types.length?t:this.finishNode(e,"UnionTypeAnnotation")}flowParseType(){const e=this.state.inType;this.state.inType=!0;const t=this.flowParseUnionType();return this.state.inType=e,t}flowParseTypeOrImplicitInstantiation(){if(132===this.state.type&&"_"===this.state.value){const e=this.state.startLoc,t=this.parseIdentifier();return this.flowParseGenericType(e,t)}return this.flowParseType()}flowParseTypeAnnotation(){const e=this.startNode();return e.typeAnnotation=this.flowParseTypeInitialiser(),this.finishNode(e,"TypeAnnotation")}flowParseTypeAnnotatableIdentifier(e){const t=e?this.parseIdentifier():this.flowParseRestrictedIdentifier();return this.match(14)&&(t.typeAnnotation=this.flowParseTypeAnnotation(),this.resetEndLocation(t)),t}typeCastToParameter(e){return e.expression.typeAnnotation=e.typeAnnotation,this.resetEndLocation(e.expression,e.typeAnnotation.loc.end),e.expression}flowParseVariance(){let e=null;return this.match(53)?(e=this.startNode(),"+"===this.state.value?e.kind="plus":e.kind="minus",this.next(),this.finishNode(e,"Variance")):e}parseFunctionBody(e,t,s=!1){t?this.forwardNoArrowParamsConversionAt(e,(()=>super.parseFunctionBody(e,!0,s))):super.parseFunctionBody(e,!1,s)}parseFunctionBodyAndFinish(e,t,s=!1){if(this.match(14)){const t=this.startNode();[t.typeAnnotation,e.predicate]=this.flowParseTypeAndPredicateInitialiser(),e.returnType=t.typeAnnotation?this.finishNode(t,"TypeAnnotation"):null}return super.parseFunctionBodyAndFinish(e,t,s)}parseStatementLike(e){if(this.state.strict&&this.isContextual(129)){if(V(this.lookahead().type)){const e=this.startNode();return this.next(),this.flowParseInterface(e)}}else if(this.shouldParseEnums()&&this.isContextual(126)){const e=this.startNode();return this.next(),this.flowParseEnumDeclaration(e)}const t=super.parseStatementLike(e);return void 0!==this.flowPragma||this.isValidDirective(t)||(this.flowPragma=null),t}parseExpressionStatement(e,t,s){if("Identifier"===t.type)if("declare"===t.name){if(this.match(80)||H(this.state.type)||this.match(68)||this.match(74)||this.match(82))return this.flowParseDeclare(e)}else if(H(this.state.type)){if("interface"===t.name)return this.flowParseInterface(e);if("type"===t.name)return this.flowParseTypeAlias(e);if("opaque"===t.name)return this.flowParseOpaqueType(e,!1)}return super.parseExpressionStatement(e,t,s)}shouldParseExportDeclaration(){const{type:e}=this.state;return K(e)||this.shouldParseEnums()&&126===e?!this.state.containsEsc:super.shouldParseExportDeclaration()}isExportDefaultSpecifier(){const{type:e}=this.state;return K(e)||this.shouldParseEnums()&&126===e?this.state.containsEsc:super.isExportDefaultSpecifier()}parseExportDefaultExpression(){if(this.shouldParseEnums()&&this.isContextual(126)){const e=this.startNode();return this.next(),this.flowParseEnumDeclaration(e)}return super.parseExportDefaultExpression()}parseConditional(e,t,s){if(!this.match(17))return e;if(this.state.maybeInArrowParameters){const t=this.lookaheadCharCode();if(44===t||61===t||58===t||41===t)return this.setOptionalParametersError(s),e}this.expect(17);const i=this.state.clone(),r=this.state.noArrowAt,n=this.startNodeAt(t);let{consequent:a,failed:o}=this.tryParseConditionalConsequent(),[h,c]=this.getArrowLikeExpressions(a);if(o||c.length>0){const e=[...r];if(c.length>0){this.state=i,this.state.noArrowAt=e;for(let t=0;t<c.length;t++)e.push(c[t].start);({consequent:a,failed:o}=this.tryParseConditionalConsequent()),[h,c]=this.getArrowLikeExpressions(a)}o&&h.length>1&&this.raise(ot.AmbiguousConditionalArrow,i.startLoc),o&&1===h.length&&(this.state=i,e.push(h[0].start),this.state.noArrowAt=e,({consequent:a,failed:o}=this.tryParseConditionalConsequent()))}return this.getArrowLikeExpressions(a,!0),this.state.noArrowAt=r,this.expect(14),n.test=e,n.consequent=a,n.alternate=this.forwardNoArrowParamsConversionAt(n,(()=>this.parseMaybeAssign(void 0,void 0))),this.finishNode(n,"ConditionalExpression")}tryParseConditionalConsequent(){this.state.noArrowParamsConversionAt.push(this.state.start);const e=this.parseMaybeAssignAllowIn(),t=!this.match(14);return this.state.noArrowParamsConversionAt.pop(),{consequent:e,failed:t}}getArrowLikeExpressions(e,t){const s=[e],i=[];for(;0!==s.length;){const e=s.pop();"ArrowFunctionExpression"===e.type?(e.typeParameters||!e.returnType?this.finishArrowValidation(e):i.push(e),s.push(e.body)):"ConditionalExpression"===e.type&&(s.push(e.consequent),s.push(e.alternate))}return t?(i.forEach((e=>this.finishArrowValidation(e))),[i,[]]):function(e,t){const s=[],i=[];for(let r=0;r<e.length;r++)(t(e[r])?s:i).push(e[r]);return[s,i]}(i,(e=>e.params.every((e=>this.isAssignable(e,!0)))))}finishArrowValidation(e){var t;this.toAssignableList(e.params,null==(t=e.extra)?void 0:t.trailingCommaLoc,!1),this.scope.enter(6),super.checkParams(e,!1,!0),this.scope.exit()}forwardNoArrowParamsConversionAt(e,t){let s;return-1!==this.state.noArrowParamsConversionAt.indexOf(e.start)?(this.state.noArrowParamsConversionAt.push(this.state.start),s=t(),this.state.noArrowParamsConversionAt.pop()):s=t(),s}parseParenItem(e,t){if(e=super.parseParenItem(e,t),this.eat(17)&&(e.optional=!0,this.resetEndLocation(e)),this.match(14)){const s=this.startNodeAt(t);return s.expression=e,s.typeAnnotation=this.flowParseTypeAnnotation(),this.finishNode(s,"TypeCastExpression")}return e}assertModuleNodeAllowed(e){"ImportDeclaration"===e.type&&("type"===e.importKind||"typeof"===e.importKind)||"ExportNamedDeclaration"===e.type&&"type"===e.exportKind||"ExportAllDeclaration"===e.type&&"type"===e.exportKind||super.assertModuleNodeAllowed(e)}parseExportDeclaration(e){if(this.isContextual(130)){e.exportKind="type";const t=this.startNode();return this.next(),this.match(5)?(e.specifiers=this.parseExportSpecifiers(!0),super.parseExportFrom(e),null):this.flowParseTypeAlias(t)}if(this.isContextual(131)){e.exportKind="type";const t=this.startNode();return this.next(),this.flowParseOpaqueType(t,!1)}if(this.isContextual(129)){e.exportKind="type";const t=this.startNode();return this.next(),this.flowParseInterface(t)}if(this.shouldParseEnums()&&this.isContextual(126)){e.exportKind="value";const t=this.startNode();return this.next(),this.flowParseEnumDeclaration(t)}return super.parseExportDeclaration(e)}eatExportStar(e){return!!super.eatExportStar(e)||!(!this.isContextual(130)||55!==this.lookahead().type)&&(e.exportKind="type",this.next(),this.next(),!0)}maybeParseExportNamespaceSpecifier(e){const{startLoc:t}=this.state,s=super.maybeParseExportNamespaceSpecifier(e);return s&&"type"===e.exportKind&&this.unexpected(t),s}parseClassId(e,t,s){super.parseClassId(e,t,s),this.match(47)&&(e.typeParameters=this.flowParseTypeParameterDeclaration())}parseClassMember(e,t,s){const{startLoc:i}=this.state;if(this.isContextual(125)){if(super.parseClassMemberFromModifier(e,t))return;t.declare=!0}super.parseClassMember(e,t,s),t.declare&&("ClassProperty"!==t.type&&"ClassPrivateProperty"!==t.type&&"PropertyDefinition"!==t.type?this.raise(ot.DeclareClassElement,i):t.value&&this.raise(ot.DeclareClassFieldInitializer,t.value))}isIterator(e){return"iterator"===e||"asyncIterator"===e}readIterator(){const e=super.readWord1(),t="@@"+e;this.isIterator(e)&&this.state.inType||this.raise(b.InvalidIdentifier,this.state.curPosition(),{identifierName:t}),this.finishToken(132,t)}getTokenFromCode(e){const t=this.input.charCodeAt(this.state.pos+1);123===e&&124===t?this.finishOp(6,2):!this.state.inType||62!==e&&60!==e?this.state.inType&&63===e?46===t?this.finishOp(18,2):this.finishOp(17,1):function(e,t,s){return 64===e&&64===t&&ae(s)}(e,t,this.input.charCodeAt(this.state.pos+2))?(this.state.pos+=2,this.readIterator()):super.getTokenFromCode(e):this.finishOp(62===e?48:47,1)}isAssignable(e,t){return"TypeCastExpression"===e.type?this.isAssignable(e.expression,t):super.isAssignable(e,t)}toAssignable(e,t=!1){t||"AssignmentExpression"!==e.type||"TypeCastExpression"!==e.left.type||(e.left=this.typeCastToParameter(e.left)),super.toAssignable(e,t)}toAssignableList(e,t,s){for(let t=0;t<e.length;t++){const s=e[t];"TypeCastExpression"===(null==s?void 0:s.type)&&(e[t]=this.typeCastToParameter(s))}super.toAssignableList(e,t,s)}toReferencedList(e,t){for(let i=0;i<e.length;i++){var s;const r=e[i];!r||"TypeCastExpression"!==r.type||null!=(s=r.extra)&&s.parenthesized||!(e.length>1)&&t||this.raise(ot.TypeCastInPattern,r.typeAnnotation)}return e}parseArrayLike(e,t,s,i){const r=super.parseArrayLike(e,t,s,i);return t&&!this.state.maybeInArrowParameters&&this.toReferencedList(r.elements),r}isValidLVal(e,t,s){return"TypeCastExpression"===e||super.isValidLVal(e,t,s)}parseClassProperty(e){return this.match(14)&&(e.typeAnnotation=this.flowParseTypeAnnotation()),super.parseClassProperty(e)}parseClassPrivateProperty(e){return this.match(14)&&(e.typeAnnotation=this.flowParseTypeAnnotation()),super.parseClassPrivateProperty(e)}isClassMethod(){return this.match(47)||super.isClassMethod()}isClassProperty(){return this.match(14)||super.isClassProperty()}isNonstaticConstructor(e){return!this.match(14)&&super.isNonstaticConstructor(e)}pushClassMethod(e,t,s,i,r,n){if(t.variance&&this.unexpected(t.variance.loc.start),delete t.variance,this.match(47)&&(t.typeParameters=this.flowParseTypeParameterDeclaration()),super.pushClassMethod(e,t,s,i,r,n),t.params&&r){const e=t.params;e.length>0&&this.isThisParam(e[0])&&this.raise(ot.ThisParamBannedInConstructor,t)}else if("MethodDefinition"===t.type&&r&&t.value.params){const e=t.value.params;e.length>0&&this.isThisParam(e[0])&&this.raise(ot.ThisParamBannedInConstructor,t)}}pushClassPrivateMethod(e,t,s,i){t.variance&&this.unexpected(t.variance.loc.start),delete t.variance,this.match(47)&&(t.typeParameters=this.flowParseTypeParameterDeclaration()),super.pushClassPrivateMethod(e,t,s,i)}parseClassSuper(e){if(super.parseClassSuper(e),e.superClass&&this.match(47)&&(e.superTypeParameters=this.flowParseTypeParameterInstantiation()),this.isContextual(113)){this.next();const t=e.implements=[];do{const e=this.startNode();e.id=this.flowParseRestrictedIdentifier(!0),this.match(47)?e.typeParameters=this.flowParseTypeParameterInstantiation():e.typeParameters=null,t.push(this.finishNode(e,"ClassImplements"))}while(this.eat(12))}}checkGetterSetterParams(e){super.checkGetterSetterParams(e);const t=this.getObjectOrClassMethodParams(e);if(t.length>0){const s=t[0];this.isThisParam(s)&&"get"===e.kind?this.raise(ot.GetterMayNotHaveThisParam,s):this.isThisParam(s)&&this.raise(ot.SetterMayNotHaveThisParam,s)}}parsePropertyNamePrefixOperator(e){e.variance=this.flowParseVariance()}parseObjPropValue(e,t,s,i,r,n,a){let o;e.variance&&this.unexpected(e.variance.loc.start),delete e.variance,this.match(47)&&!n&&(o=this.flowParseTypeParameterDeclaration(),this.match(10)||this.unexpected());const h=super.parseObjPropValue(e,t,s,i,r,n,a);return o&&((h.value||h).typeParameters=o),h}parseAssignableListItemTypes(e){return this.eat(17)&&("Identifier"!==e.type&&this.raise(ot.PatternIsOptional,e),this.isThisParam(e)&&this.raise(ot.ThisParamMayNotBeOptional,e),e.optional=!0),this.match(14)?e.typeAnnotation=this.flowParseTypeAnnotation():this.isThisParam(e)&&this.raise(ot.ThisParamAnnotationRequired,e),this.match(29)&&this.isThisParam(e)&&this.raise(ot.ThisParamNoDefault,e),this.resetEndLocation(e),e}parseMaybeDefault(e,t){const s=super.parseMaybeDefault(e,t);return"AssignmentPattern"===s.type&&s.typeAnnotation&&s.right.start<s.typeAnnotation.start&&this.raise(ot.TypeBeforeInitializer,s.typeAnnotation),s}checkImportReflection(e){super.checkImportReflection(e),e.module&&"value"!==e.importKind&&this.raise(ot.ImportReflectionHasImportType,e.specifiers[0].loc.start)}parseImportSpecifierLocal(e,t,s){t.local=ht(e)?this.flowParseRestrictedIdentifier(!0,!0):this.parseIdentifier(),e.specifiers.push(this.finishImportSpecifier(t,s))}isPotentialImportPhase(e){if(super.isPotentialImportPhase(e))return!0;if(this.isContextual(130)){if(!e)return!0;const t=this.lookaheadCharCode();return 123===t||42===t}return!e&&this.isContextual(87)}applyImportPhase(e,t,s,i){if(super.applyImportPhase(e,t,s,i),t){if(!s&&this.match(65))return;e.exportKind="type"===s?s:"value"}else"type"===s&&this.match(55)&&this.unexpected(),e.importKind="type"===s||"typeof"===s?s:"value"}parseImportSpecifier(e,t,s,i,r){const n=e.imported;let a=null;"Identifier"===n.type&&("type"===n.name?a="type":"typeof"===n.name&&(a="typeof"));let o=!1;if(this.isContextual(93)&&!this.isLookaheadContextual("as")){const t=this.parseIdentifier(!0);null===a||V(this.state.type)?(e.imported=n,e.importKind=null,e.local=this.parseIdentifier()):(e.imported=t,e.importKind=a,e.local=rt(t))}else{if(null!==a&&V(this.state.type))e.imported=this.parseIdentifier(!0),e.importKind=a;else{if(t)throw this.raise(b.ImportBindingIsString,e,{importName:n.value});e.imported=n,e.importKind=null}this.eatContextual(93)?e.local=this.parseIdentifier():(o=!0,e.local=rt(e.imported))}const h=ht(e);return s&&h&&this.raise(ot.ImportTypeShorthandOnlyInPureImport,e),(s||h)&&this.checkReservedType(e.local.name,e.local.loc.start,!0),!o||s||h||this.checkReservedWord(e.local.name,e.loc.start,!0,!0),this.finishImportSpecifier(e,"ImportSpecifier")}parseBindingAtom(){return 78===this.state.type?this.parseIdentifier(!0):super.parseBindingAtom()}parseFunctionParams(e,t){const s=e.kind;"get"!==s&&"set"!==s&&this.match(47)&&(e.typeParameters=this.flowParseTypeParameterDeclaration()),super.parseFunctionParams(e,t)}parseVarId(e,t){super.parseVarId(e,t),this.match(14)&&(e.id.typeAnnotation=this.flowParseTypeAnnotation(),this.resetEndLocation(e.id))}parseAsyncArrowFromCallExpression(e,t){if(this.match(14)){const t=this.state.noAnonFunctionType;this.state.noAnonFunctionType=!0,e.returnType=this.flowParseTypeAnnotation(),this.state.noAnonFunctionType=t}return super.parseAsyncArrowFromCallExpression(e,t)}shouldParseAsyncArrow(){return this.match(14)||super.shouldParseAsyncArrow()}parseMaybeAssign(e,t){var s;let i,r=null;if(this.hasPlugin("jsx")&&(this.match(142)||this.match(47))){if(r=this.state.clone(),i=this.tryParse((()=>super.parseMaybeAssign(e,t)),r),!i.error)return i.node;const{context:s}=this.state,n=s[s.length-1];n!==P.j_oTag&&n!==P.j_expr||s.pop()}if(null!=(s=i)&&s.error||this.match(47)){var n,a;let s;r=r||this.state.clone();const o=this.tryParse((i=>{var r;s=this.flowParseTypeParameterDeclaration();const n=this.forwardNoArrowParamsConversionAt(s,(()=>{const i=super.parseMaybeAssign(e,t);return this.resetStartLocationFromNode(i,s),i}));null!=(r=n.extra)&&r.parenthesized&&i();const a=this.maybeUnwrapTypeCastExpression(n);return"ArrowFunctionExpression"!==a.type&&i(),a.typeParameters=s,this.resetStartLocationFromNode(a,s),n}),r);let h=null;if(o.node&&"ArrowFunctionExpression"===this.maybeUnwrapTypeCastExpression(o.node).type){if(!o.error&&!o.aborted)return o.node.async&&this.raise(ot.UnexpectedTypeParameterBeforeAsyncArrowFunction,s),o.node;h=o.node}if(null!=(n=i)&&n.node)return this.state=i.failState,i.node;if(h)return this.state=o.failState,h;if(null!=(a=i)&&a.thrown)throw i.error;if(o.thrown)throw o.error;throw this.raise(ot.UnexpectedTokenAfterTypeParameter,s)}return super.parseMaybeAssign(e,t)}parseArrow(e){if(this.match(14)){const t=this.tryParse((()=>{const t=this.state.noAnonFunctionType;this.state.noAnonFunctionType=!0;const s=this.startNode();return[s.typeAnnotation,e.predicate]=this.flowParseTypeAndPredicateInitialiser(),this.state.noAnonFunctionType=t,this.canInsertSemicolon()&&this.unexpected(),this.match(19)||this.unexpected(),s}));if(t.thrown)return null;t.error&&(this.state=t.failState),e.returnType=t.node.typeAnnotation?this.finishNode(t.node,"TypeAnnotation"):null}return super.parseArrow(e)}shouldParseArrow(e){return this.match(14)||super.shouldParseArrow(e)}setArrowFunctionParameters(e,t){-1!==this.state.noArrowParamsConversionAt.indexOf(e.start)?e.params=t:super.setArrowFunctionParameters(e,t)}checkParams(e,t,s,i=!0){if(!s||-1===this.state.noArrowParamsConversionAt.indexOf(e.start)){for(let t=0;t<e.params.length;t++)this.isThisParam(e.params[t])&&t>0&&this.raise(ot.ThisParamMustBeFirst,e.params[t]);super.checkParams(e,t,s,i)}}parseParenAndDistinguishExpression(e){return super.parseParenAndDistinguishExpression(e&&-1===this.state.noArrowAt.indexOf(this.state.start))}parseSubscripts(e,t,s){if("Identifier"===e.type&&"async"===e.name&&-1!==this.state.noArrowAt.indexOf(t.index)){this.next();const s=this.startNodeAt(t);s.callee=e,s.arguments=super.parseCallExpressionArguments(11,!1),e=this.finishNode(s,"CallExpression")}else if("Identifier"===e.type&&"async"===e.name&&this.match(47)){const i=this.state.clone(),r=this.tryParse((e=>this.parseAsyncArrowWithTypeParameters(t)||e()),i);if(!r.error&&!r.aborted)return r.node;const n=this.tryParse((()=>super.parseSubscripts(e,t,s)),i);if(n.node&&!n.error)return n.node;if(r.node)return this.state=r.failState,r.node;if(n.node)return this.state=n.failState,n.node;throw r.error||n.error}return super.parseSubscripts(e,t,s)}parseSubscript(e,t,s,i){if(this.match(18)&&this.isLookaheadToken_lt()){if(i.optionalChainMember=!0,s)return i.stop=!0,e;this.next();const r=this.startNodeAt(t);return r.callee=e,r.typeArguments=this.flowParseTypeParameterInstantiation(),this.expect(10),r.arguments=this.parseCallExpressionArguments(11,!1),r.optional=!0,this.finishCallExpression(r,!0)}if(!s&&this.shouldParseTypes()&&this.match(47)){const s=this.startNodeAt(t);s.callee=e;const r=this.tryParse((()=>(s.typeArguments=this.flowParseTypeParameterInstantiationCallOrNew(),this.expect(10),s.arguments=super.parseCallExpressionArguments(11,!1),i.optionalChainMember&&(s.optional=!1),this.finishCallExpression(s,i.optionalChainMember))));if(r.node)return r.error&&(this.state=r.failState),r.node}return super.parseSubscript(e,t,s,i)}parseNewCallee(e){super.parseNewCallee(e);let t=null;this.shouldParseTypes()&&this.match(47)&&(t=this.tryParse((()=>this.flowParseTypeParameterInstantiationCallOrNew())).node),e.typeArguments=t}parseAsyncArrowWithTypeParameters(e){const t=this.startNodeAt(e);if(this.parseFunctionParams(t,!1),this.parseArrow(t))return super.parseArrowExpression(t,void 0,!0)}readToken_mult_modulo(e){const t=this.input.charCodeAt(this.state.pos+1);if(42===e&&47===t&&this.state.hasFlowComment)return this.state.hasFlowComment=!1,this.state.pos+=2,void this.nextToken();super.readToken_mult_modulo(e)}readToken_pipe_amp(e){const t=this.input.charCodeAt(this.state.pos+1);124!==e||125!==t?super.readToken_pipe_amp(e):this.finishOp(9,2)}parseTopLevel(e,t){const s=super.parseTopLevel(e,t);return this.state.hasFlowComment&&this.raise(ot.UnterminatedFlowComment,this.state.curPosition()),s}skipBlockComment(){if(!this.hasPlugin("flowComments")||!this.skipFlowComment())return super.skipBlockComment(this.state.hasFlowComment?"*-/":"*/");{if(this.state.hasFlowComment)throw this.raise(ot.NestedFlowComment,this.state.startLoc);this.hasFlowCommentCompletion();const e=this.skipFlowComment();e&&(this.state.pos+=e,this.state.hasFlowComment=!0)}}skipFlowComment(){const{pos:e}=this.state;let t=2;for(;[32,9].includes(this.input.charCodeAt(e+t));)t++;const s=this.input.charCodeAt(t+e),i=this.input.charCodeAt(t+e+1);return 58===s&&58===i?t+2:"flow-include"===this.input.slice(t+e,t+e+12)?t+12:58===s&&58!==i&&t}hasFlowCommentCompletion(){if(-1===this.input.indexOf("*/",this.state.pos))throw this.raise(b.UnterminatedComment,this.state.curPosition())}flowEnumErrorBooleanMemberNotInitialized(e,{enumName:t,memberName:s}){this.raise(ot.EnumBooleanMemberNotInitialized,e,{memberName:s,enumName:t})}flowEnumErrorInvalidMemberInitializer(e,t){return this.raise(t.explicitType?"symbol"===t.explicitType?ot.EnumInvalidMemberInitializerSymbolType:ot.EnumInvalidMemberInitializerPrimaryType:ot.EnumInvalidMemberInitializerUnknownType,e,t)}flowEnumErrorNumberMemberNotInitialized(e,t){this.raise(ot.EnumNumberMemberNotInitialized,e,t)}flowEnumErrorStringMemberInconsistentlyInitialized(e,t){this.raise(ot.EnumStringMemberInconsistentlyInitialized,e,t)}flowEnumMemberInit(){const e=this.state.startLoc,t=()=>this.match(12)||this.match(8);switch(this.state.type){case 134:{const s=this.parseNumericLiteral(this.state.value);return t()?{type:"number",loc:s.loc.start,value:s}:{type:"invalid",loc:e}}case 133:{const s=this.parseStringLiteral(this.state.value);return t()?{type:"string",loc:s.loc.start,value:s}:{type:"invalid",loc:e}}case 85:case 86:{const s=this.parseBooleanLiteral(this.match(85));return t()?{type:"boolean",loc:s.loc.start,value:s}:{type:"invalid",loc:e}}default:return{type:"invalid",loc:e}}}flowEnumMemberRaw(){const e=this.state.startLoc;return{id:this.parseIdentifier(!0),init:this.eat(29)?this.flowEnumMemberInit():{type:"none",loc:e}}}flowEnumCheckExplicitTypeMismatch(e,t,s){const{explicitType:i}=t;null!==i&&i!==s&&this.flowEnumErrorInvalidMemberInitializer(e,t)}flowEnumMembers({enumName:e,explicitType:t}){const s=new Set,i={booleanMembers:[],numberMembers:[],stringMembers:[],defaultedMembers:[]};let r=!1;for(;!this.match(8);){if(this.eat(21)){r=!0;break}const n=this.startNode(),{id:a,init:o}=this.flowEnumMemberRaw(),h=a.name;if(""===h)continue;/^[a-z]/.test(h)&&this.raise(ot.EnumInvalidMemberName,a,{memberName:h,suggestion:h[0].toUpperCase()+h.slice(1),enumName:e}),s.has(h)&&this.raise(ot.EnumDuplicateMemberName,a,{memberName:h,enumName:e}),s.add(h);const c={enumName:e,explicitType:t,memberName:h};switch(n.id=a,o.type){case"boolean":this.flowEnumCheckExplicitTypeMismatch(o.loc,c,"boolean"),n.init=o.value,i.booleanMembers.push(this.finishNode(n,"EnumBooleanMember"));break;case"number":this.flowEnumCheckExplicitTypeMismatch(o.loc,c,"number"),n.init=o.value,i.numberMembers.push(this.finishNode(n,"EnumNumberMember"));break;case"string":this.flowEnumCheckExplicitTypeMismatch(o.loc,c,"string"),n.init=o.value,i.stringMembers.push(this.finishNode(n,"EnumStringMember"));break;case"invalid":throw this.flowEnumErrorInvalidMemberInitializer(o.loc,c);case"none":switch(t){case"boolean":this.flowEnumErrorBooleanMemberNotInitialized(o.loc,c);break;case"number":this.flowEnumErrorNumberMemberNotInitialized(o.loc,c);break;default:i.defaultedMembers.push(this.finishNode(n,"EnumDefaultedMember"))}}this.match(8)||this.expect(12)}return{members:i,hasUnknownMembers:r}}flowEnumStringMembers(e,t,{enumName:s}){if(0===e.length)return t;if(0===t.length)return e;if(t.length>e.length){for(const t of e)this.flowEnumErrorStringMemberInconsistentlyInitialized(t,{enumName:s});return t}for(const e of t)this.flowEnumErrorStringMemberInconsistentlyInitialized(e,{enumName:s});return e}flowEnumParseExplicitType({enumName:e}){if(!this.eatContextual(102))return null;if(!H(this.state.type))throw this.raise(ot.EnumInvalidExplicitTypeUnknownSupplied,this.state.startLoc,{enumName:e});const{value:t}=this.state;return this.next(),"boolean"!==t&&"number"!==t&&"string"!==t&&"symbol"!==t&&this.raise(ot.EnumInvalidExplicitType,this.state.startLoc,{enumName:e,invalidEnumType:t}),t}flowEnumBody(e,t){const s=t.name,i=t.loc.start,r=this.flowEnumParseExplicitType({enumName:s});this.expect(5);const{members:n,hasUnknownMembers:a}=this.flowEnumMembers({enumName:s,explicitType:r});switch(e.hasUnknownMembers=a,r){case"boolean":return e.explicitType=!0,e.members=n.booleanMembers,this.expect(8),this.finishNode(e,"EnumBooleanBody");case"number":return e.explicitType=!0,e.members=n.numberMembers,this.expect(8),this.finishNode(e,"EnumNumberBody");case"string":return e.explicitType=!0,e.members=this.flowEnumStringMembers(n.stringMembers,n.defaultedMembers,{enumName:s}),this.expect(8),this.finishNode(e,"EnumStringBody");case"symbol":return e.members=n.defaultedMembers,this.expect(8),this.finishNode(e,"EnumSymbolBody");default:{const t=()=>(e.members=[],this.expect(8),this.finishNode(e,"EnumStringBody"));e.explicitType=!1;const r=n.booleanMembers.length,a=n.numberMembers.length,o=n.stringMembers.length,h=n.defaultedMembers.length;if(r||a||o||h){if(r||a){if(!a&&!o&&r>=h){for(const e of n.defaultedMembers)this.flowEnumErrorBooleanMemberNotInitialized(e.loc.start,{enumName:s,memberName:e.id.name});return e.members=n.booleanMembers,this.expect(8),this.finishNode(e,"EnumBooleanBody")}if(!r&&!o&&a>=h){for(const e of n.defaultedMembers)this.flowEnumErrorNumberMemberNotInitialized(e.loc.start,{enumName:s,memberName:e.id.name});return e.members=n.numberMembers,this.expect(8),this.finishNode(e,"EnumNumberBody")}return this.raise(ot.EnumInconsistentMemberValues,i,{enumName:s}),t()}return e.members=this.flowEnumStringMembers(n.stringMembers,n.defaultedMembers,{enumName:s}),this.expect(8),this.finishNode(e,"EnumStringBody")}return t()}}}flowParseEnumDeclaration(e){const t=this.parseIdentifier();return e.id=t,e.body=this.flowEnumBody(this.startNode(),t),this.finishNode(e,"EnumDeclaration")}isLookaheadToken_lt(){const e=this.nextTokenStart();if(60===this.input.charCodeAt(e)){const t=this.input.charCodeAt(e+1);return 60!==t&&61!==t}return!1}maybeUnwrapTypeCastExpression(e){return"TypeCastExpression"===e.type?e.expression:e}},typescript:e=>class extends e{constructor(...e){super(...e),this.tsParseInOutModifiers=this.tsParseModifiers.bind(this,{allowedModifiers:["in","out"],disallowedModifiers:["const","public","private","protected","readonly","declare","abstract","override"],errorTemplate:_t.InvalidModifierOnTypeParameter}),this.tsParseConstModifier=this.tsParseModifiers.bind(this,{allowedModifiers:["const"],disallowedModifiers:["in","out"],errorTemplate:_t.InvalidModifierOnTypeParameterPositions}),this.tsParseInOutConstModifiers=this.tsParseModifiers.bind(this,{allowedModifiers:["in","out","const"],disallowedModifiers:["public","private","protected","readonly","declare","abstract","override"],errorTemplate:_t.InvalidModifierOnTypeParameter})}getScopeHandler(){return yt}tsIsIdentifier(){return H(this.state.type)}tsTokenCanFollowModifier(){return(this.match(0)||this.match(5)||this.match(55)||this.match(21)||this.match(138)||this.isLiteralPropertyName())&&!this.hasPrecedingLineBreak()}tsNextTokenCanFollowModifier(){return this.next(),this.tsTokenCanFollowModifier()}tsParseModifier(e,t){if(!H(this.state.type)&&58!==this.state.type&&75!==this.state.type)return;const s=this.state.value;if(-1!==e.indexOf(s)){if(t&&this.tsIsStartOfStaticBlocks())return;if(this.tsTryParse(this.tsNextTokenCanFollowModifier.bind(this)))return s}}tsParseModifiers({allowedModifiers:e,disallowedModifiers:t,stopOnStartOfClassStaticBlock:s,errorTemplate:i=_t.InvalidModifierOnTypeMember},r){const n=(e,t,s,i)=>{t===s&&r[i]&&this.raise(_t.InvalidModifiersOrder,e,{orderedModifiers:[s,i]})},a=(e,t,s,i)=>{(r[s]&&t===i||r[i]&&t===s)&&this.raise(_t.IncompatibleModifiers,e,{modifiers:[s,i]})};for(;;){const{startLoc:o}=this.state,h=this.tsParseModifier(e.concat(null!=t?t:[]),s);if(!h)break;xt(h)?r.accessibility?this.raise(_t.DuplicateAccessibilityModifier,o,{modifier:h}):(n(o,h,h,"override"),n(o,h,h,"static"),n(o,h,h,"readonly"),r.accessibility=h):vt(h)?(r[h]&&this.raise(_t.DuplicateModifier,o,{modifier:h}),r[h]=!0,n(o,h,"in","out")):(hasOwnProperty.call(r,h)?this.raise(_t.DuplicateModifier,o,{modifier:h}):(n(o,h,"static","readonly"),n(o,h,"static","override"),n(o,h,"override","readonly"),n(o,h,"abstract","override"),a(o,h,"declare","override"),a(o,h,"static","abstract")),r[h]=!0),null!=t&&t.includes(h)&&this.raise(i,o,{modifier:h})}}tsIsListTerminator(e){switch(e){case"EnumMembers":case"TypeMembers":return this.match(8);case"HeritageClauseElement":return this.match(5);case"TupleElementTypes":return this.match(3);case"TypeParametersOrArguments":return this.match(48)}}tsParseList(e,t){const s=[];for(;!this.tsIsListTerminator(e);)s.push(t());return s}tsParseDelimitedList(e,t,s){return function(e){if(null==e)throw new Error(`Unexpected ${e} value.`);return e}(this.tsParseDelimitedListWorker(e,t,!0,s))}tsParseDelimitedListWorker(e,t,s,i){const r=[];let n=-1;for(;!this.tsIsListTerminator(e);){n=-1;const i=t();if(null==i)return;if(r.push(i),!this.eat(12)){if(this.tsIsListTerminator(e))break;return void(s&&this.expect(12))}n=this.state.lastTokStartLoc.index}return i&&(i.value=n),r}tsParseBracketedList(e,t,s,i,r){i||(s?this.expect(0):this.expect(47));const n=this.tsParseDelimitedList(e,t,r);return s?this.expect(3):this.expect(48),n}tsParseImportType(){const e=this.startNode();return this.expect(83),this.expect(10),this.match(133)||this.raise(_t.UnsupportedImportTypeArgument,this.state.startLoc),e.argument=super.parseExprAtom(),(this.hasPlugin("importAttributes")||this.hasPlugin("importAssertions"))&&(e.options=null),this.eat(12)&&(this.expectImportAttributesPlugin(),this.match(11)||(e.options=super.parseMaybeAssignAllowIn(),this.eat(12))),this.expect(11),this.eat(16)&&(e.qualifier=this.tsParseEntityName()),this.match(47)&&(e.typeParameters=this.tsParseTypeArguments()),this.finishNode(e,"TSImportType")}tsParseEntityName(e=!0){let t=this.parseIdentifier(e);for(;this.eat(16);){const s=this.startNodeAtNode(t);s.left=t,s.right=this.parseIdentifier(e),t=this.finishNode(s,"TSQualifiedName")}return t}tsParseTypeReference(){const e=this.startNode();return e.typeName=this.tsParseEntityName(),!this.hasPrecedingLineBreak()&&this.match(47)&&(e.typeParameters=this.tsParseTypeArguments()),this.finishNode(e,"TSTypeReference")}tsParseThisTypePredicate(e){this.next();const t=this.startNodeAtNode(e);return t.parameterName=e,t.typeAnnotation=this.tsParseTypeAnnotation(!1),t.asserts=!1,this.finishNode(t,"TSTypePredicate")}tsParseThisTypeNode(){const e=this.startNode();return this.next(),this.finishNode(e,"TSThisType")}tsParseTypeQuery(){const e=this.startNode();return this.expect(87),this.match(83)?e.exprName=this.tsParseImportType():e.exprName=this.tsParseEntityName(),!this.hasPrecedingLineBreak()&&this.match(47)&&(e.typeParameters=this.tsParseTypeArguments()),this.finishNode(e,"TSTypeQuery")}tsParseTypeParameter(e){const t=this.startNode();return e(t),t.name=this.tsParseTypeParameterName(),t.constraint=this.tsEatThenParseType(81),t.default=this.tsEatThenParseType(29),this.finishNode(t,"TSTypeParameter")}tsTryParseTypeParameters(e){if(this.match(47))return this.tsParseTypeParameters(e)}tsParseTypeParameters(e){const t=this.startNode();this.match(47)||this.match(142)?this.next():this.unexpected();const s={value:-1};return t.params=this.tsParseBracketedList("TypeParametersOrArguments",this.tsParseTypeParameter.bind(this,e),!1,!0,s),0===t.params.length&&this.raise(_t.EmptyTypeParameters,t),-1!==s.value&&this.addExtra(t,"trailingComma",s.value),this.finishNode(t,"TSTypeParameterDeclaration")}tsFillSignature(e,t){const s=19===e;t.typeParameters=this.tsTryParseTypeParameters(this.tsParseConstModifier),this.expect(10),t.parameters=this.tsParseBindingListForSignature(),(s||this.match(e))&&(t.typeAnnotation=this.tsParseTypeOrTypePredicateAnnotation(e))}tsParseBindingListForSignature(){const e=super.parseBindingList(11,41,2);for(const t of e){const{type:e}=t;"AssignmentPattern"!==e&&"TSParameterProperty"!==e||this.raise(_t.UnsupportedSignatureParameterKind,t,{type:e})}return e}tsParseTypeMemberSemicolon(){this.eat(12)||this.isLineTerminator()||this.expect(13)}tsParseSignatureMember(e,t){return this.tsFillSignature(14,t),this.tsParseTypeMemberSemicolon(),this.finishNode(t,e)}tsIsUnambiguouslyIndexSignature(){return this.next(),!!H(this.state.type)&&(this.next(),this.match(14))}tsTryParseIndexSignature(e){if(!this.match(0)||!this.tsLookAhead(this.tsIsUnambiguouslyIndexSignature.bind(this)))return;this.expect(0);const t=this.parseIdentifier();t.typeAnnotation=this.tsParseTypeAnnotation(),this.resetEndLocation(t),this.expect(3),e.parameters=[t];const s=this.tsTryParseTypeAnnotation();return s&&(e.typeAnnotation=s),this.tsParseTypeMemberSemicolon(),this.finishNode(e,"TSIndexSignature")}tsParsePropertyOrMethodSignature(e,t){this.eat(17)&&(e.optional=!0);const s=e;if(this.match(10)||this.match(47)){t&&this.raise(_t.ReadonlyForMethodSignature,e);const i=s;i.kind&&this.match(47)&&this.raise(_t.AccesorCannotHaveTypeParameters,this.state.curPosition()),this.tsFillSignature(14,i),this.tsParseTypeMemberSemicolon();const r="parameters",n="typeAnnotation";if("get"===i.kind)i[r].length>0&&(this.raise(b.BadGetterArity,this.state.curPosition()),this.isThisParam(i[r][0])&&this.raise(_t.AccesorCannotDeclareThisParameter,this.state.curPosition()));else if("set"===i.kind){if(1!==i[r].length)this.raise(b.BadSetterArity,this.state.curPosition());else{const e=i[r][0];this.isThisParam(e)&&this.raise(_t.AccesorCannotDeclareThisParameter,this.state.curPosition()),"Identifier"===e.type&&e.optional&&this.raise(_t.SetAccesorCannotHaveOptionalParameter,this.state.curPosition()),"RestElement"===e.type&&this.raise(_t.SetAccesorCannotHaveRestParameter,this.state.curPosition())}i[n]&&this.raise(_t.SetAccesorCannotHaveReturnType,i[n])}else i.kind="method";return this.finishNode(i,"TSMethodSignature")}{const e=s;t&&(e.readonly=!0);const i=this.tsTryParseTypeAnnotation();return i&&(e.typeAnnotation=i),this.tsParseTypeMemberSemicolon(),this.finishNode(e,"TSPropertySignature")}}tsParseTypeMember(){const e=this.startNode();if(this.match(10)||this.match(47))return this.tsParseSignatureMember("TSCallSignatureDeclaration",e);if(this.match(77)){const t=this.startNode();return this.next(),this.match(10)||this.match(47)?this.tsParseSignatureMember("TSConstructSignatureDeclaration",e):(e.key=this.createIdentifier(t,"new"),this.tsParsePropertyOrMethodSignature(e,!1))}this.tsParseModifiers({allowedModifiers:["readonly"],disallowedModifiers:["declare","abstract","private","protected","public","static","override"]},e);return this.tsTryParseIndexSignature(e)||(super.parsePropertyName(e),e.computed||"Identifier"!==e.key.type||"get"!==e.key.name&&"set"!==e.key.name||!this.tsTokenCanFollowModifier()||(e.kind=e.key.name,super.parsePropertyName(e)),this.tsParsePropertyOrMethodSignature(e,!!e.readonly))}tsParseTypeLiteral(){const e=this.startNode();return e.members=this.tsParseObjectTypeMembers(),this.finishNode(e,"TSTypeLiteral")}tsParseObjectTypeMembers(){this.expect(5);const e=this.tsParseList("TypeMembers",this.tsParseTypeMember.bind(this));return this.expect(8),e}tsIsStartOfMappedType(){return this.next(),this.eat(53)?this.isContextual(122):(this.isContextual(122)&&this.next(),!!this.match(0)&&(this.next(),!!this.tsIsIdentifier()&&(this.next(),this.match(58))))}tsParseMappedTypeParameter(){const e=this.startNode();return e.name=this.tsParseTypeParameterName(),e.constraint=this.tsExpectThenParseType(58),this.finishNode(e,"TSTypeParameter")}tsParseMappedType(){const e=this.startNode();return this.expect(5),this.match(53)?(e.readonly=this.state.value,this.next(),this.expectContextual(122)):this.eatContextual(122)&&(e.readonly=!0),this.expect(0),e.typeParameter=this.tsParseMappedTypeParameter(),e.nameType=this.eatContextual(93)?this.tsParseType():null,this.expect(3),this.match(53)?(e.optional=this.state.value,this.next(),this.expect(17)):this.eat(17)&&(e.optional=!0),e.typeAnnotation=this.tsTryParseType(),this.semicolon(),this.expect(8),this.finishNode(e,"TSMappedType")}tsParseTupleType(){const e=this.startNode();e.elementTypes=this.tsParseBracketedList("TupleElementTypes",this.tsParseTupleElementType.bind(this),!0,!1);let t=!1;return e.elementTypes.forEach((e=>{const{type:s}=e;!t||"TSRestType"===s||"TSOptionalType"===s||"TSNamedTupleMember"===s&&e.optional||this.raise(_t.OptionalTypeBeforeRequired,e),t||(t="TSNamedTupleMember"===s&&e.optional||"TSOptionalType"===s)})),this.finishNode(e,"TSTupleType")}tsParseTupleElementType(){const{startLoc:e}=this.state,t=this.eat(21);let s,i,r,n;const a=V(this.state.type)?this.lookaheadCharCode():null;if(58===a)s=!0,r=!1,i=this.parseIdentifier(!0),this.expect(14),n=this.tsParseType();else if(63===a){r=!0;const e=this.state.startLoc,t=this.state.value,a=this.tsParseNonArrayType();58===this.lookaheadCharCode()?(s=!0,i=this.createIdentifier(this.startNodeAt(e),t),this.expect(17),this.expect(14),n=this.tsParseType()):(s=!1,n=a,this.expect(17))}else n=this.tsParseType(),r=this.eat(17),s=this.eat(14);if(s){let e;i?(e=this.startNodeAtNode(i),e.optional=r,e.label=i,e.elementType=n,this.eat(17)&&(e.optional=!0,this.raise(_t.TupleOptionalAfterType,this.state.lastTokStartLoc))):(e=this.startNodeAtNode(n),e.optional=r,this.raise(_t.InvalidTupleMemberLabel,n),e.label=n,e.elementType=this.tsParseType()),n=this.finishNode(e,"TSNamedTupleMember")}else if(r){const e=this.startNodeAtNode(n);e.typeAnnotation=n,n=this.finishNode(e,"TSOptionalType")}if(t){const t=this.startNodeAt(e);t.typeAnnotation=n,n=this.finishNode(t,"TSRestType")}return n}tsParseParenthesizedType(){const e=this.startNode();return this.expect(10),e.typeAnnotation=this.tsParseType(),this.expect(11),this.finishNode(e,"TSParenthesizedType")}tsParseFunctionOrConstructorType(e,t){const s=this.startNode();return"TSConstructorType"===e&&(s.abstract=!!t,t&&this.next(),this.next()),this.tsInAllowConditionalTypesContext((()=>this.tsFillSignature(19,s))),this.finishNode(s,e)}tsParseLiteralTypeNode(){const e=this.startNode();switch(this.state.type){case 134:case 135:case 133:case 85:case 86:e.literal=super.parseExprAtom();break;default:this.unexpected()}return this.finishNode(e,"TSLiteralType")}tsParseTemplateLiteralType(){const e=this.startNode();return e.literal=super.parseTemplate(!1),this.finishNode(e,"TSLiteralType")}parseTemplateSubstitution(){return this.state.inType?this.tsParseType():super.parseTemplateSubstitution()}tsParseThisTypeOrThisTypePredicate(){const e=this.tsParseThisTypeNode();return this.isContextual(116)&&!this.hasPrecedingLineBreak()?this.tsParseThisTypePredicate(e):e}tsParseNonArrayType(){switch(this.state.type){case 133:case 134:case 135:case 85:case 86:return this.tsParseLiteralTypeNode();case 53:if("-"===this.state.value){const e=this.startNode(),t=this.lookahead();return 134!==t.type&&135!==t.type&&this.unexpected(),e.literal=this.parseMaybeUnary(),this.finishNode(e,"TSLiteralType")}break;case 78:return this.tsParseThisTypeOrThisTypePredicate();case 87:return this.tsParseTypeQuery();case 83:return this.tsParseImportType();case 5:return this.tsLookAhead(this.tsIsStartOfMappedType.bind(this))?this.tsParseMappedType():this.tsParseTypeLiteral();case 0:return this.tsParseTupleType();case 10:return this.tsParseParenthesizedType();case 25:case 24:return this.tsParseTemplateLiteralType();default:{const{type:e}=this.state;if(H(e)||88===e||84===e){const t=88===e?"TSVoidKeyword":84===e?"TSNullKeyword":function(e){switch(e){case"any":return"TSAnyKeyword";case"boolean":return"TSBooleanKeyword";case"bigint":return"TSBigIntKeyword";case"never":return"TSNeverKeyword";case"number":return"TSNumberKeyword";case"object":return"TSObjectKeyword";case"string":return"TSStringKeyword";case"symbol":return"TSSymbolKeyword";case"undefined":return"TSUndefinedKeyword";case"unknown":return"TSUnknownKeyword";default:return}}(this.state.value);if(void 0!==t&&46!==this.lookaheadCharCode()){const e=this.startNode();return this.next(),this.finishNode(e,t)}return this.tsParseTypeReference()}}}this.unexpected()}tsParseArrayTypeOrHigher(){let e=this.tsParseNonArrayType();for(;!this.hasPrecedingLineBreak()&&this.eat(0);)if(this.match(3)){const t=this.startNodeAtNode(e);t.elementType=e,this.expect(3),e=this.finishNode(t,"TSArrayType")}else{const t=this.startNodeAtNode(e);t.objectType=e,t.indexType=this.tsParseType(),this.expect(3),e=this.finishNode(t,"TSIndexedAccessType")}return e}tsParseTypeOperator(){const e=this.startNode(),t=this.state.value;return this.next(),e.operator=t,e.typeAnnotation=this.tsParseTypeOperatorOrHigher(),"readonly"===t&&this.tsCheckTypeAnnotationForReadOnly(e),this.finishNode(e,"TSTypeOperator")}tsCheckTypeAnnotationForReadOnly(e){switch(e.typeAnnotation.type){case"TSTupleType":case"TSArrayType":return;default:this.raise(_t.UnexpectedReadonly,e)}}tsParseInferType(){const e=this.startNode();this.expectContextual(115);const t=this.startNode();return t.name=this.tsParseTypeParameterName(),t.constraint=this.tsTryParse((()=>this.tsParseConstraintForInferType())),e.typeParameter=this.finishNode(t,"TSTypeParameter"),this.finishNode(e,"TSInferType")}tsParseConstraintForInferType(){if(this.eat(81)){const e=this.tsInDisallowConditionalTypesContext((()=>this.tsParseType()));if(this.state.inDisallowConditionalTypesContext||!this.match(17))return e}}tsParseTypeOperatorOrHigher(){var e;return(e=this.state.type)>=121&&e<=123&&!this.state.containsEsc?this.tsParseTypeOperator():this.isContextual(115)?this.tsParseInferType():this.tsInAllowConditionalTypesContext((()=>this.tsParseArrayTypeOrHigher()))}tsParseUnionOrIntersectionType(e,t,s){const i=this.startNode(),r=this.eat(s),n=[];do{n.push(t())}while(this.eat(s));return 1!==n.length||r?(i.types=n,this.finishNode(i,e)):n[0]}tsParseIntersectionTypeOrHigher(){return this.tsParseUnionOrIntersectionType("TSIntersectionType",this.tsParseTypeOperatorOrHigher.bind(this),45)}tsParseUnionTypeOrHigher(){return this.tsParseUnionOrIntersectionType("TSUnionType",this.tsParseIntersectionTypeOrHigher.bind(this),43)}tsIsStartOfFunctionType(){return!!this.match(47)||this.match(10)&&this.tsLookAhead(this.tsIsUnambiguouslyStartOfFunctionType.bind(this))}tsSkipParameterStart(){if(H(this.state.type)||this.match(78))return this.next(),!0;if(this.match(5)){const{errors:e}=this.state,t=e.length;try{return this.parseObjectLike(8,!0),e.length===t}catch(e){return!1}}if(this.match(0)){this.next();const{errors:e}=this.state,t=e.length;try{return super.parseBindingList(3,93,1),e.length===t}catch(e){return!1}}return!1}tsIsUnambiguouslyStartOfFunctionType(){if(this.next(),this.match(11)||this.match(21))return!0;if(this.tsSkipParameterStart()){if(this.match(14)||this.match(12)||this.match(17)||this.match(29))return!0;if(this.match(11)&&(this.next(),this.match(19)))return!0}return!1}tsParseTypeOrTypePredicateAnnotation(e){return this.tsInType((()=>{const t=this.startNode();this.expect(e);const s=this.startNode(),i=!!this.tsTryParse(this.tsParseTypePredicateAsserts.bind(this));if(i&&this.match(78)){let e=this.tsParseThisTypeOrThisTypePredicate();return"TSThisType"===e.type?(s.parameterName=e,s.asserts=!0,s.typeAnnotation=null,e=this.finishNode(s,"TSTypePredicate")):(this.resetStartLocationFromNode(e,s),e.asserts=!0),t.typeAnnotation=e,this.finishNode(t,"TSTypeAnnotation")}const r=this.tsIsIdentifier()&&this.tsTryParse(this.tsParseTypePredicatePrefix.bind(this));if(!r)return i?(s.parameterName=this.parseIdentifier(),s.asserts=i,s.typeAnnotation=null,t.typeAnnotation=this.finishNode(s,"TSTypePredicate"),this.finishNode(t,"TSTypeAnnotation")):this.tsParseTypeAnnotation(!1,t);const n=this.tsParseTypeAnnotation(!1);return s.parameterName=r,s.typeAnnotation=n,s.asserts=i,t.typeAnnotation=this.finishNode(s,"TSTypePredicate"),this.finishNode(t,"TSTypeAnnotation")}))}tsTryParseTypeOrTypePredicateAnnotation(){if(this.match(14))return this.tsParseTypeOrTypePredicateAnnotation(14)}tsTryParseTypeAnnotation(){if(this.match(14))return this.tsParseTypeAnnotation()}tsTryParseType(){return this.tsEatThenParseType(14)}tsParseTypePredicatePrefix(){const e=this.parseIdentifier();if(this.isContextual(116)&&!this.hasPrecedingLineBreak())return this.next(),e}tsParseTypePredicateAsserts(){if(109!==this.state.type)return!1;const e=this.state.containsEsc;return this.next(),!(!H(this.state.type)&&!this.match(78)||(e&&this.raise(b.InvalidEscapedReservedWord,this.state.lastTokStartLoc,{reservedWord:"asserts"}),0))}tsParseTypeAnnotation(e=!0,t=this.startNode()){return this.tsInType((()=>{e&&this.expect(14),t.typeAnnotation=this.tsParseType()})),this.finishNode(t,"TSTypeAnnotation")}tsParseType(){wt(this.state.inType);const e=this.tsParseNonConditionalType();if(this.state.inDisallowConditionalTypesContext||this.hasPrecedingLineBreak()||!this.eat(81))return e;const t=this.startNodeAtNode(e);return t.checkType=e,t.extendsType=this.tsInDisallowConditionalTypesContext((()=>this.tsParseNonConditionalType())),this.expect(17),t.trueType=this.tsInAllowConditionalTypesContext((()=>this.tsParseType())),this.expect(14),t.falseType=this.tsInAllowConditionalTypesContext((()=>this.tsParseType())),this.finishNode(t,"TSConditionalType")}isAbstractConstructorSignature(){return this.isContextual(124)&&77===this.lookahead().type}tsParseNonConditionalType(){return this.tsIsStartOfFunctionType()?this.tsParseFunctionOrConstructorType("TSFunctionType"):this.match(77)?this.tsParseFunctionOrConstructorType("TSConstructorType"):this.isAbstractConstructorSignature()?this.tsParseFunctionOrConstructorType("TSConstructorType",!0):this.tsParseUnionTypeOrHigher()}tsParseTypeAssertion(){this.getPluginOption("typescript","disallowAmbiguousJSXLike")&&this.raise(_t.ReservedTypeAssertion,this.state.startLoc);const e=this.startNode();return e.typeAnnotation=this.tsInType((()=>(this.next(),this.match(75)?this.tsParseTypeReference():this.tsParseType()))),this.expect(48),e.expression=this.parseMaybeUnary(),this.finishNode(e,"TSTypeAssertion")}tsParseHeritageClause(e){const t=this.state.startLoc,s=this.tsParseDelimitedList("HeritageClauseElement",(()=>{const e=this.startNode();return e.expression=this.tsParseEntityName(),this.match(47)&&(e.typeParameters=this.tsParseTypeArguments()),this.finishNode(e,"TSExpressionWithTypeArguments")}));return s.length||this.raise(_t.EmptyHeritageClauseType,t,{token:e}),s}tsParseInterfaceDeclaration(e,t={}){if(this.hasFollowingLineBreak())return null;this.expectContextual(129),t.declare&&(e.declare=!0),H(this.state.type)?(e.id=this.parseIdentifier(),this.checkIdentifier(e.id,130)):(e.id=null,this.raise(_t.MissingInterfaceName,this.state.startLoc)),e.typeParameters=this.tsTryParseTypeParameters(this.tsParseInOutConstModifiers),this.eat(81)&&(e.extends=this.tsParseHeritageClause("extends"));const s=this.startNode();return s.body=this.tsInType(this.tsParseObjectTypeMembers.bind(this)),e.body=this.finishNode(s,"TSInterfaceBody"),this.finishNode(e,"TSInterfaceDeclaration")}tsParseTypeAliasDeclaration(e){return e.id=this.parseIdentifier(),this.checkIdentifier(e.id,2),e.typeAnnotation=this.tsInType((()=>{if(e.typeParameters=this.tsTryParseTypeParameters(this.tsParseInOutModifiers),this.expect(29),this.isContextual(114)&&16!==this.lookahead().type){const e=this.startNode();return this.next(),this.finishNode(e,"TSIntrinsicKeyword")}return this.tsParseType()})),this.semicolon(),this.finishNode(e,"TSTypeAliasDeclaration")}tsInNoContext(e){const t=this.state.context;this.state.context=[t[0]];try{return e()}finally{this.state.context=t}}tsInType(e){const t=this.state.inType;this.state.inType=!0;try{return e()}finally{this.state.inType=t}}tsInDisallowConditionalTypesContext(e){const t=this.state.inDisallowConditionalTypesContext;this.state.inDisallowConditionalTypesContext=!0;try{return e()}finally{this.state.inDisallowConditionalTypesContext=t}}tsInAllowConditionalTypesContext(e){const t=this.state.inDisallowConditionalTypesContext;this.state.inDisallowConditionalTypesContext=!1;try{return e()}finally{this.state.inDisallowConditionalTypesContext=t}}tsEatThenParseType(e){if(this.match(e))return this.tsNextThenParseType()}tsExpectThenParseType(e){return this.tsInType((()=>(this.expect(e),this.tsParseType())))}tsNextThenParseType(){return this.tsInType((()=>(this.next(),this.tsParseType())))}tsParseEnumMember(){const e=this.startNode();return e.id=this.match(133)?super.parseStringLiteral(this.state.value):this.parseIdentifier(!0),this.eat(29)&&(e.initializer=super.parseMaybeAssignAllowIn()),this.finishNode(e,"TSEnumMember")}tsParseEnumDeclaration(e,t={}){return t.const&&(e.const=!0),t.declare&&(e.declare=!0),this.expectContextual(126),e.id=this.parseIdentifier(),this.checkIdentifier(e.id,e.const?8971:8459),this.expect(5),e.members=this.tsParseDelimitedList("EnumMembers",this.tsParseEnumMember.bind(this)),this.expect(8),this.finishNode(e,"TSEnumDeclaration")}tsParseModuleBlock(){const e=this.startNode();return this.scope.enter(0),this.expect(5),super.parseBlockOrModuleBlockBody(e.body=[],void 0,!0,8),this.scope.exit(),this.finishNode(e,"TSModuleBlock")}tsParseModuleOrNamespaceDeclaration(e,t=!1){if(e.id=this.parseIdentifier(),t||this.checkIdentifier(e.id,1024),this.eat(16)){const t=this.startNode();this.tsParseModuleOrNamespaceDeclaration(t,!0),e.body=t}else this.scope.enter(256),this.prodParam.enter(0),e.body=this.tsParseModuleBlock(),this.prodParam.exit(),this.scope.exit();return this.finishNode(e,"TSModuleDeclaration")}tsParseAmbientExternalModuleDeclaration(e){return this.isContextual(112)?(e.global=!0,e.id=this.parseIdentifier()):this.match(133)?e.id=super.parseStringLiteral(this.state.value):this.unexpected(),this.match(5)?(this.scope.enter(256),this.prodParam.enter(0),e.body=this.tsParseModuleBlock(),this.prodParam.exit(),this.scope.exit()):this.semicolon(),this.finishNode(e,"TSModuleDeclaration")}tsParseImportEqualsDeclaration(e,t,s){e.isExport=s||!1,e.id=t||this.parseIdentifier(),this.checkIdentifier(e.id,4096),this.expect(29);const i=this.tsParseModuleReference();return"type"===e.importKind&&"TSExternalModuleReference"!==i.type&&this.raise(_t.ImportAliasHasImportType,i),e.moduleReference=i,this.semicolon(),this.finishNode(e,"TSImportEqualsDeclaration")}tsIsExternalModuleReference(){return this.isContextual(119)&&40===this.lookaheadCharCode()}tsParseModuleReference(){return this.tsIsExternalModuleReference()?this.tsParseExternalModuleReference():this.tsParseEntityName(!1)}tsParseExternalModuleReference(){const e=this.startNode();return this.expectContextual(119),this.expect(10),this.match(133)||this.unexpected(),e.expression=super.parseExprAtom(),this.expect(11),this.sawUnambiguousESM=!0,this.finishNode(e,"TSExternalModuleReference")}tsLookAhead(e){const t=this.state.clone(),s=e();return this.state=t,s}tsTryParseAndCatch(e){const t=this.tryParse((t=>e()||t()));if(!t.aborted&&t.node)return t.error&&(this.state=t.failState),t.node}tsTryParse(e){const t=this.state.clone(),s=e();if(void 0!==s&&!1!==s)return s;this.state=t}tsTryParseDeclare(e){if(this.isLineTerminator())return;let t,s=this.state.type;return this.isContextual(100)&&(s=74,t="let"),this.tsInAmbientContext((()=>{switch(s){case 68:return e.declare=!0,super.parseFunctionStatement(e,!1,!1);case 80:return e.declare=!0,this.parseClass(e,!0,!1);case 126:return this.tsParseEnumDeclaration(e,{declare:!0});case 112:return this.tsParseAmbientExternalModuleDeclaration(e);case 75:case 74:return this.match(75)&&this.isLookaheadContextual("enum")?(this.expect(75),this.tsParseEnumDeclaration(e,{const:!0,declare:!0})):(e.declare=!0,this.parseVarStatement(e,t||this.state.value,!0));case 129:{const t=this.tsParseInterfaceDeclaration(e,{declare:!0});if(t)return t}default:if(H(s))return this.tsParseDeclaration(e,this.state.value,!0,null)}}))}tsTryParseExportDeclaration(){return this.tsParseDeclaration(this.startNode(),this.state.value,!0,null)}tsParseExpressionStatement(e,t,s){switch(t.name){case"declare":{const t=this.tsTryParseDeclare(e);return t&&(t.declare=!0),t}case"global":if(this.match(5)){this.scope.enter(256),this.prodParam.enter(0);const s=e;return s.global=!0,s.id=t,s.body=this.tsParseModuleBlock(),this.scope.exit(),this.prodParam.exit(),this.finishNode(s,"TSModuleDeclaration")}break;default:return this.tsParseDeclaration(e,t.name,!1,s)}}tsParseDeclaration(e,t,s,i){switch(t){case"abstract":if(this.tsCheckLineTerminator(s)&&(this.match(80)||H(this.state.type)))return this.tsParseAbstractDeclaration(e,i);break;case"module":if(this.tsCheckLineTerminator(s)){if(this.match(133))return this.tsParseAmbientExternalModuleDeclaration(e);if(H(this.state.type))return this.tsParseModuleOrNamespaceDeclaration(e)}break;case"namespace":if(this.tsCheckLineTerminator(s)&&H(this.state.type))return this.tsParseModuleOrNamespaceDeclaration(e);break;case"type":if(this.tsCheckLineTerminator(s)&&H(this.state.type))return this.tsParseTypeAliasDeclaration(e)}}tsCheckLineTerminator(e){return e?!this.hasFollowingLineBreak()&&(this.next(),!0):!this.isLineTerminator()}tsTryParseGenericAsyncArrowFunction(e){if(!this.match(47))return;const t=this.state.maybeInArrowParameters;this.state.maybeInArrowParameters=!0;const s=this.tsTryParseAndCatch((()=>{const t=this.startNodeAt(e);return t.typeParameters=this.tsParseTypeParameters(this.tsParseConstModifier),super.parseFunctionParams(t),t.returnType=this.tsTryParseTypeOrTypePredicateAnnotation(),this.expect(19),t}));return this.state.maybeInArrowParameters=t,s?super.parseArrowExpression(s,null,!0):void 0}tsParseTypeArgumentsInExpression(){if(47===this.reScan_lt())return this.tsParseTypeArguments()}tsParseTypeArguments(){const e=this.startNode();return e.params=this.tsInType((()=>this.tsInNoContext((()=>(this.expect(47),this.tsParseDelimitedList("TypeParametersOrArguments",this.tsParseType.bind(this))))))),0===e.params.length?this.raise(_t.EmptyTypeArguments,e):this.state.inType||this.curContext()!==P.brace||this.reScan_lt_gt(),this.expect(48),this.finishNode(e,"TSTypeParameterInstantiation")}tsIsDeclarationStart(){return(e=this.state.type)>=124&&e<=130;var e}isExportDefaultSpecifier(){return!this.tsIsDeclarationStart()&&super.isExportDefaultSpecifier()}parseAssignableListItem(e,t){const s=this.state.startLoc,i={};this.tsParseModifiers({allowedModifiers:["public","private","protected","override","readonly"]},i);const r=i.accessibility,n=i.override,a=i.readonly;4&e||!(r||a||n)||this.raise(_t.UnexpectedParameterModifier,s);const o=this.parseMaybeDefault();this.parseAssignableListItemTypes(o,e);const h=this.parseMaybeDefault(o.loc.start,o);if(r||a||n){const e=this.startNodeAt(s);return t.length&&(e.decorators=t),r&&(e.accessibility=r),a&&(e.readonly=a),n&&(e.override=n),"Identifier"!==h.type&&"AssignmentPattern"!==h.type&&this.raise(_t.UnsupportedParameterPropertyKind,e),e.parameter=h,this.finishNode(e,"TSParameterProperty")}return t.length&&(o.decorators=t),h}isSimpleParameter(e){return"TSParameterProperty"===e.type&&super.isSimpleParameter(e.parameter)||super.isSimpleParameter(e)}tsDisallowOptionalPattern(e){for(const t of e.params)"Identifier"!==t.type&&t.optional&&!this.state.isAmbientContext&&this.raise(_t.PatternIsOptional,t)}setArrowFunctionParameters(e,t,s){super.setArrowFunctionParameters(e,t,s),this.tsDisallowOptionalPattern(e)}parseFunctionBodyAndFinish(e,t,s=!1){this.match(14)&&(e.returnType=this.tsParseTypeOrTypePredicateAnnotation(14));const i="FunctionDeclaration"===t?"TSDeclareFunction":"ClassMethod"===t||"ClassPrivateMethod"===t?"TSDeclareMethod":void 0;return i&&!this.match(5)&&this.isLineTerminator()?this.finishNode(e,i):"TSDeclareFunction"===i&&this.state.isAmbientContext&&(this.raise(_t.DeclareFunctionHasImplementation,e),e.declare)?super.parseFunctionBodyAndFinish(e,i,s):(this.tsDisallowOptionalPattern(e),super.parseFunctionBodyAndFinish(e,t,s))}registerFunctionStatementId(e){!e.body&&e.id?this.checkIdentifier(e.id,1024):super.registerFunctionStatementId(e)}tsCheckForInvalidTypeCasts(e){e.forEach((e=>{"TSTypeCastExpression"===(null==e?void 0:e.type)&&this.raise(_t.UnexpectedTypeAnnotation,e.typeAnnotation)}))}toReferencedList(e,t){return this.tsCheckForInvalidTypeCasts(e),e}parseArrayLike(e,t,s,i){const r=super.parseArrayLike(e,t,s,i);return"ArrayExpression"===r.type&&this.tsCheckForInvalidTypeCasts(r.elements),r}parseSubscript(e,t,s,i){if(!this.hasPrecedingLineBreak()&&this.match(35)){this.state.canStartJSXElement=!1,this.next();const s=this.startNodeAt(t);return s.expression=e,this.finishNode(s,"TSNonNullExpression")}let r=!1;if(this.match(18)&&60===this.lookaheadCharCode()){if(s)return i.stop=!0,e;i.optionalChainMember=r=!0,this.next()}if(this.match(47)||this.match(51)){let n;const a=this.tsTryParseAndCatch((()=>{if(!s&&this.atPossibleAsyncArrow(e)){const e=this.tsTryParseGenericAsyncArrowFunction(t);if(e)return e}const a=this.tsParseTypeArgumentsInExpression();if(!a)return;if(r&&!this.match(10))return void(n=this.state.curPosition());if(Z(this.state.type)){const s=super.parseTaggedTemplateExpression(e,t,i);return s.typeParameters=a,s}if(!s&&this.eat(10)){const s=this.startNodeAt(t);return s.callee=e,s.arguments=this.parseCallExpressionArguments(11,!1),this.tsCheckForInvalidTypeCasts(s.arguments),s.typeParameters=a,i.optionalChainMember&&(s.optional=r),this.finishCallExpression(s,i.optionalChainMember)}const o=this.state.type;if(48===o||52===o||10!==o&&$(o)&&!this.hasPrecedingLineBreak())return;const h=this.startNodeAt(t);return h.expression=e,h.typeParameters=a,this.finishNode(h,"TSInstantiationExpression")}));if(n&&this.unexpected(n,10),a)return"TSInstantiationExpression"===a.type&&(this.match(16)||this.match(18)&&40!==this.lookaheadCharCode())&&this.raise(_t.InvalidPropertyAccessAfterInstantiationExpression,this.state.startLoc),a}return super.parseSubscript(e,t,s,i)}parseNewCallee(e){var t;super.parseNewCallee(e);const{callee:s}=e;"TSInstantiationExpression"!==s.type||null!=(t=s.extra)&&t.parenthesized||(e.typeParameters=s.typeParameters,e.callee=s.expression)}parseExprOp(e,t,s){let i;if(J(58)>s&&!this.hasPrecedingLineBreak()&&(this.isContextual(93)||(i=this.isContextual(120)))){const r=this.startNodeAt(t);return r.expression=e,r.typeAnnotation=this.tsInType((()=>(this.next(),this.match(75)?(i&&this.raise(b.UnexpectedKeyword,this.state.startLoc,{keyword:"const"}),this.tsParseTypeReference()):this.tsParseType()))),this.finishNode(r,i?"TSSatisfiesExpression":"TSAsExpression"),this.reScan_lt_gt(),this.parseExprOp(r,t,s)}return super.parseExprOp(e,t,s)}checkReservedWord(e,t,s,i){this.state.isAmbientContext||super.checkReservedWord(e,t,s,i)}checkImportReflection(e){super.checkImportReflection(e),e.module&&"value"!==e.importKind&&this.raise(_t.ImportReflectionHasImportType,e.specifiers[0].loc.start)}checkDuplicateExports(){}isPotentialImportPhase(e){if(super.isPotentialImportPhase(e))return!0;if(this.isContextual(130)){const t=this.lookaheadCharCode();return e?123===t||42===t:61!==t}return!e&&this.isContextual(87)}applyImportPhase(e,t,s,i){super.applyImportPhase(e,t,s,i),t?e.exportKind="type"===s?"type":"value":e.importKind="type"===s||"typeof"===s?s:"value"}parseImport(e){if(this.match(133))return e.importKind="value",super.parseImport(e);let t;if(H(this.state.type)&&61===this.lookaheadCharCode())return e.importKind="value",this.tsParseImportEqualsDeclaration(e);if(this.isContextual(130)){const s=this.parseMaybeImportPhase(e,!1);if(61===this.lookaheadCharCode())return this.tsParseImportEqualsDeclaration(e,s);t=super.parseImportSpecifiersAndAfter(e,s)}else t=super.parseImport(e);return"type"===t.importKind&&t.specifiers.length>1&&"ImportDefaultSpecifier"===t.specifiers[0].type&&this.raise(_t.TypeImportCannotSpecifyDefaultAndNamed,t),t}parseExport(e,t){if(this.match(83)){this.next();let t=null;return this.isContextual(130)&&this.isPotentialImportPhase(!1)?t=this.parseMaybeImportPhase(e,!1):e.importKind="value",this.tsParseImportEqualsDeclaration(e,t,!0)}if(this.eat(29)){const t=e;return t.expression=super.parseExpression(),this.semicolon(),this.sawUnambiguousESM=!0,this.finishNode(t,"TSExportAssignment")}if(this.eatContextual(93)){const t=e;return this.expectContextual(128),t.id=this.parseIdentifier(),this.semicolon(),this.finishNode(t,"TSNamespaceExportDeclaration")}return super.parseExport(e,t)}isAbstractClass(){return this.isContextual(124)&&80===this.lookahead().type}parseExportDefaultExpression(){if(this.isAbstractClass()){const e=this.startNode();return this.next(),e.abstract=!0,this.parseClass(e,!0,!0)}if(this.match(129)){const e=this.tsParseInterfaceDeclaration(this.startNode());if(e)return e}return super.parseExportDefaultExpression()}parseVarStatement(e,t,s=!1){const{isAmbientContext:i}=this.state,r=super.parseVarStatement(e,t,s||i);if(!i)return r;for(const{id:e,init:s}of r.declarations)s&&("const"!==t||e.typeAnnotation?this.raise(_t.InitializerNotAllowedInAmbientContext,s):Tt(s,this.hasPlugin("estree"))||this.raise(_t.ConstInitiailizerMustBeStringOrNumericLiteralOrLiteralEnumReference,s));return r}parseStatementContent(e,t){if(this.match(75)&&this.isLookaheadContextual("enum")){const e=this.startNode();return this.expect(75),this.tsParseEnumDeclaration(e,{const:!0})}if(this.isContextual(126))return this.tsParseEnumDeclaration(this.startNode());if(this.isContextual(129)){const e=this.tsParseInterfaceDeclaration(this.startNode());if(e)return e}return super.parseStatementContent(e,t)}parseAccessModifier(){return this.tsParseModifier(["public","protected","private"])}tsHasSomeModifiers(e,t){return t.some((t=>xt(t)?e.accessibility===t:!!e[t]))}tsIsStartOfStaticBlocks(){return this.isContextual(106)&&123===this.lookaheadCharCode()}parseClassMember(e,t,s){const i=["declare","private","public","protected","override","abstract","readonly","static"];this.tsParseModifiers({allowedModifiers:i,disallowedModifiers:["in","out"],stopOnStartOfClassStaticBlock:!0,errorTemplate:_t.InvalidModifierOnTypeParameterPositions},t);const r=()=>{this.tsIsStartOfStaticBlocks()?(this.next(),this.next(),this.tsHasSomeModifiers(t,i)&&this.raise(_t.StaticBlockCannotHaveModifier,this.state.curPosition()),super.parseClassStaticBlock(e,t)):this.parseClassMemberWithIsStatic(e,t,s,!!t.static)};t.declare?this.tsInAmbientContext(r):r()}parseClassMemberWithIsStatic(e,t,s,i){const r=this.tsTryParseIndexSignature(t);if(r)return e.body.push(r),t.abstract&&this.raise(_t.IndexSignatureHasAbstract,t),t.accessibility&&this.raise(_t.IndexSignatureHasAccessibility,t,{modifier:t.accessibility}),t.declare&&this.raise(_t.IndexSignatureHasDeclare,t),void(t.override&&this.raise(_t.IndexSignatureHasOverride,t));!this.state.inAbstractClass&&t.abstract&&this.raise(_t.NonAbstractClassHasAbstractMethod,t),t.override&&(s.hadSuperClass||this.raise(_t.OverrideNotInSubClass,t)),super.parseClassMemberWithIsStatic(e,t,s,i)}parsePostMemberNameModifiers(e){this.eat(17)&&(e.optional=!0),e.readonly&&this.match(10)&&this.raise(_t.ClassMethodHasReadonly,e),e.declare&&this.match(10)&&this.raise(_t.ClassMethodHasDeclare,e)}parseExpressionStatement(e,t,s){return("Identifier"===t.type?this.tsParseExpressionStatement(e,t,s):void 0)||super.parseExpressionStatement(e,t,s)}shouldParseExportDeclaration(){return!!this.tsIsDeclarationStart()||super.shouldParseExportDeclaration()}parseConditional(e,t,s){if(!this.state.maybeInArrowParameters||!this.match(17))return super.parseConditional(e,t,s);const i=this.tryParse((()=>super.parseConditional(e,t)));return i.node?(i.error&&(this.state=i.failState),i.node):(i.error&&super.setOptionalParametersError(s,i.error),e)}parseParenItem(e,t){if(e=super.parseParenItem(e,t),this.eat(17)&&(e.optional=!0,this.resetEndLocation(e)),this.match(14)){const s=this.startNodeAt(t);return s.expression=e,s.typeAnnotation=this.tsParseTypeAnnotation(),this.finishNode(s,"TSTypeCastExpression")}return e}parseExportDeclaration(e){if(!this.state.isAmbientContext&&this.isContextual(125))return this.tsInAmbientContext((()=>this.parseExportDeclaration(e)));const t=this.state.startLoc,s=this.eatContextual(125);if(s&&(this.isContextual(125)||!this.shouldParseExportDeclaration()))throw this.raise(_t.ExpectedAmbientAfterExportDeclare,this.state.startLoc);const i=H(this.state.type)&&this.tsTryParseExportDeclaration()||super.parseExportDeclaration(e);return i?(("TSInterfaceDeclaration"===i.type||"TSTypeAliasDeclaration"===i.type||s)&&(e.exportKind="type"),s&&(this.resetStartLocation(i,t),i.declare=!0),i):null}parseClassId(e,t,s,i){if((!t||s)&&this.isContextual(113))return;super.parseClassId(e,t,s,e.declare?1024:8331);const r=this.tsTryParseTypeParameters(this.tsParseInOutConstModifiers);r&&(e.typeParameters=r)}parseClassPropertyAnnotation(e){e.optional||(this.eat(35)?e.definite=!0:this.eat(17)&&(e.optional=!0));const t=this.tsTryParseTypeAnnotation();t&&(e.typeAnnotation=t)}parseClassProperty(e){if(this.parseClassPropertyAnnotation(e),this.state.isAmbientContext&&(!e.readonly||e.typeAnnotation)&&this.match(29)&&this.raise(_t.DeclareClassFieldHasInitializer,this.state.startLoc),e.abstract&&this.match(29)){const{key:t}=e;this.raise(_t.AbstractPropertyHasInitializer,this.state.startLoc,{propertyName:"Identifier"!==t.type||e.computed?`[${this.input.slice(t.start,t.end)}]`:t.name})}return super.parseClassProperty(e)}parseClassPrivateProperty(e){return e.abstract&&this.raise(_t.PrivateElementHasAbstract,e),e.accessibility&&this.raise(_t.PrivateElementHasAccessibility,e,{modifier:e.accessibility}),this.parseClassPropertyAnnotation(e),super.parseClassPrivateProperty(e)}parseClassAccessorProperty(e){return this.parseClassPropertyAnnotation(e),e.optional&&this.raise(_t.AccessorCannotBeOptional,e),super.parseClassAccessorProperty(e)}pushClassMethod(e,t,s,i,r,n){const a=this.tsTryParseTypeParameters(this.tsParseConstModifier);a&&r&&this.raise(_t.ConstructorHasTypeParameters,a);const{declare:o=!1,kind:h}=t;!o||"get"!==h&&"set"!==h||this.raise(_t.DeclareAccessor,t,{kind:h}),a&&(t.typeParameters=a),super.pushClassMethod(e,t,s,i,r,n)}pushClassPrivateMethod(e,t,s,i){const r=this.tsTryParseTypeParameters(this.tsParseConstModifier);r&&(t.typeParameters=r),super.pushClassPrivateMethod(e,t,s,i)}declareClassPrivateMethodInScope(e,t){"TSDeclareMethod"!==e.type&&("MethodDefinition"!==e.type||e.value.body)&&super.declareClassPrivateMethodInScope(e,t)}parseClassSuper(e){super.parseClassSuper(e),e.superClass&&(this.match(47)||this.match(51))&&(e.superTypeParameters=this.tsParseTypeArgumentsInExpression()),this.eatContextual(113)&&(e.implements=this.tsParseHeritageClause("implements"))}parseObjPropValue(e,t,s,i,r,n,a){const o=this.tsTryParseTypeParameters(this.tsParseConstModifier);return o&&(e.typeParameters=o),super.parseObjPropValue(e,t,s,i,r,n,a)}parseFunctionParams(e,t){const s=this.tsTryParseTypeParameters(this.tsParseConstModifier);s&&(e.typeParameters=s),super.parseFunctionParams(e,t)}parseVarId(e,t){super.parseVarId(e,t),"Identifier"===e.id.type&&!this.hasPrecedingLineBreak()&&this.eat(35)&&(e.definite=!0);const s=this.tsTryParseTypeAnnotation();s&&(e.id.typeAnnotation=s,this.resetEndLocation(e.id))}parseAsyncArrowFromCallExpression(e,t){return this.match(14)&&(e.returnType=this.tsParseTypeAnnotation()),super.parseAsyncArrowFromCallExpression(e,t)}parseMaybeAssign(e,t){var s,i,r,n,a;let o,h,c,l;if(this.hasPlugin("jsx")&&(this.match(142)||this.match(47))){if(o=this.state.clone(),h=this.tryParse((()=>super.parseMaybeAssign(e,t)),o),!h.error)return h.node;const{context:s}=this.state,i=s[s.length-1];i!==P.j_oTag&&i!==P.j_expr||s.pop()}if(!(null!=(s=h)&&s.error||this.match(47)))return super.parseMaybeAssign(e,t);o&&o!==this.state||(o=this.state.clone());const p=this.tryParse((s=>{var i,r;l=this.tsParseTypeParameters(this.tsParseConstModifier);const n=super.parseMaybeAssign(e,t);return("ArrowFunctionExpression"!==n.type||null!=(i=n.extra)&&i.parenthesized)&&s(),0!==(null==(r=l)?void 0:r.params.length)&&this.resetStartLocationFromNode(n,l),n.typeParameters=l,n}),o);if(!p.error&&!p.aborted)return l&&this.reportReservedArrowTypeParam(l),p.node;if(!h&&(wt(!this.hasPlugin("jsx")),c=this.tryParse((()=>super.parseMaybeAssign(e,t)),o),!c.error))return c.node;if(null!=(i=h)&&i.node)return this.state=h.failState,h.node;if(p.node)return this.state=p.failState,l&&this.reportReservedArrowTypeParam(l),p.node;if(null!=(r=c)&&r.node)return this.state=c.failState,c.node;throw(null==(n=h)?void 0:n.error)||p.error||(null==(a=c)?void 0:a.error)}reportReservedArrowTypeParam(e){var t;1!==e.params.length||e.params[0].constraint||null!=(t=e.extra)&&t.trailingComma||!this.getPluginOption("typescript","disallowAmbiguousJSXLike")||this.raise(_t.ReservedArrowTypeParam,e)}parseMaybeUnary(e,t){return!this.hasPlugin("jsx")&&this.match(47)?this.tsParseTypeAssertion():super.parseMaybeUnary(e,t)}parseArrow(e){if(this.match(14)){const t=this.tryParse((e=>{const t=this.tsParseTypeOrTypePredicateAnnotation(14);return!this.canInsertSemicolon()&&this.match(19)||e(),t}));if(t.aborted)return;t.thrown||(t.error&&(this.state=t.failState),e.returnType=t.node)}return super.parseArrow(e)}parseAssignableListItemTypes(e,t){if(!(2&t))return e;this.eat(17)&&(e.optional=!0);const s=this.tsTryParseTypeAnnotation();return s&&(e.typeAnnotation=s),this.resetEndLocation(e),e}isAssignable(e,t){switch(e.type){case"TSTypeCastExpression":return this.isAssignable(e.expression,t);case"TSParameterProperty":return!0;default:return super.isAssignable(e,t)}}toAssignable(e,t=!1){switch(e.type){case"ParenthesizedExpression":this.toAssignableParenthesizedExpression(e,t);break;case"TSAsExpression":case"TSSatisfiesExpression":case"TSNonNullExpression":case"TSTypeAssertion":t?this.expressionScope.recordArrowParameterBindingError(_t.UnexpectedTypeCastInParameter,e):this.raise(_t.UnexpectedTypeCastInParameter,e),this.toAssignable(e.expression,t);break;case"AssignmentExpression":t||"TSTypeCastExpression"!==e.left.type||(e.left=this.typeCastToParameter(e.left));default:super.toAssignable(e,t)}}toAssignableParenthesizedExpression(e,t){switch(e.expression.type){case"TSAsExpression":case"TSSatisfiesExpression":case"TSNonNullExpression":case"TSTypeAssertion":case"ParenthesizedExpression":this.toAssignable(e.expression,t);break;default:super.toAssignable(e,t)}}checkToRestConversion(e,t){switch(e.type){case"TSAsExpression":case"TSSatisfiesExpression":case"TSTypeAssertion":case"TSNonNullExpression":this.checkToRestConversion(e.expression,!1);break;default:super.checkToRestConversion(e,t)}}isValidLVal(e,t,s){return i={TSTypeCastExpression:!0,TSParameterProperty:"parameter",TSNonNullExpression:"expression",TSAsExpression:(64!==s||!t)&&["expression",!0],TSSatisfiesExpression:(64!==s||!t)&&["expression",!0],TSTypeAssertion:(64!==s||!t)&&["expression",!0]},r=e,hasOwnProperty.call(i,r)&&i[r]||super.isValidLVal(e,t,s);var i,r}parseBindingAtom(){return 78===this.state.type?this.parseIdentifier(!0):super.parseBindingAtom()}parseMaybeDecoratorArguments(e){if(this.match(47)||this.match(51)){const t=this.tsParseTypeArgumentsInExpression();if(this.match(10)){const s=super.parseMaybeDecoratorArguments(e);return s.typeParameters=t,s}this.unexpected(null,10)}return super.parseMaybeDecoratorArguments(e)}checkCommaAfterRest(e){return this.state.isAmbientContext&&this.match(12)&&this.lookaheadCharCode()===e?(this.next(),!1):super.checkCommaAfterRest(e)}isClassMethod(){return this.match(47)||super.isClassMethod()}isClassProperty(){return this.match(35)||this.match(14)||super.isClassProperty()}parseMaybeDefault(e,t){const s=super.parseMaybeDefault(e,t);return"AssignmentPattern"===s.type&&s.typeAnnotation&&s.right.start<s.typeAnnotation.start&&this.raise(_t.TypeAnnotationAfterAssign,s.typeAnnotation),s}getTokenFromCode(e){if(this.state.inType){if(62===e)return void this.finishOp(48,1);if(60===e)return void this.finishOp(47,1)}super.getTokenFromCode(e)}reScan_lt_gt(){const{type:e}=this.state;47===e?(this.state.pos-=1,this.readToken_lt()):48===e&&(this.state.pos-=1,this.readToken_gt())}reScan_lt(){const{type:e}=this.state;return 51===e?(this.state.pos-=2,this.finishOp(47,1),47):e}toAssignableList(e,t,s){for(let t=0;t<e.length;t++){const s=e[t];"TSTypeCastExpression"===(null==s?void 0:s.type)&&(e[t]=this.typeCastToParameter(s))}super.toAssignableList(e,t,s)}typeCastToParameter(e){return e.expression.typeAnnotation=e.typeAnnotation,this.resetEndLocation(e.expression,e.typeAnnotation.loc.end),e.expression}shouldParseArrow(e){return this.match(14)?e.every((e=>this.isAssignable(e,!0))):super.shouldParseArrow(e)}shouldParseAsyncArrow(){return this.match(14)||super.shouldParseAsyncArrow()}canHaveLeadingDecorator(){return super.canHaveLeadingDecorator()||this.isAbstractClass()}jsxParseOpeningElementAfterName(e){if(this.match(47)||this.match(51)){const t=this.tsTryParseAndCatch((()=>this.tsParseTypeArgumentsInExpression()));t&&(e.typeParameters=t)}return super.jsxParseOpeningElementAfterName(e)}getGetterSetterExpectedParamCount(e){const t=super.getGetterSetterExpectedParamCount(e),s=this.getObjectOrClassMethodParams(e)[0];return s&&this.isThisParam(s)?t+1:t}parseCatchClauseParam(){const e=super.parseCatchClauseParam(),t=this.tsTryParseTypeAnnotation();return t&&(e.typeAnnotation=t,this.resetEndLocation(e)),e}tsInAmbientContext(e){const t=this.state.isAmbientContext;this.state.isAmbientContext=!0;try{return e()}finally{this.state.isAmbientContext=t}}parseClass(e,t,s){const i=this.state.inAbstractClass;this.state.inAbstractClass=!!e.abstract;try{return super.parseClass(e,t,s)}finally{this.state.inAbstractClass=i}}tsParseAbstractDeclaration(e,t){if(this.match(80))return e.abstract=!0,this.maybeTakeDecorators(t,this.parseClass(e,!0,!1));if(this.isContextual(129)){if(!this.hasFollowingLineBreak())return e.abstract=!0,this.raise(_t.NonClassMethodPropertyHasAbstractModifer,e),this.tsParseInterfaceDeclaration(e)}else this.unexpected(null,80)}parseMethod(e,t,s,i,r,n,a){const o=super.parseMethod(e,t,s,i,r,n,a);if(o.abstract&&(this.hasPlugin("estree")?o.value.body:o.body)){const{key:e}=o;this.raise(_t.AbstractMethodHasImplementation,o,{methodName:"Identifier"!==e.type||o.computed?`[${this.input.slice(e.start,e.end)}]`:e.name})}return o}tsParseTypeParameterName(){return this.parseIdentifier().name}shouldParseAsAmbientContext(){return!!this.getPluginOption("typescript","dts")}parse(){return this.shouldParseAsAmbientContext()&&(this.state.isAmbientContext=!0),super.parse()}getExpression(){return this.shouldParseAsAmbientContext()&&(this.state.isAmbientContext=!0),super.getExpression()}parseExportSpecifier(e,t,s,i){return!t&&i?(this.parseTypeOnlyImportExportSpecifier(e,!1,s),this.finishNode(e,"ExportSpecifier")):(e.exportKind="value",super.parseExportSpecifier(e,t,s,i))}parseImportSpecifier(e,t,s,i,r){return!t&&i?(this.parseTypeOnlyImportExportSpecifier(e,!0,s),this.finishNode(e,"ImportSpecifier")):(e.importKind="value",super.parseImportSpecifier(e,t,s,i,s?4098:4096))}parseTypeOnlyImportExportSpecifier(e,t,s){const i=t?"imported":"local",r=t?"local":"exported";let n,a=e[i],o=!1,h=!0;const c=a.loc.start;if(this.isContextual(93)){const e=this.parseIdentifier();if(this.isContextual(93)){const s=this.parseIdentifier();V(this.state.type)?(o=!0,a=e,n=t?this.parseIdentifier():this.parseModuleExportName(),h=!1):(n=s,h=!1)}else V(this.state.type)?(h=!1,n=t?this.parseIdentifier():this.parseModuleExportName()):(o=!0,a=e)}else V(this.state.type)&&(o=!0,t?(a=this.parseIdentifier(!0),this.isContextual(93)||this.checkReservedWord(a.name,a.loc.start,!0,!0)):a=this.parseModuleExportName());o&&s&&this.raise(t?_t.TypeModifierIsUsedInTypeImports:_t.TypeModifierIsUsedInTypeExports,c),e[i]=a,e[r]=n,e[t?"importKind":"exportKind"]=o?"type":"value",h&&this.eatContextual(93)&&(e[r]=t?this.parseIdentifier():this.parseModuleExportName()),e[r]||(e[r]=rt(e[i])),t&&this.checkIdentifier(e[r],o?4098:4096)}},v8intrinsic:e=>class extends e{parseV8Intrinsic(){if(this.match(54)){const e=this.state.startLoc,t=this.startNode();if(this.next(),H(this.state.type)){const e=this.parseIdentifierName(),s=this.createIdentifier(t,e);if(s.type="V8IntrinsicIdentifier",this.match(10))return s}this.unexpected(e)}}parseExprAtom(e){return this.parseV8Intrinsic()||super.parseExprAtom(e)}},placeholders:e=>class extends e{parsePlaceholder(e){if(this.match(144)){const t=this.startNode();return this.next(),this.assertNoSpace(),t.name=super.parseIdentifier(!0),this.assertNoSpace(),this.expect(144),this.finishPlaceholder(t,e)}}finishPlaceholder(e,t){const s=!(!e.expectedNode||"Placeholder"!==e.type);return e.expectedNode=t,s?e:this.finishNode(e,"Placeholder")}getTokenFromCode(e){37===e&&37===this.input.charCodeAt(this.state.pos+1)?this.finishOp(144,2):super.getTokenFromCode(e)}parseExprAtom(e){return this.parsePlaceholder("Expression")||super.parseExprAtom(e)}parseIdentifier(e){return this.parsePlaceholder("Identifier")||super.parseIdentifier(e)}checkReservedWord(e,t,s,i){void 0!==e&&super.checkReservedWord(e,t,s,i)}parseBindingAtom(){return this.parsePlaceholder("Pattern")||super.parseBindingAtom()}isValidLVal(e,t,s){return"Placeholder"===e||super.isValidLVal(e,t,s)}toAssignable(e,t){e&&"Placeholder"===e.type&&"Expression"===e.expectedNode?e.expectedNode="Pattern":super.toAssignable(e,t)}chStartsBindingIdentifier(e,t){return!!super.chStartsBindingIdentifier(e,t)||144===this.lookahead().type}verifyBreakContinue(e,t){e.label&&"Placeholder"===e.label.type||super.verifyBreakContinue(e,t)}parseExpressionStatement(e,t){var s;if("Placeholder"!==t.type||null!=(s=t.extra)&&s.parenthesized)return super.parseExpressionStatement(e,t);if(this.match(14)){const s=e;return s.label=this.finishPlaceholder(t,"Identifier"),this.next(),s.body=super.parseStatementOrSloppyAnnexBFunctionDeclaration(),this.finishNode(s,"LabeledStatement")}return this.semicolon(),e.name=t.name,this.finishPlaceholder(e,"Statement")}parseBlock(e,t,s){return this.parsePlaceholder("BlockStatement")||super.parseBlock(e,t,s)}parseFunctionId(e){return this.parsePlaceholder("Identifier")||super.parseFunctionId(e)}parseClass(e,t,s){const i=t?"ClassDeclaration":"ClassExpression";this.next();const r=this.state.strict,n=this.parsePlaceholder("Identifier");if(n){if(!(this.match(81)||this.match(144)||this.match(5))){if(s||!t)return e.id=null,e.body=this.finishPlaceholder(n,"ClassBody"),this.finishNode(e,i);throw this.raise(kt.ClassNameIsRequired,this.state.startLoc)}e.id=n}else this.parseClassId(e,t,s);return super.parseClassSuper(e),e.body=this.parsePlaceholder("ClassBody")||super.parseClassBody(!!e.superClass,r),this.finishNode(e,i)}parseExport(e,t){const s=this.parsePlaceholder("Identifier");if(!s)return super.parseExport(e,t);if(!this.isContextual(98)&&!this.match(12))return e.specifiers=[],e.source=null,e.declaration=this.finishPlaceholder(s,"Declaration"),this.finishNode(e,"ExportNamedDeclaration");this.expectPlugin("exportDefaultFrom");const i=this.startNode();return i.exported=s,e.specifiers=[this.finishNode(i,"ExportDefaultSpecifier")],super.parseExport(e,t)}isExportDefaultSpecifier(){if(this.match(65)){const e=this.nextTokenStart();if(this.isUnparsedContextual(e,"from")&&this.input.startsWith(Y(144),this.nextTokenStartSince(e+4)))return!0}return super.isExportDefaultSpecifier()}maybeParseExportDefaultSpecifier(e,t){var s;return!(null==(s=e.specifiers)||!s.length)||super.maybeParseExportDefaultSpecifier(e,t)}checkExport(e){const{specifiers:t}=e;null!=t&&t.length&&(e.specifiers=t.filter((e=>"Placeholder"===e.exported.type))),super.checkExport(e),e.specifiers=t}parseImport(e){const t=this.parsePlaceholder("Identifier");if(!t)return super.parseImport(e);if(e.specifiers=[],!this.isContextual(98)&&!this.match(12))return e.source=this.finishPlaceholder(t,"StringLiteral"),this.semicolon(),this.finishNode(e,"ImportDeclaration");const s=this.startNodeAtNode(t);return s.local=t,e.specifiers.push(this.finishNode(s,"ImportDefaultSpecifier")),this.eat(12)&&(this.maybeParseStarImportSpecifier(e)||this.parseNamedImportSpecifiers(e)),this.expectContextual(98),e.source=this.parseImportSource(),this.semicolon(),this.finishNode(e,"ImportDeclaration")}parseImportSource(){return this.parsePlaceholder("StringLiteral")||super.parseImportSource()}assertNoSpace(){this.state.start>this.state.lastTokEndLoc.index&&this.raise(kt.UnexpectedSpace,this.state.lastTokEndLoc)}}},Ot=Object.keys(Dt),Mt={sourceType:"script",sourceFilename:void 0,startColumn:0,startLine:1,allowAwaitOutsideFunction:!1,allowReturnOutsideFunction:!1,allowNewTargetOutsideFunction:!1,allowImportExportEverywhere:!1,allowSuperOutsideMethod:!1,allowUndeclaredExports:!1,plugins:[],strictMode:null,ranges:!1,tokens:!1,createImportExpressions:!1,createParenthesizedExpressions:!1,errorRecovery:!1,attachComment:!0,annexB:!0};class Rt extends bt{checkProto(e,t,s,i){if("SpreadElement"===e.type||this.isObjectMethod(e)||e.computed||e.shorthand)return;const r=e.key;if("__proto__"===("Identifier"===r.type?r.name:r.value)){if(t)return void this.raise(b.RecordNoProto,r);s.used&&(i?null===i.doubleProtoLoc&&(i.doubleProtoLoc=r.loc.start):this.raise(b.DuplicateProto,r)),s.used=!0}}shouldExitDescending(e,t){return"ArrowFunctionExpression"===e.type&&e.start===t}getExpression(){this.enterInitialScopes(),this.nextToken();const e=this.parseExpression();return this.match(139)||this.unexpected(),this.finalizeRemainingComments(),e.comments=this.comments,e.errors=this.state.errors,this.options.tokens&&(e.tokens=this.tokens),e}parseExpression(e,t){return e?this.disallowInAnd((()=>this.parseExpressionBase(t))):this.allowInAnd((()=>this.parseExpressionBase(t)))}parseExpressionBase(e){const t=this.state.startLoc,s=this.parseMaybeAssign(e);if(this.match(12)){const i=this.startNodeAt(t);for(i.expressions=[s];this.eat(12);)i.expressions.push(this.parseMaybeAssign(e));return this.toReferencedList(i.expressions),this.finishNode(i,"SequenceExpression")}return s}parseMaybeAssignDisallowIn(e,t){return this.disallowInAnd((()=>this.parseMaybeAssign(e,t)))}parseMaybeAssignAllowIn(e,t){return this.allowInAnd((()=>this.parseMaybeAssign(e,t)))}setOptionalParametersError(e,t){var s;e.optionalParametersLoc=null!=(s=null==t?void 0:t.loc)?s:this.state.startLoc}parseMaybeAssign(e,t){const s=this.state.startLoc;if(this.isContextual(108)&&this.prodParam.hasYield){let e=this.parseYield();return t&&(e=t.call(this,e,s)),e}let i;e?i=!1:(e=new tt,i=!0);const{type:r}=this.state;(10===r||H(r))&&(this.state.potentialArrowAt=this.state.start);let n=this.parseMaybeConditional(e);if(t&&(n=t.call(this,n,s)),(a=this.state.type)>=29&&a<=33){const t=this.startNodeAt(s),i=this.state.value;if(t.operator=i,this.match(29)){this.toAssignable(n,!0),t.left=n;const i=s.index;null!=e.doubleProtoLoc&&e.doubleProtoLoc.index>=i&&(e.doubleProtoLoc=null),null!=e.shorthandAssignLoc&&e.shorthandAssignLoc.index>=i&&(e.shorthandAssignLoc=null),null!=e.privateKeyLoc&&e.privateKeyLoc.index>=i&&(this.checkDestructuringPrivate(e),e.privateKeyLoc=null)}else t.left=n;return this.next(),t.right=this.parseMaybeAssign(),this.checkLVal(n,{in:this.finishNode(t,"AssignmentExpression")}),t}var a;return i&&this.checkExpressionErrors(e,!0),n}parseMaybeConditional(e){const t=this.state.startLoc,s=this.state.potentialArrowAt,i=this.parseExprOps(e);return this.shouldExitDescending(i,s)?i:this.parseConditional(i,t,e)}parseConditional(e,t,s){if(this.eat(17)){const s=this.startNodeAt(t);return s.test=e,s.consequent=this.parseMaybeAssignAllowIn(),this.expect(14),s.alternate=this.parseMaybeAssign(),this.finishNode(s,"ConditionalExpression")}return e}parseMaybeUnaryOrPrivate(e){return this.match(138)?this.parsePrivateName():this.parseMaybeUnary(e)}parseExprOps(e){const t=this.state.startLoc,s=this.state.potentialArrowAt,i=this.parseMaybeUnaryOrPrivate(e);return this.shouldExitDescending(i,s)?i:this.parseExprOp(i,t,-1)}parseExprOp(e,t,s){if(this.isPrivateName(e)){const t=this.getPrivateNameSV(e);(s>=J(58)||!this.prodParam.hasIn||!this.match(58))&&this.raise(b.PrivateInExpectedIn,e,{identifierName:t}),this.classScope.usePrivateName(t,e.loc.start)}const i=this.state.type;if((r=i)>=39&&r<=59&&(this.prodParam.hasIn||!this.match(58))){let r=J(i);if(r>s){if(39===i){if(this.expectPlugin("pipelineOperator"),this.state.inFSharpPipelineDirectBody)return e;this.checkPipelineAtInfixOperator(e,t)}const n=this.startNodeAt(t);n.left=e,n.operator=this.state.value;const a=41===i||42===i,o=40===i;if(o&&(r=J(42)),this.next(),39===i&&this.hasPlugin(["pipelineOperator",{proposal:"minimal"}])&&96===this.state.type&&this.prodParam.hasAwait)throw this.raise(b.UnexpectedAwaitAfterPipelineBody,this.state.startLoc);n.right=this.parseExprOpRightExpr(i,r);const h=this.finishNode(n,a||o?"LogicalExpression":"BinaryExpression"),c=this.state.type;if(o&&(41===c||42===c)||a&&40===c)throw this.raise(b.MixingCoalesceWithLogical,this.state.startLoc);return this.parseExprOp(h,t,s)}}var r;return e}parseExprOpRightExpr(e,t){const s=this.state.startLoc;if(39===e)switch(this.getPluginOption("pipelineOperator","proposal")){case"hack":return this.withTopicBindingContext((()=>this.parseHackPipeBody()));case"smart":return this.withTopicBindingContext((()=>{if(this.prodParam.hasYield&&this.isContextual(108))throw this.raise(b.PipeBodyIsTighter,this.state.startLoc);return this.parseSmartPipelineBodyInStyle(this.parseExprOpBaseRightExpr(e,t),s)}));case"fsharp":return this.withSoloAwaitPermittingContext((()=>this.parseFSharpPipelineBody(t)))}return this.parseExprOpBaseRightExpr(e,t)}parseExprOpBaseRightExpr(e,t){const s=this.state.startLoc;return this.parseExprOp(this.parseMaybeUnaryOrPrivate(),s,57===e?t-1:t)}parseHackPipeBody(){var e;const{startLoc:t}=this.state,s=this.parseMaybeAssign();return!p.has(s.type)||null!=(e=s.extra)&&e.parenthesized||this.raise(b.PipeUnparenthesizedBody,t,{type:s.type}),this.topicReferenceWasUsedInCurrentContext()||this.raise(b.PipeTopicUnused,t),s}checkExponentialAfterUnary(e){this.match(57)&&this.raise(b.UnexpectedTokenUnaryExponentiation,e.argument)}parseMaybeUnary(e,t){const s=this.state.startLoc,i=this.isContextual(96);if(i&&this.isAwaitAllowed()){this.next();const e=this.parseAwait(s);return t||this.checkExponentialAfterUnary(e),e}const r=this.match(34),n=this.startNode();if(a=this.state.type,U[a]){n.operator=this.state.value,n.prefix=!0,this.match(72)&&this.expectPlugin("throwExpressions");const s=this.match(89);if(this.next(),n.argument=this.parseMaybeUnary(null,!0),this.checkExpressionErrors(e,!0),this.state.strict&&s){const e=n.argument;"Identifier"===e.type?this.raise(b.StrictDelete,n):this.hasPropertyAsPrivateName(e)&&this.raise(b.DeletePrivateField,n)}if(!r)return t||this.checkExponentialAfterUnary(n),this.finishNode(n,"UnaryExpression")}var a;const o=this.parseUpdate(n,r,e);if(i){const{type:e}=this.state;if((this.hasPlugin("v8intrinsic")?$(e):$(e)&&!this.match(54))&&!this.isAmbiguousAwait())return this.raiseOverwrite(b.AwaitNotInAsyncContext,s),this.parseAwait(s)}return o}parseUpdate(e,t,s){if(t){const t=e;return this.checkLVal(t.argument,{in:this.finishNode(t,"UpdateExpression")}),e}const i=this.state.startLoc;let r=this.parseExprSubscripts(s);if(this.checkExpressionErrors(s,!1))return r;for(;34===this.state.type&&!this.canInsertSemicolon();){const e=this.startNodeAt(i);e.operator=this.state.value,e.prefix=!1,e.argument=r,this.next(),this.checkLVal(r,{in:r=this.finishNode(e,"UpdateExpression")})}return r}parseExprSubscripts(e){const t=this.state.startLoc,s=this.state.potentialArrowAt,i=this.parseExprAtom(e);return this.shouldExitDescending(i,s)?i:this.parseSubscripts(i,t)}parseSubscripts(e,t,s){const i={optionalChainMember:!1,maybeAsyncArrow:this.atPossibleAsyncArrow(e),stop:!1};do{e=this.parseSubscript(e,t,s,i),i.maybeAsyncArrow=!1}while(!i.stop);return e}parseSubscript(e,t,s,i){const{type:r}=this.state;if(!s&&15===r)return this.parseBind(e,t,s,i);if(Z(r))return this.parseTaggedTemplateExpression(e,t,i);let n=!1;if(18===r){if(s&&(this.raise(b.OptionalChainingNoNew,this.state.startLoc),40===this.lookaheadCharCode()))return i.stop=!0,e;i.optionalChainMember=n=!0,this.next()}if(!s&&this.match(10))return this.parseCoverCallAndAsyncArrowHead(e,t,i,n);{const s=this.eat(0);return s||n||this.eat(16)?this.parseMember(e,t,i,s,n):(i.stop=!0,e)}}parseMember(e,t,s,i,r){const n=this.startNodeAt(t);return n.object=e,n.computed=i,i?(n.property=this.parseExpression(),this.expect(3)):this.match(138)?("Super"===e.type&&this.raise(b.SuperPrivateField,t),this.classScope.usePrivateName(this.state.value,this.state.startLoc),n.property=this.parsePrivateName()):n.property=this.parseIdentifier(!0),s.optionalChainMember?(n.optional=r,this.finishNode(n,"OptionalMemberExpression")):this.finishNode(n,"MemberExpression")}parseBind(e,t,s,i){const r=this.startNodeAt(t);return r.object=e,this.next(),r.callee=this.parseNoCallExpr(),i.stop=!0,this.parseSubscripts(this.finishNode(r,"BindExpression"),t,s)}parseCoverCallAndAsyncArrowHead(e,t,s,i){const r=this.state.maybeInArrowParameters;let n=null;this.state.maybeInArrowParameters=!0,this.next();const a=this.startNodeAt(t);a.callee=e;const{maybeAsyncArrow:o,optionalChainMember:h}=s;o&&(this.expressionScope.enter(new Ye(2)),n=new tt),h&&(a.optional=i),a.arguments=i?this.parseCallExpressionArguments(11):this.parseCallExpressionArguments(11,"Import"===e.type,"Super"!==e.type,a,n);let c=this.finishCallExpression(a,h);return o&&this.shouldParseAsyncArrow()&&!i?(s.stop=!0,this.checkDestructuringPrivate(n),this.expressionScope.validateAsPattern(),this.expressionScope.exit(),c=this.parseAsyncArrowFromCallExpression(this.startNodeAt(t),c)):(o&&(this.checkExpressionErrors(n,!0),this.expressionScope.exit()),this.toReferencedArguments(c)),this.state.maybeInArrowParameters=r,c}toReferencedArguments(e,t){this.toReferencedListDeep(e.arguments,t)}parseTaggedTemplateExpression(e,t,s){const i=this.startNodeAt(t);return i.tag=e,i.quasi=this.parseTemplate(!0),s.optionalChainMember&&this.raise(b.OptionalChainingNoTemplate,t),this.finishNode(i,"TaggedTemplateExpression")}atPossibleAsyncArrow(e){return"Identifier"===e.type&&"async"===e.name&&this.state.lastTokEndLoc.index===e.end&&!this.canInsertSemicolon()&&e.end-e.start==5&&e.start===this.state.potentialArrowAt}expectImportAttributesPlugin(){this.hasPlugin("importAssertions")||this.expectPlugin("importAttributes")}finishCallExpression(e,t){if("Import"===e.callee.type)if(2===e.arguments.length&&(this.hasPlugin("moduleAttributes")||this.expectImportAttributesPlugin()),0===e.arguments.length||e.arguments.length>2)this.raise(b.ImportCallArity,e,{maxArgumentCount:this.hasPlugin("importAttributes")||this.hasPlugin("importAssertions")||this.hasPlugin("moduleAttributes")?2:1});else for(const t of e.arguments)"SpreadElement"===t.type&&this.raise(b.ImportCallSpreadArgument,t);return this.finishNode(e,t?"OptionalCallExpression":"CallExpression")}parseCallExpressionArguments(e,t,s,i,r){const n=[];let a=!0;const o=this.state.inFSharpPipelineDirectBody;for(this.state.inFSharpPipelineDirectBody=!1;!this.eat(e);){if(a)a=!1;else if(this.expect(12),this.match(e)){!t||this.hasPlugin("importAttributes")||this.hasPlugin("importAssertions")||this.hasPlugin("moduleAttributes")||this.raise(b.ImportCallArgumentTrailingComma,this.state.lastTokStartLoc),i&&this.addTrailingCommaExtraToNode(i),this.next();break}n.push(this.parseExprListItem(!1,r,s))}return this.state.inFSharpPipelineDirectBody=o,n}shouldParseAsyncArrow(){return this.match(19)&&!this.canInsertSemicolon()}parseAsyncArrowFromCallExpression(e,t){var s;return this.resetPreviousNodeTrailingComments(t),this.expect(19),this.parseArrowExpression(e,t.arguments,!0,null==(s=t.extra)?void 0:s.trailingCommaLoc),t.innerComments&&ve(e,t.innerComments),t.callee.trailingComments&&ve(e,t.callee.trailingComments),e}parseNoCallExpr(){const e=this.state.startLoc;return this.parseSubscripts(this.parseExprAtom(),e,!0)}parseExprAtom(e){let t,s=null;const{type:i}=this.state;switch(i){case 79:return this.parseSuper();case 83:return t=this.startNode(),this.next(),this.match(16)?this.parseImportMetaProperty(t):this.match(10)?this.options.createImportExpressions?this.parseImportCall(t):this.finishNode(t,"Import"):(this.raise(b.UnsupportedImport,this.state.lastTokStartLoc),this.finishNode(t,"Import"));case 78:return t=this.startNode(),this.next(),this.finishNode(t,"ThisExpression");case 90:return this.parseDo(this.startNode(),!1);case 56:case 31:return this.readRegexp(),this.parseRegExpLiteral(this.state.value);case 134:return this.parseNumericLiteral(this.state.value);case 135:return this.parseBigIntLiteral(this.state.value);case 136:return this.parseDecimalLiteral(this.state.value);case 133:return this.parseStringLiteral(this.state.value);case 84:return this.parseNullLiteral();case 85:return this.parseBooleanLiteral(!0);case 86:return this.parseBooleanLiteral(!1);case 10:{const e=this.state.potentialArrowAt===this.state.start;return this.parseParenAndDistinguishExpression(e)}case 2:case 1:return this.parseArrayLike(2===this.state.type?4:3,!1,!0);case 0:return this.parseArrayLike(3,!0,!1,e);case 6:case 7:return this.parseObjectLike(6===this.state.type?9:8,!1,!0);case 5:return this.parseObjectLike(8,!1,!1,e);case 68:return this.parseFunctionOrFunctionSent();case 26:s=this.parseDecorators();case 80:return this.parseClass(this.maybeTakeDecorators(s,this.startNode()),!1);case 77:return this.parseNewOrNewTarget();case 25:case 24:return this.parseTemplate(!1);case 15:{t=this.startNode(),this.next(),t.object=null;const e=t.callee=this.parseNoCallExpr();if("MemberExpression"===e.type)return this.finishNode(t,"BindExpression");throw this.raise(b.UnsupportedBind,e)}case 138:return this.raise(b.PrivateInExpectedIn,this.state.startLoc,{identifierName:this.state.value}),this.parsePrivateName();case 33:return this.parseTopicReferenceThenEqualsSign(54,"%");case 32:return this.parseTopicReferenceThenEqualsSign(44,"^");case 37:case 38:return this.parseTopicReference("hack");case 44:case 54:case 27:{const e=this.getPluginOption("pipelineOperator","proposal");if(e)return this.parseTopicReference(e);this.unexpected();break}case 47:{const e=this.input.codePointAt(this.nextTokenStart());ae(e)||62===e?this.expectOnePlugin(["jsx","flow","typescript"]):this.unexpected();break}default:if(H(i)){if(this.isContextual(127)&&123===this.lookaheadInLineCharCode())return this.parseModuleExpression();const e=this.state.potentialArrowAt===this.state.start,t=this.state.containsEsc,s=this.parseIdentifier();if(!t&&"async"===s.name&&!this.canInsertSemicolon()){const{type:e}=this.state;if(68===e)return this.resetPreviousNodeTrailingComments(s),this.next(),this.parseAsyncFunctionExpression(this.startNodeAtNode(s));if(H(e))return 61===this.lookaheadCharCode()?this.parseAsyncArrowUnaryFunction(this.startNodeAtNode(s)):s;if(90===e)return this.resetPreviousNodeTrailingComments(s),this.parseDo(this.startNodeAtNode(s),!0)}return e&&this.match(19)&&!this.canInsertSemicolon()?(this.next(),this.parseArrowExpression(this.startNodeAtNode(s),[s],!1)):s}this.unexpected()}}parseTopicReferenceThenEqualsSign(e,t){const s=this.getPluginOption("pipelineOperator","proposal");if(s)return this.state.type=e,this.state.value=t,this.state.pos--,this.state.end--,this.state.endLoc=n(this.state.endLoc,-1),this.parseTopicReference(s);this.unexpected()}parseTopicReference(e){const t=this.startNode(),s=this.state.startLoc,i=this.state.type;return this.next(),this.finishTopicReference(t,s,e,i)}finishTopicReference(e,t,s,i){if(this.testTopicReferenceConfiguration(s,t,i)){const i="smart"===s?"PipelinePrimaryTopicReference":"TopicReference";return this.topicReferenceIsAllowedInCurrentContext()||this.raise("smart"===s?b.PrimaryTopicNotAllowed:b.PipeTopicUnbound,t),this.registerTopicReference(),this.finishNode(e,i)}throw this.raise(b.PipeTopicUnconfiguredToken,t,{token:Y(i)})}testTopicReferenceConfiguration(e,t,s){switch(e){case"hack":return this.hasPlugin(["pipelineOperator",{topicToken:Y(s)}]);case"smart":return 27===s;default:throw this.raise(b.PipeTopicRequiresHackPipes,t)}}parseAsyncArrowUnaryFunction(e){this.prodParam.enter(Qe(!0,this.prodParam.hasYield));const t=[this.parseIdentifier()];return this.prodParam.exit(),this.hasPrecedingLineBreak()&&this.raise(b.LineTerminatorBeforeArrow,this.state.curPosition()),this.expect(19),this.parseArrowExpression(e,t,!0)}parseDo(e,t){this.expectPlugin("doExpressions"),t&&this.expectPlugin("asyncDoExpressions"),e.async=t,this.next();const s=this.state.labels;return this.state.labels=[],t?(this.prodParam.enter(2),e.body=this.parseBlock(),this.prodParam.exit()):e.body=this.parseBlock(),this.state.labels=s,this.finishNode(e,"DoExpression")}parseSuper(){const e=this.startNode();return this.next(),!this.match(10)||this.scope.allowDirectSuper||this.options.allowSuperOutsideMethod?this.scope.allowSuper||this.options.allowSuperOutsideMethod||this.raise(b.UnexpectedSuper,e):this.raise(b.SuperNotAllowed,e),this.match(10)||this.match(0)||this.match(16)||this.raise(b.UnsupportedSuper,e),this.finishNode(e,"Super")}parsePrivateName(){const e=this.startNode(),t=this.startNodeAt(n(this.state.startLoc,1)),s=this.state.value;return this.next(),e.id=this.createIdentifier(t,s),this.finishNode(e,"PrivateName")}parseFunctionOrFunctionSent(){const e=this.startNode();if(this.next(),this.prodParam.hasYield&&this.match(16)){const t=this.createIdentifier(this.startNodeAtNode(e),"function");return this.next(),this.match(103)?this.expectPlugin("functionSent"):this.hasPlugin("functionSent")||this.unexpected(),this.parseMetaProperty(e,t,"sent")}return this.parseFunction(e)}parseMetaProperty(e,t,s){e.meta=t;const i=this.state.containsEsc;return e.property=this.parseIdentifier(!0),(e.property.name!==s||i)&&this.raise(b.UnsupportedMetaProperty,e.property,{target:t.name,onlyValidPropertyName:s}),this.finishNode(e,"MetaProperty")}parseImportMetaProperty(e){const t=this.createIdentifier(this.startNodeAtNode(e),"import");if(this.next(),this.isContextual(101))this.inModule||this.raise(b.ImportMetaOutsideModule,t),this.sawUnambiguousESM=!0;else if(this.isContextual(105)||this.isContextual(97)){const t=this.isContextual(105);if(t||this.unexpected(),this.expectPlugin(t?"sourcePhaseImports":"deferredImportEvaluation"),!this.options.createImportExpressions)throw this.raise(b.DynamicImportPhaseRequiresImportExpressions,this.state.startLoc,{phase:this.state.value});return this.next(),e.phase=t?"source":"defer",this.parseImportCall(e)}return this.parseMetaProperty(e,t,"meta")}parseLiteralAtNode(e,t,s){return this.addExtra(s,"rawValue",e),this.addExtra(s,"raw",this.input.slice(s.start,this.state.end)),s.value=e,this.next(),this.finishNode(s,t)}parseLiteral(e,t){const s=this.startNode();return this.parseLiteralAtNode(e,t,s)}parseStringLiteral(e){return this.parseLiteral(e,"StringLiteral")}parseNumericLiteral(e){return this.parseLiteral(e,"NumericLiteral")}parseBigIntLiteral(e){return this.parseLiteral(e,"BigIntLiteral")}parseDecimalLiteral(e){return this.parseLiteral(e,"DecimalLiteral")}parseRegExpLiteral(e){const t=this.parseLiteral(e.value,"RegExpLiteral");return t.pattern=e.pattern,t.flags=e.flags,t}parseBooleanLiteral(e){const t=this.startNode();return t.value=e,this.next(),this.finishNode(t,"BooleanLiteral")}parseNullLiteral(){const e=this.startNode();return this.next(),this.finishNode(e,"NullLiteral")}parseParenAndDistinguishExpression(e){const t=this.state.startLoc;let s;this.next(),this.expressionScope.enter(new Ye(1));const i=this.state.maybeInArrowParameters,r=this.state.inFSharpPipelineDirectBody;this.state.maybeInArrowParameters=!0,this.state.inFSharpPipelineDirectBody=!1;const n=this.state.startLoc,a=[],o=new tt;let h,c,l=!0;for(;!this.match(11);){if(l)l=!1;else if(this.expect(12,null===o.optionalParametersLoc?null:o.optionalParametersLoc),this.match(11)){c=this.state.startLoc;break}if(this.match(21)){const e=this.state.startLoc;if(h=this.state.startLoc,a.push(this.parseParenItem(this.parseRestBinding(),e)),!this.checkCommaAfterRest(41))break}else a.push(this.parseMaybeAssignAllowIn(o,this.parseParenItem))}const p=this.state.lastTokEndLoc;this.expect(11),this.state.maybeInArrowParameters=i,this.state.inFSharpPipelineDirectBody=r;let u=this.startNodeAt(t);return e&&this.shouldParseArrow(a)&&(u=this.parseArrow(u))?(this.checkDestructuringPrivate(o),this.expressionScope.validateAsPattern(),this.expressionScope.exit(),this.parseArrowExpression(u,a,!1),u):(this.expressionScope.exit(),a.length||this.unexpected(this.state.lastTokStartLoc),c&&this.unexpected(c),h&&this.unexpected(h),this.checkExpressionErrors(o,!0),this.toReferencedListDeep(a,!0),a.length>1?(s=this.startNodeAt(n),s.expressions=a,this.finishNode(s,"SequenceExpression"),this.resetEndLocation(s,p)):s=a[0],this.wrapParenthesis(t,s))}wrapParenthesis(e,t){if(!this.options.createParenthesizedExpressions)return this.addExtra(t,"parenthesized",!0),this.addExtra(t,"parenStart",e.index),this.takeSurroundingComments(t,e.index,this.state.lastTokEndLoc.index),t;const s=this.startNodeAt(e);return s.expression=t,this.finishNode(s,"ParenthesizedExpression")}shouldParseArrow(e){return!this.canInsertSemicolon()}parseArrow(e){if(this.eat(19))return e}parseParenItem(e,t){return e}parseNewOrNewTarget(){const e=this.startNode();if(this.next(),this.match(16)){const t=this.createIdentifier(this.startNodeAtNode(e),"new");this.next();const s=this.parseMetaProperty(e,t,"target");return this.scope.inNonArrowFunction||this.scope.inClass||this.options.allowNewTargetOutsideFunction||this.raise(b.UnexpectedNewTarget,s),s}return this.parseNew(e)}parseNew(e){if(this.parseNewCallee(e),this.eat(10)){const t=this.parseExprList(11);this.toReferencedList(t),e.arguments=t}else e.arguments=[];return this.finishNode(e,"NewExpression")}parseNewCallee(e){const t=this.match(83),s=this.parseNoCallExpr();e.callee=s,!t||"Import"!==s.type&&"ImportExpression"!==s.type||this.raise(b.ImportCallNotNewExpression,s)}parseTemplateElement(e){const{start:t,startLoc:s,end:i,value:r}=this.state,a=t+1,o=this.startNodeAt(n(s,1));null===r&&(e||this.raise(b.InvalidEscapeSequenceTemplate,n(this.state.firstInvalidTemplateEscapePos,1)));const h=this.match(24),c=h?-1:-2,l=i+c;o.value={raw:this.input.slice(a,l).replace(/\r\n?/g,"\n"),cooked:null===r?null:r.slice(1,c)},o.tail=h,this.next();const p=this.finishNode(o,"TemplateElement");return this.resetEndLocation(p,n(this.state.lastTokEndLoc,c)),p}parseTemplate(e){const t=this.startNode();t.expressions=[];let s=this.parseTemplateElement(e);for(t.quasis=[s];!s.tail;)t.expressions.push(this.parseTemplateSubstitution()),this.readTemplateContinuation(),t.quasis.push(s=this.parseTemplateElement(e));return this.finishNode(t,"TemplateLiteral")}parseTemplateSubstitution(){return this.parseExpression()}parseObjectLike(e,t,s,i){s&&this.expectPlugin("recordAndTuple");const r=this.state.inFSharpPipelineDirectBody;this.state.inFSharpPipelineDirectBody=!1;const n=Object.create(null);let a=!0;const o=this.startNode();for(o.properties=[],this.next();!this.match(e);){if(a)a=!1;else if(this.expect(12),this.match(e)){this.addTrailingCommaExtraToNode(o);break}let r;t?r=this.parseBindingProperty():(r=this.parsePropertyDefinition(i),this.checkProto(r,s,n,i)),s&&!this.isObjectProperty(r)&&"SpreadElement"!==r.type&&this.raise(b.InvalidRecordProperty,r),r.shorthand&&this.addExtra(r,"shorthand",!0),o.properties.push(r)}this.next(),this.state.inFSharpPipelineDirectBody=r;let h="ObjectExpression";return t?h="ObjectPattern":s&&(h="RecordExpression"),this.finishNode(o,h)}addTrailingCommaExtraToNode(e){this.addExtra(e,"trailingComma",this.state.lastTokStartLoc.index),this.addExtra(e,"trailingCommaLoc",this.state.lastTokStartLoc,!1)}maybeAsyncOrAccessorProp(e){return!e.computed&&"Identifier"===e.key.type&&(this.isLiteralPropertyName()||this.match(0)||this.match(55))}parsePropertyDefinition(e){let t=[];if(this.match(26))for(this.hasPlugin("decorators")&&this.raise(b.UnsupportedPropertyDecorator,this.state.startLoc);this.match(26);)t.push(this.parseDecorator());const s=this.startNode();let i,r=!1,n=!1;if(this.match(21))return t.length&&this.unexpected(),this.parseSpread();t.length&&(s.decorators=t,t=[]),s.method=!1,e&&(i=this.state.startLoc);let a=this.eat(55);this.parsePropertyNamePrefixOperator(s);const o=this.state.containsEsc,h=this.parsePropertyName(s,e);if(!a&&!o&&this.maybeAsyncOrAccessorProp(s)){const e=h.name;"async"!==e||this.hasPrecedingLineBreak()||(r=!0,this.resetPreviousNodeTrailingComments(h),a=this.eat(55),this.parsePropertyName(s)),"get"!==e&&"set"!==e||(n=!0,this.resetPreviousNodeTrailingComments(h),s.kind=e,this.match(55)&&(a=!0,this.raise(b.AccessorIsGenerator,this.state.curPosition(),{kind:e}),this.next()),this.parsePropertyName(s))}return this.parseObjPropValue(s,i,a,r,!1,n,e)}getGetterSetterExpectedParamCount(e){return"get"===e.kind?0:1}getObjectOrClassMethodParams(e){return e.params}checkGetterSetterParams(e){var t;const s=this.getGetterSetterExpectedParamCount(e),i=this.getObjectOrClassMethodParams(e);i.length!==s&&this.raise("get"===e.kind?b.BadGetterArity:b.BadSetterArity,e),"set"===e.kind&&"RestElement"===(null==(t=i[i.length-1])?void 0:t.type)&&this.raise(b.BadSetterRestParameter,e)}parseObjectMethod(e,t,s,i,r){if(r){const s=this.parseMethod(e,t,!1,!1,!1,"ObjectMethod");return this.checkGetterSetterParams(s),s}if(s||t||this.match(10))return i&&this.unexpected(),e.kind="method",e.method=!0,this.parseMethod(e,t,s,!1,!1,"ObjectMethod")}parseObjectProperty(e,t,s,i){if(e.shorthand=!1,this.eat(14))return e.value=s?this.parseMaybeDefault(this.state.startLoc):this.parseMaybeAssignAllowIn(i),this.finishNode(e,"ObjectProperty");if(!e.computed&&"Identifier"===e.key.type){if(this.checkReservedWord(e.key.name,e.key.loc.start,!0,!1),s)e.value=this.parseMaybeDefault(t,rt(e.key));else if(this.match(29)){const s=this.state.startLoc;null!=i?null===i.shorthandAssignLoc&&(i.shorthandAssignLoc=s):this.raise(b.InvalidCoverInitializedName,s),e.value=this.parseMaybeDefault(t,rt(e.key))}else e.value=rt(e.key);return e.shorthand=!0,this.finishNode(e,"ObjectProperty")}}parseObjPropValue(e,t,s,i,r,n,a){const o=this.parseObjectMethod(e,s,i,r,n)||this.parseObjectProperty(e,t,r,a);return o||this.unexpected(),o}parsePropertyName(e,t){if(this.eat(0))e.computed=!0,e.key=this.parseMaybeAssignAllowIn(),this.expect(3);else{const{type:s,value:i}=this.state;let r;if(V(s))r=this.parseIdentifier(!0);else switch(s){case 134:r=this.parseNumericLiteral(i);break;case 133:r=this.parseStringLiteral(i);break;case 135:r=this.parseBigIntLiteral(i);break;case 136:r=this.parseDecimalLiteral(i);break;case 138:{const e=this.state.startLoc;null!=t?null===t.privateKeyLoc&&(t.privateKeyLoc=e):this.raise(b.UnexpectedPrivateField,e),r=this.parsePrivateName();break}default:this.unexpected()}e.key=r,138!==s&&(e.computed=!1)}return e.key}initFunction(e,t){e.id=null,e.generator=!1,e.async=t}parseMethod(e,t,s,i,r,n,a=!1){this.initFunction(e,s),e.generator=t,this.scope.enter(18|(a?64:0)|(r?32:0)),this.prodParam.enter(Qe(s,e.generator)),this.parseFunctionParams(e,i);const o=this.parseFunctionBodyAndFinish(e,n,!0);return this.prodParam.exit(),this.scope.exit(),o}parseArrayLike(e,t,s,i){s&&this.expectPlugin("recordAndTuple");const r=this.state.inFSharpPipelineDirectBody;this.state.inFSharpPipelineDirectBody=!1;const n=this.startNode();return this.next(),n.elements=this.parseExprList(e,!s,i,n),this.state.inFSharpPipelineDirectBody=r,this.finishNode(n,s?"TupleExpression":"ArrayExpression")}parseArrowExpression(e,t,s,i){this.scope.enter(6);let r=Qe(s,!1);!this.match(5)&&this.prodParam.hasIn&&(r|=8),this.prodParam.enter(r),this.initFunction(e,s);const n=this.state.maybeInArrowParameters;return t&&(this.state.maybeInArrowParameters=!0,this.setArrowFunctionParameters(e,t,i)),this.state.maybeInArrowParameters=!1,this.parseFunctionBody(e,!0),this.prodParam.exit(),this.scope.exit(),this.state.maybeInArrowParameters=n,this.finishNode(e,"ArrowFunctionExpression")}setArrowFunctionParameters(e,t,s){this.toAssignableList(t,s,!1),e.params=t}parseFunctionBodyAndFinish(e,t,s=!1){return this.parseFunctionBody(e,!1,s),this.finishNode(e,t)}parseFunctionBody(e,t,s=!1){const i=t&&!this.match(5);if(this.expressionScope.enter(Ze()),i)e.body=this.parseMaybeAssign(),this.checkParams(e,!1,t,!1);else{const i=this.state.strict,r=this.state.labels;this.state.labels=[],this.prodParam.enter(4|this.prodParam.currentFlags()),e.body=this.parseBlock(!0,!1,(r=>{const n=!this.isSimpleParamList(e.params);r&&n&&this.raise(b.IllegalLanguageModeDirective,"method"!==e.kind&&"constructor"!==e.kind||!e.key?e:e.key.loc.end);const a=!i&&this.state.strict;this.checkParams(e,!(this.state.strict||t||s||n),t,a),this.state.strict&&e.id&&this.checkIdentifier(e.id,65,a)})),this.prodParam.exit(),this.state.labels=r}this.expressionScope.exit()}isSimpleParameter(e){return"Identifier"===e.type}isSimpleParamList(e){for(let t=0,s=e.length;t<s;t++)if(!this.isSimpleParameter(e[t]))return!1;return!0}checkParams(e,t,s,i=!0){const r=!t&&new Set,n={type:"FormalParameters"};for(const t of e.params)this.checkLVal(t,{in:n,binding:5,checkClashes:r,strictModeChanged:i})}parseExprList(e,t,s,i){const r=[];let n=!0;for(;!this.eat(e);){if(n)n=!1;else if(this.expect(12),this.match(e)){i&&this.addTrailingCommaExtraToNode(i),this.next();break}r.push(this.parseExprListItem(t,s))}return r}parseExprListItem(e,t,s){let i;if(this.match(12))e||this.raise(b.UnexpectedToken,this.state.curPosition(),{unexpected:","}),i=null;else if(this.match(21)){const e=this.state.startLoc;i=this.parseParenItem(this.parseSpread(t),e)}else if(this.match(17)){this.expectPlugin("partialApplication"),s||this.raise(b.UnexpectedArgumentPlaceholder,this.state.startLoc);const e=this.startNode();this.next(),i=this.finishNode(e,"ArgumentPlaceholder")}else i=this.parseMaybeAssignAllowIn(t,this.parseParenItem);return i}parseIdentifier(e){const t=this.startNode(),s=this.parseIdentifierName(e);return this.createIdentifier(t,s)}createIdentifier(e,t){return e.name=t,e.loc.identifierName=t,this.finishNode(e,"Identifier")}parseIdentifierName(e){let t;const{startLoc:s,type:i}=this.state;V(i)?t=this.state.value:this.unexpected();const r=i<=92;return e?r&&this.replaceToken(132):this.checkReservedWord(t,s,r,!1),this.next(),t}checkReservedWord(e,t,s,i){if(!(e.length>10)&&function(e){return me.has(e)}(e))if(s&&function(e){return he.has(e)}(e))this.raise(b.UnexpectedKeyword,t,{keyword:e});else if((this.state.strict?i?fe:ue:pe)(e,this.inModule))this.raise(b.UnexpectedReservedWord,t,{reservedWord:e});else if("yield"===e){if(this.prodParam.hasYield)return void this.raise(b.YieldBindingIdentifier,t)}else if("await"===e){if(this.prodParam.hasAwait)return void this.raise(b.AwaitBindingIdentifier,t);if(this.scope.inStaticBlock)return void this.raise(b.AwaitBindingIdentifierInStaticBlock,t);this.expressionScope.recordAsyncArrowParametersError(t)}else if("arguments"===e&&this.scope.inClassAndNotInNonArrowFunction)return void this.raise(b.ArgumentsInClass,t)}isAwaitAllowed(){return!!this.prodParam.hasAwait||!(!this.options.allowAwaitOutsideFunction||this.scope.inFunction)}parseAwait(e){const t=this.startNodeAt(e);return this.expressionScope.recordParameterInitializerError(b.AwaitExpressionFormalParameter,t),this.eat(55)&&this.raise(b.ObsoleteAwaitStar,t),this.scope.inFunction||this.options.allowAwaitOutsideFunction||(this.isAmbiguousAwait()?this.ambiguousScriptDifferentAst=!0:this.sawUnambiguousESM=!0),this.state.soloAwait||(t.argument=this.parseMaybeUnary(null,!0)),this.finishNode(t,"AwaitExpression")}isAmbiguousAwait(){if(this.hasPrecedingLineBreak())return!0;const{type:e}=this.state;return 53===e||10===e||0===e||Z(e)||102===e&&!this.state.containsEsc||137===e||56===e||this.hasPlugin("v8intrinsic")&&54===e}parseYield(){const e=this.startNode();this.expressionScope.recordParameterInitializerError(b.YieldInParameter,e),this.next();let t=!1,s=null;if(!this.hasPrecedingLineBreak())switch(t=this.eat(55),this.state.type){case 13:case 139:case 8:case 11:case 3:case 9:case 14:case 12:if(!t)break;default:s=this.parseMaybeAssign()}return e.delegate=t,e.argument=s,this.finishNode(e,"YieldExpression")}parseImportCall(e){return this.next(),e.source=this.parseMaybeAssignAllowIn(),(this.hasPlugin("importAttributes")||this.hasPlugin("importAssertions"))&&(e.options=null),this.eat(12)&&(this.expectImportAttributesPlugin(),this.match(11)||(e.options=this.parseMaybeAssignAllowIn(),this.eat(12))),this.expect(11),this.finishNode(e,"ImportExpression")}checkPipelineAtInfixOperator(e,t){this.hasPlugin(["pipelineOperator",{proposal:"smart"}])&&"SequenceExpression"===e.type&&this.raise(b.PipelineHeadSequenceExpression,t)}parseSmartPipelineBodyInStyle(e,t){if(this.isSimpleReference(e)){const s=this.startNodeAt(t);return s.callee=e,this.finishNode(s,"PipelineBareFunction")}{const s=this.startNodeAt(t);return this.checkSmartPipeTopicBodyEarlyErrors(t),s.expression=e,this.finishNode(s,"PipelineTopicExpression")}}isSimpleReference(e){switch(e.type){case"MemberExpression":return!e.computed&&this.isSimpleReference(e.object);case"Identifier":return!0;default:return!1}}checkSmartPipeTopicBodyEarlyErrors(e){if(this.match(19))throw this.raise(b.PipelineBodyNoArrow,this.state.startLoc);this.topicReferenceWasUsedInCurrentContext()||this.raise(b.PipelineTopicUnused,e)}withTopicBindingContext(e){const t=this.state.topicContext;this.state.topicContext={maxNumOfResolvableTopics:1,maxTopicIndex:null};try{return e()}finally{this.state.topicContext=t}}withSmartMixTopicForbiddingContext(e){if(!this.hasPlugin(["pipelineOperator",{proposal:"smart"}]))return e();{const t=this.state.topicContext;this.state.topicContext={maxNumOfResolvableTopics:0,maxTopicIndex:null};try{return e()}finally{this.state.topicContext=t}}}withSoloAwaitPermittingContext(e){const t=this.state.soloAwait;this.state.soloAwait=!0;try{return e()}finally{this.state.soloAwait=t}}allowInAnd(e){const t=this.prodParam.currentFlags();if(8&~t){this.prodParam.enter(8|t);try{return e()}finally{this.prodParam.exit()}}return e()}disallowInAnd(e){const t=this.prodParam.currentFlags();if(8&t){this.prodParam.enter(-9&t);try{return e()}finally{this.prodParam.exit()}}return e()}registerTopicReference(){this.state.topicContext.maxTopicIndex=0}topicReferenceIsAllowedInCurrentContext(){return this.state.topicContext.maxNumOfResolvableTopics>=1}topicReferenceWasUsedInCurrentContext(){return null!=this.state.topicContext.maxTopicIndex&&this.state.topicContext.maxTopicIndex>=0}parseFSharpPipelineBody(e){const t=this.state.startLoc;this.state.potentialArrowAt=this.state.start;const s=this.state.inFSharpPipelineDirectBody;this.state.inFSharpPipelineDirectBody=!0;const i=this.parseExprOp(this.parseMaybeUnaryOrPrivate(),t,e);return this.state.inFSharpPipelineDirectBody=s,i}parseModuleExpression(){this.expectPlugin("moduleBlocks");const e=this.startNode();this.next(),this.match(5)||this.unexpected(null,5);const t=this.startNodeAt(this.state.endLoc);this.next();const s=this.initializeScopes(!0);this.enterInitialScopes();try{e.body=this.parseProgram(t,8,"module")}finally{s()}return this.finishNode(e,"ModuleExpression")}parsePropertyNamePrefixOperator(e){}}const Ft={kind:1},Bt={kind:2},Ut=/[\uD800-\uDFFF]/u,jt=/in(?:stanceof)?/y;class zt extends Rt{parseTopLevel(e,t){return e.program=this.parseProgram(t),e.comments=this.comments,this.options.tokens&&(e.tokens=function(e,t){for(let s=0;s<e.length;s++){const i=e[s],{type:r}=i;if("number"==typeof r){if(138===r){const{loc:t,start:r,value:a,end:o}=i,h=r+1,c=n(t.start,1);e.splice(s,1,new Ve({type:X(27),value:"#",start:r,end:h,startLoc:t.start,endLoc:c}),new Ve({type:X(132),value:a,start:h,end:o,startLoc:c,endLoc:t.end})),s++;continue}if(Z(r)){const{loc:a,start:o,value:h,end:c}=i,l=o+1,p=n(a.start,1);let u,d,f,m,y;u=96===t.charCodeAt(o)?new Ve({type:X(22),value:"`",start:o,end:l,startLoc:a.start,endLoc:p}):new Ve({type:X(8),value:"}",start:o,end:l,startLoc:a.start,endLoc:p}),24===r?(f=c-1,m=n(a.end,-1),d=null===h?null:h.slice(1,-1),y=new Ve({type:X(22),value:"`",start:f,end:c,startLoc:m,endLoc:a.end})):(f=c-2,m=n(a.end,-2),d=null===h?null:h.slice(1,-2),y=new Ve({type:X(23),value:"${",start:f,end:c,startLoc:m,endLoc:a.end})),e.splice(s,1,u,new Ve({type:X(20),value:d,start:l,end:f,startLoc:p,endLoc:m}),y),s+=2;continue}i.type=X(r)}}return e}(this.tokens,this.input)),this.finishNode(e,"File")}parseProgram(e,t=139,s=this.options.sourceType){if(e.sourceType=s,e.interpreter=this.parseInterpreterDirective(),this.parseBlockBody(e,!0,!0,t),this.inModule&&!this.options.allowUndeclaredExports&&this.scope.undefinedExports.size>0)for(const[e,t]of Array.from(this.scope.undefinedExports))this.raise(b.ModuleExportUndefined,t,{localName:e});let i;return i=139===t?this.finishNode(e,"Program"):this.finishNodeAt(e,"Program",n(this.state.startLoc,-1)),i}stmtToDirective(e){const t=e;t.type="Directive",t.value=t.expression,delete t.expression;const s=t.value,i=s.value,r=this.input.slice(s.start,s.end),n=s.value=r.slice(1,-1);return this.addExtra(s,"raw",r),this.addExtra(s,"rawValue",n),this.addExtra(s,"expressionValue",i),s.type="DirectiveLiteral",t}parseInterpreterDirective(){if(!this.match(28))return null;const e=this.startNode();return e.value=this.state.value,this.next(),this.finishNode(e,"InterpreterDirective")}isLet(){return!!this.isContextual(100)&&this.hasFollowingBindingAtom()}chStartsBindingIdentifier(e,t){if(ae(e)){if(jt.lastIndex=t,jt.test(this.input)){const e=this.codePointAtPos(jt.lastIndex);if(!oe(e)&&92!==e)return!1}return!0}return 92===e}chStartsBindingPattern(e){return 91===e||123===e}hasFollowingBindingAtom(){const e=this.nextTokenStart(),t=this.codePointAtPos(e);return this.chStartsBindingPattern(t)||this.chStartsBindingIdentifier(t,e)}hasInLineFollowingBindingIdentifier(){const e=this.nextTokenInLineStart(),t=this.codePointAtPos(e);return this.chStartsBindingIdentifier(t,e)}startsUsingForOf(){const{type:e,containsEsc:t}=this.lookahead();return!(102===e&&!t)&&(H(e)&&!this.hasFollowingLineBreak()?(this.expectPlugin("explicitResourceManagement"),!0):void 0)}startsAwaitUsing(){let e=this.nextTokenInLineStart();if(this.isUnparsedContextual(e,"using")){e=this.nextTokenInLineStartSince(e+5);const t=this.codePointAtPos(e);if(this.chStartsBindingIdentifier(t,e))return this.expectPlugin("explicitResourceManagement"),!0}return!1}parseModuleItem(){return this.parseStatementLike(15)}parseStatementListItem(){return this.parseStatementLike(6|(!this.options.annexB||this.state.strict?0:8))}parseStatementOrSloppyAnnexBFunctionDeclaration(e=!1){let t=0;return this.options.annexB&&!this.state.strict&&(t|=4,e&&(t|=8)),this.parseStatementLike(t)}parseStatement(){return this.parseStatementLike(0)}parseStatementLike(e){let t=null;return this.match(26)&&(t=this.parseDecorators(!0)),this.parseStatementContent(e,t)}parseStatementContent(e,t){const s=this.state.type,i=this.startNode(),r=!!(2&e),n=!!(4&e),a=1&e;switch(s){case 60:return this.parseBreakContinueStatement(i,!0);case 63:return this.parseBreakContinueStatement(i,!1);case 64:return this.parseDebuggerStatement(i);case 90:return this.parseDoWhileStatement(i);case 91:return this.parseForStatement(i);case 68:if(46===this.lookaheadCharCode())break;return n||this.raise(this.state.strict?b.StrictFunction:this.options.annexB?b.SloppyFunctionAnnexB:b.SloppyFunction,this.state.startLoc),this.parseFunctionStatement(i,!1,!r&&n);case 80:return r||this.unexpected(),this.parseClass(this.maybeTakeDecorators(t,i),!0);case 69:return this.parseIfStatement(i);case 70:return this.parseReturnStatement(i);case 71:return this.parseSwitchStatement(i);case 72:return this.parseThrowStatement(i);case 73:return this.parseTryStatement(i);case 96:if(!this.state.containsEsc&&this.startsAwaitUsing())return this.isAwaitAllowed()?r||this.raise(b.UnexpectedLexicalDeclaration,i):this.raise(b.AwaitUsingNotInAsyncContext,i),this.next(),this.parseVarStatement(i,"await using");break;case 107:if(this.state.containsEsc||!this.hasInLineFollowingBindingIdentifier())break;return this.expectPlugin("explicitResourceManagement"),!this.scope.inModule&&this.scope.inTopLevel?this.raise(b.UnexpectedUsingDeclaration,this.state.startLoc):r||this.raise(b.UnexpectedLexicalDeclaration,this.state.startLoc),this.parseVarStatement(i,"using");case 100:{if(this.state.containsEsc)break;const e=this.nextTokenStart(),t=this.codePointAtPos(e);if(91!==t){if(!r&&this.hasFollowingLineBreak())break;if(!this.chStartsBindingIdentifier(t,e)&&123!==t)break}}case 75:r||this.raise(b.UnexpectedLexicalDeclaration,this.state.startLoc);case 74:{const e=this.state.value;return this.parseVarStatement(i,e)}case 92:return this.parseWhileStatement(i);case 76:return this.parseWithStatement(i);case 5:return this.parseBlock();case 13:return this.parseEmptyStatement(i);case 83:{const e=this.lookaheadCharCode();if(40===e||46===e)break}case 82:{let e;return this.options.allowImportExportEverywhere||a||this.raise(b.UnexpectedImportExport,this.state.startLoc),this.next(),83===s?(e=this.parseImport(i),"ImportDeclaration"!==e.type||e.importKind&&"value"!==e.importKind||(this.sawUnambiguousESM=!0)):(e=this.parseExport(i,t),("ExportNamedDeclaration"!==e.type||e.exportKind&&"value"!==e.exportKind)&&("ExportAllDeclaration"!==e.type||e.exportKind&&"value"!==e.exportKind)&&"ExportDefaultDeclaration"!==e.type||(this.sawUnambiguousESM=!0)),this.assertModuleNodeAllowed(e),e}default:if(this.isAsyncFunction())return r||this.raise(b.AsyncFunctionInSingleStatementContext,this.state.startLoc),this.next(),this.parseFunctionStatement(i,!0,!r&&n)}const o=this.state.value,h=this.parseExpression();return H(s)&&"Identifier"===h.type&&this.eat(14)?this.parseLabeledStatement(i,o,h,e):this.parseExpressionStatement(i,h,t)}assertModuleNodeAllowed(e){this.options.allowImportExportEverywhere||this.inModule||this.raise(b.ImportOutsideModule,e)}decoratorsEnabledBeforeExport(){return!!this.hasPlugin("decorators-legacy")||this.hasPlugin("decorators")&&!1!==this.getPluginOption("decorators","decoratorsBeforeExport")}maybeTakeDecorators(e,t,s){return e&&(t.decorators&&t.decorators.length>0?("boolean"!=typeof this.getPluginOption("decorators","decoratorsBeforeExport")&&this.raise(b.DecoratorsBeforeAfterExport,t.decorators[0]),t.decorators.unshift(...e)):t.decorators=e,this.resetStartLocationFromNode(t,e[0]),s&&this.resetStartLocationFromNode(s,t)),t}canHaveLeadingDecorator(){return this.match(80)}parseDecorators(e){const t=[];do{t.push(this.parseDecorator())}while(this.match(26));if(this.match(82))e||this.unexpected(),this.decoratorsEnabledBeforeExport()||this.raise(b.DecoratorExportClass,this.state.startLoc);else if(!this.canHaveLeadingDecorator())throw this.raise(b.UnexpectedLeadingDecorator,this.state.startLoc);return t}parseDecorator(){this.expectOnePlugin(["decorators","decorators-legacy"]);const e=this.startNode();if(this.next(),this.hasPlugin("decorators")){const t=this.state.startLoc;let s;if(this.match(10)){const t=this.state.startLoc;this.next(),s=this.parseExpression(),this.expect(11),s=this.wrapParenthesis(t,s);const i=this.state.startLoc;e.expression=this.parseMaybeDecoratorArguments(s),!1===this.getPluginOption("decorators","allowCallParenthesized")&&e.expression!==s&&this.raise(b.DecoratorArgumentsOutsideParentheses,i)}else{for(s=this.parseIdentifier(!1);this.eat(16);){const e=this.startNodeAt(t);e.object=s,this.match(138)?(this.classScope.usePrivateName(this.state.value,this.state.startLoc),e.property=this.parsePrivateName()):e.property=this.parseIdentifier(!0),e.computed=!1,s=this.finishNode(e,"MemberExpression")}e.expression=this.parseMaybeDecoratorArguments(s)}}else e.expression=this.parseExprSubscripts();return this.finishNode(e,"Decorator")}parseMaybeDecoratorArguments(e){if(this.eat(10)){const t=this.startNodeAtNode(e);return t.callee=e,t.arguments=this.parseCallExpressionArguments(11,!1),this.toReferencedList(t.arguments),this.finishNode(t,"CallExpression")}return e}parseBreakContinueStatement(e,t){return this.next(),this.isLineTerminator()?e.label=null:(e.label=this.parseIdentifier(),this.semicolon()),this.verifyBreakContinue(e,t),this.finishNode(e,t?"BreakStatement":"ContinueStatement")}verifyBreakContinue(e,t){let s;for(s=0;s<this.state.labels.length;++s){const i=this.state.labels[s];if(null==e.label||i.name===e.label.name){if(null!=i.kind&&(t||1===i.kind))break;if(e.label&&t)break}}if(s===this.state.labels.length){const s=t?"BreakStatement":"ContinueStatement";this.raise(b.IllegalBreakContinue,e,{type:s})}}parseDebuggerStatement(e){return this.next(),this.semicolon(),this.finishNode(e,"DebuggerStatement")}parseHeaderExpression(){this.expect(10);const e=this.parseExpression();return this.expect(11),e}parseDoWhileStatement(e){return this.next(),this.state.labels.push(Ft),e.body=this.withSmartMixTopicForbiddingContext((()=>this.parseStatement())),this.state.labels.pop(),this.expect(92),e.test=this.parseHeaderExpression(),this.eat(13),this.finishNode(e,"DoWhileStatement")}parseForStatement(e){this.next(),this.state.labels.push(Ft);let t=null;if(this.isAwaitAllowed()&&this.eatContextual(96)&&(t=this.state.lastTokStartLoc),this.scope.enter(0),this.expect(10),this.match(13))return null!==t&&this.unexpected(t),this.parseFor(e,null);const s=this.isContextual(100);{const i=this.isContextual(96)&&this.startsAwaitUsing(),r=i||this.isContextual(107)&&this.startsUsingForOf(),n=s&&this.hasFollowingBindingAtom()||r;if(this.match(74)||this.match(75)||n){const s=this.startNode();let n;i?(n="await using",this.isAwaitAllowed()||this.raise(b.AwaitUsingNotInAsyncContext,this.state.startLoc),this.next()):n=this.state.value,this.next(),this.parseVar(s,!0,n);const a=this.finishNode(s,"VariableDeclaration"),o=this.match(58);return o&&r&&this.raise(b.ForInUsing,a),(o||this.isContextual(102))&&1===a.declarations.length?this.parseForIn(e,a,t):(null!==t&&this.unexpected(t),this.parseFor(e,a))}}const i=this.isContextual(95),r=new tt,n=this.parseExpression(!0,r),a=this.isContextual(102);if(a&&(s&&this.raise(b.ForOfLet,n),null===t&&i&&"Identifier"===n.type&&this.raise(b.ForOfAsync,n)),a||this.match(58)){this.checkDestructuringPrivate(r),this.toAssignable(n,!0);const s=a?"ForOfStatement":"ForInStatement";return this.checkLVal(n,{in:{type:s}}),this.parseForIn(e,n,t)}return this.checkExpressionErrors(r,!0),null!==t&&this.unexpected(t),this.parseFor(e,n)}parseFunctionStatement(e,t,s){return this.next(),this.parseFunction(e,1|(s?2:0)|(t?8:0))}parseIfStatement(e){return this.next(),e.test=this.parseHeaderExpression(),e.consequent=this.parseStatementOrSloppyAnnexBFunctionDeclaration(),e.alternate=this.eat(66)?this.parseStatementOrSloppyAnnexBFunctionDeclaration():null,this.finishNode(e,"IfStatement")}parseReturnStatement(e){return this.prodParam.hasReturn||this.options.allowReturnOutsideFunction||this.raise(b.IllegalReturn,this.state.startLoc),this.next(),this.isLineTerminator()?e.argument=null:(e.argument=this.parseExpression(),this.semicolon()),this.finishNode(e,"ReturnStatement")}parseSwitchStatement(e){this.next(),e.discriminant=this.parseHeaderExpression();const t=e.cases=[];let s;this.expect(5),this.state.labels.push(Bt),this.scope.enter(0);for(let e;!this.match(8);)if(this.match(61)||this.match(65)){const i=this.match(61);s&&this.finishNode(s,"SwitchCase"),t.push(s=this.startNode()),s.consequent=[],this.next(),i?s.test=this.parseExpression():(e&&this.raise(b.MultipleDefaultsInSwitch,this.state.lastTokStartLoc),e=!0,s.test=null),this.expect(14)}else s?s.consequent.push(this.parseStatementListItem()):this.unexpected();return this.scope.exit(),s&&this.finishNode(s,"SwitchCase"),this.next(),this.state.labels.pop(),this.finishNode(e,"SwitchStatement")}parseThrowStatement(e){return this.next(),this.hasPrecedingLineBreak()&&this.raise(b.NewlineAfterThrow,this.state.lastTokEndLoc),e.argument=this.parseExpression(),this.semicolon(),this.finishNode(e,"ThrowStatement")}parseCatchClauseParam(){const e=this.parseBindingAtom();return this.scope.enter(this.options.annexB&&"Identifier"===e.type?8:0),this.checkLVal(e,{in:{type:"CatchClause"},binding:9}),e}parseTryStatement(e){if(this.next(),e.block=this.parseBlock(),e.handler=null,this.match(62)){const t=this.startNode();this.next(),this.match(10)?(this.expect(10),t.param=this.parseCatchClauseParam(),this.expect(11)):(t.param=null,this.scope.enter(0)),t.body=this.withSmartMixTopicForbiddingContext((()=>this.parseBlock(!1,!1))),this.scope.exit(),e.handler=this.finishNode(t,"CatchClause")}return e.finalizer=this.eat(67)?this.parseBlock():null,e.handler||e.finalizer||this.raise(b.NoCatchOrFinally,e),this.finishNode(e,"TryStatement")}parseVarStatement(e,t,s=!1){return this.next(),this.parseVar(e,!1,t,s),this.semicolon(),this.finishNode(e,"VariableDeclaration")}parseWhileStatement(e){return this.next(),e.test=this.parseHeaderExpression(),this.state.labels.push(Ft),e.body=this.withSmartMixTopicForbiddingContext((()=>this.parseStatement())),this.state.labels.pop(),this.finishNode(e,"WhileStatement")}parseWithStatement(e){return this.state.strict&&this.raise(b.StrictWith,this.state.startLoc),this.next(),e.object=this.parseHeaderExpression(),e.body=this.withSmartMixTopicForbiddingContext((()=>this.parseStatement())),this.finishNode(e,"WithStatement")}parseEmptyStatement(e){return this.next(),this.finishNode(e,"EmptyStatement")}parseLabeledStatement(e,t,s,i){for(const e of this.state.labels)e.name===t&&this.raise(b.LabelRedeclaration,s,{labelName:t});const r=(n=this.state.type)>=90&&n<=92?1:this.match(71)?2:null;var n;for(let t=this.state.labels.length-1;t>=0;t--){const s=this.state.labels[t];if(s.statementStart!==e.start)break;s.statementStart=this.state.start,s.kind=r}return this.state.labels.push({name:t,kind:r,statementStart:this.state.start}),e.body=8&i?this.parseStatementOrSloppyAnnexBFunctionDeclaration(!0):this.parseStatement(),this.state.labels.pop(),e.label=s,this.finishNode(e,"LabeledStatement")}parseExpressionStatement(e,t,s){return e.expression=t,this.semicolon(),this.finishNode(e,"ExpressionStatement")}parseBlock(e=!1,t=!0,s){const i=this.startNode();return e&&this.state.strictErrors.clear(),this.expect(5),t&&this.scope.enter(0),this.parseBlockBody(i,e,!1,8,s),t&&this.scope.exit(),this.finishNode(i,"BlockStatement")}isValidDirective(e){return"ExpressionStatement"===e.type&&"StringLiteral"===e.expression.type&&!e.expression.extra.parenthesized}parseBlockBody(e,t,s,i,r){const n=e.body=[],a=e.directives=[];this.parseBlockOrModuleBlockBody(n,t?a:void 0,s,i,r)}parseBlockOrModuleBlockBody(e,t,s,i,r){const n=this.state.strict;let a=!1,o=!1;for(;!this.match(i);){const i=s?this.parseModuleItem():this.parseStatementListItem();if(t&&!o){if(this.isValidDirective(i)){const e=this.stmtToDirective(i);t.push(e),a||"use strict"!==e.value.value||(a=!0,this.setStrict(!0));continue}o=!0,this.state.strictErrors.clear()}e.push(i)}null==r||r.call(this,a),n||this.setStrict(!1),this.next()}parseFor(e,t){return e.init=t,this.semicolon(!1),e.test=this.match(13)?null:this.parseExpression(),this.semicolon(!1),e.update=this.match(11)?null:this.parseExpression(),this.expect(11),e.body=this.withSmartMixTopicForbiddingContext((()=>this.parseStatement())),this.scope.exit(),this.state.labels.pop(),this.finishNode(e,"ForStatement")}parseForIn(e,t,s){const i=this.match(58);return this.next(),i?null!==s&&this.unexpected(s):e.await=null!==s,"VariableDeclaration"!==t.type||null==t.declarations[0].init||i&&this.options.annexB&&!this.state.strict&&"var"===t.kind&&"Identifier"===t.declarations[0].id.type||this.raise(b.ForInOfLoopInitializer,t,{type:i?"ForInStatement":"ForOfStatement"}),"AssignmentPattern"===t.type&&this.raise(b.InvalidLhs,t,{ancestor:{type:"ForStatement"}}),e.left=t,e.right=i?this.parseExpression():this.parseMaybeAssignAllowIn(),this.expect(11),e.body=this.withSmartMixTopicForbiddingContext((()=>this.parseStatement())),this.scope.exit(),this.state.labels.pop(),this.finishNode(e,i?"ForInStatement":"ForOfStatement")}parseVar(e,t,s,i=!1){const r=e.declarations=[];for(e.kind=s;;){const e=this.startNode();if(this.parseVarId(e,s),e.init=this.eat(29)?t?this.parseMaybeAssignDisallowIn():this.parseMaybeAssignAllowIn():null,null!==e.init||i||("Identifier"===e.id.type||t&&(this.match(58)||this.isContextual(102))?"const"!==s&&"using"!==s&&"await using"!==s||this.match(58)||this.isContextual(102)||this.raise(b.DeclarationMissingInitializer,this.state.lastTokEndLoc,{kind:s}):this.raise(b.DeclarationMissingInitializer,this.state.lastTokEndLoc,{kind:"destructuring"})),r.push(this.finishNode(e,"VariableDeclarator")),!this.eat(12))break}return e}parseVarId(e,t){const s=this.parseBindingAtom();this.checkLVal(s,{in:{type:"VariableDeclarator"},binding:"var"===t?5:8201}),e.id=s}parseAsyncFunctionExpression(e){return this.parseFunction(e,8)}parseFunction(e,t=0){const s=2&t,i=!!(1&t),r=i&&!(4&t),n=!!(8&t);this.initFunction(e,n),this.match(55)&&(s&&this.raise(b.GeneratorInSingleStatementContext,this.state.startLoc),this.next(),e.generator=!0),i&&(e.id=this.parseFunctionId(r));const a=this.state.maybeInArrowParameters;return this.state.maybeInArrowParameters=!1,this.scope.enter(2),this.prodParam.enter(Qe(n,e.generator)),i||(e.id=this.parseFunctionId()),this.parseFunctionParams(e,!1),this.withSmartMixTopicForbiddingContext((()=>{this.parseFunctionBodyAndFinish(e,i?"FunctionDeclaration":"FunctionExpression")})),this.prodParam.exit(),this.scope.exit(),i&&!s&&this.registerFunctionStatementId(e),this.state.maybeInArrowParameters=a,e}parseFunctionId(e){return e||H(this.state.type)?this.parseIdentifier():null}parseFunctionParams(e,t){this.expect(10),this.expressionScope.enter(new Ge(3)),e.params=this.parseBindingList(11,41,2|(t?4:0)),this.expressionScope.exit()}registerFunctionStatementId(e){e.id&&this.scope.declareName(e.id.name,!this.options.annexB||this.state.strict||e.generator||e.async?this.scope.treatFunctionsAsVar?5:8201:17,e.id.loc.start)}parseClass(e,t,s){this.next();const i=this.state.strict;return this.state.strict=!0,this.parseClassId(e,t,s),this.parseClassSuper(e),e.body=this.parseClassBody(!!e.superClass,i),this.finishNode(e,t?"ClassDeclaration":"ClassExpression")}isClassProperty(){return this.match(29)||this.match(13)||this.match(8)}isClassMethod(){return this.match(10)}isNonstaticConstructor(e){return!(e.computed||e.static||"constructor"!==e.key.name&&"constructor"!==e.key.value)}parseClassBody(e,t){this.classScope.enter();const s={hadConstructor:!1,hadSuperClass:e};let i=[];const r=this.startNode();if(r.body=[],this.expect(5),this.withSmartMixTopicForbiddingContext((()=>{for(;!this.match(8);){if(this.eat(13)){if(i.length>0)throw this.raise(b.DecoratorSemicolon,this.state.lastTokEndLoc);continue}if(this.match(26)){i.push(this.parseDecorator());continue}const e=this.startNode();i.length&&(e.decorators=i,this.resetStartLocationFromNode(e,i[0]),i=[]),this.parseClassMember(r,e,s),"constructor"===e.kind&&e.decorators&&e.decorators.length>0&&this.raise(b.DecoratorConstructor,e)}})),this.state.strict=t,this.next(),i.length)throw this.raise(b.TrailingDecorator,this.state.startLoc);return this.classScope.exit(),this.finishNode(r,"ClassBody")}parseClassMemberFromModifier(e,t){const s=this.parseIdentifier(!0);if(this.isClassMethod()){const i=t;return i.kind="method",i.computed=!1,i.key=s,i.static=!1,this.pushClassMethod(e,i,!1,!1,!1,!1),!0}if(this.isClassProperty()){const i=t;return i.computed=!1,i.key=s,i.static=!1,e.body.push(this.parseClassProperty(i)),!0}return this.resetPreviousNodeTrailingComments(s),!1}parseClassMember(e,t,s){const i=this.isContextual(106);if(i){if(this.parseClassMemberFromModifier(e,t))return;if(this.eat(5))return void this.parseClassStaticBlock(e,t)}this.parseClassMemberWithIsStatic(e,t,s,i)}parseClassMemberWithIsStatic(e,t,s,i){const r=t,n=t,a=t,o=t,h=t,c=r,l=r;if(t.static=i,this.parsePropertyNamePrefixOperator(t),this.eat(55)){c.kind="method";const t=this.match(138);return this.parseClassElementName(c),t?void this.pushClassPrivateMethod(e,n,!0,!1):(this.isNonstaticConstructor(r)&&this.raise(b.ConstructorIsGenerator,r.key),void this.pushClassMethod(e,r,!0,!1,!1,!1))}const p=H(this.state.type)&&!this.state.containsEsc,u=this.match(138),d=this.parseClassElementName(t),f=this.state.startLoc;if(this.parsePostMemberNameModifiers(l),this.isClassMethod()){if(c.kind="method",u)return void this.pushClassPrivateMethod(e,n,!1,!1);const i=this.isNonstaticConstructor(r);let a=!1;i&&(r.kind="constructor",s.hadConstructor&&!this.hasPlugin("typescript")&&this.raise(b.DuplicateConstructor,d),i&&this.hasPlugin("typescript")&&t.override&&this.raise(b.OverrideOnConstructor,d),s.hadConstructor=!0,a=s.hadSuperClass),this.pushClassMethod(e,r,!1,!1,i,a)}else if(this.isClassProperty())u?this.pushClassPrivateProperty(e,o):this.pushClassProperty(e,a);else if(p&&"async"===d.name&&!this.isLineTerminator()){this.resetPreviousNodeTrailingComments(d);const t=this.eat(55);l.optional&&this.unexpected(f),c.kind="method";const s=this.match(138);this.parseClassElementName(c),this.parsePostMemberNameModifiers(l),s?this.pushClassPrivateMethod(e,n,t,!0):(this.isNonstaticConstructor(r)&&this.raise(b.ConstructorIsAsync,r.key),this.pushClassMethod(e,r,t,!0,!1,!1))}else if(!p||"get"!==d.name&&"set"!==d.name||this.match(55)&&this.isLineTerminator())if(p&&"accessor"===d.name&&!this.isLineTerminator()){this.expectPlugin("decoratorAutoAccessors"),this.resetPreviousNodeTrailingComments(d);const t=this.match(138);this.parseClassElementName(a),this.pushClassAccessorProperty(e,h,t)}else this.isLineTerminator()?u?this.pushClassPrivateProperty(e,o):this.pushClassProperty(e,a):this.unexpected();else{this.resetPreviousNodeTrailingComments(d),c.kind=d.name;const t=this.match(138);this.parseClassElementName(r),t?this.pushClassPrivateMethod(e,n,!1,!1):(this.isNonstaticConstructor(r)&&this.raise(b.ConstructorIsAccessor,r.key),this.pushClassMethod(e,r,!1,!1,!1,!1)),this.checkGetterSetterParams(r)}}parseClassElementName(e){const{type:t,value:s}=this.state;if(132!==t&&133!==t||!e.static||"prototype"!==s||this.raise(b.StaticPrototype,this.state.startLoc),138===t){"constructor"===s&&this.raise(b.ConstructorClassPrivateField,this.state.startLoc);const t=this.parsePrivateName();return e.key=t,t}return this.parsePropertyName(e)}parseClassStaticBlock(e,t){var s;this.scope.enter(208);const i=this.state.labels;this.state.labels=[],this.prodParam.enter(0);const r=t.body=[];this.parseBlockOrModuleBlockBody(r,void 0,!1,8),this.prodParam.exit(),this.scope.exit(),this.state.labels=i,e.body.push(this.finishNode(t,"StaticBlock")),null!=(s=t.decorators)&&s.length&&this.raise(b.DecoratorStaticBlock,t)}pushClassProperty(e,t){t.computed||"constructor"!==t.key.name&&"constructor"!==t.key.value||this.raise(b.ConstructorClassField,t.key),e.body.push(this.parseClassProperty(t))}pushClassPrivateProperty(e,t){const s=this.parseClassPrivateProperty(t);e.body.push(s),this.classScope.declarePrivateName(this.getPrivateNameSV(s.key),0,s.key.loc.start)}pushClassAccessorProperty(e,t,s){if(!s&&!t.computed){const e=t.key;"constructor"!==e.name&&"constructor"!==e.value||this.raise(b.ConstructorClassField,e)}const i=this.parseClassAccessorProperty(t);e.body.push(i),s&&this.classScope.declarePrivateName(this.getPrivateNameSV(i.key),0,i.key.loc.start)}pushClassMethod(e,t,s,i,r,n){e.body.push(this.parseMethod(t,s,i,r,n,"ClassMethod",!0))}pushClassPrivateMethod(e,t,s,i){const r=this.parseMethod(t,s,i,!1,!1,"ClassPrivateMethod",!0);e.body.push(r);const n="get"===r.kind?r.static?6:2:"set"===r.kind?r.static?5:1:0;this.declareClassPrivateMethodInScope(r,n)}declareClassPrivateMethodInScope(e,t){this.classScope.declarePrivateName(this.getPrivateNameSV(e.key),t,e.key.loc.start)}parsePostMemberNameModifiers(e){}parseClassPrivateProperty(e){return this.parseInitializer(e),this.semicolon(),this.finishNode(e,"ClassPrivateProperty")}parseClassProperty(e){return this.parseInitializer(e),this.semicolon(),this.finishNode(e,"ClassProperty")}parseClassAccessorProperty(e){return this.parseInitializer(e),this.semicolon(),this.finishNode(e,"ClassAccessorProperty")}parseInitializer(e){this.scope.enter(80),this.expressionScope.enter(Ze()),this.prodParam.enter(0),e.value=this.eat(29)?this.parseMaybeAssignAllowIn():null,this.expressionScope.exit(),this.prodParam.exit(),this.scope.exit()}parseClassId(e,t,s,i=8331){if(H(this.state.type))e.id=this.parseIdentifier(),t&&this.declareNameFromIdentifier(e.id,i);else{if(!s&&t)throw this.raise(b.MissingClassName,this.state.startLoc);e.id=null}}parseClassSuper(e){e.superClass=this.eat(81)?this.parseExprSubscripts():null}parseExport(e,t){const s=this.parseMaybeImportPhase(e,!0),i=this.maybeParseExportDefaultSpecifier(e,s),r=!i||this.eat(12),n=r&&this.eatExportStar(e),a=n&&this.maybeParseExportNamespaceSpecifier(e),o=r&&(!a||this.eat(12)),h=i||n;if(n&&!a){if(i&&this.unexpected(),t)throw this.raise(b.UnsupportedDecoratorExport,e);return this.parseExportFrom(e,!0),this.finishNode(e,"ExportAllDeclaration")}const c=this.maybeParseExportNamedSpecifiers(e);let l;if(i&&r&&!n&&!c&&this.unexpected(null,5),a&&o&&this.unexpected(null,98),h||c){if(l=!1,t)throw this.raise(b.UnsupportedDecoratorExport,e);this.parseExportFrom(e,h)}else l=this.maybeParseExportDeclaration(e);if(h||c||l){var p;const s=e;if(this.checkExport(s,!0,!1,!!s.source),"ClassDeclaration"===(null==(p=s.declaration)?void 0:p.type))this.maybeTakeDecorators(t,s.declaration,s);else if(t)throw this.raise(b.UnsupportedDecoratorExport,e);return this.finishNode(s,"ExportNamedDeclaration")}if(this.eat(65)){const s=e,i=this.parseExportDefaultExpression();if(s.declaration=i,"ClassDeclaration"===i.type)this.maybeTakeDecorators(t,i,s);else if(t)throw this.raise(b.UnsupportedDecoratorExport,e);return this.checkExport(s,!0,!0),this.finishNode(s,"ExportDefaultDeclaration")}this.unexpected(null,5)}eatExportStar(e){return this.eat(55)}maybeParseExportDefaultSpecifier(e,t){if(t||this.isExportDefaultSpecifier()){this.expectPlugin("exportDefaultFrom",null==t?void 0:t.loc.start);const s=t||this.parseIdentifier(!0),i=this.startNodeAtNode(s);return i.exported=s,e.specifiers=[this.finishNode(i,"ExportDefaultSpecifier")],!0}return!1}maybeParseExportNamespaceSpecifier(e){if(this.isContextual(93)){e.specifiers||(e.specifiers=[]);const t=this.startNodeAt(this.state.lastTokStartLoc);return this.next(),t.exported=this.parseModuleExportName(),e.specifiers.push(this.finishNode(t,"ExportNamespaceSpecifier")),!0}return!1}maybeParseExportNamedSpecifiers(e){if(this.match(5)){e.specifiers||(e.specifiers=[]);const t="type"===e.exportKind;return e.specifiers.push(...this.parseExportSpecifiers(t)),e.source=null,e.declaration=null,this.hasPlugin("importAssertions")&&(e.assertions=[]),!0}return!1}maybeParseExportDeclaration(e){return!!this.shouldParseExportDeclaration()&&(e.specifiers=[],e.source=null,this.hasPlugin("importAssertions")&&(e.assertions=[]),e.declaration=this.parseExportDeclaration(e),!0)}isAsyncFunction(){if(!this.isContextual(95))return!1;const e=this.nextTokenInLineStart();return this.isUnparsedContextual(e,"function")}parseExportDefaultExpression(){const e=this.startNode();if(this.match(68))return this.next(),this.parseFunction(e,5);if(this.isAsyncFunction())return this.next(),this.next(),this.parseFunction(e,13);if(this.match(80))return this.parseClass(e,!0,!0);if(this.match(26))return this.hasPlugin("decorators")&&!0===this.getPluginOption("decorators","decoratorsBeforeExport")&&this.raise(b.DecoratorBeforeExport,this.state.startLoc),this.parseClass(this.maybeTakeDecorators(this.parseDecorators(!1),this.startNode()),!0,!0);if(this.match(75)||this.match(74)||this.isLet())throw this.raise(b.UnsupportedDefaultExport,this.state.startLoc);const t=this.parseMaybeAssignAllowIn();return this.semicolon(),t}parseExportDeclaration(e){return this.match(80)?this.parseClass(this.startNode(),!0,!1):this.parseStatementListItem()}isExportDefaultSpecifier(){const{type:e}=this.state;if(H(e)){if(95===e&&!this.state.containsEsc||100===e)return!1;if((130===e||129===e)&&!this.state.containsEsc){const{type:e}=this.lookahead();if(H(e)&&98!==e||5===e)return this.expectOnePlugin(["flow","typescript"]),!1}}else if(!this.match(65))return!1;const t=this.nextTokenStart(),s=this.isUnparsedContextual(t,"from");if(44===this.input.charCodeAt(t)||H(this.state.type)&&s)return!0;if(this.match(65)&&s){const e=this.input.charCodeAt(this.nextTokenStartSince(t+4));return 34===e||39===e}return!1}parseExportFrom(e,t){this.eatContextual(98)?(e.source=this.parseImportSource(),this.checkExport(e),this.maybeParseImportAttributes(e),this.checkJSONModuleImport(e)):t&&this.unexpected(),this.semicolon()}shouldParseExportDeclaration(){const{type:e}=this.state;return 26===e&&(this.expectOnePlugin(["decorators","decorators-legacy"]),this.hasPlugin("decorators"))?(!0===this.getPluginOption("decorators","decoratorsBeforeExport")&&this.raise(b.DecoratorBeforeExport,this.state.startLoc),!0):74===e||75===e||68===e||80===e||this.isLet()||this.isAsyncFunction()}checkExport(e,t,s,i){var r;if(t)if(s){if(this.checkDuplicateExports(e,"default"),this.hasPlugin("exportDefaultFrom")){var n;const t=e.declaration;"Identifier"!==t.type||"from"!==t.name||t.end-t.start!=4||null!=(n=t.extra)&&n.parenthesized||this.raise(b.ExportDefaultFromAsIdentifier,t)}}else if(null!=(r=e.specifiers)&&r.length)for(const t of e.specifiers){const{exported:e}=t,s="Identifier"===e.type?e.name:e.value;if(this.checkDuplicateExports(t,s),!i&&t.local){const{local:e}=t;"Identifier"!==e.type?this.raise(b.ExportBindingIsString,t,{localName:e.value,exportName:s}):(this.checkReservedWord(e.name,e.loc.start,!0,!1),this.scope.checkLocalExport(e))}}else if(e.declaration)if("FunctionDeclaration"===e.declaration.type||"ClassDeclaration"===e.declaration.type){const t=e.declaration.id;if(!t)throw new Error("Assertion failure");this.checkDuplicateExports(e,t.name)}else if("VariableDeclaration"===e.declaration.type)for(const t of e.declaration.declarations)this.checkDeclaration(t.id)}checkDeclaration(e){if("Identifier"===e.type)this.checkDuplicateExports(e,e.name);else if("ObjectPattern"===e.type)for(const t of e.properties)this.checkDeclaration(t);else if("ArrayPattern"===e.type)for(const t of e.elements)t&&this.checkDeclaration(t);else"ObjectProperty"===e.type?this.checkDeclaration(e.value):"RestElement"===e.type?this.checkDeclaration(e.argument):"AssignmentPattern"===e.type&&this.checkDeclaration(e.left)}checkDuplicateExports(e,t){this.exportedIdentifiers.has(t)&&("default"===t?this.raise(b.DuplicateDefaultExport,e):this.raise(b.DuplicateExport,e,{exportName:t})),this.exportedIdentifiers.add(t)}parseExportSpecifiers(e){const t=[];let s=!0;for(this.expect(5);!this.eat(8);){if(s)s=!1;else if(this.expect(12),this.eat(8))break;const i=this.isContextual(130),r=this.match(133),n=this.startNode();n.local=this.parseModuleExportName(),t.push(this.parseExportSpecifier(n,r,e,i))}return t}parseExportSpecifier(e,t,s,i){return this.eatContextual(93)?e.exported=this.parseModuleExportName():t?e.exported=function(e){const{type:t,start:s,end:i,loc:r,range:n,extra:a}=e;if("Placeholder"===t)return function(e){return rt(e)}(e);const o=Object.create(it);return o.type=t,o.start=s,o.end=i,o.loc=r,o.range=n,void 0!==e.raw?o.raw=e.raw:o.extra=a,o.value=e.value,o}(e.local):e.exported||(e.exported=rt(e.local)),this.finishNode(e,"ExportSpecifier")}parseModuleExportName(){if(this.match(133)){const e=this.parseStringLiteral(this.state.value),t=e.value.match(Ut);return t&&this.raise(b.ModuleExportNameHasLoneSurrogate,e,{surrogateCharCode:t[0].charCodeAt(0)}),e}return this.parseIdentifier(!0)}isJSONModuleImport(e){return null!=e.assertions&&e.assertions.some((({key:e,value:t})=>"json"===t.value&&("Identifier"===e.type?"type"===e.name:"type"===e.value)))}checkImportReflection(e){const{specifiers:t}=e,s=1===t.length?t[0].type:null;if("source"===e.phase)"ImportDefaultSpecifier"!==s&&this.raise(b.SourcePhaseImportRequiresDefault,t[0].loc.start);else if("defer"===e.phase)"ImportNamespaceSpecifier"!==s&&this.raise(b.DeferImportRequiresNamespace,t[0].loc.start);else if(e.module){var i;"ImportDefaultSpecifier"!==s&&this.raise(b.ImportReflectionNotBinding,t[0].loc.start),(null==(i=e.assertions)?void 0:i.length)>0&&this.raise(b.ImportReflectionHasAssertion,t[0].loc.start)}}checkJSONModuleImport(e){if(this.isJSONModuleImport(e)&&"ExportAllDeclaration"!==e.type){const{specifiers:t}=e;if(null!=t){const e=t.find((e=>{let t;if("ExportSpecifier"===e.type?t=e.local:"ImportSpecifier"===e.type&&(t=e.imported),void 0!==t)return"Identifier"===t.type?"default"!==t.name:"default"!==t.value}));void 0!==e&&this.raise(b.ImportJSONBindingNotDefault,e.loc.start)}}}isPotentialImportPhase(e){return!e&&(this.isContextual(105)||this.isContextual(97)||this.isContextual(127))}applyImportPhase(e,t,s,i){t||("module"===s?(this.expectPlugin("importReflection",i),e.module=!0):this.hasPlugin("importReflection")&&(e.module=!1),"source"===s?(this.expectPlugin("sourcePhaseImports",i),e.phase="source"):"defer"===s?(this.expectPlugin("deferredImportEvaluation",i),e.phase="defer"):this.hasPlugin("sourcePhaseImports")&&(e.phase=null))}parseMaybeImportPhase(e,t){if(!this.isPotentialImportPhase(t))return this.applyImportPhase(e,t,null),null;const s=this.parseIdentifier(!0),{type:i}=this.state;return(V(i)?98!==i||102===this.lookaheadCharCode():12!==i)?(this.resetPreviousIdentifierLeadingComments(s),this.applyImportPhase(e,t,s.name,s.loc.start),null):(this.applyImportPhase(e,t,null),s)}isPrecedingIdImportPhase(e){const{type:t}=this.state;return H(t)?98!==t||102===this.lookaheadCharCode():12!==t}parseImport(e){return this.match(133)?this.parseImportSourceAndAttributes(e):this.parseImportSpecifiersAndAfter(e,this.parseMaybeImportPhase(e,!1))}parseImportSpecifiersAndAfter(e,t){e.specifiers=[];const s=!this.maybeParseDefaultImportSpecifier(e,t)||this.eat(12),i=s&&this.maybeParseStarImportSpecifier(e);return s&&!i&&this.parseNamedImportSpecifiers(e),this.expectContextual(98),this.parseImportSourceAndAttributes(e)}parseImportSourceAndAttributes(e){return null!=e.specifiers||(e.specifiers=[]),e.source=this.parseImportSource(),this.maybeParseImportAttributes(e),this.checkImportReflection(e),this.checkJSONModuleImport(e),this.semicolon(),this.finishNode(e,"ImportDeclaration")}parseImportSource(){return this.match(133)||this.unexpected(),this.parseExprAtom()}parseImportSpecifierLocal(e,t,s){t.local=this.parseIdentifier(),e.specifiers.push(this.finishImportSpecifier(t,s))}finishImportSpecifier(e,t,s=8201){return this.checkLVal(e.local,{in:{type:t},binding:s}),this.finishNode(e,t)}parseImportAttributes(){this.expect(5);const e=[],t=new Set;do{if(this.match(8))break;const s=this.startNode(),i=this.state.value;if(t.has(i)&&this.raise(b.ModuleAttributesWithDuplicateKeys,this.state.startLoc,{key:i}),t.add(i),this.match(133)?s.key=this.parseStringLiteral(i):s.key=this.parseIdentifier(!0),this.expect(14),!this.match(133))throw this.raise(b.ModuleAttributeInvalidValue,this.state.startLoc);s.value=this.parseStringLiteral(this.state.value),e.push(this.finishNode(s,"ImportAttribute"))}while(this.eat(12));return this.expect(8),e}parseModuleAttributes(){const e=[],t=new Set;do{const s=this.startNode();if(s.key=this.parseIdentifier(!0),"type"!==s.key.name&&this.raise(b.ModuleAttributeDifferentFromType,s.key),t.has(s.key.name)&&this.raise(b.ModuleAttributesWithDuplicateKeys,s.key,{key:s.key.name}),t.add(s.key.name),this.expect(14),!this.match(133))throw this.raise(b.ModuleAttributeInvalidValue,this.state.startLoc);s.value=this.parseStringLiteral(this.state.value),e.push(this.finishNode(s,"ImportAttribute"))}while(this.eat(12));return e}maybeParseImportAttributes(e){let t,s=!1;if(this.match(76)){if(this.hasPrecedingLineBreak()&&40===this.lookaheadCharCode())return;this.next(),this.hasPlugin("moduleAttributes")?t=this.parseModuleAttributes():(this.expectImportAttributesPlugin(),t=this.parseImportAttributes()),s=!0}else if(this.isContextual(94)&&!this.hasPrecedingLineBreak())this.hasPlugin("importAttributes")?(!0!==this.getPluginOption("importAttributes","deprecatedAssertSyntax")&&this.raise(b.ImportAttributesUseAssert,this.state.startLoc),this.addExtra(e,"deprecatedAssertSyntax",!0)):this.expectOnePlugin(["importAttributes","importAssertions"]),this.next(),t=this.parseImportAttributes();else if(this.hasPlugin("importAttributes")||this.hasPlugin("importAssertions"))t=[];else{if(!this.hasPlugin("moduleAttributes"))return;t=[]}!s&&this.hasPlugin("importAssertions")?e.assertions=t:e.attributes=t}maybeParseDefaultImportSpecifier(e,t){if(t){const s=this.startNodeAtNode(t);return s.local=t,e.specifiers.push(this.finishImportSpecifier(s,"ImportDefaultSpecifier")),!0}return!!V(this.state.type)&&(this.parseImportSpecifierLocal(e,this.startNode(),"ImportDefaultSpecifier"),!0)}maybeParseStarImportSpecifier(e){if(this.match(55)){const t=this.startNode();return this.next(),this.expectContextual(93),this.parseImportSpecifierLocal(e,t,"ImportNamespaceSpecifier"),!0}return!1}parseNamedImportSpecifiers(e){let t=!0;for(this.expect(5);!this.eat(8);){if(t)t=!1;else{if(this.eat(14))throw this.raise(b.DestructureNamedImport,this.state.startLoc);if(this.expect(12),this.eat(8))break}const s=this.startNode(),i=this.match(133),r=this.isContextual(130);s.imported=this.parseModuleExportName();const n=this.parseImportSpecifier(s,i,"type"===e.importKind||"typeof"===e.importKind,r,void 0);e.specifiers.push(n)}}parseImportSpecifier(e,t,s,i,r){if(this.eatContextual(93))e.local=this.parseIdentifier();else{const{imported:s}=e;if(t)throw this.raise(b.ImportBindingIsString,e,{importName:s.value});this.checkReservedWord(s.name,e.loc.start,!0,!0),e.local||(e.local=rt(s))}return this.finishImportSpecifier(e,"ImportSpecifier",r)}isThisParam(e){return"Identifier"===e.type&&"this"===e.name}}class qt extends zt{constructor(e,t){super(e=function(e){if(null==e)return Object.assign({},Mt);if(null!=e.annexB&&!1!==e.annexB)throw new Error("The `annexB` option can only be set to `false`.");const t={};for(const i of Object.keys(Mt)){var s;t[i]=null!=(s=e[i])?s:Mt[i]}return t}(e),t),this.options=e,this.initializeScopes(),this.plugins=function(e){const t=new Map;for(const s of e){const[e,i]=Array.isArray(s)?s:[s,{}];t.has(e)||t.set(e,i||{})}return t}(this.options.plugins),this.filename=e.sourceFilename}getScopeHandler(){return ge}parse(){this.enterInitialScopes();const e=this.startNode(),t=this.startNode();return this.nextToken(),e.errors=null,this.parseTopLevel(e,t),e.errors=this.state.errors,e.comments.length=this.state.commentsLen,e}}!function(e){const t={};for(const s of Object.keys(e))t[s]=X(e[s])}(q);function Ht(e,t){let s=qt;return null!=e&&e.plugins&&(function(e){if(At(e,"decorators")){if(At(e,"decorators-legacy"))throw new Error("Cannot use the decorators and decorators-legacy plugin together");const t=St(e,"decorators","decoratorsBeforeExport");if(null!=t&&"boolean"!=typeof t)throw new Error("'decoratorsBeforeExport' must be a boolean, if specified.");const s=St(e,"decorators","allowCallParenthesized");if(null!=s&&"boolean"!=typeof s)throw new Error("'allowCallParenthesized' must be a boolean.")}if(At(e,"flow")&&At(e,"typescript"))throw new Error("Cannot combine flow and typescript plugins.");if(At(e,"placeholders")&&At(e,"v8intrinsic"))throw new Error("Cannot combine placeholders and v8intrinsic plugins.");if(At(e,"pipelineOperator")){const t=St(e,"pipelineOperator","proposal");if(!It.includes(t)){const e=It.map((e=>`"${e}"`)).join(", ");throw new Error(`"pipelineOperator" requires "proposal" option whose value must be one of: ${e}.`)}const s=At(e,["recordAndTuple",{syntaxType:"hash"}]);if("hack"===t){if(At(e,"placeholders"))throw new Error("Cannot combine placeholders plugin and Hack-style pipes.");if(At(e,"v8intrinsic"))throw new Error("Cannot combine v8intrinsic plugin and Hack-style pipes.");const t=St(e,"pipelineOperator","topicToken");if(!Nt.includes(t)){const e=Nt.map((e=>`"${e}"`)).join(", ");throw new Error(`"pipelineOperator" in "proposal": "hack" mode also requires a "topicToken" option whose value must be one of: ${e}.`)}if("#"===t&&s)throw new Error('Plugin conflict between `["pipelineOperator", { proposal: "hack", topicToken: "#" }]` and `["recordAndtuple", { syntaxType: "hash"}]`.')}else if("smart"===t&&s)throw new Error('Plugin conflict between `["pipelineOperator", { proposal: "smart" }]` and `["recordAndtuple", { syntaxType: "hash"}]`.')}if(At(e,"moduleAttributes")){if(At(e,"importAssertions")||At(e,"importAttributes"))throw new Error("Cannot combine importAssertions, importAttributes and moduleAttributes plugins.");if("may-2020"!==St(e,"moduleAttributes","version"))throw new Error("The 'moduleAttributes' plugin requires a 'version' option, representing the last proposal update. Currently, the only supported value is 'may-2020'.")}if(At(e,"importAssertions")&&At(e,"importAttributes"))throw new Error("Cannot combine importAssertions and importAttributes plugins.");if(At(e,"recordAndTuple")&&null!=St(e,"recordAndTuple","syntaxType")&&!Lt.includes(St(e,"recordAndTuple","syntaxType")))throw new Error("The 'syntaxType' option of the 'recordAndTuple' plugin must be one of: "+Lt.map((e=>`'${e}'`)).join(", "));if(At(e,"asyncDoExpressions")&&!At(e,"doExpressions")){const e=new Error("'asyncDoExpressions' requires 'doExpressions', please add 'doExpressions' to parser plugins.");throw e.missingPlugins="doExpressions",e}if(At(e,"optionalChainingAssign")&&"2023-07"!==St(e,"optionalChainingAssign","version"))throw new Error("The 'optionalChainingAssign' plugin requires a 'version' option, representing the last proposal update. Currently, the only supported value is '2023-07'.")}(e.plugins),s=function(e){const t=Ot.filter((t=>At(e,t))),s=t.join("/");let i=Vt[s];if(!i){i=qt;for(const e of t)i=Dt[e](i);Vt[s]=i}return i}(e.plugins)),new s(e,t)}const Vt={};t.qg=function(e,t){var s;if("unambiguous"!==(null==(s=t)?void 0:s.sourceType))return Ht(t,e).parse();t=Object.assign({},t);try{t.sourceType="module";const s=Ht(t,e),i=s.parse();if(s.sawUnambiguousESM)return i;if(s.ambiguousScriptDifferentAst)try{return t.sourceType="script",Ht(t,e).parse()}catch(e){}else i.program.sourceType="script";return i}catch(s){try{return t.sourceType="script",Ht(t,e).parse()}catch(e){}throw s}}}},t={};function s(i){var r=t[i];if(void 0!==r)return r.exports;var n=t[i]={exports:{}};return e[i](n,n.exports,s),n.exports}s.d=(e,t)=>{for(var i in t)s.o(t,i)&&!s.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={};s.r(e),s.d(e,{Decoder:()=>me,Encoder:()=>de,PacketType:()=>ue,protocol:()=>pe});var t={};s.r(t),s.d(t,{decode:()=>Au,encode:()=>Eu});const i=Object.create(null);i.open="0",i.close="1",i.ping="2",i.pong="3",i.message="4",i.upgrade="5",i.noop="6";const r=Object.create(null);Object.keys(i).forEach((e=>{r[i[e]]=e}));const n={type:"error",data:"parser error"},a="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),o="function"==typeof ArrayBuffer,h=e=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,c=({type:e,data:t},s,r)=>a&&t instanceof Blob?s?r(t):l(t,r):o&&(t instanceof ArrayBuffer||h(t))?s?r(t):l(new Blob([t]),r):r(i[e]+(t||"")),l=(e,t)=>{const s=new FileReader;return s.onload=function(){const e=s.result.split(",")[1];t("b"+(e||""))},s.readAsDataURL(e)};function p(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let u;const d="undefined"==typeof Uint8Array?[]:new Uint8Array(256);for(let e=0;e<64;e++)d["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(e)]=e;const f="function"==typeof ArrayBuffer,m=(e,t)=>{if("string"!=typeof e)return{type:"message",data:g(e,t)};const s=e.charAt(0);return"b"===s?{type:"message",data:y(e.substring(1),t)}:r[s]?e.length>1?{type:r[s],data:e.substring(1)}:{type:r[s]}:n},y=(e,t)=>{if(f){const s=(e=>{let t,s,i,r,n,a=.75*e.length,o=e.length,h=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);const c=new ArrayBuffer(a),l=new Uint8Array(c);for(t=0;t<o;t+=4)s=d[e.charCodeAt(t)],i=d[e.charCodeAt(t+1)],r=d[e.charCodeAt(t+2)],n=d[e.charCodeAt(t+3)],l[h++]=s<<2|i>>4,l[h++]=(15&i)<<4|r>>2,l[h++]=(3&r)<<6|63&n;return c})(e);return g(s,t)}return{base64:!0,data:e}},g=(e,t)=>"blob"===t?e instanceof Blob?e:new Blob([e]):e instanceof ArrayBuffer?e:e.buffer,b=String.fromCharCode(30);let w;function _(e){return e.reduce(((e,t)=>e+t.length),0)}function x(e,t){if(e[0].length===t)return e.shift();const s=new Uint8Array(t);let i=0;for(let r=0;r<t;r++)s[r]=e[0][i++],i===e[0].length&&(e.shift(),i=0);return e.length&&i<e[0].length&&(e[0]=e[0].slice(i)),s}function v(e){if(e)return function(e){for(var t in v.prototype)e[t]=v.prototype[t];return e}(e)}v.prototype.on=v.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},v.prototype.once=function(e,t){function s(){this.off(e,s),t.apply(this,arguments)}return s.fn=t,this.on(e,s),this},v.prototype.off=v.prototype.removeListener=v.prototype.removeAllListeners=v.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var s,i=this._callbacks["$"+e];if(!i)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var r=0;r<i.length;r++)if((s=i[r])===t||s.fn===t){i.splice(r,1);break}return 0===i.length&&delete this._callbacks["$"+e],this},v.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),s=this._callbacks["$"+e],i=1;i<arguments.length;i++)t[i-1]=arguments[i];if(s){i=0;for(var r=(s=s.slice(0)).length;i<r;++i)s[i].apply(this,t)}return this},v.prototype.emitReserved=v.prototype.emit,v.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},v.prototype.hasListeners=function(e){return!!this.listeners(e).length};const P="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")();function T(e,...t){return t.reduce(((t,s)=>(e.hasOwnProperty(s)&&(t[s]=e[s]),t)),{})}const C=P.setTimeout,E=P.clearTimeout;function k(e,t){t.useNativeTimers?(e.setTimeoutFn=C.bind(P),e.clearTimeoutFn=E.bind(P)):(e.setTimeoutFn=P.setTimeout.bind(P),e.clearTimeoutFn=P.clearTimeout.bind(P))}class A extends Error{constructor(e,t,s){super(e),this.description=t,this.context=s,this.type="TransportError"}}class S extends v{constructor(e){super(),this.writable=!1,k(this,e),this.opts=e,this.query=e.query,this.socket=e.socket}onError(e,t,s){return super.emitReserved("error",new A(e,t,s)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(e){"open"===this.readyState&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=m(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return-1===e.indexOf(":")?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(443!==this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}_query(e){const t=function(e){let t="";for(let s in e)e.hasOwnProperty(s)&&(t.length&&(t+="&"),t+=encodeURIComponent(s)+"="+encodeURIComponent(e[s]));return t}(e);return t.length?"?"+t:""}}const I="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),N=64,L={};let D,O=0,M=0;function R(e){let t="";do{t=I[e%N]+t,e=Math.floor(e/N)}while(e>0);return t}function F(){const e=R(+new Date);return e!==D?(O=0,D=e):e+"."+R(O++)}for(;M<N;M++)L[I[M]]=M;let B=!1;try{B="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(fl){}const U=B;function j(e){const t=e.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!t||U))return new XMLHttpRequest}catch(e){}if(!t)try{return new(P[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}function z(){}const q=null!=new j({xdomain:!1}).responseType;class H extends v{constructor(e,t){super(),k(this,t),this.opts=t,this.method=t.method||"GET",this.uri=e,this.data=void 0!==t.data?t.data:null,this.create()}create(){var e;const t=T(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd;const s=this.xhr=new j(t);try{s.open(this.method,this.uri,!0);try{if(this.opts.extraHeaders){s.setDisableHeaderCheck&&s.setDisableHeaderCheck(!0);for(let e in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(e)&&s.setRequestHeader(e,this.opts.extraHeaders[e])}}catch(e){}if("POST"===this.method)try{s.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{s.setRequestHeader("Accept","*/*")}catch(e){}null===(e=this.opts.cookieJar)||void 0===e||e.addCookies(s),"withCredentials"in s&&(s.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(s.timeout=this.opts.requestTimeout),s.onreadystatechange=()=>{var e;3===s.readyState&&(null===(e=this.opts.cookieJar)||void 0===e||e.parseCookies(s)),4===s.readyState&&(200===s.status||1223===s.status?this.onLoad():this.setTimeoutFn((()=>{this.onError("number"==typeof s.status?s.status:0)}),0))},s.send(this.data)}catch(e){return void this.setTimeoutFn((()=>{this.onError(e)}),0)}"undefined"!=typeof document&&(this.index=H.requestsCount++,H.requests[this.index]=this)}onError(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}cleanup(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=z,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete H.requests[this.index],this.xhr=null}}onLoad(){const e=this.xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}function V(){for(let e in H.requests)H.requests.hasOwnProperty(e)&&H.requests[e].abort()}H.requestsCount=0,H.requests={},"undefined"!=typeof document&&("function"==typeof attachEvent?attachEvent("onunload",V):"function"==typeof addEventListener&&addEventListener("onpagehide"in P?"pagehide":"unload",V,!1));const W="function"==typeof Promise&&"function"==typeof Promise.resolve?e=>Promise.resolve().then(e):(e,t)=>t(e,0),$=P.WebSocket||P.MozWebSocket,K="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),G={websocket:class extends S{constructor(e){super(e),this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const e=this.uri(),t=this.opts.protocols,s=K?{}:T(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(s.headers=this.opts.extraHeaders);try{this.ws=K?new $(e,t,s):t?new $(e,t):new $(e)}catch(e){return this.emitReserved("error",e)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const s=e[t],i=t===e.length-1;c(s,this.supportsBinary,(e=>{try{this.ws.send(e)}catch(e){}i&&W((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){void 0!==this.ws&&(this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=F()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}check(){return!!$}},webtransport:class extends S{get name(){return"webtransport"}doOpen(){"function"==typeof WebTransport&&(this.transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name]),this.transport.closed.then((()=>{this.onClose()})).catch((e=>{this.onError("webtransport error",e)})),this.transport.ready.then((()=>{this.transport.createBidirectionalStream().then((e=>{const t=function(e,t){w||(w=new TextDecoder);const s=[];let i=0,r=-1,a=!1;return new TransformStream({transform(o,h){for(s.push(o);;){if(0===i){if(_(s)<1)break;const e=x(s,1);a=128==(128&e[0]),r=127&e[0],i=r<126?3:126===r?1:2}else if(1===i){if(_(s)<2)break;const e=x(s,2);r=new DataView(e.buffer,e.byteOffset,e.length).getUint16(0),i=3}else if(2===i){if(_(s)<8)break;const e=x(s,8),t=new DataView(e.buffer,e.byteOffset,e.length),a=t.getUint32(0);if(a>Math.pow(2,21)-1){h.enqueue(n);break}r=a*Math.pow(2,32)+t.getUint32(4),i=3}else{if(_(s)<r)break;const e=x(s,r);h.enqueue(m(a?e:w.decode(e),t)),i=0}if(0===r||r>e){h.enqueue(n);break}}}})}(Number.MAX_SAFE_INTEGER,this.socket.binaryType),s=e.readable.pipeThrough(t).getReader(),i=new TransformStream({transform(e,t){!function(e,t){a&&e.data instanceof Blob?e.data.arrayBuffer().then(p).then(t):o&&(e.data instanceof ArrayBuffer||h(e.data))?t(p(e.data)):c(e,!1,(e=>{u||(u=new TextEncoder),t(u.encode(e))}))}(e,(s=>{const i=s.length;let r;if(i<126)r=new Uint8Array(1),new DataView(r.buffer).setUint8(0,i);else if(i<65536){r=new Uint8Array(3);const e=new DataView(r.buffer);e.setUint8(0,126),e.setUint16(1,i)}else{r=new Uint8Array(9);const e=new DataView(r.buffer);e.setUint8(0,127),e.setBigUint64(1,BigInt(i))}e.data&&"string"!=typeof e.data&&(r[0]|=128),t.enqueue(r),t.enqueue(s)}))}});i.readable.pipeTo(e.writable),this.writer=i.writable.getWriter();const r=()=>{s.read().then((({done:e,value:t})=>{e||(this.onPacket(t),r())})).catch((e=>{}))};r();const l={type:"open"};this.query.sid&&(l.data=`{"sid":"${this.query.sid}"}`),this.writer.write(l).then((()=>this.onOpen()))}))})))}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const s=e[t],i=t===e.length-1;this.writer.write(s).then((()=>{i&&W((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){var e;null===(e=this.transport)||void 0===e||e.close()}},polling:class extends S{constructor(e){if(super(e),this.polling=!1,"undefined"!=typeof location){const t="https:"===location.protocol;let s=location.port;s||(s=t?"443":"80"),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||s!==e.port}const t=e&&e.forceBase64;this.supportsBinary=q&&!t,this.opts.withCredentials&&(this.cookieJar=void 0)}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this.polling||!this.writable){let e=0;this.polling&&(e++,this.once("pollComplete",(function(){--e||t()}))),this.writable||(e++,this.once("drain",(function(){--e||t()})))}else t()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){((e,t)=>{const s=e.split(b),i=[];for(let e=0;e<s.length;e++){const r=m(s[e],t);if(i.push(r),"error"===r.type)break}return i})(e,this.socket.binaryType).forEach((e=>{if("opening"===this.readyState&&"open"===e.type&&this.onOpen(),"close"===e.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(e)})),"closed"!==this.readyState&&(this.polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this.poll())}doClose(){const e=()=>{this.write([{type:"close"}])};"open"===this.readyState?e():this.once("open",e)}write(e){this.writable=!1,((e,t)=>{const s=e.length,i=new Array(s);let r=0;e.forEach(((e,n)=>{c(e,!1,(e=>{i[n]=e,++r===s&&t(i.join(b))}))}))})(e,(e=>{this.doWrite(e,(()=>{this.writable=!0,this.emitReserved("drain")}))}))}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=F()),this.supportsBinary||t.sid||(t.b64=1),this.createUri(e,t)}request(e={}){return Object.assign(e,{xd:this.xd,cookieJar:this.cookieJar},this.opts),new H(this.uri(),e)}doWrite(e,t){const s=this.request({method:"POST",data:e});s.on("success",t),s.on("error",((e,t)=>{this.onError("xhr post error",e,t)}))}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",((e,t)=>{this.onError("xhr poll error",e,t)})),this.pollXhr=e}}},Y=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,J=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Z(e){if(e.length>2e3)throw"URI too long";const t=e,s=e.indexOf("["),i=e.indexOf("]");-1!=s&&-1!=i&&(e=e.substring(0,s)+e.substring(s,i).replace(/:/g,";")+e.substring(i,e.length));let r=Y.exec(e||""),n={},a=14;for(;a--;)n[J[a]]=r[a]||"";return-1!=s&&-1!=i&&(n.source=t,n.host=n.host.substring(1,n.host.length-1).replace(/;/g,":"),n.authority=n.authority.replace("[","").replace("]","").replace(/;/g,":"),n.ipv6uri=!0),n.pathNames=function(e,t){const s=t.replace(/\/{2,9}/g,"/").split("/");return"/"!=t.slice(0,1)&&0!==t.length||s.splice(0,1),"/"==t.slice(-1)&&s.splice(s.length-1,1),s}(0,n.path),n.queryKey=function(e,t){const s={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(e,t,i){t&&(s[t]=i)})),s}(0,n.query),n}class X extends v{constructor(e,t={}){super(),this.binaryType="arraybuffer",this.writeBuffer=[],e&&"object"==typeof e&&(t=e,e=null),e?(e=Z(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=Z(t.host).host),k(this,t),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=t.transports||["polling","websocket","webtransport"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"==typeof this.opts.query&&(this.opts.query=function(e){let t={},s=e.split("&");for(let e=0,i=s.length;e<i;e++){let i=s[e].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"==typeof addEventListener&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=4,t.transport=e,this.id&&(t.sid=this.id);const s=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new G[e](s)}open(){let e;if(this.opts.rememberUpgrade&&X.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn((()=>{this.emitReserved("error","No transports available")}),0);e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",(e=>this.onClose("transport close",e)))}probe(e){let t=this.createTransport(e),s=!1;X.priorWebsocketSuccess=!1;const i=()=>{s||(t.send([{type:"ping",data:"probe"}]),t.once("packet",(e=>{if(!s)if("pong"===e.type&&"probe"===e.data){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;X.priorWebsocketSuccess="websocket"===t.name,this.transport.pause((()=>{s||"closed"!==this.readyState&&(c(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())}))}else{const e=new Error("probe error");e.transport=t.name,this.emitReserved("upgradeError",e)}})))};function r(){s||(s=!0,c(),t.close(),t=null)}const n=e=>{const s=new Error("probe error: "+e);s.transport=t.name,r(),this.emitReserved("upgradeError",s)};function a(){n("transport closed")}function o(){n("socket closed")}function h(e){t&&e.name!==t.name&&r()}const c=()=>{t.removeListener("open",i),t.removeListener("error",n),t.removeListener("close",a),this.off("close",o),this.off("upgrading",h)};t.once("open",i),t.once("error",n),t.once("close",a),this.once("close",o),this.once("upgrading",h),-1!==this.upgrades.indexOf("webtransport")&&"webtransport"!==e?this.setTimeoutFn((()=>{s||t.open()}),200):t.open()}onOpen(){if(this.readyState="open",X.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade){let e=0;const t=this.upgrades.length;for(;e<t;e++)this.probe(this.upgrades[e])}}onPacket(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),this.resetPingTimeout(),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn((()=>{this.onClose("ping timeout")}),this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this.getWritablePackets();this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let s=0;s<this.writeBuffer.length;s++){const i=this.writeBuffer[s].data;if(i&&(e+="string"==typeof(t=i)?function(e){let t=0,s=0;for(let i=0,r=e.length;i<r;i++)t=e.charCodeAt(i),t<128?s+=1:t<2048?s+=2:t<55296||t>=57344?s+=3:(i++,s+=4);return s}(t):Math.ceil(1.33*(t.byteLength||t.size))),s>0&&e>this.maxPayload)return this.writeBuffer.slice(0,s);e+=2}var t;return this.writeBuffer}write(e,t,s){return this.sendPacket("message",e,t,s),this}send(e,t,s){return this.sendPacket("message",e,t,s),this}sendPacket(e,t,s,i){if("function"==typeof t&&(i=t,t=void 0),"function"==typeof s&&(i=s,s=null),"closing"===this.readyState||"closed"===this.readyState)return;(s=s||{}).compress=!1!==s.compress;const r={type:e,data:t,options:s};this.emitReserved("packetCreate",r),this.writeBuffer.push(r),i&&this.once("flush",i),this.flush()}close(){const e=()=>{this.onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},s=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(()=>{this.upgrading?s():e()})):this.upgrading?s():e()),this}onError(e){X.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}onClose(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){const t=[];let s=0;const i=e.length;for(;s<i;s++)~this.transports.indexOf(e[s])&&t.push(e[s]);return t}}X.protocol=4,X.protocol;const Q="function"==typeof ArrayBuffer,ee=e=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,te=Object.prototype.toString,se="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===te.call(Blob),ie="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===te.call(File);function re(e){return Q&&(e instanceof ArrayBuffer||ee(e))||se&&e instanceof Blob||ie&&e instanceof File}function ne(e,t){if(!e||"object"!=typeof e)return!1;if(Array.isArray(e)){for(let t=0,s=e.length;t<s;t++)if(ne(e[t]))return!0;return!1}if(re(e))return!0;if(e.toJSON&&"function"==typeof e.toJSON&&1===arguments.length)return ne(e.toJSON(),!0);for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&ne(e[t]))return!0;return!1}function ae(e){const t=[],s=e.data,i=e;return i.data=oe(s,t),i.attachments=t.length,{packet:i,buffers:t}}function oe(e,t){if(!e)return e;if(re(e)){const s={_placeholder:!0,num:t.length};return t.push(e),s}if(Array.isArray(e)){const s=new Array(e.length);for(let i=0;i<e.length;i++)s[i]=oe(e[i],t);return s}if("object"==typeof e&&!(e instanceof Date)){const s={};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(s[i]=oe(e[i],t));return s}return e}function he(e,t){return e.data=ce(e.data,t),delete e.attachments,e}function ce(e,t){if(!e)return e;if(e&&!0===e._placeholder){if("number"==typeof e.num&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}if(Array.isArray(e))for(let s=0;s<e.length;s++)e[s]=ce(e[s],t);else if("object"==typeof e)for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&(e[s]=ce(e[s],t));return e}const le=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],pe=5;var ue;!function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"}(ue||(ue={}));class de{constructor(e){this.replacer=e}encode(e){return e.type!==ue.EVENT&&e.type!==ue.ACK||!ne(e)?[this.encodeAsString(e)]:this.encodeAsBinary({type:e.type===ue.EVENT?ue.BINARY_EVENT:ue.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id})}encodeAsString(e){let t=""+e.type;return e.type!==ue.BINARY_EVENT&&e.type!==ue.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=ae(e),s=this.encodeAsString(t.packet),i=t.buffers;return i.unshift(s),i}}function fe(e){return"[object Object]"===Object.prototype.toString.call(e)}class me extends v{constructor(e){super(),this.reviver=e}add(e){let t;if("string"==typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const s=t.type===ue.BINARY_EVENT;s||t.type===ue.BINARY_ACK?(t.type=s?ue.EVENT:ue.ACK,this.reconstructor=new ye(t),0===t.attachments&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else{if(!re(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t))}}decodeString(e){let t=0;const s={type:Number(e.charAt(0))};if(void 0===ue[s.type])throw new Error("unknown packet type "+s.type);if(s.type===ue.BINARY_EVENT||s.type===ue.BINARY_ACK){const i=t+1;for(;"-"!==e.charAt(++t)&&t!=e.length;);const r=e.substring(i,t);if(r!=Number(r)||"-"!==e.charAt(t))throw new Error("Illegal attachments");s.attachments=Number(r)}if("/"===e.charAt(t+1)){const i=t+1;for(;++t&&","!==e.charAt(t)&&t!==e.length;);s.nsp=e.substring(i,t)}else s.nsp="/";const i=e.charAt(t+1);if(""!==i&&Number(i)==i){const i=t+1;for(;++t;){const s=e.charAt(t);if(null==s||Number(s)!=s){--t;break}if(t===e.length)break}s.id=Number(e.substring(i,t+1))}if(e.charAt(++t)){const i=this.tryParse(e.substr(t));if(!me.isPayloadValid(s.type,i))throw new Error("invalid payload");s.data=i}return s}tryParse(e){try{return JSON.parse(e,this.reviver)}catch(e){return!1}}static isPayloadValid(e,t){switch(e){case ue.CONNECT:return fe(t);case ue.DISCONNECT:return void 0===t;case ue.CONNECT_ERROR:return"string"==typeof t||fe(t);case ue.EVENT:case ue.BINARY_EVENT:return Array.isArray(t)&&("number"==typeof t[0]||"string"==typeof t[0]&&-1===le.indexOf(t[0]));case ue.ACK:case ue.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class ye{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const e=he(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function ge(e,t,s){return e.on(t,s),function(){e.off(t,s)}}const be=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class we extends v{constructor(e,t,s){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,s&&s.auth&&(this.auth=s.auth),this._opts=Object.assign({},s),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[ge(e,"open",this.onopen.bind(this)),ge(e,"packet",this.onpacket.bind(this)),ge(e,"error",this.onerror.bind(this)),ge(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){if(be.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const s={type:ue.EVENT,data:t,options:{}};if(s.options.compress=!1!==this.flags.compress,"function"==typeof t[t.length-1]){const e=this.ids++,i=t.pop();this._registerAckCallback(e,i),s.id=e}const i=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!i||!this.connected)||(this.connected?(this.notifyOutgoingListeners(s),this.packet(s)):this.sendBuffer.push(s)),this.flags={},this}_registerAckCallback(e,t){var s;const i=null!==(s=this.flags.timeout)&&void 0!==s?s:this._opts.ackTimeout;if(void 0===i)return void(this.acks[e]=t);const r=this.io.setTimeoutFn((()=>{delete this.acks[e];for(let t=0;t<this.sendBuffer.length;t++)this.sendBuffer[t].id===e&&this.sendBuffer.splice(t,1);t.call(this,new Error("operation has timed out"))}),i),n=(...e)=>{this.io.clearTimeoutFn(r),t.apply(this,e)};n.withError=!0,this.acks[e]=n}emitWithAck(e,...t){return new Promise(((s,i)=>{const r=(e,t)=>e?i(e):s(t);r.withError=!0,t.push(r),this.emit(e,...t)}))}_addToQueue(e){let t;"function"==typeof e[e.length-1]&&(t=e.pop());const s={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push(((e,...i)=>{if(s===this._queue[0])return null!==e?s.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(e)):(this._queue.shift(),t&&t(null,...i)),s.pending=!1,this._drainQueue()})),this._queue.push(s),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||0===this._queue.length)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){"function"==typeof this.auth?this.auth((e=>{this._sendConnectPacket(e)})):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:ue.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach((e=>{if(!this.sendBuffer.some((t=>String(t.id)===e))){const t=this.acks[e];delete this.acks[e],t.withError&&t.call(this,new Error("socket has been disconnected"))}}))}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case ue.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case ue.EVENT:case ue.BINARY_EVENT:this.onevent(e);break;case ue.ACK:case ue.BINARY_ACK:this.onack(e);break;case ue.DISCONNECT:this.ondisconnect();break;case ue.CONNECT_ERROR:this.destroy();const t=new Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t)}}onevent(e){const t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const s of t)s.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&"string"==typeof e[e.length-1]&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let s=!1;return function(...i){s||(s=!0,t.packet({type:ue.ACK,id:e,data:i}))}}onack(e){const t=this.acks[e.id];"function"==typeof t&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach((e=>this.emitEvent(e))),this.receiveBuffer=[],this.sendBuffer.forEach((e=>{this.notifyOutgoingListeners(e),this.packet(e)})),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach((e=>e())),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:ue.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let s=0;s<t.length;s++)if(e===t[s])return t.splice(s,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let s=0;s<t.length;s++)if(e===t[s])return t.splice(s,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const s of t)s.apply(this,e.data)}}}function _e(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}_e.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),s=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-s:e+s}return 0|Math.min(e,this.max)},_e.prototype.reset=function(){this.attempts=0},_e.prototype.setMin=function(e){this.ms=e},_e.prototype.setMax=function(e){this.max=e},_e.prototype.setJitter=function(e){this.jitter=e};class xe extends v{constructor(t,s){var i;super(),this.nsps={},this.subs=[],t&&"object"==typeof t&&(s=t,t=void 0),(s=s||{}).path=s.path||"/socket.io",this.opts=s,k(this,s),this.reconnection(!1!==s.reconnection),this.reconnectionAttempts(s.reconnectionAttempts||1/0),this.reconnectionDelay(s.reconnectionDelay||1e3),this.reconnectionDelayMax(s.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(i=s.randomizationFactor)&&void 0!==i?i:.5),this.backoff=new _e({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==s.timeout?2e4:s.timeout),this._readyState="closed",this.uri=t;const r=s.parser||e;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=!1!==s.autoConnect,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}randomizationFactor(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new X(this.uri,this.opts);const t=this.engine,s=this;this._readyState="opening",this.skipReconnect=!1;const i=ge(t,"open",(function(){s.onopen(),e&&e()})),r=t=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",t),e?e(t):this.maybeReconnectOnOpen()},n=ge(t,"error",r);if(!1!==this._timeout){const e=this._timeout,s=this.setTimeoutFn((()=>{i(),r(new Error("timeout")),t.close()}),e);this.opts.autoUnref&&s.unref(),this.subs.push((()=>{this.clearTimeoutFn(s)}))}return this.subs.push(i),this.subs.push(n),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(ge(e,"ping",this.onping.bind(this)),ge(e,"data",this.ondata.bind(this)),ge(e,"error",this.onerror.bind(this)),ge(e,"close",this.onclose.bind(this)),ge(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(e){this.onclose("parse error",e)}}ondecoded(e){W((()=>{this.emitReserved("packet",e)}),this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let s=this.nsps[e];return s?this._autoConnect&&!s.active&&s.connect():(s=new we(this,e,t),this.nsps[e]=s),s}_destroy(e){const t=Object.keys(this.nsps);for(const e of t)if(this.nsps[e].active)return;this._close()}_packet(e){const t=this.encoder.encode(e);for(let s=0;s<t.length;s++)this.engine.write(t[s],e.options)}cleanup(){this.subs.forEach((e=>e())),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e,t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const s=this.setTimeoutFn((()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open((t=>{t?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",t)):e.onreconnect()})))}),t);this.opts.autoUnref&&s.unref(),this.subs.push((()=>{this.clearTimeoutFn(s)}))}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const ve={};function Pe(e,t){"object"==typeof e&&(t=e,e=void 0);const s=function(e,t="",s){let i=e;s=s||"undefined"!=typeof location&&location,null==e&&(e=s.protocol+"//"+s.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?s.protocol+e:s.host+e),/^(https?|wss?):\/\//.test(e)||(e=void 0!==s?s.protocol+"//"+e:"https://"+e),i=Z(e)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";const r=-1!==i.host.indexOf(":")?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+r+":"+i.port+t,i.href=i.protocol+"://"+r+(s&&s.port===i.port?"":":"+i.port),i}(e,(t=t||{}).path||"/socket.io"),i=s.source,r=s.id,n=s.path,a=ve[r]&&n in ve[r].nsps;let o;return t.forceNew||t["force new connection"]||!1===t.multiplex||a?o=new xe(i,t):(ve[r]||(ve[r]=new xe(i,t)),o=ve[r]),s.query&&!t.query&&(t.query=s.queryKey),o.socket(s.path,t)}Object.assign(Pe,{Manager:xe,Socket:we,io:Pe,connect:Pe});const Te=function(e,t){if(!e)throw Ce(t)},Ce=function(e){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+e)},Ee=function(e){const t=[];let s=0;for(let i=0;i<e.length;i++){let r=e.charCodeAt(i);r<128?t[s++]=r:r<2048?(t[s++]=r>>6|192,t[s++]=63&r|128):55296==(64512&r)&&i+1<e.length&&56320==(64512&e.charCodeAt(i+1))?(r=65536+((1023&r)<<10)+(1023&e.charCodeAt(++i)),t[s++]=r>>18|240,t[s++]=r>>12&63|128,t[s++]=r>>6&63|128,t[s++]=63&r|128):(t[s++]=r>>12|224,t[s++]=r>>6&63|128,t[s++]=63&r|128)}return t},ke={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const s=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let t=0;t<e.length;t+=3){const r=e[t],n=t+1<e.length,a=n?e[t+1]:0,o=t+2<e.length,h=o?e[t+2]:0,c=r>>2,l=(3&r)<<4|a>>4;let p=(15&a)<<2|h>>6,u=63&h;o||(u=64,n||(p=64)),i.push(s[c],s[l],s[p],s[u])}return i.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Ee(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let s=0,i=0;for(;s<e.length;){const r=e[s++];if(r<128)t[i++]=String.fromCharCode(r);else if(r>191&&r<224){const n=e[s++];t[i++]=String.fromCharCode((31&r)<<6|63&n)}else if(r>239&&r<365){const n=((7&r)<<18|(63&e[s++])<<12|(63&e[s++])<<6|63&e[s++])-65536;t[i++]=String.fromCharCode(55296+(n>>10)),t[i++]=String.fromCharCode(56320+(1023&n))}else{const n=e[s++],a=e[s++];t[i++]=String.fromCharCode((15&r)<<12|(63&n)<<6|63&a)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const s=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let t=0;t<e.length;){const r=s[e.charAt(t++)],n=t<e.length?s[e.charAt(t)]:0;++t;const a=t<e.length?s[e.charAt(t)]:64;++t;const o=t<e.length?s[e.charAt(t)]:64;if(++t,null==r||null==n||null==a||null==o)throw new Ae;const h=r<<2|n>>4;if(i.push(h),64!==a){const e=n<<4&240|a>>2;if(i.push(e),64!==o){const e=a<<6&192|o;i.push(e)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class Ae extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Se=function(e){const t=Ee(e);return ke.encodeByteArray(t,!0)},Ie=function(e){return Se(e).replace(/\./g,"")},Ne=function(e){try{return ke.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Le(e){return De(void 0,e)}function De(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(const s in t)t.hasOwnProperty(s)&&"__proto__"!==s&&(e[s]=De(e[s],t[s]));return e}const Oe=()=>{try{return function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==s.g)return s.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const e=process.env.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"==typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}const t=e&&Ne(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},Me=()=>{var e;return null===(e=Oe())||void 0===e?void 0:e.config};class Re{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,s)=>{t?this.reject(t):this.resolve(s),"function"==typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,s))}}}function Fe(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test("undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:"")}function Be(){try{return"object"==typeof indexedDB}catch(e){return!1}}function Ue(){return new Promise(((e,t)=>{try{let s=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),s||self.indexedDB.deleteDatabase(i),e(!0)},r.onupgradeneeded=()=>{s=!1},r.onerror=()=>{var e;t((null===(e=r.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}}))}class je extends Error{constructor(e,t,s){super(t),this.code=e,this.customData=s,this.name="FirebaseError",Object.setPrototypeOf(this,je.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ze.prototype.create)}}class ze{constructor(e,t,s){this.service=e,this.serviceName=t,this.errors=s}create(e,...t){const s=t[0]||{},i=`${this.service}/${e}`,r=this.errors[e],n=r?function(e,t){return e.replace(qe,((e,s)=>{const i=t[s];return null!=i?String(i):`<${s}?>`}))}(r,s):"Error",a=`${this.serviceName}: ${n} (${i}).`;return new je(i,a,s)}}const qe=/\{\$([^}]+)}/g;function He(e){return JSON.parse(e)}function Ve(e){return JSON.stringify(e)}const We=function(e){let t={},s={},i={},r="";try{const n=e.split(".");t=He(Ne(n[0])||""),s=He(Ne(n[1])||""),r=n[2],i=s.d||{},delete s.d}catch(e){}return{header:t,claims:s,data:i,signature:r}};function $e(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Ke(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function Ge(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function Ye(e,t,s){const i={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(i[r]=t.call(s,e[r],r,e));return i}function Je(e,t){if(e===t)return!0;const s=Object.keys(e),i=Object.keys(t);for(const r of s){if(!i.includes(r))return!1;const s=e[r],n=t[r];if(Ze(s)&&Ze(n)){if(!Je(s,n))return!1}else if(s!==n)return!1}for(const e of i)if(!s.includes(e))return!1;return!0}function Ze(e){return null!==e&&"object"==typeof e}class Xe{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const s=this.W_;if("string"==typeof e)for(let i=0;i<16;i++)s[i]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let i=0;i<16;i++)s[i]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let e=16;e<80;e++){const t=s[e-3]^s[e-8]^s[e-14]^s[e-16];s[e]=4294967295&(t<<1|t>>>31)}let i,r,n=this.chain_[0],a=this.chain_[1],o=this.chain_[2],h=this.chain_[3],c=this.chain_[4];for(let e=0;e<80;e++){e<40?e<20?(i=h^a&(o^h),r=1518500249):(i=a^o^h,r=1859775393):e<60?(i=a&o|h&(a|o),r=2400959708):(i=a^o^h,r=3395469782);const t=(n<<5|n>>>27)+i+c+r+s[e]&4294967295;c=h,h=o,o=4294967295&(a<<30|a>>>2),a=n,n=t}this.chain_[0]=this.chain_[0]+n&4294967295,this.chain_[1]=this.chain_[1]+a&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+h&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,t){if(null==e)return;void 0===t&&(t=e.length);const s=t-this.blockSize;let i=0;const r=this.buf_;let n=this.inbuf_;for(;i<t;){if(0===n)for(;i<=s;)this.compress_(e,i),i+=this.blockSize;if("string"==typeof e){for(;i<t;)if(r[n]=e.charCodeAt(i),++n,++i,n===this.blockSize){this.compress_(r),n=0;break}}else for(;i<t;)if(r[n]=e[i],++n,++i,n===this.blockSize){this.compress_(r),n=0;break}}this.inbuf_=n,this.total_+=t}digest(){const e=[];let t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let e=this.blockSize-1;e>=56;e--)this.buf_[e]=255&t,t/=256;this.compress_(this.buf_);let s=0;for(let t=0;t<5;t++)for(let i=24;i>=0;i-=8)e[s]=this.chain_[t]>>i&255,++s;return e}}function Qe(e,t){return`${e} failed: ${t} argument `}const et=function(e){let t=0;for(let s=0;s<e.length;s++){const i=e.charCodeAt(s);i<128?t++:i<2048?t+=2:i>=55296&&i<=56319?(t+=4,s++):t+=3}return t},tt=1e3,st=2,it=144e5,rt=.5;function nt(e,t=tt,s=st){const i=t*Math.pow(s,e),r=Math.round(rt*i*(Math.random()-.5)*2);return Math.min(it,i+r)}function at(e){return e&&e._delegate?e._delegate:e}class ot{constructor(e,t,s){this.name=e,this.instanceFactory=t,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const ht="[DEFAULT]";class ct{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new Re;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&e.resolve(s)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const s=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),i=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(s)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:s})}catch(e){if(i)return null;throw e}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:ht})}catch(e){}for(const[e,t]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:s});t.resolve(e)}catch(e){}}}}clearInstance(e=ht){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(e=ht){return this.instances.has(e)}getOptions(e=ht){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:s,options:t});for(const[e,t]of this.instancesDeferred.entries())s===this.normalizeInstanceIdentifier(e)&&t.resolve(i);return i}onInit(e,t){var s;const i=this.normalizeInstanceIdentifier(t),r=null!==(s=this.onInitCallbacks.get(i))&&void 0!==s?s:new Set;r.add(e),this.onInitCallbacks.set(i,r);const n=this.instances.get(i);return n&&e(n,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const s=this.onInitCallbacks.get(t);if(s)for(const i of s)try{i(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:(i=e,i===ht?void 0:i),options:t}),this.instances.set(e,s),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch(e){}var i;return s||null}normalizeInstanceIdentifier(e=ht){return this.component?this.component.multipleInstances?e:ht:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class lt{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new ct(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const pt=[];var ut;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(ut||(ut={}));const dt={debug:ut.DEBUG,verbose:ut.VERBOSE,info:ut.INFO,warn:ut.WARN,error:ut.ERROR,silent:ut.SILENT},ft=ut.INFO,mt={[ut.DEBUG]:"log",[ut.VERBOSE]:"log",[ut.INFO]:"info",[ut.WARN]:"warn",[ut.ERROR]:"error"},yt=(e,t,...s)=>{if(t<e.logLevel)return;const i=(new Date).toISOString(),r=mt[t];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[r](`[${i}]  ${e.name}:`,...s)};class gt{constructor(e){this.name=e,this._logLevel=ft,this._logHandler=yt,this._userLogHandler=null,pt.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ut))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?dt[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ut.DEBUG,...e),this._logHandler(this,ut.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ut.VERBOSE,...e),this._logHandler(this,ut.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ut.INFO,...e),this._logHandler(this,ut.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ut.WARN,...e),this._logHandler(this,ut.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ut.ERROR,...e),this._logHandler(this,ut.ERROR,...e)}}const bt=(e,t)=>t.some((t=>e instanceof t));let wt,_t;const xt=new WeakMap,vt=new WeakMap,Pt=new WeakMap,Tt=new WeakMap,Ct=new WeakMap;let Et={get(e,t,s){if(e instanceof IDBTransaction){if("done"===t)return vt.get(e);if("objectStoreNames"===t)return e.objectStoreNames||Pt.get(e);if("store"===t)return s.objectStoreNames[1]?void 0:s.objectStore(s.objectStoreNames[0])}return At(e[t])},set:(e,t,s)=>(e[t]=s,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function kt(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(_t||(_t=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(St(this),e),At(xt.get(this))}:function(...e){return At(t.apply(St(this),e))}:function(e,...s){const i=t.call(St(this),e,...s);return Pt.set(i,e.sort?e.sort():[e]),At(i)}:(e instanceof IDBTransaction&&function(e){if(vt.has(e))return;const t=new Promise(((t,s)=>{const i=()=>{e.removeEventListener("complete",r),e.removeEventListener("error",n),e.removeEventListener("abort",n)},r=()=>{t(),i()},n=()=>{s(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",r),e.addEventListener("error",n),e.addEventListener("abort",n)}));vt.set(e,t)}(e),bt(e,wt||(wt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,Et):e);var t}function At(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,s)=>{const i=()=>{e.removeEventListener("success",r),e.removeEventListener("error",n)},r=()=>{t(At(e.result)),i()},n=()=>{s(e.error),i()};e.addEventListener("success",r),e.addEventListener("error",n)}));return t.then((t=>{t instanceof IDBCursor&&xt.set(t,e)})).catch((()=>{})),Ct.set(t,e),t}(e);if(Tt.has(e))return Tt.get(e);const t=kt(e);return t!==e&&(Tt.set(e,t),Ct.set(t,e)),t}const St=e=>Ct.get(e);function It(e,t,{blocked:s,upgrade:i,blocking:r,terminated:n}={}){const a=indexedDB.open(e,t),o=At(a);return i&&a.addEventListener("upgradeneeded",(e=>{i(At(a.result),e.oldVersion,e.newVersion,At(a.transaction),e)})),s&&a.addEventListener("blocked",(e=>s(e.oldVersion,e.newVersion,e))),o.then((e=>{n&&e.addEventListener("close",(()=>n())),r&&e.addEventListener("versionchange",(e=>r(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),o}const Nt=["get","getKey","getAll","getAllKeys","count"],Lt=["put","add","delete","clear"],Dt=new Map;function Ot(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(Dt.get(t))return Dt.get(t);const s=t.replace(/FromIndex$/,""),i=t!==s,r=Lt.includes(s);if(!(s in(i?IDBIndex:IDBObjectStore).prototype)||!r&&!Nt.includes(s))return;const n=async function(e,...t){const n=this.transaction(e,r?"readwrite":"readonly");let a=n.store;return i&&(a=a.index(t.shift())),(await Promise.all([a[s](...t),r&&n.done]))[0]};return Dt.set(t,n),n}var Mt;Mt=Et,Et={...Mt,get:(e,t,s)=>Ot(e,t)||Mt.get(e,t,s),has:(e,t)=>!!Ot(e,t)||Mt.has(e,t)};class Rt{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const Ft="@firebase/app",Bt="0.10.1",Ut=new gt("@firebase/app"),jt="[DEFAULT]",zt={[Ft]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},qt=new Map,Ht=new Map,Vt=new Map;function Wt(e,t){try{e.container.addComponent(t)}catch(s){Ut.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,s)}}function $t(e){const t=e.name;if(Vt.has(t))return Ut.debug(`There were multiple attempts to register component ${t}.`),!1;Vt.set(t,e);for(const t of qt.values())Wt(t,e);for(const t of Ht.values())Wt(t,e);return!0}function Kt(e,t){const s=e.container.getProvider("heartbeat").getImmediate({optional:!0});return s&&s.triggerHeartbeat(),e.container.getProvider(t)}const Gt=new ze("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class Yt{constructor(e,t,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new ot("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Gt.create("app-deleted",{appName:this._name})}}function Jt(e,t={}){let s=e;"object"!=typeof t&&(t={name:t});const i=Object.assign({name:jt,automaticDataCollectionEnabled:!1},t),r=i.name;if("string"!=typeof r||!r)throw Gt.create("bad-app-name",{appName:String(r)});if(s||(s=Me()),!s)throw Gt.create("no-options");const n=qt.get(r);if(n){if(Je(s,n.options)&&Je(i,n.config))return n;throw Gt.create("duplicate-app",{appName:r})}const a=new lt(r);for(const e of Vt.values())a.addComponent(e);const o=new Yt(s,i,a);return qt.set(r,o),o}function Zt(e=jt){const t=qt.get(e);if(!t&&e===jt&&Me())return Jt();if(!t)throw Gt.create("no-app",{appName:e});return t}function Xt(e,t,s){var i;let r=null!==(i=zt[e])&&void 0!==i?i:e;s&&(r+=`-${s}`);const n=r.match(/\s|\//),a=t.match(/\s|\//);if(n||a){const e=[`Unable to register library "${r}" with version "${t}":`];return n&&e.push(`library name "${r}" contains illegal characters (whitespace or "/")`),n&&a&&e.push("and"),a&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void Ut.warn(e.join(" "))}$t(new ot(`${r}-version`,(()=>({library:r,version:t})),"VERSION"))}const Qt="firebase-heartbeat-database",es=1,ts="firebase-heartbeat-store";let ss=null;function is(){return ss||(ss=It(Qt,es,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(ts)}catch(e){console.warn(e)}}}).catch((e=>{throw Gt.create("idb-open",{originalErrorMessage:e.message})}))),ss}async function rs(e,t){try{const s=(await is()).transaction(ts,"readwrite"),i=s.objectStore(ts);await i.put(t,ns(e)),await s.done}catch(e){if(e instanceof je)Ut.warn(e.message);else{const t=Gt.create("idb-set",{originalErrorMessage:null==e?void 0:e.message});Ut.warn(t.message)}}}function ns(e){return`${e.name}!${e.options.appId}`}class as{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new hs(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){var e,t;const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=os();if((null!=(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||(this._heartbeatsCache=await this._heartbeatsCachePromise,null!=(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))&&this._heartbeatsCache.lastSentHeartbeatDate!==i&&!this._heartbeatsCache.heartbeats.some((e=>e.date===i)))return this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=os(),{heartbeatsToSend:s,unsentEntries:i}=function(e,t=1024){const s=[];let i=e.slice();for(const r of e){const e=s.find((e=>e.agent===r.agent));if(e){if(e.dates.push(r.date),cs(s)>t){e.dates.pop();break}}else if(s.push({agent:r.agent,dates:[r.date]}),cs(s)>t){s.pop();break}i=i.slice(1)}return{heartbeatsToSend:s,unsentEntries:i}}(this._heartbeatsCache.heartbeats),r=Ie(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}}function os(){return(new Date).toISOString().substring(0,10)}class hs{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!Be()&&Ue().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await is()).transaction(ts),s=await t.objectStore(ts).get(ns(e));return await t.done,s}catch(e){if(e instanceof je)Ut.warn(e.message);else{const t=Gt.create("idb-get",{originalErrorMessage:null==e?void 0:e.message});Ut.warn(t.message)}}}(this.app);return(null==e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return rs(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return rs(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}}}function cs(e){return Ie(JSON.stringify({version:2,heartbeats:e})).length}$t(new ot("platform-logger",(e=>new Rt(e)),"PRIVATE")),$t(new ot("heartbeat",(e=>new as(e)),"PRIVATE")),Xt(Ft,Bt,""),Xt(Ft,Bt,"esm2017"),Xt("fire-js",""),Xt("firebase","10.11.0","app");const ls="@firebase/installations",ps="0.6.6",us=1e4,ds=`w:${ps}`,fs="FIS_v2",ms="https://firebaseinstallations.googleapis.com/v1",ys=36e5,gs=new ze("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function bs(e){return e instanceof je&&e.code.includes("request-failed")}function ws({projectId:e}){return`${ms}/projects/${e}/installations`}function _s(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function xs(e,t){const s=(await t.json()).error;return gs.create("request-failed",{requestName:e,serverCode:s.code,serverMessage:s.message,serverStatus:s.status})}function vs({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}async function Ps(e){const t=await e();return t.status>=500&&t.status<600?e():t}function Ts(e){return new Promise((t=>{setTimeout(t,e)}))}const Cs=/^[cdef][\w-]{21}$/,Es="";function ks(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){var t;return(t=e,btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22)}(e);return Cs.test(t)?t:Es}catch(e){return Es}}function As(e){return`${e.appName}!${e.appId}`}const Ss=new Map;function Is(e,t){const s=As(e);Ns(s,t),function(e,t){const s=(!Ls&&"BroadcastChannel"in self&&(Ls=new BroadcastChannel("[Firebase] FID Change"),Ls.onmessage=e=>{Ns(e.data.key,e.data.fid)}),Ls);s&&s.postMessage({key:e,fid:t}),0===Ss.size&&Ls&&(Ls.close(),Ls=null)}(s,t)}function Ns(e,t){const s=Ss.get(e);if(s)for(const e of s)e(t)}let Ls=null;const Ds="firebase-installations-database",Os=1,Ms="firebase-installations-store";let Rs=null;function Fs(){return Rs||(Rs=It(Ds,Os,{upgrade:(e,t)=>{0===t&&e.createObjectStore(Ms)}})),Rs}async function Bs(e,t){const s=As(e),i=(await Fs()).transaction(Ms,"readwrite"),r=i.objectStore(Ms),n=await r.get(s);return await r.put(t,s),await i.done,n&&n.fid===t.fid||Is(e,t.fid),t}async function Us(e){const t=As(e),s=(await Fs()).transaction(Ms,"readwrite");await s.objectStore(Ms).delete(t),await s.done}async function js(e,t){const s=As(e),i=(await Fs()).transaction(Ms,"readwrite"),r=i.objectStore(Ms),n=await r.get(s),a=t(n);return void 0===a?await r.delete(s):await r.put(a,s),await i.done,!a||n&&n.fid===a.fid||Is(e,a.fid),a}async function zs(e){let t;const s=await js(e.appConfig,(s=>{const i=function(e){return Vs(e||{fid:ks(),registrationStatus:0})}(s),r=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(gs.create("app-offline"))};const s={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},i=async function(e,t){try{const s=await async function({appConfig:e,heartbeatServiceProvider:t},{fid:s}){const i=ws(e),r=vs(e),n=t.getImmediate({optional:!0});if(n){const e=await n.getHeartbeatsHeader();e&&r.append("x-firebase-client",e)}const a={fid:s,authVersion:fs,appId:e.appId,sdkVersion:ds},o={method:"POST",headers:r,body:JSON.stringify(a)},h=await Ps((()=>fetch(i,o)));if(h.ok){const e=await h.json();return{fid:e.fid||s,registrationStatus:2,refreshToken:e.refreshToken,authToken:_s(e.authToken)}}throw await xs("Create Installation",h)}(e,t);return Bs(e.appConfig,s)}catch(s){throw bs(s)&&409===s.customData.serverCode?await Us(e.appConfig):await Bs(e.appConfig,{fid:t.fid,registrationStatus:0}),s}}(e,s);return{installationEntry:s,registrationPromise:i}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:qs(e)}:{installationEntry:t}}(e,i);return t=r.registrationPromise,r.installationEntry}));return s.fid===Es?{installationEntry:await t}:{installationEntry:s,registrationPromise:t}}async function qs(e){let t=await Hs(e.appConfig);for(;1===t.registrationStatus;)await Ts(100),t=await Hs(e.appConfig);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:s}=await zs(e);return s||t}return t}function Hs(e){return js(e,(e=>{if(!e)throw gs.create("installation-not-found");return Vs(e)}))}function Vs(e){return 1===(t=e).registrationStatus&&t.registrationTime+us<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}async function Ws({appConfig:e,heartbeatServiceProvider:t},s){const i=function(e,{fid:t}){return`${ws(e)}/${t}/authTokens:generate`}(e,s),r=function(e,{refreshToken:t}){const s=vs(e);return s.append("Authorization",function(e){return`${fs} ${e}`}(t)),s}(e,s),n=t.getImmediate({optional:!0});if(n){const e=await n.getHeartbeatsHeader();e&&r.append("x-firebase-client",e)}const a={installation:{sdkVersion:ds,appId:e.appId}},o={method:"POST",headers:r,body:JSON.stringify(a)},h=await Ps((()=>fetch(i,o)));if(h.ok)return _s(await h.json());throw await xs("Generate Auth Token",h)}async function $s(e,t=!1){let s;const i=await js(e.appConfig,(i=>{if(!Gs(i))throw gs.create("not-registered");const r=i.authToken;if(!t&&(2===(n=r).requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+ys}(n)))return i;var n;if(1===r.requestStatus)return s=async function(e,t){let s=await Ks(e.appConfig);for(;1===s.authToken.requestStatus;)await Ts(100),s=await Ks(e.appConfig);const i=s.authToken;return 0===i.requestStatus?$s(e,t):i}(e,t),i;{if(!navigator.onLine)throw gs.create("app-offline");const t=function(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}(i);return s=async function(e,t){try{const s=await Ws(e,t),i=Object.assign(Object.assign({},t),{authToken:s});return await Bs(e.appConfig,i),s}catch(s){if(!bs(s)||401!==s.customData.serverCode&&404!==s.customData.serverCode){const s=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await Bs(e.appConfig,s)}else await Us(e.appConfig);throw s}}(e,t),t}}));return s?await s:i.authToken}function Ks(e){return js(e,(e=>{if(!Gs(e))throw gs.create("not-registered");return 1===(t=e.authToken).requestStatus&&t.requestTime+us<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e;var t}))}function Gs(e){return void 0!==e&&2===e.registrationStatus}function Ys(e){return gs.create("missing-app-config-values",{valueName:e})}const Js="installations";$t(new ot(Js,(e=>{const t=e.getProvider("app").getImmediate(),s=function(e){if(!e||!e.options)throw Ys("App Configuration");if(!e.name)throw Ys("App Name");const t=["projectId","apiKey","appId"];for(const s of t)if(!e.options[s])throw Ys(s);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:s,heartbeatServiceProvider:Kt(t,"heartbeat"),_delete:()=>Promise.resolve()}}),"PUBLIC")),$t(new ot("installations-internal",(e=>{const t=Kt(e.getProvider("app").getImmediate(),Js).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:s,registrationPromise:i}=await zs(t);return i?i.catch(console.error):$s(t).catch(console.error),s.fid}(t),getToken:e=>async function(e,t=!1){const s=e;return await async function(e){const{registrationPromise:t}=await zs(e);t&&await t}(s),(await $s(s,t)).token}(t,e)}}),"PRIVATE")),Xt(ls,ps),Xt(ls,ps,"esm2017");const Zs="analytics",Xs="firebase_id",Qs="origin",ei=6e4,ti="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",si="https://www.googletagmanager.com/gtag/js",ii=new gt("@firebase/analytics"),ri=new ze("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function ni(e){if(!e.startsWith(si)){const t=ri.create("invalid-gtag-resource",{gtagURL:e});return ii.warn(t.message),""}return e}function ai(e){return Promise.all(e.map((e=>e.catch((e=>e)))))}const oi=30,hi=new class{constructor(e={},t=1e3){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function ci(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function li(e,t=hi,s){const{appId:i,apiKey:r,measurementId:n}=e.options;if(!i)throw ri.create("no-app-id");if(!r){if(n)return{measurementId:n,appId:i};throw ri.create("no-api-key")}const a=t.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},o=new ui;return setTimeout((async()=>{o.abort()}),void 0!==s?s:ei),pi({appId:i,apiKey:r,measurementId:n},a,o,t)}async function pi(e,{throttleEndTimeMillis:t,backoffCount:s},i,r=hi){var n;const{appId:a,measurementId:o}=e;try{await function(e,t){return new Promise(((s,i)=>{const r=Math.max(t-Date.now(),0),n=setTimeout(s,r);e.addEventListener((()=>{clearTimeout(n),i(ri.create("fetch-throttle",{throttleEndTimeMillis:t}))}))}))}(i,t)}catch(e){if(o)return ii.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${null==e?void 0:e.message}]`),{appId:a,measurementId:o};throw e}try{const t=await async function(e){var t;const{appId:s,apiKey:i}=e,r={method:"GET",headers:ci(i)},n=ti.replace("{app-id}",s),a=await fetch(n,r);if(200!==a.status&&304!==a.status){let e="";try{const s=await a.json();(null===(t=s.error)||void 0===t?void 0:t.message)&&(e=s.error.message)}catch(e){}throw ri.create("config-fetch-failed",{httpStatus:a.status,responseMessage:e})}return a.json()}(e);return r.deleteThrottleMetadata(a),t}catch(t){const h=t;if(!function(e){if(!(e instanceof je&&e.customData))return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(h)){if(r.deleteThrottleMetadata(a),o)return ii.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${null==h?void 0:h.message}]`),{appId:a,measurementId:o};throw t}const c=503===Number(null===(n=null==h?void 0:h.customData)||void 0===n?void 0:n.httpStatus)?nt(s,r.intervalMillis,oi):nt(s,r.intervalMillis),l={throttleEndTimeMillis:Date.now()+c,backoffCount:s+1};return r.setThrottleMetadata(a,l),ii.debug(`Calling attemptFetch again in ${c} millis`),pi(e,l,i,r)}}class ui{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach((e=>e()))}}let di,fi;async function mi(e,t,s,i,r,n,a){var o;const h=li(e);h.then((t=>{s[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&ii.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${t.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((e=>ii.error(e))),t.push(h);const c=async function(){if(!Be())return ii.warn(ri.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await Ue()}catch(e){return ii.warn(ri.create("indexeddb-unavailable",{errorInfo:null==e?void 0:e.toString()}).message),!1}return!0}().then((e=>e?i.getId():void 0)),[l,p]=await Promise.all([h,c]);(function(e){const t=window.document.getElementsByTagName("script");for(const s of Object.values(t))if(s.src&&s.src.includes(si)&&s.src.includes(e))return s;return null})(n)||function(e,t){const s=function(e,t){let s;return window.trustedTypes&&(s=window.trustedTypes.createPolicy("firebase-js-sdk-policy",t)),s}(0,{createScriptURL:ni}),i=document.createElement("script"),r=`${si}?l=${e}&id=${t}`;i.src=s?null==s?void 0:s.createScriptURL(r):r,i.async=!0,document.head.appendChild(i)}(n,l.measurementId),fi&&(r("consent","default",fi),fi=void 0),r("js",new Date);const u=null!==(o=null==a?void 0:a.config)&&void 0!==o?o:{};return u[Qs]="firebase",u.update=!0,null!=p&&(u[Xs]=p),r("config",l.measurementId,u),di&&(r("set",di),di=void 0),l.measurementId}class yi{constructor(e){this.app=e}_delete(){return delete gi[this.app.options.appId],Promise.resolve()}}let gi={},bi=[];const wi={};let _i,xi,vi="dataLayer",Pi=!1;function Ti(e,t,s){!function(){const e=[];if(function(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}()&&e.push("This is a browser extension environment."),"undefined"!=typeof navigator&&navigator.cookieEnabled||e.push("Cookies are not available."),e.length>0){const t=e.map(((e,t)=>`(${t+1}) ${e}`)).join(" "),s=ri.create("invalid-analytics-context",{errorInfo:t});ii.warn(s.message)}}();const i=e.options.appId;if(!i)throw ri.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw ri.create("no-api-key");ii.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=gi[i])throw ri.create("already-exists",{id:i});if(!Pi){!function(e){let t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(vi);const{wrappedGtag:e,gtagCore:t}=function(e,t,s,i,r){let n=function(...e){window[i].push(arguments)};return window[r]&&"function"==typeof window[r]&&(n=window[r]),window[r]=function(e,t,s,i){return async function(r,...n){try{if("event"===r){const[i,r]=n;await async function(e,t,s,i,r){try{let n=[];if(r&&r.send_to){let e=r.send_to;Array.isArray(e)||(e=[e]);const i=await ai(s);for(const s of e){const e=i.find((e=>e.measurementId===s)),r=e&&t[e.appId];if(!r){n=[];break}n.push(r)}}0===n.length&&(n=Object.values(t)),await Promise.all(n),e("event",i,r||{})}catch(e){ii.error(e)}}(e,t,s,i,r)}else if("config"===r){const[r,a]=n;await async function(e,t,s,i,r,n){const a=i[r];try{if(a)await t[a];else{const e=(await ai(s)).find((e=>e.measurementId===r));e&&await t[e.appId]}}catch(e){ii.error(e)}e("config",r,n)}(e,t,s,i,r,a)}else if("consent"===r){const[t]=n;e("consent","update",t)}else if("get"===r){const[t,s,i]=n;e("get",t,s,i)}else if("set"===r){const[t]=n;e("set",t)}else e(r,...n)}catch(e){ii.error(e)}}}(n,e,t,s),{gtagCore:n,wrappedGtag:window[r]}}(gi,bi,wi,vi,"gtag");xi=e,_i=t,Pi=!0}return gi[i]=mi(e,bi,wi,t,_i,vi,s),new yi(e)}const Ci="@firebase/analytics",Ei="0.10.2";$t(new ot(Zs,((e,{options:t})=>Ti(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),t)),"PUBLIC")),$t(new ot("analytics-internal",(function(e){try{const t=e.getProvider(Zs).getImmediate();return{logEvent:(e,s,i)=>function(e,t,s,i){e=at(e),async function(e,t,s,i,r){if(r&&r.global)e("event",s,i);else{const r=await t;e("event",s,Object.assign(Object.assign({},i),{send_to:r}))}}(xi,gi[e.app.options.appId],t,s,i).catch((e=>ii.error(e)))}(t,e,s,i)}}catch(e){throw ri.create("interop-component-reg-failed",{reason:e})}}),"PRIVATE")),Xt(Ci,Ei),Xt(Ci,Ei,"esm2017");const ki="@firebase/database",Ai="1.0.4";let Si="";class Ii{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Ve(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:He(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class Ni{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return $e(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const Li=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new Ii(t)}}catch(e){}return new Ni},Di=Li("localStorage"),Oi=Li("sessionStorage"),Mi=new gt("@firebase/database"),Ri=function(){let e=1;return function(){return e++}}(),Fi=function(e){const t=function(e){const t=[];let s=0;for(let i=0;i<e.length;i++){let r=e.charCodeAt(i);if(r>=55296&&r<=56319){const t=r-55296;i++,Te(i<e.length,"Surrogate pair missing trail surrogate."),r=65536+(t<<10)+(e.charCodeAt(i)-56320)}r<128?t[s++]=r:r<2048?(t[s++]=r>>6|192,t[s++]=63&r|128):r<65536?(t[s++]=r>>12|224,t[s++]=r>>6&63|128,t[s++]=63&r|128):(t[s++]=r>>18|240,t[s++]=r>>12&63|128,t[s++]=r>>6&63|128,t[s++]=63&r|128)}return t}(e),s=new Xe;s.update(t);const i=s.digest();return ke.encodeByteArray(i)},Bi=function(...e){let t="";for(let s=0;s<e.length;s++){const i=e[s];Array.isArray(i)||i&&"object"==typeof i&&"number"==typeof i.length?t+=Bi.apply(null,i):t+="object"==typeof i?Ve(i):i,t+=" "}return t};let Ui=null,ji=!0;const zi=function(...e){if(!0===ji&&(ji=!1,null===Ui&&!0===Oi.get("logging_enabled")&&(t=!0,Te(!s||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(Mi.logLevel=ut.VERBOSE,Ui=Mi.log.bind(Mi),s&&Oi.set("logging_enabled",!0)):"function"==typeof t?Ui=t:(Ui=null,Oi.remove("logging_enabled")))),Ui){const t=Bi.apply(null,e);Ui(t)}var t,s},qi=function(e){return function(...t){zi(e,...t)}},Hi=function(...e){const t="FIREBASE INTERNAL ERROR: "+Bi(...e);Mi.error(t)},Vi=function(...e){const t=`FIREBASE FATAL ERROR: ${Bi(...e)}`;throw Mi.error(t),new Error(t)},Wi=function(...e){const t="FIREBASE WARNING: "+Bi(...e);Mi.warn(t)},$i=function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},Ki="[MIN_NAME]",Gi="[MAX_NAME]",Yi=function(e,t){if(e===t)return 0;if(e===Ki||t===Gi)return-1;if(t===Ki||e===Gi)return 1;{const s=ir(e),i=ir(t);return null!==s?null!==i?s-i==0?e.length-t.length:s-i:-1:null!==i?1:e<t?-1:1}},Ji=function(e,t){return e===t?0:e<t?-1:1},Zi=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+Ve(t))},Xi=function(e){if("object"!=typeof e||null===e)return Ve(e);const t=[];for(const s in e)t.push(s);t.sort();let s="{";for(let i=0;i<t.length;i++)0!==i&&(s+=","),s+=Ve(t[i]),s+=":",s+=Xi(e[t[i]]);return s+="}",s},Qi=function(e,t){const s=e.length;if(s<=t)return[e];const i=[];for(let r=0;r<s;r+=t)r+t>s?i.push(e.substring(r,s)):i.push(e.substring(r,r+t));return i};function er(e,t){for(const s in e)e.hasOwnProperty(s)&&t(s,e[s])}const tr=function(e){Te(!$i(e),"Invalid JSON number");let t,s,i,r,n;0===e?(s=0,i=0,t=1/e==-1/0?1:0):(t=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(r=Math.min(Math.floor(Math.log(e)/Math.LN2),1023),s=r+1023,i=Math.round(e*Math.pow(2,52-r)-Math.pow(2,52))):(s=0,i=Math.round(e/Math.pow(2,-1074))));const a=[];for(n=52;n;n-=1)a.push(i%2?1:0),i=Math.floor(i/2);for(n=11;n;n-=1)a.push(s%2?1:0),s=Math.floor(s/2);a.push(t?1:0),a.reverse();const o=a.join("");let h="";for(n=0;n<64;n+=8){let e=parseInt(o.substr(n,8),2).toString(16);1===e.length&&(e="0"+e),h+=e}return h.toLowerCase()},sr=new RegExp("^-?(0*)\\d{1,10}$"),ir=function(e){if(sr.test(e)){const t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},rr=function(e){try{e()}catch(e){setTimeout((()=>{const t=e.stack||"";throw Wi("Exception was thrown by user callback.",t),e}),Math.floor(0))}},nr=function(e,t){const s=setTimeout(e,t);return"number"==typeof s&&"undefined"!=typeof Deno&&Deno.unrefTimer?Deno.unrefTimer(s):"object"==typeof s&&s.unref&&s.unref(),s};class ar{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=null==t?void 0:t.getImmediate({optional:!0}),this.appCheck||null==t||t.get().then((e=>this.appCheck=e))}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise(((t,s)=>{setTimeout((()=>{this.appCheck?this.getToken(e).then(t,s):t(null)}),0)}))}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then((t=>t.addTokenListener(e)))}notifyForInvalidToken(){Wi(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class or{constructor(e,t,s){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=s,this.auth_=null,this.auth_=s.getImmediate({optional:!0}),this.auth_||s.onInit((e=>this.auth_=e))}getToken(e){return this.auth_?this.auth_.getToken(e).catch((e=>e&&"auth/token-not-initialized"===e.code?(zi("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e))):new Promise(((t,s)=>{setTimeout((()=>{this.auth_?this.getToken(e).then(t,s):t(null)}),0)}))}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then((t=>t.addAuthTokenListener(e)))}removeTokenChangeListener(e){this.authProvider_.get().then((t=>t.removeAuthTokenListener(e)))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Wi(e)}}class hr{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}hr.OWNER="owner";const cr="5",lr=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,pr="ac",ur="websocket",dr="long_polling";class fr{constructor(e,t,s,i,r=!1,n="",a=!1,o=!1){this.secure=t,this.namespace=s,this.webSocketOnly=i,this.nodeAdmin=r,this.persistenceKey=n,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=o,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Di.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Di.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function mr(e,t,s){let i;if(Te("string"==typeof t,"typeof type must == string"),Te("object"==typeof s,"typeof params must == object"),t===ur)i=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==dr)throw new Error("Unknown connection type: "+t);i=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(s.ns=e.namespace);const r=[];return er(s,((e,t)=>{r.push(e+"="+t)})),i+r.join("&")}class yr{constructor(){this.counters_={}}incrementCounter(e,t=1){$e(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return Le(this.counters_)}}const gr={},br={};function wr(e){const t=e.toString();return gr[t]||(gr[t]=new yr),gr[t]}class _r{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const e=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let t=0;t<e.length;++t)e[t]&&rr((()=>{this.onMessage_(e[t])}));if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}const xr="start";class vr{constructor(e,t,s,i,r,n,a){this.connId=e,this.repoInfo=t,this.applicationId=s,this.appCheckToken=i,this.authToken=r,this.transportSessionId=n,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=qi(e),this.stats_=wr(t),this.urlFn=e=>(this.appCheckToken&&(e[pr]=this.appCheckToken),mr(t,dr,e))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new _r(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if("complete"===document.readyState)e();else{let t=!1;const s=function(){document.body?t||(t=!0,e()):setTimeout(s,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",s,!1),window.addEventListener("load",s,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(()=>{"complete"===document.readyState&&s()})),window.attachEvent("onload",s))}}((()=>{if(this.isClosed_)return;this.scriptTagHolder=new Pr(((...e)=>{const[t,s,i,r,n]=e;if(this.incrementIncomingBytes_(e),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,t===xr)this.id=s,this.password=i;else{if("close"!==t)throw new Error("Unrecognized command received: "+t);s?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(s,(()=>{this.onClosed_()}))):this.onClosed_()}}),((...e)=>{const[t,s]=e;this.incrementIncomingBytes_(e),this.myPacketOrderer.handleResponse(t,s)}),(()=>{this.onClosed_()}),this.urlFn);const e={};e[xr]="t",e.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=this.scriptTagHolder.uniqueCallbackIdentifier),e.v=cr,this.transportSessionId&&(e.s=this.transportSessionId),this.lastSessionId&&(e.ls=this.lastSessionId),this.applicationId&&(e.p=this.applicationId),this.appCheckToken&&(e[pr]=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&lr.test(location.hostname)&&(e.r="f");const t=this.urlFn(e);this.log_("Connecting via long-poll to "+t),this.scriptTagHolder.addTag(t,(()=>{}))}))}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){vr.forceAllow_=!0}static forceDisallow(){vr.forceDisallow_=!0}static isAvailable(){return!(!vr.forceAllow_&&(vr.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=Ve(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const s=Se(t),i=Qi(s,1840);for(let e=0;e<i.length;e++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[e]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const s={dframe:"t"};s.id=e,s.pw=t,this.myDisconnFrame.src=this.urlFn(s),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=Ve(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class Pr{constructor(e,t,s,i){this.onDisconnect=s,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=Ri(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=Pr.createIFrame_();let s="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(s='<script>document.domain="'+document.domain+'";<\/script>');const i="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(i),this.myIFrame.doc.close()}catch(e){zi("frame writing exception"),e.stack&&zi(e.stack),zi(e)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||zi("No IE domain setting required")}catch(t){const s=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+s+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout((()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)}),Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),s="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+s.length<=1870;){const e=this.pendingSegs.shift();s=s+"&seg"+i+"="+e.seg+"&ts"+i+"="+e.ts+"&d"+i+"="+e.d,i++}return t+=s,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,s){this.pendingSegs.push({seg:e,ts:t,d:s}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const s=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(s,Math.floor(25e3));this.addTag(e,(()=>{clearTimeout(i),s()}))}addTag(e,t){setTimeout((()=>{try{if(!this.sendNewPolls)return;const s=this.myIFrame.doc.createElement("script");s.type="text/javascript",s.async=!0,s.src=e,s.onload=s.onreadystatechange=function(){const e=s.readyState;e&&"loaded"!==e&&"complete"!==e||(s.onload=s.onreadystatechange=null,s.parentNode&&s.parentNode.removeChild(s),t())},s.onerror=()=>{zi("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(s)}catch(e){}}),Math.floor(1))}}let Tr=null;"undefined"!=typeof MozWebSocket?Tr=MozWebSocket:"undefined"!=typeof WebSocket&&(Tr=WebSocket);class Cr{constructor(e,t,s,i,r,n,a){this.connId=e,this.applicationId=s,this.appCheckToken=i,this.authToken=r,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=qi(this.connId),this.stats_=wr(t),this.connURL=Cr.connectionURL_(t,n,a,i,s),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,s,i,r){const n={};return n.v=cr,"undefined"!=typeof location&&location.hostname&&lr.test(location.hostname)&&(n.r="f"),t&&(n.s=t),s&&(n.ls=s),i&&(n[pr]=i),r&&(n.p=r),mr(e,ur,n)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Di.set("previous_websocket_failure",!0);try{let e;0,this.mySock=new Tr(this.connURL,[],e)}catch(e){this.log_("Error instantiating WebSocket.");const t=e.message||e.data;return t&&this.log_(t),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=e=>{this.handleIncomingFrame(e)},this.mySock.onerror=e=>{this.log_("WebSocket error.  Closing connection.");const t=e.message||e.data;t&&this.log_(t),this.onClosed_()}}start(){}static forceDisallow(){Cr.forceDisallow_=!0}static isAvailable(){let e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,s=navigator.userAgent.match(t);s&&s.length>1&&parseFloat(s[1])<4.4&&(e=!0)}return!e&&null!==Tr&&!Cr.forceDisallow_}static previouslyFailed(){return Di.isInMemoryStorage||!0===Di.get("previous_websocket_failure")}markConnectionHealthy(){Di.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const e=this.frames.join("");this.frames=null;const t=He(e);this.onMessage(t)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(Te(null===this.frames,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{const e=this.extractFrameCount_(t);null!==e&&this.appendFrame_(e)}}send(e){this.resetKeepAlive();const t=Ve(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const s=Qi(t,16384);s.length>1&&this.sendString_(String(s.length));for(let e=0;e<s.length;e++)this.sendString_(s[e])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()}),Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Cr.responsesRequiredToBeHealthy=2,Cr.healthyTimeout=3e4;class Er{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[vr,Cr]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const t=Cr&&Cr.isAvailable();let s=t&&!Cr.previouslyFailed();if(e.webSocketOnly&&(t||Wi("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),s=!0),s)this.transports_=[Cr];else{const e=this.transports_=[];for(const t of Er.ALL_TRANSPORTS)t&&t.isAvailable()&&e.push(t);Er.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Er.globalTransportInitialized_=!1;class kr{constructor(e,t,s,i,r,n,a,o,h,c){this.id=e,this.repoInfo_=t,this.applicationId_=s,this.appCheckToken_=i,this.authToken_=r,this.onMessage_=n,this.onReady_=a,this.onDisconnect_=o,this.onKill_=h,this.lastSessionId=c,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=qi("c:"+this.id+":"),this.transportManager_=new Er(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),s=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((()=>{this.conn_&&this.conn_.open(t,s)}),Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=nr((()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))}),Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=Zi("t",e),s=Zi("d",e);if("c"===t)this.onSecondaryControl_(s);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(s)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=Zi("t",e),s=Zi("d",e);"c"===t?this.onControl_(s):"d"===t&&this.onDataMessage_(s)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=Zi("t",e);if("d"in e){const s=e.d;if("h"===t){const e=Object.assign({},s);this.repoInfo_.isUsingEmulator&&(e.h=this.repoInfo_.host),this.onHandshake_(e)}else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let e=0;e<this.pendingDataMessages.length;++e)this.onDataMessage_(this.pendingDataMessages[e]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(s):"r"===t?this.onReset_(s):"e"===t?Hi("Server Error: "+s):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Hi("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,s=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),cr!==s&&Wi("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),s=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,s),nr((()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())}),Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):nr((()=>{this.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Di.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class Ar{put(e,t,s,i){}merge(e,t,s,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,s){}onDisconnectMerge(e,t,s){}onDisconnectCancel(e,t){}reportStats(e){}}class Sr{constructor(e){this.allowedEvents_=e,this.listeners_={},Te(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const s=[...this.listeners_[e]];for(let e=0;e<s.length;e++)s[e].callback.apply(s[e].context,t)}}on(e,t,s){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:s});const i=this.getInitialEvent(e);i&&t.apply(s,i)}off(e,t,s){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let e=0;e<i.length;e++)if(i[e].callback===t&&(!s||s===i[e].context))return void i.splice(e,1)}validateEventType_(e){Te(this.allowedEvents_.find((t=>t===e)),"Unknown event: "+e)}}class Ir extends Sr{constructor(){super(["online"]),this.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||Fe()||(window.addEventListener("online",(()=>{this.online_||(this.online_=!0,this.trigger("online",!0))}),!1),window.addEventListener("offline",(()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))}),!1))}static getInstance(){return new Ir}getInitialEvent(e){return Te("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class Nr{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let t=0;for(let e=0;e<this.pieces_.length;e++)this.pieces_[e].length>0&&(this.pieces_[t]=this.pieces_[e],t++);this.pieces_.length=t,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function Lr(){return new Nr("")}function Dr(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function Or(e){return e.pieces_.length-e.pieceNum_}function Mr(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new Nr(e.pieces_,t)}function Rr(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function Fr(e,t=0){return e.pieces_.slice(e.pieceNum_+t)}function Br(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let s=e.pieceNum_;s<e.pieces_.length-1;s++)t.push(e.pieces_[s]);return new Nr(t,0)}function Ur(e,t){const s=[];for(let t=e.pieceNum_;t<e.pieces_.length;t++)s.push(e.pieces_[t]);if(t instanceof Nr)for(let e=t.pieceNum_;e<t.pieces_.length;e++)s.push(t.pieces_[e]);else{const e=t.split("/");for(let t=0;t<e.length;t++)e[t].length>0&&s.push(e[t])}return new Nr(s,0)}function jr(e){return e.pieceNum_>=e.pieces_.length}function zr(e,t){const s=Dr(e),i=Dr(t);if(null===s)return t;if(s===i)return zr(Mr(e),Mr(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function qr(e,t){if(Or(e)!==Or(t))return!1;for(let s=e.pieceNum_,i=t.pieceNum_;s<=e.pieces_.length;s++,i++)if(e.pieces_[s]!==t.pieces_[i])return!1;return!0}function Hr(e,t){let s=e.pieceNum_,i=t.pieceNum_;if(Or(e)>Or(t))return!1;for(;s<e.pieces_.length;){if(e.pieces_[s]!==t.pieces_[i])return!1;++s,++i}return!0}class Vr{constructor(e,t){this.errorPrefix_=t,this.parts_=Fr(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let e=0;e<this.parts_.length;e++)this.byteLength_+=et(this.parts_[e]);Wr(this)}}function Wr(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+$r(e))}function $r(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}class Kr extends Sr{constructor(){let e,t;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(t="visibilitychange",e="hidden"):void 0!==document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(t="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,(()=>{const t=!document[e];t!==this.visible_&&(this.visible_=t,this.trigger("visible",t))}),!1)}static getInstance(){return new Kr}getInitialEvent(e){return Te("visible"===e,"Unknown event type: "+e),[this.visible_]}}const Gr=1e3;class Yr extends Ar{constructor(e,t,s,i,r,n,a,o){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=s,this.onConnectStatus_=i,this.onServerInfoUpdate_=r,this.authTokenProvider_=n,this.appCheckTokenProvider_=a,this.authOverride_=o,this.id=Yr.nextPersistentConnectionId_++,this.log_=qi("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Gr,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,o)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Kr.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&Ir.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,s){const i=++this.requestNumber_,r={r:i,a:e,b:t};this.log_(Ve(r)),Te(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(r),s&&(this.requestCBHash_[i]=s)}get(e){this.initConnection_();const t=new Re,s={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:e=>{const s=e.d;"ok"===e.s?t.resolve(s):t.reject(s)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(i),t.promise}listen(e,t,s,i){this.initConnection_();const r=e._queryIdentifier,n=e._path.toString();this.log_("Listen called for "+n+" "+r),this.listens.has(n)||this.listens.set(n,new Map),Te(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),Te(!this.listens.get(n).has(r),"listen() called twice for same path/queryId.");const a={onComplete:i,hashFn:t,query:e,tag:s};this.listens.get(n).set(r,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,(s=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(s)}))}sendListen_(e){const t=e.query,s=t._path.toString(),i=t._queryIdentifier;this.log_("Listen on "+s+" for "+i);const r={p:s};e.tag&&(r.q=t._queryObject,r.t=e.tag),r.h=e.hashFn(),this.sendRequest("q",r,(r=>{const n=r.d,a=r.s;Yr.warnOnListenWarnings_(n,t),(this.listens.get(s)&&this.listens.get(s).get(i))===e&&(this.log_("listen response",r),"ok"!==a&&this.removeListen_(s,i),e.onComplete&&e.onComplete(a,n))}))}static warnOnListenWarnings_(e,t){if(e&&"object"==typeof e&&$e(e,"w")){const s=Ke(e,"w");if(Array.isArray(s)&&~s.indexOf("no_index")){const e='".indexOn": "'+t._queryParams.getIndex().toString()+'"',s=t._path.toString();Wi(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${e} at ${s} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(()=>{})),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||function(e){const t=We(e).claims;return"object"==typeof t&&!0===t.admin}(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(()=>{}))}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=function(e){const t=We(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")}(e)?"auth":"gauth",s={cred:e};null===this.authOverride_?s.noauth=!0:"object"==typeof this.authOverride_&&(s.authvar=this.authOverride_),this.sendRequest(t,s,(t=>{const s=t.s,i=t.d||"error";this.authToken_===e&&("ok"===s?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(s,i))}))}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(e=>{const t=e.s,s=e.d||"error";"ok"===t?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,s)}))}unlisten(e,t){const s=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+s+" "+i),Te(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(s,i)&&this.connected_&&this.sendUnlisten_(s,i,e._queryObject,t)}sendUnlisten_(e,t,s,i){this.log_("Unlisten on "+e+" for "+t);const r={p:e};i&&(r.q=s,r.t=i),this.sendRequest("n",r)}onDisconnectPut(e,t,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:s})}onDisconnectMerge(e,t,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:s})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,s,i){const r={p:t,d:s};this.log_("onDisconnect "+e,r),this.sendRequest(e,r,(e=>{i&&setTimeout((()=>{i(e.s,e.d)}),Math.floor(0))}))}put(e,t,s,i){this.putInternal("p",e,t,s,i)}merge(e,t,s,i){this.putInternal("m",e,t,s,i)}putInternal(e,t,s,i,r){this.initConnection_();const n={p:t,d:s};void 0!==r&&(n.h=r),this.outstandingPuts_.push({action:e,request:n,onComplete:i}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,s=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,s,(s=>{this.log_(t+" response",s),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),i&&i(s.s,s.d)}))}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,(e=>{if("ok"!==e.s){const t=e.d;this.log_("reportStats","Error sending stats: "+t)}}))}}onDataMessage_(e){if("r"in e){this.log_("from server: "+Ve(e));const t=e.r,s=this.requestCBHash_[t];s&&(delete this.requestCBHash_[t],s(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):Hi("Unrecognized action received from server: "+Ve(e)+"\nAre you using the latest client?")}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){Te(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((()=>{this.establishConnectionTimer_=null,this.establishConnection_()}),Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Gr,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Gr,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Gr),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const e=(new Date).getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),s=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+Yr.nextConnectionId_++,r=this.lastSessionId;let n=!1,a=null;const o=function(){a?a.close():(n=!0,s())},h=function(e){Te(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(e)};this.realtime_={close:o,sendRequest:h};const c=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[o,h]=await Promise.all([this.authTokenProvider_.getToken(c),this.appCheckTokenProvider_.getToken(c)]);n?zi("getToken() completed but was canceled"):(zi("getToken() completed. Creating connection."),this.authToken_=o&&o.accessToken,this.appCheckToken_=h&&h.token,a=new kr(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,s,(e=>{Wi(e+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")}),r))}catch(e){this.log_("Failed to get token: "+e),n||(this.repoInfo_.nodeAdmin&&Wi(e),o())}}}interrupt(e){zi("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){zi("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Ge(this.interruptReasons_)&&(this.reconnectDelay_=Gr,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let s;s=t?t.map((e=>Xi(e))).join("$"):"default";const i=this.removeListen_(e,s);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,t){const s=new Nr(e).toString();let i;if(this.listens.has(s)){const e=this.listens.get(s);i=e.get(t),e.delete(t),0===e.size&&this.listens.delete(s)}else i=void 0;return i}onAuthRevoked_(e,t){zi("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){zi("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+Si.replace(/\./g,"-")]=1,Fe()?e["framework.cordova"]=1:"object"==typeof navigator&&"ReactNative"===navigator.product&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=Ir.getInstance().currentlyOnline();return Ge(this.interruptReasons_)&&e}}Yr.nextPersistentConnectionId_=0,Yr.nextConnectionId_=0;class Jr{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Jr(e,t)}}class Zr{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const s=new Jr(Ki,e),i=new Jr(Ki,t);return 0!==this.compare(s,i)}minPost(){return Jr.MIN}}let Xr;class Qr extends Zr{static get __EMPTY_NODE(){return Xr}static set __EMPTY_NODE(e){Xr=e}compare(e,t){return Yi(e.name,t.name)}isDefinedOn(e){throw Ce("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Jr.MIN}maxPost(){return new Jr(Gi,Xr)}makePost(e,t){return Te("string"==typeof e,"KeyIndex indexValue must always be a string."),new Jr(e,Xr)}toString(){return".key"}}const en=new Qr;class tn{constructor(e,t,s,i,r=null){this.isReverse_=i,this.resultGenerator_=r,this.nodeStack_=[];let n=1;for(;!e.isEmpty();)if(n=t?s(e.key,t):1,i&&(n*=-1),n<0)e=this.isReverse_?e.left:e.right;else{if(0===n){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class sn{constructor(e,t,s,i,r){this.key=e,this.value=t,this.color=null!=s?s:sn.RED,this.left=null!=i?i:rn.EMPTY_NODE,this.right=null!=r?r:rn.EMPTY_NODE}copy(e,t,s,i,r){return new sn(null!=e?e:this.key,null!=t?t:this.value,null!=s?s:this.color,null!=i?i:this.left,null!=r?r:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let i=this;const r=s(e,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(e,t,s),null):0===r?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,s)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return rn.EMPTY_NODE;let e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let s,i;if(s=this,t(e,s.key)<0)s.left.isEmpty()||s.left.isRed_()||s.left.left.isRed_()||(s=s.moveRedLeft_()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed_()&&(s=s.rotateRight_()),s.right.isEmpty()||s.right.isRed_()||s.right.left.isRed_()||(s=s.moveRedRight_()),0===t(e,s.key)){if(s.right.isEmpty())return rn.EMPTY_NODE;i=s.right.min_(),s=s.copy(i.key,i.value,null,null,s.right.removeMin_())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,sn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,sn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}sn.RED=!0,sn.BLACK=!1;class rn{constructor(e,t=rn.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new rn(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,sn.BLACK,null,null))}remove(e){return new rn(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,sn.BLACK,null,null))}get(e){let t,s=this.root_;for(;!s.isEmpty();){if(t=this.comparator_(e,s.key),0===t)return s.value;t<0?s=s.left:t>0&&(s=s.right)}return null}getPredecessorKey(e){let t,s=this.root_,i=null;for(;!s.isEmpty();){if(t=this.comparator_(e,s.key),0===t){if(s.left.isEmpty())return i?i.key:null;for(s=s.left;!s.right.isEmpty();)s=s.right;return s.key}t<0?s=s.left:t>0&&(i=s,s=s.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new tn(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new tn(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new tn(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new tn(this.root_,null,this.comparator_,!0,e)}}function nn(e,t){return Yi(e.name,t.name)}function an(e,t){return Yi(e,t)}let on;rn.EMPTY_NODE=new class{copy(e,t,s,i,r){return this}insert(e,t,s){return new sn(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const hn=function(e){return"number"==typeof e?"number:"+tr(e):"string:"+e},cn=function(e){if(e.isLeafNode()){const t=e.val();Te("string"==typeof t||"number"==typeof t||"object"==typeof t&&$e(t,".sv"),"Priority must be a string or number.")}else Te(e===on||e.isEmpty(),"priority of unexpected type.");Te(e===on||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let ln,pn,un;class dn{constructor(e,t=dn.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,Te(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),cn(this.priorityNode_)}static set __childrenNodeConstructor(e){ln=e}static get __childrenNodeConstructor(){return ln}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new dn(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:dn.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return jr(e)?this:".priority"===Dr(e)?this.priorityNode_:dn.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:dn.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const s=Dr(e);return null===s?t:t.isEmpty()&&".priority"!==s?this:(Te(".priority"!==s||1===Or(e),".priority must be the last token in a path"),this.updateImmediateChild(s,dn.__childrenNodeConstructor.EMPTY_NODE.updateChild(Mr(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+hn(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",e+="number"===t?tr(this.value_):this.value_,this.lazyHash_=Fi(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===dn.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof dn.__childrenNodeConstructor?-1:(Te(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,s=typeof this.value_,i=dn.VALUE_TYPE_ORDER.indexOf(t),r=dn.VALUE_TYPE_ORDER.indexOf(s);return Te(i>=0,"Unknown leaf type: "+t),Te(r>=0,"Unknown leaf type: "+s),i===r?"object"===s?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:r-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}dn.VALUE_TYPE_ORDER=["object","boolean","number","string"];const fn=new class extends Zr{compare(e,t){const s=e.node.getPriority(),i=t.node.getPriority(),r=s.compareTo(i);return 0===r?Yi(e.name,t.name):r}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Jr.MIN}maxPost(){return new Jr(Gi,new dn("[PRIORITY-POST]",un))}makePost(e,t){const s=pn(e);return new Jr(t,new dn("[PRIORITY-POST]",s))}toString(){return".priority"}},mn=Math.log(2);class yn{constructor(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/mn,10)),this.current_=this.count-1;const s=(i=this.count,parseInt(Array(i+1).join("1"),2));var i;this.bits_=e+1&s}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const gn=function(e,t,s,i){e.sort(t);const r=function(t,i){const n=i-t;let a,o;if(0===n)return null;if(1===n)return a=e[t],o=s?s(a):a,new sn(o,a.node,sn.BLACK,null,null);{const h=parseInt(n/2,10)+t,c=r(t,h),l=r(h+1,i);return a=e[h],o=s?s(a):a,new sn(o,a.node,sn.BLACK,c,l)}},n=function(t){let i=null,n=null,a=e.length;const o=function(t,i){const n=a-t,o=a;a-=t;const c=r(n+1,o),l=e[n],p=s?s(l):l;h(new sn(p,l.node,i,null,c))},h=function(e){i?(i.left=e,i=e):(n=e,i=e)};for(let e=0;e<t.count;++e){const s=t.nextBitIsOne(),i=Math.pow(2,t.count-(e+1));s?o(i,sn.BLACK):(o(i,sn.BLACK),o(i,sn.RED))}return n}(new yn(e.length));return new rn(i||t,n)};let bn;const wn={};class _n{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return Te(wn&&fn,"ChildrenNode.ts has not been loaded"),bn=bn||new _n({".priority":wn},{".priority":fn}),bn}get(e){const t=Ke(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof rn?t:null}hasIndex(e){return $e(this.indexSet_,e.toString())}addIndex(e,t){Te(e!==en,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const s=[];let i=!1;const r=t.getIterator(Jr.Wrap);let n,a=r.getNext();for(;a;)i=i||e.isDefinedOn(a.node),s.push(a),a=r.getNext();n=i?gn(s,e.getCompare()):wn;const o=e.toString(),h=Object.assign({},this.indexSet_);h[o]=e;const c=Object.assign({},this.indexes_);return c[o]=n,new _n(c,h)}addToIndexes(e,t){const s=Ye(this.indexes_,((s,i)=>{const r=Ke(this.indexSet_,i);if(Te(r,"Missing index implementation for "+i),s===wn){if(r.isDefinedOn(e.node)){const s=[],i=t.getIterator(Jr.Wrap);let n=i.getNext();for(;n;)n.name!==e.name&&s.push(n),n=i.getNext();return s.push(e),gn(s,r.getCompare())}return wn}{const i=t.get(e.name);let r=s;return i&&(r=r.remove(new Jr(e.name,i))),r.insert(e,e.node)}}));return new _n(s,this.indexSet_)}removeFromIndexes(e,t){const s=Ye(this.indexes_,(s=>{if(s===wn)return s;{const i=t.get(e.name);return i?s.remove(new Jr(e.name,i)):s}}));return new _n(s,this.indexSet_)}}let xn;class vn{constructor(e,t,s){this.children_=e,this.priorityNode_=t,this.indexMap_=s,this.lazyHash_=null,this.priorityNode_&&cn(this.priorityNode_),this.children_.isEmpty()&&Te(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return xn||(xn=new vn(new rn(an),null,_n.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||xn}updatePriority(e){return this.children_.isEmpty()?this:new vn(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{const t=this.children_.get(e);return null===t?xn:t}}getChild(e){const t=Dr(e);return null===t?this:this.getImmediateChild(t).getChild(Mr(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(e,t){if(Te(t,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(t);{const s=new Jr(e,t);let i,r;t.isEmpty()?(i=this.children_.remove(e),r=this.indexMap_.removeFromIndexes(s,this.children_)):(i=this.children_.insert(e,t),r=this.indexMap_.addToIndexes(s,this.children_));const n=i.isEmpty()?xn:this.priorityNode_;return new vn(i,n,r)}}updateChild(e,t){const s=Dr(e);if(null===s)return t;{Te(".priority"!==Dr(e)||1===Or(e),".priority must be the last token in a path");const i=this.getImmediateChild(s).updateChild(Mr(e),t);return this.updateImmediateChild(s,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let s=0,i=0,r=!0;if(this.forEachChild(fn,((n,a)=>{t[n]=a.val(e),s++,r&&vn.INTEGER_REGEXP_.test(n)?i=Math.max(i,Number(n)):r=!1})),!e&&r&&i<2*s){const e=[];for(const s in t)e[s]=t[s];return e}return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+hn(this.getPriority().val())+":"),this.forEachChild(fn,((t,s)=>{const i=s.hash();""!==i&&(e+=":"+t+":"+i)})),this.lazyHash_=""===e?"":Fi(e)}return this.lazyHash_}getPredecessorChildName(e,t,s){const i=this.resolveIndex_(s);if(i){const s=i.getPredecessorKey(new Jr(e,t));return s?s.name:null}return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.minKey();return e&&e.name}return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new Jr(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.maxKey();return e&&e.name}return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new Jr(t,this.children_.get(t)):null}forEachChild(e,t){const s=this.resolveIndex_(e);return s?s.inorderTraversal((e=>t(e.name,e.node))):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const s=this.resolveIndex_(t);if(s)return s.getIteratorFrom(e,(e=>e));{const s=this.children_.getIteratorFrom(e.name,Jr.Wrap);let i=s.peek();for(;null!=i&&t.compare(i,e)<0;)s.getNext(),i=s.peek();return s}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const s=this.resolveIndex_(t);if(s)return s.getReverseIteratorFrom(e,(e=>e));{const s=this.children_.getReverseIteratorFrom(e.name,Jr.Wrap);let i=s.peek();for(;null!=i&&t.compare(i,e)>0;)s.getNext(),i=s.peek();return s}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Pn?-1:0}withIndex(e){if(e===en||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new vn(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===en||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){const e=this.getIterator(fn),s=t.getIterator(fn);let i=e.getNext(),r=s.getNext();for(;i&&r;){if(i.name!==r.name||!i.node.equals(r.node))return!1;i=e.getNext(),r=s.getNext()}return null===i&&null===r}return!1}return!1}}resolveIndex_(e){return e===en?null:this.indexMap_.get(e.toString())}}vn.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;const Pn=new class extends vn{constructor(){super(new rn(an),vn.EMPTY_NODE,_n.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return vn.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(Jr,{MIN:{value:new Jr(Ki,vn.EMPTY_NODE)},MAX:{value:new Jr(Gi,Pn)}}),Qr.__EMPTY_NODE=vn.EMPTY_NODE,dn.__childrenNodeConstructor=vn,on=Pn,un=Pn;const Tn=!0;function Cn(e,t=null){if(null===e)return vn.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),Te(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e)return new dn(e,Cn(t));if(e instanceof Array||!Tn){let s=vn.EMPTY_NODE;return er(e,((t,i)=>{if($e(e,t)&&"."!==t.substring(0,1)){const e=Cn(i);!e.isLeafNode()&&e.isEmpty()||(s=s.updateImmediateChild(t,e))}})),s.updatePriority(Cn(t))}{const s=[];let i=!1;if(er(e,((e,t)=>{if("."!==e.substring(0,1)){const r=Cn(t);r.isEmpty()||(i=i||!r.getPriority().isEmpty(),s.push(new Jr(e,r)))}})),0===s.length)return vn.EMPTY_NODE;const r=gn(s,nn,(e=>e.name),an);if(i){const e=gn(s,fn.getCompare());return new vn(r,Cn(t),new _n({".priority":e},{".priority":fn}))}return new vn(r,Cn(t),_n.Default)}}!function(e){pn=e}(Cn);class En extends Zr{constructor(e){super(),this.indexPath_=e,Te(!jr(e)&&".priority"!==Dr(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const s=this.extractChild(e.node),i=this.extractChild(t.node),r=s.compareTo(i);return 0===r?Yi(e.name,t.name):r}makePost(e,t){const s=Cn(e),i=vn.EMPTY_NODE.updateChild(this.indexPath_,s);return new Jr(t,i)}maxPost(){const e=vn.EMPTY_NODE.updateChild(this.indexPath_,Pn);return new Jr(Gi,e)}toString(){return Fr(this.indexPath_,0).join("/")}}const kn=new class extends Zr{compare(e,t){const s=e.node.compareTo(t.node);return 0===s?Yi(e.name,t.name):s}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Jr.MIN}maxPost(){return Jr.MAX}makePost(e,t){const s=Cn(e);return new Jr(t,s)}toString(){return".value"}};function An(e){return{type:"value",snapshotNode:e}}function Sn(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function In(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function Nn(e,t,s){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:s}}class Ln{constructor(e){this.index_=e}updateChild(e,t,s,i,r,n){Te(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(t);return a.getChild(i).equals(s.getChild(i))&&a.isEmpty()===s.isEmpty()?e:(null!=n&&(s.isEmpty()?e.hasChild(t)?n.trackChildChange(In(t,a)):Te(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?n.trackChildChange(Sn(t,s)):n.trackChildChange(Nn(t,s,a))),e.isLeafNode()&&s.isEmpty()?e:e.updateImmediateChild(t,s).withIndex(this.index_))}updateFullNode(e,t,s){return null!=s&&(e.isLeafNode()||e.forEachChild(fn,((e,i)=>{t.hasChild(e)||s.trackChildChange(In(e,i))})),t.isLeafNode()||t.forEachChild(fn,((t,i)=>{if(e.hasChild(t)){const r=e.getImmediateChild(t);r.equals(i)||s.trackChildChange(Nn(t,i,r))}else s.trackChildChange(Sn(t,i))}))),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?vn.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class Dn{constructor(e){this.indexedFilter_=new Ln(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Dn.getStartPost_(e),this.endPost_=Dn.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,s=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&s}updateChild(e,t,s,i,r,n){return this.matches(new Jr(t,s))||(s=vn.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,s,i,r,n)}updateFullNode(e,t,s){t.isLeafNode()&&(t=vn.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(vn.EMPTY_NODE);const r=this;return t.forEachChild(fn,((e,t)=>{r.matches(new Jr(e,t))||(i=i.updateImmediateChild(e,vn.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(e,i,s)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class On{constructor(e){this.withinDirectionalStart=e=>this.reverse_?this.withinEndPost(e):this.withinStartPost(e),this.withinDirectionalEnd=e=>this.reverse_?this.withinStartPost(e):this.withinEndPost(e),this.withinStartPost=e=>{const t=this.index_.compare(this.rangedFilter_.getStartPost(),e);return this.startIsInclusive_?t<=0:t<0},this.withinEndPost=e=>{const t=this.index_.compare(e,this.rangedFilter_.getEndPost());return this.endIsInclusive_?t<=0:t<0},this.rangedFilter_=new Dn(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,s,i,r,n){return this.rangedFilter_.matches(new Jr(t,s))||(s=vn.EMPTY_NODE),e.getImmediateChild(t).equals(s)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,s,i,r,n):this.fullLimitUpdateChild_(e,t,s,r,n)}updateFullNode(e,t,s){let i;if(t.isLeafNode()||t.isEmpty())i=vn.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let e;i=vn.EMPTY_NODE.withIndex(this.index_),e=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let s=0;for(;e.hasNext()&&s<this.limit_;){const t=e.getNext();if(this.withinDirectionalStart(t)){if(!this.withinDirectionalEnd(t))break;i=i.updateImmediateChild(t.name,t.node),s++}}}else{let e;i=t.withIndex(this.index_),i=i.updatePriority(vn.EMPTY_NODE),e=this.reverse_?i.getReverseIterator(this.index_):i.getIterator(this.index_);let s=0;for(;e.hasNext();){const t=e.getNext();s<this.limit_&&this.withinDirectionalStart(t)&&this.withinDirectionalEnd(t)?s++:i=i.updateImmediateChild(t.name,vn.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,s)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,s,i,r){let n;if(this.reverse_){const e=this.index_.getCompare();n=(t,s)=>e(s,t)}else n=this.index_.getCompare();const a=e;Te(a.numChildren()===this.limit_,"");const o=new Jr(t,s),h=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),c=this.rangedFilter_.matches(o);if(a.hasChild(t)){const e=a.getImmediateChild(t);let l=i.getChildAfterChild(this.index_,h,this.reverse_);for(;null!=l&&(l.name===t||a.hasChild(l.name));)l=i.getChildAfterChild(this.index_,l,this.reverse_);const p=null==l?1:n(l,o);if(c&&!s.isEmpty()&&p>=0)return null!=r&&r.trackChildChange(Nn(t,s,e)),a.updateImmediateChild(t,s);{null!=r&&r.trackChildChange(In(t,e));const s=a.updateImmediateChild(t,vn.EMPTY_NODE);return null!=l&&this.rangedFilter_.matches(l)?(null!=r&&r.trackChildChange(Sn(l.name,l.node)),s.updateImmediateChild(l.name,l.node)):s}}return s.isEmpty()?e:c&&n(h,o)>=0?(null!=r&&(r.trackChildChange(In(h.name,h.node)),r.trackChildChange(Sn(t,s))),a.updateImmediateChild(t,s).updateImmediateChild(h.name,vn.EMPTY_NODE)):e}}class Mn{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=fn}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return Te(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return Te(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Ki}hasEnd(){return this.endSet_}getIndexEndValue(){return Te(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return Te(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Gi}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return Te(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===fn}copy(){const e=new Mn;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function Rn(e){const t={};if(e.isDefault())return t;let s;if(e.index_===fn?s="$priority":e.index_===kn?s="$value":e.index_===en?s="$key":(Te(e.index_ instanceof En,"Unrecognized index type!"),s=e.index_.toString()),t.orderBy=Ve(s),e.startSet_){const s=e.startAfterSet_?"startAfter":"startAt";t[s]=Ve(e.indexStartValue_),e.startNameSet_&&(t[s]+=","+Ve(e.indexStartName_))}if(e.endSet_){const s=e.endBeforeSet_?"endBefore":"endAt";t[s]=Ve(e.indexEndValue_),e.endNameSet_&&(t[s]+=","+Ve(e.indexEndName_))}return e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function Fn(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_),t.sin=!e.startAfterSet_),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_),t.ein=!e.endBeforeSet_),e.limitSet_){t.l=e.limit_;let s=e.viewFrom_;""===s&&(s=e.isViewFromLeft()?"l":"r"),t.vf=s}return e.index_!==fn&&(t.i=e.index_.toString()),t}class Bn extends Ar{constructor(e,t,s,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=s,this.appCheckTokenProvider_=i,this.log_=qi("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:(Te(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,s,i){const r=e._path.toString();this.log_("Listen called for "+r+" "+e._queryIdentifier);const n=Bn.getListenId_(e,s),a={};this.listens_[n]=a;const o=Rn(e._queryParams);this.restRequest_(r+".json",o,((e,t)=>{let o=t;if(404===e&&(o=null,e=null),null===e&&this.onDataUpdate_(r,o,!1,s),Ke(this.listens_,n)===a){let t;t=e?401===e?"permission_denied":"rest_error:"+e:"ok",i(t,null)}}))}unlisten(e,t){const s=Bn.getListenId_(e,t);delete this.listens_[s]}get(e){const t=Rn(e._queryParams),s=e._path.toString(),i=new Re;return this.restRequest_(s+".json",t,((e,t)=>{let r=t;404===e&&(r=null,e=null),null===e?(this.onDataUpdate_(s,r,!1,null),i.resolve(r)):i.reject(new Error(r))})),i.promise}refreshAuthToken(e){}restRequest_(e,t={},s){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((([i,r])=>{i&&i.accessToken&&(t.auth=i.accessToken),r&&r.token&&(t.ac=r.token);const n=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+function(e){const t=[];for(const[s,i]of Object.entries(e))Array.isArray(i)?i.forEach((e=>{t.push(encodeURIComponent(s)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(s)+"="+encodeURIComponent(i));return t.length?"&"+t.join("&"):""}(t);this.log_("Sending REST request for "+n);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(s&&4===a.readyState){this.log_("REST Response for "+n+" received. status:",a.status,"response:",a.responseText);let e=null;if(a.status>=200&&a.status<300){try{e=He(a.responseText)}catch(e){Wi("Failed to parse JSON response for "+n+": "+a.responseText)}s(null,e)}else 401!==a.status&&404!==a.status&&Wi("Got unsuccessful REST response for "+n+" Status: "+a.status),s(a.status);s=null}},a.open("GET",n,!0),a.send()}))}}class Un{constructor(){this.rootNode_=vn.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function jn(){return{value:null,children:new Map}}function zn(e,t,s){if(jr(t))e.value=s,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,s);else{const i=Dr(t);e.children.has(i)||e.children.set(i,jn()),zn(e.children.get(i),t=Mr(t),s)}}function qn(e,t,s){null!==e.value?s(t,e.value):function(e,t){e.children.forEach(((e,s)=>{t(s,e)}))}(e,((e,i)=>{qn(i,new Nr(t.toString()+"/"+e),s)}))}class Hn{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&er(this.last_,((e,s)=>{t[e]=t[e]-s})),this.last_=e,t}}class Vn{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Hn(e);const s=1e4+2e4*Math.random();nr(this.reportStats_.bind(this),Math.floor(s))}reportStats_(){const e=this.statsListener_.get(),t={};let s=!1;er(e,((e,i)=>{i>0&&$e(this.statsToReport_,e)&&(t[e]=i,s=!0)})),s&&this.server_.reportStats(t),nr(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var Wn;function $n(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(Wn||(Wn={}));class Kn{constructor(e,t,s){this.path=e,this.affectedTree=t,this.revert=s,this.type=Wn.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(jr(this.path)){if(null!=this.affectedTree.value)return Te(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new Nr(e));return new Kn(Lr(),t,this.revert)}}return Te(Dr(this.path)===e,"operationForChild called for unrelated child."),new Kn(Mr(this.path),this.affectedTree,this.revert)}}class Gn{constructor(e,t){this.source=e,this.path=t,this.type=Wn.LISTEN_COMPLETE}operationForChild(e){return jr(this.path)?new Gn(this.source,Lr()):new Gn(this.source,Mr(this.path))}}class Yn{constructor(e,t,s){this.source=e,this.path=t,this.snap=s,this.type=Wn.OVERWRITE}operationForChild(e){return jr(this.path)?new Yn(this.source,Lr(),this.snap.getImmediateChild(e)):new Yn(this.source,Mr(this.path),this.snap)}}class Jn{constructor(e,t,s){this.source=e,this.path=t,this.children=s,this.type=Wn.MERGE}operationForChild(e){if(jr(this.path)){const t=this.children.subtree(new Nr(e));return t.isEmpty()?null:t.value?new Yn(this.source,Lr(),t.value):new Jn(this.source,Lr(),t)}return Te(Dr(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Jn(this.source,Mr(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class Zn{constructor(e,t,s){this.node_=e,this.fullyInitialized_=t,this.filtered_=s}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(jr(e))return this.isFullyInitialized()&&!this.filtered_;const t=Dr(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class Xn{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function Qn(e,t,s,i,r,n){const a=i.filter((e=>e.type===s));a.sort(((t,s)=>function(e,t,s){if(null==t.childName||null==s.childName)throw Ce("Should only compare child_ events.");const i=new Jr(t.childName,t.snapshotNode),r=new Jr(s.childName,s.snapshotNode);return e.index_.compare(i,r)}(e,t,s))),a.forEach((s=>{const i=function(e,t,s){return"value"===t.type||"child_removed"===t.type||(t.prevName=s.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,s,n);r.forEach((r=>{r.respondsTo(s.type)&&t.push(r.createEvent(i,e.query_))}))}))}function ea(e,t){return{eventCache:e,serverCache:t}}function ta(e,t,s,i){return ea(new Zn(t,s,i),e.serverCache)}function sa(e,t,s,i){return ea(e.eventCache,new Zn(t,s,i))}function ia(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function ra(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}let na;class aa{constructor(e,t=(()=>(na||(na=new rn(Ji)),na))()){this.value=e,this.children=t}static fromObject(e){let t=new aa(null);return er(e,((e,s)=>{t=t.set(new Nr(e),s)})),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:Lr(),value:this.value};if(jr(e))return null;{const s=Dr(e),i=this.children.get(s);if(null!==i){const r=i.findRootMostMatchingPathAndValue(Mr(e),t);return null!=r?{path:Ur(new Nr(s),r.path),value:r.value}:null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,(()=>!0))}subtree(e){if(jr(e))return this;{const t=Dr(e),s=this.children.get(t);return null!==s?s.subtree(Mr(e)):new aa(null)}}set(e,t){if(jr(e))return new aa(t,this.children);{const s=Dr(e),i=(this.children.get(s)||new aa(null)).set(Mr(e),t),r=this.children.insert(s,i);return new aa(this.value,r)}}remove(e){if(jr(e))return this.children.isEmpty()?new aa(null):new aa(null,this.children);{const t=Dr(e),s=this.children.get(t);if(s){const i=s.remove(Mr(e));let r;return r=i.isEmpty()?this.children.remove(t):this.children.insert(t,i),null===this.value&&r.isEmpty()?new aa(null):new aa(this.value,r)}return this}}get(e){if(jr(e))return this.value;{const t=Dr(e),s=this.children.get(t);return s?s.get(Mr(e)):null}}setTree(e,t){if(jr(e))return t;{const s=Dr(e),i=(this.children.get(s)||new aa(null)).setTree(Mr(e),t);let r;return r=i.isEmpty()?this.children.remove(s):this.children.insert(s,i),new aa(this.value,r)}}fold(e){return this.fold_(Lr(),e)}fold_(e,t){const s={};return this.children.inorderTraversal(((i,r)=>{s[i]=r.fold_(Ur(e,i),t)})),t(e,this.value,s)}findOnPath(e,t){return this.findOnPath_(e,Lr(),t)}findOnPath_(e,t,s){const i=!!this.value&&s(t,this.value);if(i)return i;if(jr(e))return null;{const i=Dr(e),r=this.children.get(i);return r?r.findOnPath_(Mr(e),Ur(t,i),s):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Lr(),t)}foreachOnPath_(e,t,s){if(jr(e))return this;{this.value&&s(t,this.value);const i=Dr(e),r=this.children.get(i);return r?r.foreachOnPath_(Mr(e),Ur(t,i),s):new aa(null)}}foreach(e){this.foreach_(Lr(),e)}foreach_(e,t){this.children.inorderTraversal(((s,i)=>{i.foreach_(Ur(e,s),t)})),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal(((t,s)=>{s.value&&e(t,s.value)}))}}class oa{constructor(e){this.writeTree_=e}static empty(){return new oa(new aa(null))}}function ha(e,t,s){if(jr(t))return new oa(new aa(s));{const i=e.writeTree_.findRootMostValueAndPath(t);if(null!=i){const r=i.path;let n=i.value;const a=zr(r,t);return n=n.updateChild(a,s),new oa(e.writeTree_.set(r,n))}{const i=new aa(s),r=e.writeTree_.setTree(t,i);return new oa(r)}}}function ca(e,t,s){let i=e;return er(s,((e,s)=>{i=ha(i,Ur(t,e),s)})),i}function la(e,t){if(jr(t))return oa.empty();{const s=e.writeTree_.setTree(t,new aa(null));return new oa(s)}}function pa(e,t){return null!=ua(e,t)}function ua(e,t){const s=e.writeTree_.findRootMostValueAndPath(t);return null!=s?e.writeTree_.get(s.path).getChild(zr(s.path,t)):null}function da(e){const t=[],s=e.writeTree_.value;return null!=s?s.isLeafNode()||s.forEachChild(fn,((e,s)=>{t.push(new Jr(e,s))})):e.writeTree_.children.inorderTraversal(((e,s)=>{null!=s.value&&t.push(new Jr(e,s.value))})),t}function fa(e,t){if(jr(t))return e;{const s=ua(e,t);return new oa(null!=s?new aa(s):e.writeTree_.subtree(t))}}function ma(e){return e.writeTree_.isEmpty()}function ya(e,t){return ga(Lr(),e.writeTree_,t)}function ga(e,t,s){if(null!=t.value)return s.updateChild(e,t.value);{let i=null;return t.children.inorderTraversal(((t,r)=>{".priority"===t?(Te(null!==r.value,"Priority writes must always be leaf nodes"),i=r.value):s=ga(Ur(e,t),r,s)})),s.getChild(e).isEmpty()||null===i||(s=s.updateChild(Ur(e,".priority"),i)),s}}function ba(e,t){return Sa(t,e)}function wa(e,t){if(e.snap)return Hr(e.path,t);for(const s in e.children)if(e.children.hasOwnProperty(s)&&Hr(Ur(e.path,s),t))return!0;return!1}function _a(e){return e.visible}function xa(e,t,s){let i=oa.empty();for(let r=0;r<e.length;++r){const n=e[r];if(t(n)){const e=n.path;let t;if(n.snap)Hr(s,e)?(t=zr(s,e),i=ha(i,t,n.snap)):Hr(e,s)&&(t=zr(e,s),i=ha(i,Lr(),n.snap.getChild(t)));else{if(!n.children)throw Ce("WriteRecord should have .snap or .children");if(Hr(s,e))t=zr(s,e),i=ca(i,t,n.children);else if(Hr(e,s))if(t=zr(e,s),jr(t))i=ca(i,Lr(),n.children);else{const e=Ke(n.children,Dr(t));if(e){const s=e.getChild(Mr(t));i=ha(i,Lr(),s)}}}}}return i}function va(e,t,s,i,r){if(i||r){const n=fa(e.visibleWrites,t);if(!r&&ma(n))return s;if(r||null!=s||pa(n,Lr())){const n=function(e){return(e.visible||r)&&(!i||!~i.indexOf(e.writeId))&&(Hr(e.path,t)||Hr(t,e.path))};return ya(xa(e.allWrites,n,t),s||vn.EMPTY_NODE)}return null}{const i=ua(e.visibleWrites,t);if(null!=i)return i;{const i=fa(e.visibleWrites,t);return ma(i)?s:null!=s||pa(i,Lr())?ya(i,s||vn.EMPTY_NODE):null}}}function Pa(e,t,s,i){return va(e.writeTree,e.treePath,t,s,i)}function Ta(e,t){return function(e,t,s){let i=vn.EMPTY_NODE;const r=ua(e.visibleWrites,t);if(r)return r.isLeafNode()||r.forEachChild(fn,((e,t)=>{i=i.updateImmediateChild(e,t)})),i;if(s){const r=fa(e.visibleWrites,t);return s.forEachChild(fn,((e,t)=>{const s=ya(fa(r,new Nr(e)),t);i=i.updateImmediateChild(e,s)})),da(r).forEach((e=>{i=i.updateImmediateChild(e.name,e.node)})),i}return da(fa(e.visibleWrites,t)).forEach((e=>{i=i.updateImmediateChild(e.name,e.node)})),i}(e.writeTree,e.treePath,t)}function Ca(e,t,s,i){return function(e,t,s,i,r){Te(i||r,"Either existingEventSnap or existingServerSnap must exist");const n=Ur(t,s);if(pa(e.visibleWrites,n))return null;{const t=fa(e.visibleWrites,n);return ma(t)?r.getChild(s):ya(t,r.getChild(s))}}(e.writeTree,e.treePath,t,s,i)}function Ea(e,t){return function(e,t){return ua(e.visibleWrites,t)}(e.writeTree,Ur(e.treePath,t))}function ka(e,t,s){return function(e,t,s,i){const r=Ur(t,s),n=ua(e.visibleWrites,r);return null!=n?n:i.isCompleteForChild(s)?ya(fa(e.visibleWrites,r),i.getNode().getImmediateChild(s)):null}(e.writeTree,e.treePath,t,s)}function Aa(e,t){return Sa(Ur(e.treePath,t),e.writeTree)}function Sa(e,t){return{treePath:e,writeTree:t}}class Ia{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,s=e.childName;Te("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),Te(".priority"!==s,"Only non-priority child changes can be tracked.");const i=this.changeMap.get(s);if(i){const r=i.type;if("child_added"===t&&"child_removed"===r)this.changeMap.set(s,Nn(s,e.snapshotNode,i.snapshotNode));else if("child_removed"===t&&"child_added"===r)this.changeMap.delete(s);else if("child_removed"===t&&"child_changed"===r)this.changeMap.set(s,In(s,i.oldSnap));else if("child_changed"===t&&"child_added"===r)this.changeMap.set(s,Sn(s,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==r)throw Ce("Illegal combination of changes: "+e+" occurred after "+i);this.changeMap.set(s,Nn(s,e.snapshotNode,i.oldSnap))}}else this.changeMap.set(s,e)}getChanges(){return Array.from(this.changeMap.values())}}const Na=new class{getCompleteChild(e){return null}getChildAfterChild(e,t,s){return null}};class La{constructor(e,t,s=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=s}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const t=null!=this.optCompleteServerCache_?new Zn(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return ka(this.writes_,e,t)}}getChildAfterChild(e,t,s){const i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:ra(this.viewCache_),r=function(e,t,s,i,r,n){return function(e,t,s,i,r,n,a){let o;const h=fa(e.visibleWrites,t),c=ua(h,Lr());if(null!=c)o=c;else{if(null==s)return[];o=ya(h,s)}if(o=o.withIndex(a),o.isEmpty()||o.isLeafNode())return[];{const e=[],t=a.getCompare(),s=n?o.getReverseIteratorFrom(i,a):o.getIteratorFrom(i,a);let h=s.getNext();for(;h&&e.length<r;)0!==t(h,i)&&e.push(h),h=s.getNext();return e}}(e.writeTree,e.treePath,t,s,i,r,n)}(this.writes_,i,t,1,s,e);return 0===r.length?null:r[0]}}function Da(e,t,s,i,r,n){const a=t.eventCache;if(null!=Ea(i,s))return t;{let o,h;if(jr(s))if(Te(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const s=ra(t),r=Ta(i,s instanceof vn?s:vn.EMPTY_NODE);o=e.filter.updateFullNode(t.eventCache.getNode(),r,n)}else{const s=Pa(i,ra(t));o=e.filter.updateFullNode(t.eventCache.getNode(),s,n)}else{const c=Dr(s);if(".priority"===c){Te(1===Or(s),"Can't have a priority with additional path components");const r=a.getNode();h=t.serverCache.getNode();const n=Ca(i,s,r,h);o=null!=n?e.filter.updatePriority(r,n):a.getNode()}else{const l=Mr(s);let p;if(a.isCompleteForChild(c)){h=t.serverCache.getNode();const e=Ca(i,s,a.getNode(),h);p=null!=e?a.getNode().getImmediateChild(c).updateChild(l,e):a.getNode().getImmediateChild(c)}else p=ka(i,c,t.serverCache);o=null!=p?e.filter.updateChild(a.getNode(),c,p,l,r,n):a.getNode()}}return ta(t,o,a.isFullyInitialized()||jr(s),e.filter.filtersNodes())}}function Oa(e,t,s,i,r,n,a,o){const h=t.serverCache;let c;const l=a?e.filter:e.filter.getIndexedFilter();if(jr(s))c=l.updateFullNode(h.getNode(),i,null);else if(l.filtersNodes()&&!h.isFiltered()){const e=h.getNode().updateChild(s,i);c=l.updateFullNode(h.getNode(),e,null)}else{const e=Dr(s);if(!h.isCompleteForPath(s)&&Or(s)>1)return t;const r=Mr(s),n=h.getNode().getImmediateChild(e).updateChild(r,i);c=".priority"===e?l.updatePriority(h.getNode(),n):l.updateChild(h.getNode(),e,n,r,Na,null)}const p=sa(t,c,h.isFullyInitialized()||jr(s),l.filtersNodes());return Da(e,p,s,r,new La(r,p,n),o)}function Ma(e,t,s,i,r,n,a){const o=t.eventCache;let h,c;const l=new La(r,t,n);if(jr(s))c=e.filter.updateFullNode(t.eventCache.getNode(),i,a),h=ta(t,c,!0,e.filter.filtersNodes());else{const r=Dr(s);if(".priority"===r)c=e.filter.updatePriority(t.eventCache.getNode(),i),h=ta(t,c,o.isFullyInitialized(),o.isFiltered());else{const n=Mr(s),c=o.getNode().getImmediateChild(r);let p;if(jr(n))p=i;else{const e=l.getCompleteChild(r);p=null!=e?".priority"===Rr(n)&&e.getChild(Br(n)).isEmpty()?e:e.updateChild(n,i):vn.EMPTY_NODE}h=c.equals(p)?t:ta(t,e.filter.updateChild(o.getNode(),r,p,n,l,a),o.isFullyInitialized(),e.filter.filtersNodes())}}return h}function Ra(e,t){return e.eventCache.isCompleteForChild(t)}function Fa(e,t,s){return s.foreach(((e,s)=>{t=t.updateChild(e,s)})),t}function Ba(e,t,s,i,r,n,a,o){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let h,c=t;h=jr(s)?i:new aa(null).setTree(s,i);const l=t.serverCache.getNode();return h.children.inorderTraversal(((s,i)=>{if(l.hasChild(s)){const h=Fa(0,t.serverCache.getNode().getImmediateChild(s),i);c=Oa(e,c,new Nr(s),h,r,n,a,o)}})),h.children.inorderTraversal(((s,i)=>{const h=!t.serverCache.isCompleteForChild(s)&&null===i.value;if(!l.hasChild(s)&&!h){const h=Fa(0,t.serverCache.getNode().getImmediateChild(s),i);c=Oa(e,c,new Nr(s),h,r,n,a,o)}})),c}class Ua{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const s=this.query_._queryParams,i=new Ln(s.getIndex()),r=(n=s).loadsAllData()?new Ln(n.getIndex()):n.hasLimit()?new On(n):new Dn(n);var n;this.processor_=function(e){return{filter:e}}(r);const a=t.serverCache,o=t.eventCache,h=i.updateFullNode(vn.EMPTY_NODE,a.getNode(),null),c=r.updateFullNode(vn.EMPTY_NODE,o.getNode(),null),l=new Zn(h,a.isFullyInitialized(),i.filtersNodes()),p=new Zn(c,o.isFullyInitialized(),r.filtersNodes());this.viewCache_=ea(p,l),this.eventGenerator_=new Xn(this.query_)}get query(){return this.query_}}function ja(e,t){const s=ra(e.viewCache_);return s&&(e.query._queryParams.loadsAllData()||!jr(t)&&!s.getImmediateChild(Dr(t)).isEmpty())?s.getChild(t):null}function za(e){return 0===e.eventRegistrations_.length}function qa(e,t,s){const i=[];if(s){Te(null==t,"A cancel should cancel all event registrations.");const r=e.query._path;e.eventRegistrations_.forEach((e=>{const t=e.createCancelEvent(s,r);t&&i.push(t)}))}if(t){let s=[];for(let i=0;i<e.eventRegistrations_.length;++i){const r=e.eventRegistrations_[i];if(r.matches(t)){if(t.hasAnyCallback()){s=s.concat(e.eventRegistrations_.slice(i+1));break}}else s.push(r)}e.eventRegistrations_=s}else e.eventRegistrations_=[];return i}function Ha(e,t,s,i){t.type===Wn.MERGE&&null!==t.source.queryId&&(Te(ra(e.viewCache_),"We should always have a full cache before handling merges"),Te(ia(e.viewCache_),"Missing event cache, even though we have a server cache"));const r=e.viewCache_,n=function(e,t,s,i,r){const n=new Ia;let a,o;if(s.type===Wn.OVERWRITE){const h=s;h.source.fromUser?a=Ma(e,t,h.path,h.snap,i,r,n):(Te(h.source.fromServer,"Unknown source."),o=h.source.tagged||t.serverCache.isFiltered()&&!jr(h.path),a=Oa(e,t,h.path,h.snap,i,r,o,n))}else if(s.type===Wn.MERGE){const h=s;h.source.fromUser?a=function(e,t,s,i,r,n,a){let o=t;return i.foreach(((i,h)=>{const c=Ur(s,i);Ra(t,Dr(c))&&(o=Ma(e,o,c,h,r,n,a))})),i.foreach(((i,h)=>{const c=Ur(s,i);Ra(t,Dr(c))||(o=Ma(e,o,c,h,r,n,a))})),o}(e,t,h.path,h.children,i,r,n):(Te(h.source.fromServer,"Unknown source."),o=h.source.tagged||t.serverCache.isFiltered(),a=Ba(e,t,h.path,h.children,i,r,o,n))}else if(s.type===Wn.ACK_USER_WRITE){const o=s;a=o.revert?function(e,t,s,i,r,n){let a;if(null!=Ea(i,s))return t;{const o=new La(i,t,r),h=t.eventCache.getNode();let c;if(jr(s)||".priority"===Dr(s)){let s;if(t.serverCache.isFullyInitialized())s=Pa(i,ra(t));else{const e=t.serverCache.getNode();Te(e instanceof vn,"serverChildren would be complete if leaf node"),s=Ta(i,e)}c=e.filter.updateFullNode(h,s,n)}else{const r=Dr(s);let l=ka(i,r,t.serverCache);null==l&&t.serverCache.isCompleteForChild(r)&&(l=h.getImmediateChild(r)),c=null!=l?e.filter.updateChild(h,r,l,Mr(s),o,n):t.eventCache.getNode().hasChild(r)?e.filter.updateChild(h,r,vn.EMPTY_NODE,Mr(s),o,n):h,c.isEmpty()&&t.serverCache.isFullyInitialized()&&(a=Pa(i,ra(t)),a.isLeafNode()&&(c=e.filter.updateFullNode(c,a,n)))}return a=t.serverCache.isFullyInitialized()||null!=Ea(i,Lr()),ta(t,c,a,e.filter.filtersNodes())}}(e,t,o.path,i,r,n):function(e,t,s,i,r,n,a){if(null!=Ea(r,s))return t;const o=t.serverCache.isFiltered(),h=t.serverCache;if(null!=i.value){if(jr(s)&&h.isFullyInitialized()||h.isCompleteForPath(s))return Oa(e,t,s,h.getNode().getChild(s),r,n,o,a);if(jr(s)){let i=new aa(null);return h.getNode().forEachChild(en,((e,t)=>{i=i.set(new Nr(e),t)})),Ba(e,t,s,i,r,n,o,a)}return t}{let c=new aa(null);return i.foreach(((e,t)=>{const i=Ur(s,e);h.isCompleteForPath(i)&&(c=c.set(e,h.getNode().getChild(i)))})),Ba(e,t,s,c,r,n,o,a)}}(e,t,o.path,o.affectedTree,i,r,n)}else{if(s.type!==Wn.LISTEN_COMPLETE)throw Ce("Unknown operation type: "+s.type);a=function(e,t,s,i,r){const n=t.serverCache;return Da(e,sa(t,n.getNode(),n.isFullyInitialized()||jr(s),n.isFiltered()),s,i,Na,r)}(e,t,s.path,i,n)}const h=n.getChanges();return function(e,t,s){const i=t.eventCache;if(i.isFullyInitialized()){const r=i.getNode().isLeafNode()||i.getNode().isEmpty(),n=ia(e);(s.length>0||!e.eventCache.isFullyInitialized()||r&&!i.getNode().equals(n)||!i.getNode().getPriority().equals(n.getPriority()))&&s.push(An(ia(t)))}}(t,a,h),{viewCache:a,changes:h}}(e.processor_,r,t,s,i);var a,o;return a=e.processor_,o=n.viewCache,Te(o.eventCache.getNode().isIndexed(a.filter.getIndex()),"Event snap not indexed"),Te(o.serverCache.getNode().isIndexed(a.filter.getIndex()),"Server snap not indexed"),Te(n.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=n.viewCache,Va(e,n.changes,n.viewCache.eventCache.getNode(),null)}function Va(e,t,s,i){const r=i?[i]:e.eventRegistrations_;return function(e,t,s,i){const r=[],n=[];return t.forEach((t=>{var s;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&n.push((s=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:s}))})),Qn(e,r,"child_removed",t,i,s),Qn(e,r,"child_added",t,i,s),Qn(e,r,"child_moved",n,i,s),Qn(e,r,"child_changed",t,i,s),Qn(e,r,"value",t,i,s),r}(e.eventGenerator_,t,s,r)}let Wa,$a;class Ka{constructor(){this.views=new Map}}function Ga(e,t,s,i){const r=t.source.queryId;if(null!==r){const n=e.views.get(r);return Te(null!=n,"SyncTree gave us an op for an invalid query."),Ha(n,t,s,i)}{let r=[];for(const n of e.views.values())r=r.concat(Ha(n,t,s,i));return r}}function Ya(e,t,s,i,r){const n=t._queryIdentifier,a=e.views.get(n);if(!a){let e=Pa(s,r?i:null),n=!1;e?n=!0:i instanceof vn?(e=Ta(s,i),n=!1):(e=vn.EMPTY_NODE,n=!1);const a=ea(new Zn(e,n,!1),new Zn(i,r,!1));return new Ua(t,a)}return a}function Ja(e){const t=[];for(const s of e.views.values())s.query._queryParams.loadsAllData()||t.push(s);return t}function Za(e,t){let s=null;for(const i of e.views.values())s=s||ja(i,t);return s}function Xa(e,t){if(t._queryParams.loadsAllData())return to(e);{const s=t._queryIdentifier;return e.views.get(s)}}function Qa(e,t){return null!=Xa(e,t)}function eo(e){return null!=to(e)}function to(e){for(const t of e.views.values())if(t.query._queryParams.loadsAllData())return t;return null}let so=1;class io{constructor(e){this.listenProvider_=e,this.syncPointTree_=new aa(null),this.pendingWriteTree_={visibleWrites:oa.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function ro(e,t,s,i,r){return function(e,t,s,i,r){Te(i>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),e.allWrites.push({path:t,snap:s,writeId:i,visible:r}),r&&(e.visibleWrites=ha(e.visibleWrites,t,s)),e.lastWriteId=i}(e.pendingWriteTree_,t,s,i,r),r?po(e,new Yn({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,s)):[]}function no(e,t,s=!1){const i=function(e,t){for(let s=0;s<e.allWrites.length;s++){const i=e.allWrites[s];if(i.writeId===t)return i}return null}(e.pendingWriteTree_,t);if(function(e,t){const s=e.allWrites.findIndex((e=>e.writeId===t));Te(s>=0,"removeWrite called with nonexistent writeId.");const i=e.allWrites[s];e.allWrites.splice(s,1);let r=i.visible,n=!1,a=e.allWrites.length-1;for(;r&&a>=0;){const t=e.allWrites[a];t.visible&&(a>=s&&wa(t,i.path)?r=!1:Hr(i.path,t.path)&&(n=!0)),a--}return!!r&&(n?(function(e){e.visibleWrites=xa(e.allWrites,_a,Lr()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0):(i.snap?e.visibleWrites=la(e.visibleWrites,i.path):er(i.children,(t=>{e.visibleWrites=la(e.visibleWrites,Ur(i.path,t))})),!0))}(e.pendingWriteTree_,t)){let t=new aa(null);return null!=i.snap?t=t.set(Lr(),!0):er(i.children,(e=>{t=t.set(new Nr(e),!0)})),po(e,new Kn(i.path,t,s))}return[]}function ao(e,t,s){return po(e,new Yn({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,s))}function oo(e,t,s,i,r=!1){const n=t._path,a=e.syncPointTree_.get(n);let o=[];if(a&&("default"===t._queryIdentifier||Qa(a,t))){const h=function(e,t,s,i){const r=t._queryIdentifier,n=[];let a=[];const o=eo(e);if("default"===r)for(const[t,r]of e.views.entries())a=a.concat(qa(r,s,i)),za(r)&&(e.views.delete(t),r.query._queryParams.loadsAllData()||n.push(r.query));else{const t=e.views.get(r);t&&(a=a.concat(qa(t,s,i)),za(t)&&(e.views.delete(r),t.query._queryParams.loadsAllData()||n.push(t.query)))}return o&&!eo(e)&&n.push(new(Te(Wa,"Reference.ts has not been loaded"),Wa)(t._repo,t._path)),{removed:n,events:a}}(a,t,s,i);0===a.views.size&&(e.syncPointTree_=e.syncPointTree_.remove(n));const c=h.removed;if(o=h.events,!r){const s=-1!==c.findIndex((e=>e._queryParams.loadsAllData())),r=e.syncPointTree_.findOnPath(n,((e,t)=>eo(t)));if(s&&!r){const t=e.syncPointTree_.subtree(n);if(!t.isEmpty()){const s=function(e){return e.fold(((e,t,s)=>{if(t&&eo(t))return[to(t)];{let e=[];return t&&(e=Ja(t)),er(s,((t,s)=>{e=e.concat(s)})),e}}))}(t);for(let t=0;t<s.length;++t){const i=s[t],r=i.query,n=mo(e,i);e.listenProvider_.startListening(xo(r),yo(e,r),n.hashFn,n.onComplete)}}}if(!r&&c.length>0&&!i)if(s){const s=null;e.listenProvider_.stopListening(xo(t),s)}else c.forEach((t=>{const s=e.queryToTagMap.get(go(t));e.listenProvider_.stopListening(xo(t),s)}))}!function(e,t){for(let s=0;s<t.length;++s){const i=t[s];if(!i._queryParams.loadsAllData()){const t=go(i),s=e.queryToTagMap.get(t);e.queryToTagMap.delete(t),e.tagToQueryMap.delete(s)}}}(e,c)}return o}function ho(e,t,s,i){const r=bo(e,i);if(null!=r){const i=wo(r),n=i.path,a=i.queryId,o=zr(n,t);return _o(e,n,new Yn($n(a),o,s))}return[]}function co(e,t,s,i=!1){const r=t._path;let n=null,a=!1;e.syncPointTree_.foreachOnPath(r,((e,t)=>{const s=zr(e,r);n=n||Za(t,s),a=a||eo(t)}));let o,h=e.syncPointTree_.get(r);h?(a=a||eo(h),n=n||Za(h,Lr())):(h=new Ka,e.syncPointTree_=e.syncPointTree_.set(r,h)),null!=n?o=!0:(o=!1,n=vn.EMPTY_NODE,e.syncPointTree_.subtree(r).foreachChild(((e,t)=>{const s=Za(t,Lr());s&&(n=n.updateImmediateChild(e,s))})));const c=Qa(h,t);if(!c&&!t._queryParams.loadsAllData()){const s=go(t);Te(!e.queryToTagMap.has(s),"View does not exist, but we have a tag");const i=so++;e.queryToTagMap.set(s,i),e.tagToQueryMap.set(i,s)}let l=function(e,t,s,i,r,n){const a=Ya(e,t,i,r,n);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,a),function(e,t){e.eventRegistrations_.push(t)}(a,s),function(e,t){const s=e.viewCache_.eventCache,i=[];return s.getNode().isLeafNode()||s.getNode().forEachChild(fn,((e,t)=>{i.push(Sn(e,t))})),s.isFullyInitialized()&&i.push(An(s.getNode())),Va(e,i,s.getNode(),t)}(a,s)}(h,t,s,ba(e.pendingWriteTree_,r),n,o);if(!c&&!a&&!i){const s=Xa(h,t);l=l.concat(function(e,t,s){const i=t._path,r=yo(e,t),n=mo(e,s),a=e.listenProvider_.startListening(xo(t),r,n.hashFn,n.onComplete),o=e.syncPointTree_.subtree(i);if(r)Te(!eo(o.value),"If we're adding a query, it shouldn't be shadowed");else{const t=o.fold(((e,t,s)=>{if(!jr(e)&&t&&eo(t))return[to(t).query];{let e=[];return t&&(e=e.concat(Ja(t).map((e=>e.query)))),er(s,((t,s)=>{e=e.concat(s)})),e}}));for(let s=0;s<t.length;++s){const i=t[s];e.listenProvider_.stopListening(xo(i),yo(e,i))}}return a}(e,t,s))}return l}function lo(e,t,s){const i=e.pendingWriteTree_,r=e.syncPointTree_.findOnPath(t,((e,s)=>{const i=Za(s,zr(e,t));if(i)return i}));return va(i,t,r,s,!0)}function po(e,t){return uo(t,e.syncPointTree_,null,ba(e.pendingWriteTree_,Lr()))}function uo(e,t,s,i){if(jr(e.path))return fo(e,t,s,i);{const r=t.get(Lr());null==s&&null!=r&&(s=Za(r,Lr()));let n=[];const a=Dr(e.path),o=e.operationForChild(a),h=t.children.get(a);if(h&&o){const e=s?s.getImmediateChild(a):null,t=Aa(i,a);n=n.concat(uo(o,h,e,t))}return r&&(n=n.concat(Ga(r,e,i,s))),n}}function fo(e,t,s,i){const r=t.get(Lr());null==s&&null!=r&&(s=Za(r,Lr()));let n=[];return t.children.inorderTraversal(((t,r)=>{const a=s?s.getImmediateChild(t):null,o=Aa(i,t),h=e.operationForChild(t);h&&(n=n.concat(fo(h,r,a,o)))})),r&&(n=n.concat(Ga(r,e,i,s))),n}function mo(e,t){const s=t.query,i=yo(e,s);return{hashFn:()=>{const e=function(e){return e.viewCache_.serverCache.getNode()}(t)||vn.EMPTY_NODE;return e.hash()},onComplete:t=>{if("ok"===t)return i?function(e,t,s){const i=bo(e,s);if(i){const s=wo(i),r=s.path,n=s.queryId,a=zr(r,t);return _o(e,r,new Gn($n(n),a))}return[]}(e,s._path,i):function(e,t){return po(e,new Gn({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t))}(e,s._path);{const i=function(e,t){let s="Unknown Error";"too_big"===e?s="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?s="Client doesn't have permission to access the desired data.":"unavailable"===e&&(s="The service is unavailable");const i=new Error(e+" at "+t._path.toString()+": "+s);return i.code=e.toUpperCase(),i}(t,s);return oo(e,s,null,i)}}}}function yo(e,t){const s=go(t);return e.queryToTagMap.get(s)}function go(e){return e._path.toString()+"$"+e._queryIdentifier}function bo(e,t){return e.tagToQueryMap.get(t)}function wo(e){const t=e.indexOf("$");return Te(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new Nr(e.substr(0,t))}}function _o(e,t,s){const i=e.syncPointTree_.get(t);return Te(i,"Missing sync point for query tag that we're tracking"),Ga(i,s,ba(e.pendingWriteTree_,t),null)}function xo(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(Te($a,"Reference.ts has not been loaded"),$a)(e._repo,e._path):e}class vo{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new vo(t)}node(){return this.node_}}class Po{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Ur(this.path_,e);return new Po(this.syncTree_,t)}node(){return lo(this.syncTree_,this.path_)}}const To=function(e){return(e=e||{}).timestamp=e.timestamp||(new Date).getTime(),e},Co=function(e,t,s){return e&&"object"==typeof e?(Te(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?Eo(e[".sv"],t,s):"object"==typeof e[".sv"]?ko(e[".sv"],t):void Te(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},Eo=function(e,t,s){if("timestamp"===e)return s.timestamp;Te(!1,"Unexpected server value: "+e)},ko=function(e,t,s){e.hasOwnProperty("increment")||Te(!1,"Unexpected server value: "+JSON.stringify(e,null,2));const i=e.increment;"number"!=typeof i&&Te(!1,"Unexpected increment value: "+i);const r=t.node();if(Te(null!=r,"Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return i;const n=r.getValue();return"number"!=typeof n?i:n+i},Ao=function(e,t,s,i){return Io(t,new Po(s,e),i)},So=function(e,t,s){return Io(e,new vo(t),s)};function Io(e,t,s){const i=e.getPriority().val(),r=Co(i,t.getImmediateChild(".priority"),s);let n;if(e.isLeafNode()){const i=e,n=Co(i.getValue(),t,s);return n!==i.getValue()||r!==i.getPriority().val()?new dn(n,Cn(r)):e}{const i=e;return n=i,r!==i.getPriority().val()&&(n=n.updatePriority(new dn(r))),i.forEachChild(fn,((e,i)=>{const r=Io(i,t.getImmediateChild(e),s);r!==i&&(n=n.updateImmediateChild(e,r))})),n}}class No{constructor(e="",t=null,s={children:{},childCount:0}){this.name=e,this.parent=t,this.node=s}}function Lo(e,t){let s=t instanceof Nr?t:new Nr(t),i=e,r=Dr(s);for(;null!==r;){const e=Ke(i.node.children,r)||{children:{},childCount:0};i=new No(r,i,e),s=Mr(s),r=Dr(s)}return i}function Do(e){return e.node.value}function Oo(e,t){e.node.value=t,Uo(e)}function Mo(e){return e.node.childCount>0}function Ro(e,t){er(e.node.children,((s,i)=>{t(new No(s,e,i))}))}function Fo(e,t,s,i){s&&!i&&t(e),Ro(e,(e=>{Fo(e,t,!0,i)})),s&&i&&t(e)}function Bo(e){return new Nr(null===e.parent?e.name:Bo(e.parent)+"/"+e.name)}function Uo(e){null!==e.parent&&function(e,t,s){const i=function(e){return void 0===Do(e)&&!Mo(e)}(s),r=$e(e.node.children,t);i&&r?(delete e.node.children[t],e.node.childCount--,Uo(e)):i||r||(e.node.children[t]=s.node,e.node.childCount++,Uo(e))}(e.parent,e.name,e)}const jo=/[\[\].#$\/\u0000-\u001F\u007F]/,zo=/[\[\].#$\u0000-\u001F\u007F]/,qo=10485760,Ho=function(e){return"string"==typeof e&&0!==e.length&&!jo.test(e)},Vo=function(e){return"string"==typeof e&&0!==e.length&&!zo.test(e)},Wo=function(e,t,s){const i=s instanceof Nr?new Vr(s,e):s;if(void 0===t)throw new Error(e+"contains undefined "+$r(i));if("function"==typeof t)throw new Error(e+"contains a function "+$r(i)+" with contents = "+t.toString());if($i(t))throw new Error(e+"contains "+t.toString()+" "+$r(i));if("string"==typeof t&&t.length>qo/3&&et(t)>qo)throw new Error(e+"contains a string greater than "+qo+" utf8 bytes "+$r(i)+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){let s=!1,r=!1;if(er(t,((t,n)=>{if(".value"===t)s=!0;else if(".priority"!==t&&".sv"!==t&&(r=!0,!Ho(t)))throw new Error(e+" contains an invalid key ("+t+") "+$r(i)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');!function(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=et(t),Wr(e)}(i,t),Wo(e,n,i),function(e){const t=e.parts_.pop();e.byteLength_-=et(t),e.parts_.length>0&&(e.byteLength_-=1)}(i)})),s&&r)throw new Error(e+' contains ".value" child '+$r(i)+" in addition to actual children.")}},$o=function(e,t,s,i){if(!(i&&void 0===s||Vo(s)))throw new Error(Qe(e,t)+'was an invalid path = "'+s+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Ko=function(e,t,s,i){s&&(s=s.replace(/^\/*\.info(\/|$)/,"/")),$o(e,t,s,i)};class Go{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Yo(e,t){let s=null;for(let i=0;i<t.length;i++){const r=t[i],n=r.getPath();null===s||qr(n,s.path)||(e.eventLists_.push(s),s=null),null===s&&(s={events:[],path:n}),s.events.push(r)}s&&e.eventLists_.push(s)}function Jo(e,t,s){Yo(e,s),function(e,t){e.recursionDepth_++;let s=!0;for(let i=0;i<e.eventLists_.length;i++){const r=e.eventLists_[i];r&&(t(r.path)?(Zo(e.eventLists_[i]),e.eventLists_[i]=null):s=!1)}s&&(e.eventLists_=[]),e.recursionDepth_--}(e,(e=>Hr(e,t)||Hr(t,e)))}function Zo(e){for(let t=0;t<e.events.length;t++){const s=e.events[t];if(null!==s){e.events[t]=null;const i=s.getEventRunner();Ui&&zi("event: "+s.toString()),rr(i)}}}const Xo="repo_interrupt",Qo=25;class eh{constructor(e,t,s,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=s,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Go,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=jn(),this.transactionQueueTree_=new No,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function th(e,t,s){if(e.stats_=wr(e.repoInfo_),e.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new Bn(e.repoInfo_,((t,s,i,r)=>{rh(e,t,s,i,r)}),e.authTokenProvider_,e.appCheckProvider_),setTimeout((()=>nh(e,!0)),0);else{if(null!=s){if("object"!=typeof s)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Ve(s)}catch(e){throw new Error("Invalid authOverride provided: "+e)}}e.persistentConnection_=new Yr(e.repoInfo_,t,((t,s,i,r)=>{rh(e,t,s,i,r)}),(t=>{nh(e,t)}),(t=>{!function(e,t){er(t,((t,s)=>{ah(e,t,s)}))}(e,t)}),e.authTokenProvider_,e.appCheckProvider_,s),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener((t=>{e.server_.refreshAuthToken(t)})),e.appCheckProvider_.addTokenChangeListener((t=>{e.server_.refreshAppCheckToken(t.token)})),e.statsReporter_=function(t,s){const i=t.toString();return br[i]||(br[i]=new Vn(e.stats_,e.server_)),br[i]}(e.repoInfo_),e.infoData_=new Un,e.infoSyncTree_=new io({startListening:(t,s,i,r)=>{let n=[];const a=e.infoData_.getNode(t._path);return a.isEmpty()||(n=ao(e.infoSyncTree_,t._path,a),setTimeout((()=>{r("ok")}),0)),n},stopListening:()=>{}}),ah(e,"connected",!1),e.serverSyncTree_=new io({startListening:(t,s,i,r)=>(e.server_.listen(t,i,s,((s,i)=>{const n=r(s,i);Jo(e.eventQueue_,t._path,n)})),[]),stopListening:(t,s)=>{e.server_.unlisten(t,s)}})}function sh(e){const t=e.infoData_.getNode(new Nr(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function ih(e){return To({timestamp:sh(e)})}function rh(e,t,s,i,r){e.dataUpdateCount++;const n=new Nr(t);s=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,s):s;let a=[];if(r)if(i){const t=Ye(s,(e=>Cn(e)));a=function(e,t,s,i){const r=bo(e,i);if(r){const i=wo(r),n=i.path,a=i.queryId,o=zr(n,t),h=aa.fromObject(s);return _o(e,n,new Jn($n(a),o,h))}return[]}(e.serverSyncTree_,n,t,r)}else{const t=Cn(s);a=ho(e.serverSyncTree_,n,t,r)}else if(i){const t=Ye(s,(e=>Cn(e)));a=function(e,t,s){const i=aa.fromObject(s);return po(e,new Jn({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,i))}(e.serverSyncTree_,n,t)}else{const t=Cn(s);a=ao(e.serverSyncTree_,n,t)}let o=n;a.length>0&&(o=dh(e,n)),Jo(e.eventQueue_,o,a)}function nh(e,t){ah(e,"connected",t),!1===t&&function(e){lh(e,"onDisconnectEvents");const t=ih(e),s=jn();qn(e.onDisconnect_,Lr(),((i,r)=>{const n=Ao(i,r,e.serverSyncTree_,t);zn(s,i,n)}));let i=[];qn(s,Lr(),((t,s)=>{i=i.concat(ao(e.serverSyncTree_,t,s));const r=bh(e,t);dh(e,r)})),e.onDisconnect_=jn(),Jo(e.eventQueue_,Lr(),i)}(e)}function ah(e,t,s){const i=new Nr("/.info/"+t),r=Cn(s);e.infoData_.updateSnapshot(i,r);const n=ao(e.infoSyncTree_,i,r);Jo(e.eventQueue_,i,n)}function oh(e){return e.nextWriteId_++}function hh(e,t,s,i,r){lh(e,"set",{path:t.toString(),value:s,priority:i});const n=ih(e),a=Cn(s,i),o=lo(e.serverSyncTree_,t),h=So(a,o,n),c=oh(e),l=ro(e.serverSyncTree_,t,h,c,!0);Yo(e.eventQueue_,l),e.server_.put(t.toString(),a.val(!0),((s,i)=>{const n="ok"===s;n||Wi("set at "+t+" failed: "+s);const a=no(e.serverSyncTree_,c,!n);Jo(e.eventQueue_,t,a),function(e,t,s,i){t&&rr((()=>{if("ok"===s)t(null);else{const e=(s||"error").toUpperCase();let r=e;i&&(r+=": "+i);const n=new Error(r);n.code=e,t(n)}}))}(0,r,s,i)}));const p=bh(e,t);dh(e,p),Jo(e.eventQueue_,p,[])}function ch(e){e.persistentConnection_&&e.persistentConnection_.interrupt(Xo)}function lh(e,...t){let s="";e.persistentConnection_&&(s=e.persistentConnection_.id+":"),zi(s,...t)}function ph(e,t,s){return lo(e.serverSyncTree_,t,s)||vn.EMPTY_NODE}function uh(e,t=e.transactionQueueTree_){if(t||gh(e,t),Do(t)){const s=mh(e,t);Te(s.length>0,"Sending zero length transaction queue"),s.every((e=>0===e.status))&&function(e,t,s){const i=s.map((e=>e.currentWriteId)),r=ph(e,t,i);let n=r;const a=r.hash();for(let e=0;e<s.length;e++){const i=s[e];Te(0===i.status,"tryToSendTransactionQueue_: items in queue should all be run."),i.status=1,i.retryCount++;const r=zr(t,i.path);n=n.updateChild(r,i.currentOutputSnapshotRaw)}const o=n.val(!0),h=t;e.server_.put(h.toString(),o,(i=>{lh(e,"transaction put response",{path:h.toString(),status:i});let r=[];if("ok"===i){const i=[];for(let t=0;t<s.length;t++)s[t].status=2,r=r.concat(no(e.serverSyncTree_,s[t].currentWriteId)),s[t].onComplete&&i.push((()=>s[t].onComplete(null,!0,s[t].currentOutputSnapshotResolved))),s[t].unwatcher();gh(e,Lo(e.transactionQueueTree_,t)),uh(e,e.transactionQueueTree_),Jo(e.eventQueue_,t,r);for(let e=0;e<i.length;e++)rr(i[e])}else{if("datastale"===i)for(let e=0;e<s.length;e++)3===s[e].status?s[e].status=4:s[e].status=0;else{Wi("transaction at "+h.toString()+" failed: "+i);for(let e=0;e<s.length;e++)s[e].status=4,s[e].abortReason=i}dh(e,t)}}),a)}(e,Bo(t),s)}else Mo(t)&&Ro(t,(t=>{uh(e,t)}))}function dh(e,t){const s=fh(e,t),i=Bo(s);return function(e,t,s){if(0===t.length)return;const i=[];let r=[];const n=t.filter((e=>0===e.status)).map((e=>e.currentWriteId));for(let o=0;o<t.length;o++){const h=t[o],c=zr(s,h.path);let l,p=!1;if(Te(null!==c,"rerunTransactionsUnderNode_: relativePath should not be null."),4===h.status)p=!0,l=h.abortReason,r=r.concat(no(e.serverSyncTree_,h.currentWriteId,!0));else if(0===h.status)if(h.retryCount>=Qo)p=!0,l="maxretry",r=r.concat(no(e.serverSyncTree_,h.currentWriteId,!0));else{const s=ph(e,h.path,n);h.currentInputSnapshot=s;const i=t[o].update(s.val());if(void 0!==i){Wo("transaction failed: Data returned ",i,h.path);let t=Cn(i);"object"==typeof i&&null!=i&&$e(i,".priority")||(t=t.updatePriority(s.getPriority()));const a=h.currentWriteId,o=ih(e),c=So(t,s,o);h.currentOutputSnapshotRaw=t,h.currentOutputSnapshotResolved=c,h.currentWriteId=oh(e),n.splice(n.indexOf(a),1),r=r.concat(ro(e.serverSyncTree_,h.path,c,h.currentWriteId,h.applyLocally)),r=r.concat(no(e.serverSyncTree_,a,!0))}else p=!0,l="nodata",r=r.concat(no(e.serverSyncTree_,h.currentWriteId,!0))}Jo(e.eventQueue_,s,r),r=[],p&&(t[o].status=2,a=t[o].unwatcher,setTimeout(a,Math.floor(0)),t[o].onComplete&&("nodata"===l?i.push((()=>t[o].onComplete(null,!1,t[o].currentInputSnapshot))):i.push((()=>t[o].onComplete(new Error(l),!1,null)))))}var a;gh(e,e.transactionQueueTree_);for(let e=0;e<i.length;e++)rr(i[e]);uh(e,e.transactionQueueTree_)}(e,mh(e,s),i),i}function fh(e,t){let s,i=e.transactionQueueTree_;for(s=Dr(t);null!==s&&void 0===Do(i);)i=Lo(i,s),s=Dr(t=Mr(t));return i}function mh(e,t){const s=[];return yh(e,t,s),s.sort(((e,t)=>e.order-t.order)),s}function yh(e,t,s){const i=Do(t);if(i)for(let e=0;e<i.length;e++)s.push(i[e]);Ro(t,(t=>{yh(e,t,s)}))}function gh(e,t){const s=Do(t);if(s){let e=0;for(let t=0;t<s.length;t++)2!==s[t].status&&(s[e]=s[t],e++);s.length=e,Oo(t,s.length>0?s:void 0)}Ro(t,(t=>{gh(e,t)}))}function bh(e,t){const s=Bo(fh(e,t)),i=Lo(e.transactionQueueTree_,t);return function(e,t,s){let i=e.parent;for(;null!==i;){if(t(i))return!0;i=i.parent}}(i,(t=>{wh(e,t)})),wh(e,i),Fo(i,(t=>{wh(e,t)})),s}function wh(e,t){const s=Do(t);if(s){const i=[];let r=[],n=-1;for(let t=0;t<s.length;t++)3===s[t].status||(1===s[t].status?(Te(n===t-1,"All SENT items should be at beginning of queue."),n=t,s[t].status=3,s[t].abortReason="set"):(Te(0===s[t].status,"Unexpected transaction status in abort"),s[t].unwatcher(),r=r.concat(no(e.serverSyncTree_,s[t].currentWriteId,!0)),s[t].onComplete&&i.push(s[t].onComplete.bind(null,new Error("set"),!1,null))));-1===n?Oo(t,void 0):s.length=n+1,Jo(e.eventQueue_,Bo(t),r);for(let e=0;e<i.length;e++)rr(i[e])}}const _h=function(e,t){const s=xh(e),i=s.namespace;"firebase.com"===s.domain&&Vi(s.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),i&&"undefined"!==i||"localhost"===s.domain||Vi("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),s.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&Wi("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");const r="ws"===s.scheme||"wss"===s.scheme;return{repoInfo:new fr(s.host,s.secure,i,r,t,"",i!==s.subdomain),path:new Nr(s.pathString)}},xh=function(e){let t="",s="",i="",r="",n="",a=!0,o="https",h=443;if("string"==typeof e){let c=e.indexOf("//");c>=0&&(o=e.substring(0,c-1),e=e.substring(c+2));let l=e.indexOf("/");-1===l&&(l=e.length);let p=e.indexOf("?");-1===p&&(p=e.length),t=e.substring(0,Math.min(l,p)),l<p&&(r=function(e){let t="";const s=e.split("/");for(let e=0;e<s.length;e++)if(s[e].length>0){let i=s[e];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(e){}t+="/"+i}return t}(e.substring(l,p)));const u=function(e){const t={};"?"===e.charAt(0)&&(e=e.substring(1));for(const s of e.split("&")){if(0===s.length)continue;const i=s.split("=");2===i.length?t[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):Wi(`Invalid query segment '${s}' in query '${e}'`)}return t}(e.substring(Math.min(e.length,p)));c=t.indexOf(":"),c>=0?(a="https"===o||"wss"===o,h=parseInt(t.substring(c+1),10)):c=t.length;const d=t.slice(0,c);if("localhost"===d.toLowerCase())s="localhost";else if(d.split(".").length<=2)s=d;else{const e=t.indexOf(".");i=t.substring(0,e).toLowerCase(),s=t.substring(e+1),n=i}"ns"in u&&(n=u.ns)}return{host:t,port:h,domain:s,subdomain:i,secure:a,scheme:o,pathString:r,namespace:n}};class vh{constructor(e,t,s,i){this.eventType=e,this.eventRegistration=t,this.snapshot=s,this.prevName=i}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Ve(this.snapshot.exportVal())}}class Ph{constructor(e,t,s){this.eventRegistration=e,this.error=t,this.path=s}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class Th{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return Te(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class Ch{constructor(e,t,s,i){this._repo=e,this._path=t,this._queryParams=s,this._orderByCalled=i}get key(){return jr(this._path)?null:Rr(this._path)}get ref(){return new Eh(this._repo,this._path)}get _queryIdentifier(){const e=Fn(this._queryParams),t=Xi(e);return"{}"===t?"default":t}get _queryObject(){return Fn(this._queryParams)}isEqual(e){if(!((e=at(e))instanceof Ch))return!1;const t=this._repo===e._repo,s=qr(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&s&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+function(e){let t="";for(let s=e.pieceNum_;s<e.pieces_.length;s++)""!==e.pieces_[s]&&(t+="/"+encodeURIComponent(String(e.pieces_[s])));return t||"/"}(this._path)}}class Eh extends Ch{constructor(e,t){super(e,t,new Mn,!1)}get parent(){const e=Br(this._path);return null===e?null:new Eh(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class kh{constructor(e,t,s){this._node=e,this.ref=t,this._index=s}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new Nr(e),s=Sh(this.ref,e);return new kh(this._node.getChild(t),s,fn)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,((t,s)=>e(new kh(s,Sh(this.ref,t),fn))))}hasChild(e){const t=new Nr(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Ah(e,t){return(e=at(e))._checkNotDeleted("ref"),void 0!==t?Sh(e._root,t):e._root}function Sh(e,t){return null===Dr((e=at(e))._path)?Ko("child","path",t,!1):$o("child","path",t,!1),new Eh(e._repo,Ur(e._path,t))}function Ih(e,t){(function(e,t){if(".info"===Dr(t))throw new Error(e+" failed = Can't modify data under /.info/")})("set",(e=at(e))._path),function(e,t,s,i){i&&void 0===t||Wo(Qe(e,"value"),t,s)}("set",t,e._path,!1);const s=new Re;return hh(e._repo,e._path,t,null,s.wrapCallback((()=>{}))),s.promise}function Nh(e){e=at(e);const t=new Th((()=>{})),s=new Lh(t);return function(e,t,s){const i=function(e,t){const s=t._path;let i=null;e.syncPointTree_.foreachOnPath(s,((e,t)=>{const r=zr(e,s);i=i||Za(t,r)}));let r=e.syncPointTree_.get(s);r?i=i||Za(r,Lr()):(r=new Ka,e.syncPointTree_=e.syncPointTree_.set(s,r));const n=null!=i,a=n?new Zn(i,!0,!1):null;return ia(Ya(r,t,ba(e.pendingWriteTree_,t._path),n?a.getNode():vn.EMPTY_NODE,n).viewCache_)}(e.serverSyncTree_,t);return null!=i?Promise.resolve(i):e.server_.get(t).then((i=>{const r=Cn(i).withIndex(t._queryParams.getIndex());let n;if(co(e.serverSyncTree_,t,s,!0),t._queryParams.loadsAllData())n=ao(e.serverSyncTree_,t._path,r);else{const s=yo(e.serverSyncTree_,t);n=ho(e.serverSyncTree_,t._path,r,s)}return Jo(e.eventQueue_,t._path,n),oo(e.serverSyncTree_,t,s,null,!0),r}),(s=>(lh(e,"get for query "+Ve(t)+" failed: "+s),Promise.reject(new Error(s)))))}(e._repo,e,s).then((t=>new kh(t,new Eh(e._repo,e._path),e._queryParams.getIndex())))}class Lh{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const s=t._queryParams.getIndex();return new vh("value",this,new kh(e.snapshotNode,new Eh(t._repo,t._path),s))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Ph(this,e,t):null}matches(e){return e instanceof Lh&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}!function(e){Te(!Wa,"__referenceConstructor has already been defined"),Wa=e}(Eh),function(e){Te(!$a,"__referenceConstructor has already been defined"),$a=e}(Eh);const Dh={};function Oh(e,t,s,i,r){let n=i||e.options.databaseURL;void 0===n&&(e.options.projectId||Vi("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),zi("Using default host for project ",e.options.projectId),n=`${e.options.projectId}-default-rtdb.firebaseio.com`);let a,o,h=_h(n,r),c=h.repoInfo;"undefined"!=typeof process&&process.env&&(o=process.env.FIREBASE_DATABASE_EMULATOR_HOST),o?(a=!0,n=`http://${o}?ns=${c.namespace}`,h=_h(n,r),c=h.repoInfo):a=!h.repoInfo.secure;const l=r&&a?new hr(hr.OWNER):new or(e.name,e.options,t);(function(e,t){const s=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!Ho(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==s.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),Vo(e)}(s))throw new Error(Qe(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')})("Invalid Firebase Database URL",h),jr(h.path)||Vi("Database URL must point to the root of a Firebase Database (not including a child path).");const p=function(e,t,s,i){let r=Dh[t.name];r||(r={},Dh[t.name]=r);let n=r[e.toURLString()];return n&&Vi("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),n=new eh(e,false,s,i),r[e.toURLString()]=n,n}(c,e,l,new ar(e.name,s));return new Mh(p,e)}class Mh{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(th(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Eh(this._repo,Lr())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function(e,t){const s=Dh[t];s&&s[e.key]===e||Vi(`Database ${t}(${e.repoInfo_}) has already been deleted.`),ch(e),delete s[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&Vi("Cannot call "+e+" on a deleted database.")}}function Rh(e){(e=at(e))._checkNotDeleted("goOffline"),ch(e._repo)}function Fh(e){const t=Object.create(Storage.prototype);return t.getItem=t=>e.get(t),t.setItem=(t,s)=>e.set(t,s),t.removeItem=t=>{e.delete(t)},t.clear=()=>e.clear(),t.key=t=>e.keys()[t]||null,Object.defineProperty(t,"length",{get:()=>e.size,enumerable:!1,configurable:!1}),Object.freeze(t)}function Bh(e){const t=Object.create(null);return t.has=t=>t in e,t.get=t=>e[t]||null,t.set=(t,s)=>{e[t]=s},t.delete=t=>delete e[t],t.clear=()=>{for(const t of Object.keys(e))delete e[t]},t.keys=()=>Object.keys(e),t.values=()=>{const t=[];for(const s of Object.keys(e))t.push(e[s]);return t},t.entries=()=>{const t=[];for(const s of Object.keys(e))t.push([s,e[s]]);return t},Object.defineProperties(t,{size:{get:()=>Object.keys(e).length,enumerable:!1,configurable:!1}}),Object.freeze(t)}function Uh(e){const t=Object.create(null);return t.has=t=>null!==e.getItem(t),t.get=t=>e.getItem(t),t.set=(t,s)=>e.setItem(t,s),t.clear=()=>e.clear(),t.delete=t=>(e.removeItem(t),!0),t.keys=()=>{const t=e.length,s=new Array(t);for(let i=0;i<t;i++)s[i]=e.key(i);return s},t.values=()=>{const t=e.length,s=new Array(t);for(let i=0;i<t;i++)s[i]=e.getItem(e.key(i));return s},t.entries=()=>{const t=e.length,s=new Array(t);for(let i=0;i<t;i++){const t=e.key(i);s[i]=[t,e.getItem(t)]}return s},Object.defineProperties(t,{size:{get:()=>e.length,enumerable:!1,configurable:!1}}),Object.freeze(t)}Yr.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},Yr.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)},Si="10.11.0",$t(new ot("database",((e,{instanceIdentifier:t})=>Oh(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t)),"PUBLIC").setMultipleInstances(!0)),Xt(ki,Ai,void 0),Xt(ki,Ai,"esm2017");const jh=function(...e){if(1!==e.length)throw new Error("Invalid arguments");const t=e[0];if("object"!=typeof t)throw new Error("Invalid arguments");const s=Object.create(zh);try{const e=t.localStorage,i=t.sessionStorage;if("object"!=typeof e||"object"!=typeof i)throw void 0;s.storageEnabled=!0,s.localStorage=Uh(e),s.sessionStorage=Uh(i)}catch(e){s.storageEnabled=!1,s.localStorage=Bh(Object.create(null)),s.sessionStorage=Bh(Object.create(null))}return Object.defineProperties(t,{localStorage:{value:Fh(s.localStorage),writable:!1,enumerable:!1,configurable:!1},sessionStorage:{value:Fh(s.sessionStorage),writable:!1,enumerable:!1,configurable:!1}}),Object.freeze(s)},zh=Object.freeze(Object.create(null));Object.defineProperty(jh,"prototype",{value:zh,writable:!1,enumerable:!1,configurable:!1}),Object.setPrototypeOf(jh,null),Object.freeze(jh);const qh=jh;var Hh=s(602);function Vh(e,t){let s="";switch(t.type){case"VariableDeclaration":switch(t.kind){case"var":case"let":for(const i of t.declarations){s+='window["'+i.id.name+'"] = ';const t=i.init;if(null!=t){const i=e.slice(t.start,t.end).trim();";"!==i[i.length-1]?s+=i+";\n":s+=i+"\n"}else s+="void 0;\n"}break;case"const":for(const i of t.declarations){s+='Object.defineProperty(window, "'+i.id.name+'", { value: ';const t=i.init;if(null!=t){const i=e.slice(t.start,t.end).trim(),r=i.length-1;";"===i[r]?s+=i.slice(0,r):s+=i}else s+="void 0";s+=", writable: false, enumerable: false, configurable: false });\n"}break;default:s+="// invalid expression\n"}break;case"InterfaceDeclaration":case"FunctionDeclaration":case"ClassDeclaration":case"EnumDeclaration":{const i=t.id;null!=i&&(s+='window["'+i.name+'"] = ');const r=e.slice(t.start,t.end).trim();";"!==r[r.length-1]?s+=r+";\n":s+=r+"\n"}break;case"EmptyStatement":case"DebuggerStatement":break;case"ExpressionStatement":{const i=t.expression;switch(i.type){case"AwaitExpression":case"YieldExpression":{const t=i.argument;if(null!=t){const i=e.slice(t.start,t.end).trim();";"!==i[i.length-1]?s+="await "+i+";\n":s+="await "+i+"\n"}}}}break;default:{const i=e.slice(t.start,t.end).trim();";"!==i[i.length-1]?s+=i+";\n":s+=i+"\n"}}return s}const Wh="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",$h=new Uint8Array(new ArrayBuffer(256));for(let e=0;e<64;e++)$h[Wh.charCodeAt(e)]=e;const Kh={encode:function(e){let t="",s="";const i=new Uint8Array(e);for(let e=0;e<i.length;e+=3){const s=i[e]<<16|i[e+1]<<8|i[e+2];t+=Wh[s>>18&63]+Wh[s>>12&63]+Wh[s>>6&63]+Wh[63&s]}const r=i.length%3;return 1===r?(s="==",t=t.slice(0,-2)):2===r&&(s="=",t=t.slice(0,-1)),t+s},decode:function(e){let t=0;e.endsWith("==")?t=2:e.endsWith("=")&&(t=1);const s=.75*e.length-t,i=new ArrayBuffer(s),r=new Uint8Array(i);let n=0;for(let t=0;t<e.length;t+=4){const s=$h[e.charCodeAt(t)]<<18|$h[e.charCodeAt(t+1)]<<12|$h[e.charCodeAt(t+2)]<<6|$h[e.charCodeAt(t+3)];r[n++]=s>>16&255,r[n++]=s>>8&255,r[n++]=255&s}return i}};Object.setPrototypeOf(Kh,null),Object.freeze(Kh);const Gh=Kh,Yh={encode:function(e){const t=Array.from(e).map((e=>e.codePointAt(0)||0)),s=[];for(const e of t)e<=127?s.push(e):e<=2047?(s.push(e>>6|192),s.push(63&e|128)):e<=65535?(s.push(e>>12|224),s.push(e>>6&63|128),s.push(63&e|128)):e<=1114111&&(s.push(e>>18|240),s.push(e>>12&63|128),s.push(e>>6&63|128),s.push(63&e|128));return new Uint8Array(s).buffer},decode:function(e){const t=new Uint8Array(e);let s="",i=0;for(;i<t.length;){const e=t[i];if(0==(128&e))s+=String.fromCharCode(e),i+=1;else if(192==(224&e)){const r=t[i+1];s+=String.fromCharCode((31&e)<<6|63&r),i+=2}else if(224==(240&e)){const r=t[i+1],n=t[i+2];s+=String.fromCharCode((15&e)<<12|(63&r)<<6|63&n),i+=3}else if(240==(248&e)){const r=(7&e)<<18|(63&t[i+1])<<12|(63&t[i+2])<<6|63&t[i+3];s+=r<=1114111?String.fromCodePoint(r):"�",i+=4}else s+="�",i+=1}return s}};Object.setPrototypeOf(Yh,null),Object.freeze(Yh);const Jh=Yh,Zh={}.constructor,Xh="".constructor,Qh=[].constructor,ec=(()=>{}).constructor,tc=(async()=>{}).constructor;function sc(e){let t=e.length;for(;--t>=0;)e[t]=0}const ic=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),rc=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),nc=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),ac=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),oc=new Array(576);sc(oc);const hc=new Array(60);sc(hc);const cc=new Array(512);sc(cc);const lc=new Array(256);sc(lc);const pc=new Array(29);sc(pc);const uc=new Array(30);function dc(e,t,s,i,r){this.static_tree=e,this.extra_bits=t,this.extra_base=s,this.elems=i,this.max_length=r,this.has_stree=e&&e.length}let fc,mc,yc;function gc(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}sc(uc);const bc=e=>e<256?cc[e]:cc[256+(e>>>7)],wc=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},_c=(e,t,s)=>{e.bi_valid>16-s?(e.bi_buf|=t<<e.bi_valid&65535,wc(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=s-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=s)},xc=(e,t,s)=>{_c(e,s[2*t],s[2*t+1])},vc=(e,t)=>{let s=0;do{s|=1&e,e>>>=1,s<<=1}while(--t>0);return s>>>1},Pc=(e,t,s)=>{const i=new Array(16);let r,n,a=0;for(r=1;r<=15;r++)a=a+s[r-1]<<1,i[r]=a;for(n=0;n<=t;n++){let t=e[2*n+1];0!==t&&(e[2*n]=vc(i[t]++,t))}},Tc=e=>{let t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},Cc=e=>{e.bi_valid>8?wc(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},Ec=(e,t,s,i)=>{const r=2*t,n=2*s;return e[r]<e[n]||e[r]===e[n]&&i[t]<=i[s]},kc=(e,t,s)=>{const i=e.heap[s];let r=s<<1;for(;r<=e.heap_len&&(r<e.heap_len&&Ec(t,e.heap[r+1],e.heap[r],e.depth)&&r++,!Ec(t,i,e.heap[r],e.depth));)e.heap[s]=e.heap[r],s=r,r<<=1;e.heap[s]=i},Ac=(e,t,s)=>{let i,r,n,a,o=0;if(0!==e.sym_next)do{i=255&e.pending_buf[e.sym_buf+o++],i+=(255&e.pending_buf[e.sym_buf+o++])<<8,r=e.pending_buf[e.sym_buf+o++],0===i?xc(e,r,t):(n=lc[r],xc(e,n+256+1,t),a=ic[n],0!==a&&(r-=pc[n],_c(e,r,a)),i--,n=bc(i),xc(e,n,s),a=rc[n],0!==a&&(i-=uc[n],_c(e,i,a)))}while(o<e.sym_next);xc(e,256,t)},Sc=(e,t)=>{const s=t.dyn_tree,i=t.stat_desc.static_tree,r=t.stat_desc.has_stree,n=t.stat_desc.elems;let a,o,h,c=-1;for(e.heap_len=0,e.heap_max=573,a=0;a<n;a++)0!==s[2*a]?(e.heap[++e.heap_len]=c=a,e.depth[a]=0):s[2*a+1]=0;for(;e.heap_len<2;)h=e.heap[++e.heap_len]=c<2?++c:0,s[2*h]=1,e.depth[h]=0,e.opt_len--,r&&(e.static_len-=i[2*h+1]);for(t.max_code=c,a=e.heap_len>>1;a>=1;a--)kc(e,s,a);h=n;do{a=e.heap[1],e.heap[1]=e.heap[e.heap_len--],kc(e,s,1),o=e.heap[1],e.heap[--e.heap_max]=a,e.heap[--e.heap_max]=o,s[2*h]=s[2*a]+s[2*o],e.depth[h]=(e.depth[a]>=e.depth[o]?e.depth[a]:e.depth[o])+1,s[2*a+1]=s[2*o+1]=h,e.heap[1]=h++,kc(e,s,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const s=t.dyn_tree,i=t.max_code,r=t.stat_desc.static_tree,n=t.stat_desc.has_stree,a=t.stat_desc.extra_bits,o=t.stat_desc.extra_base,h=t.stat_desc.max_length;let c,l,p,u,d,f,m=0;for(u=0;u<=15;u++)e.bl_count[u]=0;for(s[2*e.heap[e.heap_max]+1]=0,c=e.heap_max+1;c<573;c++)l=e.heap[c],u=s[2*s[2*l+1]+1]+1,u>h&&(u=h,m++),s[2*l+1]=u,l>i||(e.bl_count[u]++,d=0,l>=o&&(d=a[l-o]),f=s[2*l],e.opt_len+=f*(u+d),n&&(e.static_len+=f*(r[2*l+1]+d)));if(0!==m){do{for(u=h-1;0===e.bl_count[u];)u--;e.bl_count[u]--,e.bl_count[u+1]+=2,e.bl_count[h]--,m-=2}while(m>0);for(u=h;0!==u;u--)for(l=e.bl_count[u];0!==l;)p=e.heap[--c],p>i||(s[2*p+1]!==u&&(e.opt_len+=(u-s[2*p+1])*s[2*p],s[2*p+1]=u),l--)}})(e,t),Pc(s,c,e.bl_count)},Ic=(e,t,s)=>{let i,r,n=-1,a=t[1],o=0,h=7,c=4;for(0===a&&(h=138,c=3),t[2*(s+1)+1]=65535,i=0;i<=s;i++)r=a,a=t[2*(i+1)+1],++o<h&&r===a||(o<c?e.bl_tree[2*r]+=o:0!==r?(r!==n&&e.bl_tree[2*r]++,e.bl_tree[32]++):o<=10?e.bl_tree[34]++:e.bl_tree[36]++,o=0,n=r,0===a?(h=138,c=3):r===a?(h=6,c=3):(h=7,c=4))},Nc=(e,t,s)=>{let i,r,n=-1,a=t[1],o=0,h=7,c=4;for(0===a&&(h=138,c=3),i=0;i<=s;i++)if(r=a,a=t[2*(i+1)+1],!(++o<h&&r===a)){if(o<c)do{xc(e,r,e.bl_tree)}while(0!=--o);else 0!==r?(r!==n&&(xc(e,r,e.bl_tree),o--),xc(e,16,e.bl_tree),_c(e,o-3,2)):o<=10?(xc(e,17,e.bl_tree),_c(e,o-3,3)):(xc(e,18,e.bl_tree),_c(e,o-11,7));o=0,n=r,0===a?(h=138,c=3):r===a?(h=6,c=3):(h=7,c=4)}};let Lc=!1;const Dc=(e,t,s,i)=>{_c(e,0+(i?1:0),3),Cc(e),wc(e,s),wc(e,~s),s&&e.pending_buf.set(e.window.subarray(t,t+s),e.pending),e.pending+=s};var Oc={_tr_init:e=>{Lc||((()=>{let e,t,s,i,r;const n=new Array(16);for(s=0,i=0;i<28;i++)for(pc[i]=s,e=0;e<1<<ic[i];e++)lc[s++]=i;for(lc[s-1]=i,r=0,i=0;i<16;i++)for(uc[i]=r,e=0;e<1<<rc[i];e++)cc[r++]=i;for(r>>=7;i<30;i++)for(uc[i]=r<<7,e=0;e<1<<rc[i]-7;e++)cc[256+r++]=i;for(t=0;t<=15;t++)n[t]=0;for(e=0;e<=143;)oc[2*e+1]=8,e++,n[8]++;for(;e<=255;)oc[2*e+1]=9,e++,n[9]++;for(;e<=279;)oc[2*e+1]=7,e++,n[7]++;for(;e<=287;)oc[2*e+1]=8,e++,n[8]++;for(Pc(oc,287,n),e=0;e<30;e++)hc[2*e+1]=5,hc[2*e]=vc(e,5);fc=new dc(oc,ic,257,286,15),mc=new dc(hc,rc,0,30,15),yc=new dc(new Array(0),nc,0,19,7)})(),Lc=!0),e.l_desc=new gc(e.dyn_ltree,fc),e.d_desc=new gc(e.dyn_dtree,mc),e.bl_desc=new gc(e.bl_tree,yc),e.bi_buf=0,e.bi_valid=0,Tc(e)},_tr_stored_block:Dc,_tr_flush_block:(e,t,s,i)=>{let r,n,a=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,s=4093624447;for(t=0;t<=31;t++,s>>>=1)if(1&s&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),Sc(e,e.l_desc),Sc(e,e.d_desc),a=(e=>{let t;for(Ic(e,e.dyn_ltree,e.l_desc.max_code),Ic(e,e.dyn_dtree,e.d_desc.max_code),Sc(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*ac[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),r=e.opt_len+3+7>>>3,n=e.static_len+3+7>>>3,n<=r&&(r=n)):r=n=s+5,s+4<=r&&-1!==t?Dc(e,t,s,i):4===e.strategy||n===r?(_c(e,2+(i?1:0),3),Ac(e,oc,hc)):(_c(e,4+(i?1:0),3),((e,t,s,i)=>{let r;for(_c(e,t-257,5),_c(e,s-1,5),_c(e,i-4,4),r=0;r<i;r++)_c(e,e.bl_tree[2*ac[r]+1],3);Nc(e,e.dyn_ltree,t-1),Nc(e,e.dyn_dtree,s-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),Ac(e,e.dyn_ltree,e.dyn_dtree)),Tc(e),i&&Cc(e)},_tr_tally:(e,t,s)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=s,0===t?e.dyn_ltree[2*s]++:(e.matches++,t--,e.dyn_ltree[2*(lc[s]+256+1)]++,e.dyn_dtree[2*bc(t)]++),e.sym_next===e.sym_end),_tr_align:e=>{_c(e,2,3),xc(e,256,oc),(e=>{16===e.bi_valid?(wc(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)}},Mc=(e,t,s,i)=>{let r=65535&e|0,n=e>>>16&65535|0,a=0;for(;0!==s;){a=s>2e3?2e3:s,s-=a;do{r=r+t[i++]|0,n=n+r|0}while(--a);r%=65521,n%=65521}return r|n<<16|0};const Rc=new Uint32Array((()=>{let e,t=[];for(var s=0;s<256;s++){e=s;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[s]=e}return t})());var Fc=(e,t,s,i)=>{const r=Rc,n=i+s;e^=-1;for(let s=i;s<n;s++)e=e>>>8^r[255&(e^t[s])];return-1^e},Bc={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Uc={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:jc,_tr_stored_block:zc,_tr_flush_block:qc,_tr_tally:Hc,_tr_align:Vc}=Oc,{Z_NO_FLUSH:Wc,Z_PARTIAL_FLUSH:$c,Z_FULL_FLUSH:Kc,Z_FINISH:Gc,Z_BLOCK:Yc,Z_OK:Jc,Z_STREAM_END:Zc,Z_STREAM_ERROR:Xc,Z_DATA_ERROR:Qc,Z_BUF_ERROR:el,Z_DEFAULT_COMPRESSION:tl,Z_FILTERED:sl,Z_HUFFMAN_ONLY:il,Z_RLE:rl,Z_FIXED:nl,Z_DEFAULT_STRATEGY:al,Z_UNKNOWN:ol,Z_DEFLATED:hl}=Uc,cl=258,ll=262,pl=42,ul=113,dl=666,fl=(e,t)=>(e.msg=Bc[t],t),ml=e=>2*e-(e>4?9:0),yl=e=>{let t=e.length;for(;--t>=0;)e[t]=0},gl=e=>{let t,s,i,r=e.w_size;t=e.hash_size,i=t;do{s=e.head[--i],e.head[i]=s>=r?s-r:0}while(--t);t=r,i=t;do{s=e.prev[--i],e.prev[i]=s>=r?s-r:0}while(--t)};let bl=(e,t,s)=>(t<<e.hash_shift^s)&e.hash_mask;const wl=e=>{const t=e.state;let s=t.pending;s>e.avail_out&&(s=e.avail_out),0!==s&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+s),e.next_out),e.next_out+=s,t.pending_out+=s,e.total_out+=s,e.avail_out-=s,t.pending-=s,0===t.pending&&(t.pending_out=0))},_l=(e,t)=>{qc(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,wl(e.strm)},xl=(e,t)=>{e.pending_buf[e.pending++]=t},vl=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},Pl=(e,t,s,i)=>{let r=e.avail_in;return r>i&&(r=i),0===r?0:(e.avail_in-=r,t.set(e.input.subarray(e.next_in,e.next_in+r),s),1===e.state.wrap?e.adler=Mc(e.adler,t,r,s):2===e.state.wrap&&(e.adler=Fc(e.adler,t,r,s)),e.next_in+=r,e.total_in+=r,r)},Tl=(e,t)=>{let s,i,r=e.max_chain_length,n=e.strstart,a=e.prev_length,o=e.nice_match;const h=e.strstart>e.w_size-ll?e.strstart-(e.w_size-ll):0,c=e.window,l=e.w_mask,p=e.prev,u=e.strstart+cl;let d=c[n+a-1],f=c[n+a];e.prev_length>=e.good_match&&(r>>=2),o>e.lookahead&&(o=e.lookahead);do{if(s=t,c[s+a]===f&&c[s+a-1]===d&&c[s]===c[n]&&c[++s]===c[n+1]){n+=2,s++;do{}while(c[++n]===c[++s]&&c[++n]===c[++s]&&c[++n]===c[++s]&&c[++n]===c[++s]&&c[++n]===c[++s]&&c[++n]===c[++s]&&c[++n]===c[++s]&&c[++n]===c[++s]&&n<u);if(i=cl-(u-n),n=u-cl,i>a){if(e.match_start=t,a=i,i>=o)break;d=c[n+a-1],f=c[n+a]}}}while((t=p[t&l])>h&&0!=--r);return a<=e.lookahead?a:e.lookahead},Cl=e=>{const t=e.w_size;let s,i,r;do{if(i=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-ll)&&(e.window.set(e.window.subarray(t,t+t-i),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),gl(e),i+=t),0===e.strm.avail_in)break;if(s=Pl(e.strm,e.window,e.strstart+e.lookahead,i),e.lookahead+=s,e.lookahead+e.insert>=3)for(r=e.strstart-e.insert,e.ins_h=e.window[r],e.ins_h=bl(e,e.ins_h,e.window[r+1]);e.insert&&(e.ins_h=bl(e,e.ins_h,e.window[r+3-1]),e.prev[r&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=r,r++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<ll&&0!==e.strm.avail_in)},El=(e,t)=>{let s,i,r,n=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,a=0,o=e.strm.avail_in;do{if(s=65535,r=e.bi_valid+42>>3,e.strm.avail_out<r)break;if(r=e.strm.avail_out-r,i=e.strstart-e.block_start,s>i+e.strm.avail_in&&(s=i+e.strm.avail_in),s>r&&(s=r),s<n&&(0===s&&t!==Gc||t===Wc||s!==i+e.strm.avail_in))break;a=t===Gc&&s===i+e.strm.avail_in?1:0,zc(e,0,0,a),e.pending_buf[e.pending-4]=s,e.pending_buf[e.pending-3]=s>>8,e.pending_buf[e.pending-2]=~s,e.pending_buf[e.pending-1]=~s>>8,wl(e.strm),i&&(i>s&&(i=s),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+i),e.strm.next_out),e.strm.next_out+=i,e.strm.avail_out-=i,e.strm.total_out+=i,e.block_start+=i,s-=i),s&&(Pl(e.strm,e.strm.output,e.strm.next_out,s),e.strm.next_out+=s,e.strm.avail_out-=s,e.strm.total_out+=s)}while(0===a);return o-=e.strm.avail_in,o&&(o>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=o&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-o,e.strm.next_in),e.strstart),e.strstart+=o,e.insert+=o>e.w_size-e.insert?e.w_size-e.insert:o),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),a?4:t!==Wc&&t!==Gc&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(r=e.window_size-e.strstart,e.strm.avail_in>r&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,r+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),r>e.strm.avail_in&&(r=e.strm.avail_in),r&&(Pl(e.strm,e.window,e.strstart,r),e.strstart+=r,e.insert+=r>e.w_size-e.insert?e.w_size-e.insert:r),e.high_water<e.strstart&&(e.high_water=e.strstart),r=e.bi_valid+42>>3,r=e.pending_buf_size-r>65535?65535:e.pending_buf_size-r,n=r>e.w_size?e.w_size:r,i=e.strstart-e.block_start,(i>=n||(i||t===Gc)&&t!==Wc&&0===e.strm.avail_in&&i<=r)&&(s=i>r?r:i,a=t===Gc&&0===e.strm.avail_in&&s===i?1:0,zc(e,e.block_start,s,a),e.block_start+=s,wl(e.strm)),a?3:1)},kl=(e,t)=>{let s,i;for(;;){if(e.lookahead<ll){if(Cl(e),e.lookahead<ll&&t===Wc)return 1;if(0===e.lookahead)break}if(s=0,e.lookahead>=3&&(e.ins_h=bl(e,e.ins_h,e.window[e.strstart+3-1]),s=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==s&&e.strstart-s<=e.w_size-ll&&(e.match_length=Tl(e,s)),e.match_length>=3)if(i=Hc(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=bl(e,e.ins_h,e.window[e.strstart+3-1]),s=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=bl(e,e.ins_h,e.window[e.strstart+1]);else i=Hc(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(_l(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===Gc?(_l(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(_l(e,!1),0===e.strm.avail_out)?1:2},Al=(e,t)=>{let s,i,r;for(;;){if(e.lookahead<ll){if(Cl(e),e.lookahead<ll&&t===Wc)return 1;if(0===e.lookahead)break}if(s=0,e.lookahead>=3&&(e.ins_h=bl(e,e.ins_h,e.window[e.strstart+3-1]),s=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==s&&e.prev_length<e.max_lazy_match&&e.strstart-s<=e.w_size-ll&&(e.match_length=Tl(e,s),e.match_length<=5&&(e.strategy===sl||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){r=e.strstart+e.lookahead-3,i=Hc(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=r&&(e.ins_h=bl(e,e.ins_h,e.window[e.strstart+3-1]),s=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,i&&(_l(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(i=Hc(e,0,e.window[e.strstart-1]),i&&_l(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=Hc(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===Gc?(_l(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(_l(e,!1),0===e.strm.avail_out)?1:2};function Sl(e,t,s,i,r){this.good_length=e,this.max_lazy=t,this.nice_length=s,this.max_chain=i,this.func=r}const Il=[new Sl(0,0,0,0,El),new Sl(4,4,8,4,kl),new Sl(4,5,16,8,kl),new Sl(4,6,32,32,kl),new Sl(4,4,16,16,Al),new Sl(8,16,32,32,Al),new Sl(8,16,128,128,Al),new Sl(8,32,128,256,Al),new Sl(32,128,258,1024,Al),new Sl(32,258,258,4096,Al)];function Nl(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=hl,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),yl(this.dyn_ltree),yl(this.dyn_dtree),yl(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),yl(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),yl(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Ll=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==pl&&57!==t.status&&69!==t.status&&73!==t.status&&91!==t.status&&103!==t.status&&t.status!==ul&&t.status!==dl?1:0},Dl=e=>{if(Ll(e))return fl(e,Xc);e.total_in=e.total_out=0,e.data_type=ol;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?pl:ul,e.adler=2===t.wrap?0:1,t.last_flush=-2,jc(t),Jc},Ol=e=>{const t=Dl(e);var s;return t===Jc&&((s=e.state).window_size=2*s.w_size,yl(s.head),s.max_lazy_match=Il[s.level].max_lazy,s.good_match=Il[s.level].good_length,s.nice_match=Il[s.level].nice_length,s.max_chain_length=Il[s.level].max_chain,s.strstart=0,s.block_start=0,s.lookahead=0,s.insert=0,s.match_length=s.prev_length=2,s.match_available=0,s.ins_h=0),t},Ml=(e,t,s,i,r,n)=>{if(!e)return Xc;let a=1;if(t===tl&&(t=6),i<0?(a=0,i=-i):i>15&&(a=2,i-=16),r<1||r>9||s!==hl||i<8||i>15||t<0||t>9||n<0||n>nl||8===i&&1!==a)return fl(e,Xc);8===i&&(i=9);const o=new Nl;return e.state=o,o.strm=e,o.status=pl,o.wrap=a,o.gzhead=null,o.w_bits=i,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=r+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+3-1)/3),o.window=new Uint8Array(2*o.w_size),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<r+6,o.pending_buf_size=4*o.lit_bufsize,o.pending_buf=new Uint8Array(o.pending_buf_size),o.sym_buf=o.lit_bufsize,o.sym_end=3*(o.lit_bufsize-1),o.level=t,o.strategy=n,o.method=s,Ol(e)};var Rl={deflateInit:(e,t)=>Ml(e,t,hl,15,8,al),deflateInit2:Ml,deflateReset:Ol,deflateResetKeep:Dl,deflateSetHeader:(e,t)=>Ll(e)||2!==e.state.wrap?Xc:(e.state.gzhead=t,Jc),deflate:(e,t)=>{if(Ll(e)||t>Yc||t<0)return e?fl(e,Xc):Xc;const s=e.state;if(!e.output||0!==e.avail_in&&!e.input||s.status===dl&&t!==Gc)return fl(e,0===e.avail_out?el:Xc);const i=s.last_flush;if(s.last_flush=t,0!==s.pending){if(wl(e),0===e.avail_out)return s.last_flush=-1,Jc}else if(0===e.avail_in&&ml(t)<=ml(i)&&t!==Gc)return fl(e,el);if(s.status===dl&&0!==e.avail_in)return fl(e,el);if(s.status===pl&&0===s.wrap&&(s.status=ul),s.status===pl){let t=hl+(s.w_bits-8<<4)<<8,i=-1;if(i=s.strategy>=il||s.level<2?0:s.level<6?1:6===s.level?2:3,t|=i<<6,0!==s.strstart&&(t|=32),t+=31-t%31,vl(s,t),0!==s.strstart&&(vl(s,e.adler>>>16),vl(s,65535&e.adler)),e.adler=1,s.status=ul,wl(e),0!==s.pending)return s.last_flush=-1,Jc}if(57===s.status)if(e.adler=0,xl(s,31),xl(s,139),xl(s,8),s.gzhead)xl(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(s.gzhead.extra?4:0)+(s.gzhead.name?8:0)+(s.gzhead.comment?16:0)),xl(s,255&s.gzhead.time),xl(s,s.gzhead.time>>8&255),xl(s,s.gzhead.time>>16&255),xl(s,s.gzhead.time>>24&255),xl(s,9===s.level?2:s.strategy>=il||s.level<2?4:0),xl(s,255&s.gzhead.os),s.gzhead.extra&&s.gzhead.extra.length&&(xl(s,255&s.gzhead.extra.length),xl(s,s.gzhead.extra.length>>8&255)),s.gzhead.hcrc&&(e.adler=Fc(e.adler,s.pending_buf,s.pending,0)),s.gzindex=0,s.status=69;else if(xl(s,0),xl(s,0),xl(s,0),xl(s,0),xl(s,0),xl(s,9===s.level?2:s.strategy>=il||s.level<2?4:0),xl(s,3),s.status=ul,wl(e),0!==s.pending)return s.last_flush=-1,Jc;if(69===s.status){if(s.gzhead.extra){let t=s.pending,i=(65535&s.gzhead.extra.length)-s.gzindex;for(;s.pending+i>s.pending_buf_size;){let r=s.pending_buf_size-s.pending;if(s.pending_buf.set(s.gzhead.extra.subarray(s.gzindex,s.gzindex+r),s.pending),s.pending=s.pending_buf_size,s.gzhead.hcrc&&s.pending>t&&(e.adler=Fc(e.adler,s.pending_buf,s.pending-t,t)),s.gzindex+=r,wl(e),0!==s.pending)return s.last_flush=-1,Jc;t=0,i-=r}let r=new Uint8Array(s.gzhead.extra);s.pending_buf.set(r.subarray(s.gzindex,s.gzindex+i),s.pending),s.pending+=i,s.gzhead.hcrc&&s.pending>t&&(e.adler=Fc(e.adler,s.pending_buf,s.pending-t,t)),s.gzindex=0}s.status=73}if(73===s.status){if(s.gzhead.name){let t,i=s.pending;do{if(s.pending===s.pending_buf_size){if(s.gzhead.hcrc&&s.pending>i&&(e.adler=Fc(e.adler,s.pending_buf,s.pending-i,i)),wl(e),0!==s.pending)return s.last_flush=-1,Jc;i=0}t=s.gzindex<s.gzhead.name.length?255&s.gzhead.name.charCodeAt(s.gzindex++):0,xl(s,t)}while(0!==t);s.gzhead.hcrc&&s.pending>i&&(e.adler=Fc(e.adler,s.pending_buf,s.pending-i,i)),s.gzindex=0}s.status=91}if(91===s.status){if(s.gzhead.comment){let t,i=s.pending;do{if(s.pending===s.pending_buf_size){if(s.gzhead.hcrc&&s.pending>i&&(e.adler=Fc(e.adler,s.pending_buf,s.pending-i,i)),wl(e),0!==s.pending)return s.last_flush=-1,Jc;i=0}t=s.gzindex<s.gzhead.comment.length?255&s.gzhead.comment.charCodeAt(s.gzindex++):0,xl(s,t)}while(0!==t);s.gzhead.hcrc&&s.pending>i&&(e.adler=Fc(e.adler,s.pending_buf,s.pending-i,i))}s.status=103}if(103===s.status){if(s.gzhead.hcrc){if(s.pending+2>s.pending_buf_size&&(wl(e),0!==s.pending))return s.last_flush=-1,Jc;xl(s,255&e.adler),xl(s,e.adler>>8&255),e.adler=0}if(s.status=ul,wl(e),0!==s.pending)return s.last_flush=-1,Jc}if(0!==e.avail_in||0!==s.lookahead||t!==Wc&&s.status!==dl){let i=0===s.level?El(s,t):s.strategy===il?((e,t)=>{let s;for(;;){if(0===e.lookahead&&(Cl(e),0===e.lookahead)){if(t===Wc)return 1;break}if(e.match_length=0,s=Hc(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,s&&(_l(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===Gc?(_l(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(_l(e,!1),0===e.strm.avail_out)?1:2})(s,t):s.strategy===rl?((e,t)=>{let s,i,r,n;const a=e.window;for(;;){if(e.lookahead<=cl){if(Cl(e),e.lookahead<=cl&&t===Wc)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(r=e.strstart-1,i=a[r],i===a[++r]&&i===a[++r]&&i===a[++r])){n=e.strstart+cl;do{}while(i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&r<n);e.match_length=cl-(n-r),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(s=Hc(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(s=Hc(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),s&&(_l(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===Gc?(_l(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(_l(e,!1),0===e.strm.avail_out)?1:2})(s,t):Il[s.level].func(s,t);if(3!==i&&4!==i||(s.status=dl),1===i||3===i)return 0===e.avail_out&&(s.last_flush=-1),Jc;if(2===i&&(t===$c?Vc(s):t!==Yc&&(zc(s,0,0,!1),t===Kc&&(yl(s.head),0===s.lookahead&&(s.strstart=0,s.block_start=0,s.insert=0))),wl(e),0===e.avail_out))return s.last_flush=-1,Jc}return t!==Gc?Jc:s.wrap<=0?Zc:(2===s.wrap?(xl(s,255&e.adler),xl(s,e.adler>>8&255),xl(s,e.adler>>16&255),xl(s,e.adler>>24&255),xl(s,255&e.total_in),xl(s,e.total_in>>8&255),xl(s,e.total_in>>16&255),xl(s,e.total_in>>24&255)):(vl(s,e.adler>>>16),vl(s,65535&e.adler)),wl(e),s.wrap>0&&(s.wrap=-s.wrap),0!==s.pending?Jc:Zc)},deflateEnd:e=>{if(Ll(e))return Xc;const t=e.state.status;return e.state=null,t===ul?fl(e,Qc):Jc},deflateSetDictionary:(e,t)=>{let s=t.length;if(Ll(e))return Xc;const i=e.state,r=i.wrap;if(2===r||1===r&&i.status!==pl||i.lookahead)return Xc;if(1===r&&(e.adler=Mc(e.adler,t,s,0)),i.wrap=0,s>=i.w_size){0===r&&(yl(i.head),i.strstart=0,i.block_start=0,i.insert=0);let e=new Uint8Array(i.w_size);e.set(t.subarray(s-i.w_size,s),0),t=e,s=i.w_size}const n=e.avail_in,a=e.next_in,o=e.input;for(e.avail_in=s,e.next_in=0,e.input=t,Cl(i);i.lookahead>=3;){let e=i.strstart,t=i.lookahead-2;do{i.ins_h=bl(i,i.ins_h,i.window[e+3-1]),i.prev[e&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=e,e++}while(--t);i.strstart=e,i.lookahead=2,Cl(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,e.next_in=a,e.input=o,e.avail_in=n,i.wrap=r,Jc},deflateInfo:"pako deflate (from Nodeca project)"};const Fl=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var Bl={assign:function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const s=t.shift();if(s){if("object"!=typeof s)throw new TypeError(s+"must be non-object");for(const t in s)Fl(s,t)&&(e[t]=s[t])}}return e},flattenChunks:e=>{let t=0;for(let s=0,i=e.length;s<i;s++)t+=e[s].length;const s=new Uint8Array(t);for(let t=0,i=0,r=e.length;t<r;t++){let r=e[t];s.set(r,i),i+=r.length}return s}};let Ul=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){Ul=!1}const jl=new Uint8Array(256);for(let e=0;e<256;e++)jl[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;jl[254]=jl[254]=1;var zl={string2buf:e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,s,i,r,n,a=e.length,o=0;for(r=0;r<a;r++)s=e.charCodeAt(r),55296==(64512&s)&&r+1<a&&(i=e.charCodeAt(r+1),56320==(64512&i)&&(s=65536+(s-55296<<10)+(i-56320),r++)),o+=s<128?1:s<2048?2:s<65536?3:4;for(t=new Uint8Array(o),n=0,r=0;n<o;r++)s=e.charCodeAt(r),55296==(64512&s)&&r+1<a&&(i=e.charCodeAt(r+1),56320==(64512&i)&&(s=65536+(s-55296<<10)+(i-56320),r++)),s<128?t[n++]=s:s<2048?(t[n++]=192|s>>>6,t[n++]=128|63&s):s<65536?(t[n++]=224|s>>>12,t[n++]=128|s>>>6&63,t[n++]=128|63&s):(t[n++]=240|s>>>18,t[n++]=128|s>>>12&63,t[n++]=128|s>>>6&63,t[n++]=128|63&s);return t},buf2string:(e,t)=>{const s=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let i,r;const n=new Array(2*s);for(r=0,i=0;i<s;){let t=e[i++];if(t<128){n[r++]=t;continue}let a=jl[t];if(a>4)n[r++]=65533,i+=a-1;else{for(t&=2===a?31:3===a?15:7;a>1&&i<s;)t=t<<6|63&e[i++],a--;a>1?n[r++]=65533:t<65536?n[r++]=t:(t-=65536,n[r++]=55296|t>>10&1023,n[r++]=56320|1023&t)}}return((e,t)=>{if(t<65534&&e.subarray&&Ul)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let s="";for(let i=0;i<t;i++)s+=String.fromCharCode(e[i]);return s})(n,r)},utf8border:(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let s=t-1;for(;s>=0&&128==(192&e[s]);)s--;return s<0||0===s?t:s+jl[e[s]]>t?s:t}},ql=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const Hl=Object.prototype.toString,{Z_NO_FLUSH:Vl,Z_SYNC_FLUSH:Wl,Z_FULL_FLUSH:$l,Z_FINISH:Kl,Z_OK:Gl,Z_STREAM_END:Yl,Z_DEFAULT_COMPRESSION:Jl,Z_DEFAULT_STRATEGY:Zl,Z_DEFLATED:Xl}=Uc;function Ql(e){this.options=Bl.assign({level:Jl,method:Xl,chunkSize:16384,windowBits:15,memLevel:8,strategy:Zl},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ql,this.strm.avail_out=0;let s=Rl.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(s!==Gl)throw new Error(Bc[s]);if(t.header&&Rl.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?zl.string2buf(t.dictionary):"[object ArrayBuffer]"===Hl.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,s=Rl.deflateSetDictionary(this.strm,e),s!==Gl)throw new Error(Bc[s]);this._dict_set=!0}}function ep(e,t){const s=new Ql(t);if(s.push(e,!0),s.err)throw s.msg||Bc[s.err];return s.result}Ql.prototype.push=function(e,t){const s=this.strm,i=this.options.chunkSize;let r,n;if(this.ended)return!1;for(n=t===~~t?t:!0===t?Kl:Vl,"string"==typeof e?s.input=zl.string2buf(e):"[object ArrayBuffer]"===Hl.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;;)if(0===s.avail_out&&(s.output=new Uint8Array(i),s.next_out=0,s.avail_out=i),(n===Wl||n===$l)&&s.avail_out<=6)this.onData(s.output.subarray(0,s.next_out)),s.avail_out=0;else{if(r=Rl.deflate(s,n),r===Yl)return s.next_out>0&&this.onData(s.output.subarray(0,s.next_out)),r=Rl.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===Gl;if(0!==s.avail_out){if(n>0&&s.next_out>0)this.onData(s.output.subarray(0,s.next_out)),s.avail_out=0;else if(0===s.avail_in)break}else this.onData(s.output)}return!0},Ql.prototype.onData=function(e){this.chunks.push(e)},Ql.prototype.onEnd=function(e){e===Gl&&(this.result=Bl.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var tp={Deflate:Ql,deflate:ep,deflateRaw:function(e,t){return(t=t||{}).raw=!0,ep(e,t)},gzip:function(e,t){return(t=t||{}).gzip=!0,ep(e,t)},constants:Uc};const sp=16209;var ip=function(e,t){let s,i,r,n,a,o,h,c,l,p,u,d,f,m,y,g,b,w,_,x,v,P,T,C;const E=e.state;s=e.next_in,T=e.input,i=s+(e.avail_in-5),r=e.next_out,C=e.output,n=r-(t-e.avail_out),a=r+(e.avail_out-257),o=E.dmax,h=E.wsize,c=E.whave,l=E.wnext,p=E.window,u=E.hold,d=E.bits,f=E.lencode,m=E.distcode,y=(1<<E.lenbits)-1,g=(1<<E.distbits)-1;e:do{d<15&&(u+=T[s++]<<d,d+=8,u+=T[s++]<<d,d+=8),b=f[u&y];t:for(;;){if(w=b>>>24,u>>>=w,d-=w,w=b>>>16&255,0===w)C[r++]=65535&b;else{if(!(16&w)){if(0==(64&w)){b=f[(65535&b)+(u&(1<<w)-1)];continue t}if(32&w){E.mode=16191;break e}e.msg="invalid literal/length code",E.mode=sp;break e}_=65535&b,w&=15,w&&(d<w&&(u+=T[s++]<<d,d+=8),_+=u&(1<<w)-1,u>>>=w,d-=w),d<15&&(u+=T[s++]<<d,d+=8,u+=T[s++]<<d,d+=8),b=m[u&g];s:for(;;){if(w=b>>>24,u>>>=w,d-=w,w=b>>>16&255,!(16&w)){if(0==(64&w)){b=m[(65535&b)+(u&(1<<w)-1)];continue s}e.msg="invalid distance code",E.mode=sp;break e}if(x=65535&b,w&=15,d<w&&(u+=T[s++]<<d,d+=8,d<w&&(u+=T[s++]<<d,d+=8)),x+=u&(1<<w)-1,x>o){e.msg="invalid distance too far back",E.mode=sp;break e}if(u>>>=w,d-=w,w=r-n,x>w){if(w=x-w,w>c&&E.sane){e.msg="invalid distance too far back",E.mode=sp;break e}if(v=0,P=p,0===l){if(v+=h-w,w<_){_-=w;do{C[r++]=p[v++]}while(--w);v=r-x,P=C}}else if(l<w){if(v+=h+l-w,w-=l,w<_){_-=w;do{C[r++]=p[v++]}while(--w);if(v=0,l<_){w=l,_-=w;do{C[r++]=p[v++]}while(--w);v=r-x,P=C}}}else if(v+=l-w,w<_){_-=w;do{C[r++]=p[v++]}while(--w);v=r-x,P=C}for(;_>2;)C[r++]=P[v++],C[r++]=P[v++],C[r++]=P[v++],_-=3;_&&(C[r++]=P[v++],_>1&&(C[r++]=P[v++]))}else{v=r-x;do{C[r++]=C[v++],C[r++]=C[v++],C[r++]=C[v++],_-=3}while(_>2);_&&(C[r++]=C[v++],_>1&&(C[r++]=C[v++]))}break}}break}}while(s<i&&r<a);_=d>>3,s-=_,d-=_<<3,u&=(1<<d)-1,e.next_in=s,e.next_out=r,e.avail_in=s<i?i-s+5:5-(s-i),e.avail_out=r<a?a-r+257:257-(r-a),E.hold=u,E.bits=d};const rp=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),np=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),ap=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),op=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var hp=(e,t,s,i,r,n,a,o)=>{const h=o.bits;let c,l,p,u,d,f,m=0,y=0,g=0,b=0,w=0,_=0,x=0,v=0,P=0,T=0,C=null;const E=new Uint16Array(16),k=new Uint16Array(16);let A,S,I,N=null;for(m=0;m<=15;m++)E[m]=0;for(y=0;y<i;y++)E[t[s+y]]++;for(w=h,b=15;b>=1&&0===E[b];b--);if(w>b&&(w=b),0===b)return r[n++]=20971520,r[n++]=20971520,o.bits=1,0;for(g=1;g<b&&0===E[g];g++);for(w<g&&(w=g),v=1,m=1;m<=15;m++)if(v<<=1,v-=E[m],v<0)return-1;if(v>0&&(0===e||1!==b))return-1;for(k[1]=0,m=1;m<15;m++)k[m+1]=k[m]+E[m];for(y=0;y<i;y++)0!==t[s+y]&&(a[k[t[s+y]]++]=y);if(0===e?(C=N=a,f=20):1===e?(C=rp,N=np,f=257):(C=ap,N=op,f=0),T=0,y=0,m=g,d=n,_=w,x=0,p=-1,P=1<<w,u=P-1,1===e&&P>852||2===e&&P>592)return 1;for(;;){A=m-x,a[y]+1<f?(S=0,I=a[y]):a[y]>=f?(S=N[a[y]-f],I=C[a[y]-f]):(S=96,I=0),c=1<<m-x,l=1<<_,g=l;do{l-=c,r[d+(T>>x)+l]=A<<24|S<<16|I|0}while(0!==l);for(c=1<<m-1;T&c;)c>>=1;if(0!==c?(T&=c-1,T+=c):T=0,y++,0==--E[m]){if(m===b)break;m=t[s+a[y]]}if(m>w&&(T&u)!==p){for(0===x&&(x=w),d+=g,_=m-x,v=1<<_;_+x<b&&(v-=E[_+x],!(v<=0));)_++,v<<=1;if(P+=1<<_,1===e&&P>852||2===e&&P>592)return 1;p=T&u,r[p]=w<<24|_<<16|d-n|0}}return 0!==T&&(r[d+T]=m-x<<24|64<<16|0),o.bits=w,0};const{Z_FINISH:cp,Z_BLOCK:lp,Z_TREES:pp,Z_OK:up,Z_STREAM_END:dp,Z_NEED_DICT:fp,Z_STREAM_ERROR:mp,Z_DATA_ERROR:yp,Z_MEM_ERROR:gp,Z_BUF_ERROR:bp,Z_DEFLATED:wp}=Uc,_p=16180,xp=16190,vp=16191,Pp=16192,Tp=16194,Cp=16199,Ep=16200,kp=16206,Ap=16209,Sp=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function Ip(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Np=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<_p||t.mode>16211?1:0},Lp=e=>{if(Np(e))return mp;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=_p,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,up},Dp=e=>{if(Np(e))return mp;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,Lp(e)},Op=(e,t)=>{let s;if(Np(e))return mp;const i=e.state;return t<0?(s=0,t=-t):(s=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?mp:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=s,i.wbits=t,Dp(e))},Mp=(e,t)=>{if(!e)return mp;const s=new Ip;e.state=s,s.strm=e,s.window=null,s.mode=_p;const i=Op(e,t);return i!==up&&(e.state=null),i};let Rp,Fp,Bp=!0;const Up=e=>{if(Bp){Rp=new Int32Array(512),Fp=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(hp(1,e.lens,0,288,Rp,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;hp(2,e.lens,0,32,Fp,0,e.work,{bits:5}),Bp=!1}e.lencode=Rp,e.lenbits=9,e.distcode=Fp,e.distbits=5},jp=(e,t,s,i)=>{let r;const n=e.state;return null===n.window&&(n.wsize=1<<n.wbits,n.wnext=0,n.whave=0,n.window=new Uint8Array(n.wsize)),i>=n.wsize?(n.window.set(t.subarray(s-n.wsize,s),0),n.wnext=0,n.whave=n.wsize):(r=n.wsize-n.wnext,r>i&&(r=i),n.window.set(t.subarray(s-i,s-i+r),n.wnext),(i-=r)?(n.window.set(t.subarray(s-i,s),0),n.wnext=i,n.whave=n.wsize):(n.wnext+=r,n.wnext===n.wsize&&(n.wnext=0),n.whave<n.wsize&&(n.whave+=r))),0};var zp={inflateReset:Dp,inflateReset2:Op,inflateResetKeep:Lp,inflateInit:e=>Mp(e,15),inflateInit2:Mp,inflate:(e,t)=>{let s,i,r,n,a,o,h,c,l,p,u,d,f,m,y,g,b,w,_,x,v,P,T=0;const C=new Uint8Array(4);let E,k;const A=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Np(e)||!e.output||!e.input&&0!==e.avail_in)return mp;s=e.state,s.mode===vp&&(s.mode=Pp),a=e.next_out,r=e.output,h=e.avail_out,n=e.next_in,i=e.input,o=e.avail_in,c=s.hold,l=s.bits,p=o,u=h,P=up;e:for(;;)switch(s.mode){case _p:if(0===s.wrap){s.mode=Pp;break}for(;l<16;){if(0===o)break e;o--,c+=i[n++]<<l,l+=8}if(2&s.wrap&&35615===c){0===s.wbits&&(s.wbits=15),s.check=0,C[0]=255&c,C[1]=c>>>8&255,s.check=Fc(s.check,C,2,0),c=0,l=0,s.mode=16181;break}if(s.head&&(s.head.done=!1),!(1&s.wrap)||(((255&c)<<8)+(c>>8))%31){e.msg="incorrect header check",s.mode=Ap;break}if((15&c)!==wp){e.msg="unknown compression method",s.mode=Ap;break}if(c>>>=4,l-=4,v=8+(15&c),0===s.wbits&&(s.wbits=v),v>15||v>s.wbits){e.msg="invalid window size",s.mode=Ap;break}s.dmax=1<<s.wbits,s.flags=0,e.adler=s.check=1,s.mode=512&c?16189:vp,c=0,l=0;break;case 16181:for(;l<16;){if(0===o)break e;o--,c+=i[n++]<<l,l+=8}if(s.flags=c,(255&s.flags)!==wp){e.msg="unknown compression method",s.mode=Ap;break}if(57344&s.flags){e.msg="unknown header flags set",s.mode=Ap;break}s.head&&(s.head.text=c>>8&1),512&s.flags&&4&s.wrap&&(C[0]=255&c,C[1]=c>>>8&255,s.check=Fc(s.check,C,2,0)),c=0,l=0,s.mode=16182;case 16182:for(;l<32;){if(0===o)break e;o--,c+=i[n++]<<l,l+=8}s.head&&(s.head.time=c),512&s.flags&&4&s.wrap&&(C[0]=255&c,C[1]=c>>>8&255,C[2]=c>>>16&255,C[3]=c>>>24&255,s.check=Fc(s.check,C,4,0)),c=0,l=0,s.mode=16183;case 16183:for(;l<16;){if(0===o)break e;o--,c+=i[n++]<<l,l+=8}s.head&&(s.head.xflags=255&c,s.head.os=c>>8),512&s.flags&&4&s.wrap&&(C[0]=255&c,C[1]=c>>>8&255,s.check=Fc(s.check,C,2,0)),c=0,l=0,s.mode=16184;case 16184:if(1024&s.flags){for(;l<16;){if(0===o)break e;o--,c+=i[n++]<<l,l+=8}s.length=c,s.head&&(s.head.extra_len=c),512&s.flags&&4&s.wrap&&(C[0]=255&c,C[1]=c>>>8&255,s.check=Fc(s.check,C,2,0)),c=0,l=0}else s.head&&(s.head.extra=null);s.mode=16185;case 16185:if(1024&s.flags&&(d=s.length,d>o&&(d=o),d&&(s.head&&(v=s.head.extra_len-s.length,s.head.extra||(s.head.extra=new Uint8Array(s.head.extra_len)),s.head.extra.set(i.subarray(n,n+d),v)),512&s.flags&&4&s.wrap&&(s.check=Fc(s.check,i,d,n)),o-=d,n+=d,s.length-=d),s.length))break e;s.length=0,s.mode=16186;case 16186:if(2048&s.flags){if(0===o)break e;d=0;do{v=i[n+d++],s.head&&v&&s.length<65536&&(s.head.name+=String.fromCharCode(v))}while(v&&d<o);if(512&s.flags&&4&s.wrap&&(s.check=Fc(s.check,i,d,n)),o-=d,n+=d,v)break e}else s.head&&(s.head.name=null);s.length=0,s.mode=16187;case 16187:if(4096&s.flags){if(0===o)break e;d=0;do{v=i[n+d++],s.head&&v&&s.length<65536&&(s.head.comment+=String.fromCharCode(v))}while(v&&d<o);if(512&s.flags&&4&s.wrap&&(s.check=Fc(s.check,i,d,n)),o-=d,n+=d,v)break e}else s.head&&(s.head.comment=null);s.mode=16188;case 16188:if(512&s.flags){for(;l<16;){if(0===o)break e;o--,c+=i[n++]<<l,l+=8}if(4&s.wrap&&c!==(65535&s.check)){e.msg="header crc mismatch",s.mode=Ap;break}c=0,l=0}s.head&&(s.head.hcrc=s.flags>>9&1,s.head.done=!0),e.adler=s.check=0,s.mode=vp;break;case 16189:for(;l<32;){if(0===o)break e;o--,c+=i[n++]<<l,l+=8}e.adler=s.check=Sp(c),c=0,l=0,s.mode=xp;case xp:if(0===s.havedict)return e.next_out=a,e.avail_out=h,e.next_in=n,e.avail_in=o,s.hold=c,s.bits=l,fp;e.adler=s.check=1,s.mode=vp;case vp:if(t===lp||t===pp)break e;case Pp:if(s.last){c>>>=7&l,l-=7&l,s.mode=kp;break}for(;l<3;){if(0===o)break e;o--,c+=i[n++]<<l,l+=8}switch(s.last=1&c,c>>>=1,l-=1,3&c){case 0:s.mode=16193;break;case 1:if(Up(s),s.mode=Cp,t===pp){c>>>=2,l-=2;break e}break;case 2:s.mode=16196;break;case 3:e.msg="invalid block type",s.mode=Ap}c>>>=2,l-=2;break;case 16193:for(c>>>=7&l,l-=7&l;l<32;){if(0===o)break e;o--,c+=i[n++]<<l,l+=8}if((65535&c)!=(c>>>16^65535)){e.msg="invalid stored block lengths",s.mode=Ap;break}if(s.length=65535&c,c=0,l=0,s.mode=Tp,t===pp)break e;case Tp:s.mode=16195;case 16195:if(d=s.length,d){if(d>o&&(d=o),d>h&&(d=h),0===d)break e;r.set(i.subarray(n,n+d),a),o-=d,n+=d,h-=d,a+=d,s.length-=d;break}s.mode=vp;break;case 16196:for(;l<14;){if(0===o)break e;o--,c+=i[n++]<<l,l+=8}if(s.nlen=257+(31&c),c>>>=5,l-=5,s.ndist=1+(31&c),c>>>=5,l-=5,s.ncode=4+(15&c),c>>>=4,l-=4,s.nlen>286||s.ndist>30){e.msg="too many length or distance symbols",s.mode=Ap;break}s.have=0,s.mode=16197;case 16197:for(;s.have<s.ncode;){for(;l<3;){if(0===o)break e;o--,c+=i[n++]<<l,l+=8}s.lens[A[s.have++]]=7&c,c>>>=3,l-=3}for(;s.have<19;)s.lens[A[s.have++]]=0;if(s.lencode=s.lendyn,s.lenbits=7,E={bits:s.lenbits},P=hp(0,s.lens,0,19,s.lencode,0,s.work,E),s.lenbits=E.bits,P){e.msg="invalid code lengths set",s.mode=Ap;break}s.have=0,s.mode=16198;case 16198:for(;s.have<s.nlen+s.ndist;){for(;T=s.lencode[c&(1<<s.lenbits)-1],y=T>>>24,g=T>>>16&255,b=65535&T,!(y<=l);){if(0===o)break e;o--,c+=i[n++]<<l,l+=8}if(b<16)c>>>=y,l-=y,s.lens[s.have++]=b;else{if(16===b){for(k=y+2;l<k;){if(0===o)break e;o--,c+=i[n++]<<l,l+=8}if(c>>>=y,l-=y,0===s.have){e.msg="invalid bit length repeat",s.mode=Ap;break}v=s.lens[s.have-1],d=3+(3&c),c>>>=2,l-=2}else if(17===b){for(k=y+3;l<k;){if(0===o)break e;o--,c+=i[n++]<<l,l+=8}c>>>=y,l-=y,v=0,d=3+(7&c),c>>>=3,l-=3}else{for(k=y+7;l<k;){if(0===o)break e;o--,c+=i[n++]<<l,l+=8}c>>>=y,l-=y,v=0,d=11+(127&c),c>>>=7,l-=7}if(s.have+d>s.nlen+s.ndist){e.msg="invalid bit length repeat",s.mode=Ap;break}for(;d--;)s.lens[s.have++]=v}}if(s.mode===Ap)break;if(0===s.lens[256]){e.msg="invalid code -- missing end-of-block",s.mode=Ap;break}if(s.lenbits=9,E={bits:s.lenbits},P=hp(1,s.lens,0,s.nlen,s.lencode,0,s.work,E),s.lenbits=E.bits,P){e.msg="invalid literal/lengths set",s.mode=Ap;break}if(s.distbits=6,s.distcode=s.distdyn,E={bits:s.distbits},P=hp(2,s.lens,s.nlen,s.ndist,s.distcode,0,s.work,E),s.distbits=E.bits,P){e.msg="invalid distances set",s.mode=Ap;break}if(s.mode=Cp,t===pp)break e;case Cp:s.mode=Ep;case Ep:if(o>=6&&h>=258){e.next_out=a,e.avail_out=h,e.next_in=n,e.avail_in=o,s.hold=c,s.bits=l,ip(e,u),a=e.next_out,r=e.output,h=e.avail_out,n=e.next_in,i=e.input,o=e.avail_in,c=s.hold,l=s.bits,s.mode===vp&&(s.back=-1);break}for(s.back=0;T=s.lencode[c&(1<<s.lenbits)-1],y=T>>>24,g=T>>>16&255,b=65535&T,!(y<=l);){if(0===o)break e;o--,c+=i[n++]<<l,l+=8}if(g&&0==(240&g)){for(w=y,_=g,x=b;T=s.lencode[x+((c&(1<<w+_)-1)>>w)],y=T>>>24,g=T>>>16&255,b=65535&T,!(w+y<=l);){if(0===o)break e;o--,c+=i[n++]<<l,l+=8}c>>>=w,l-=w,s.back+=w}if(c>>>=y,l-=y,s.back+=y,s.length=b,0===g){s.mode=16205;break}if(32&g){s.back=-1,s.mode=vp;break}if(64&g){e.msg="invalid literal/length code",s.mode=Ap;break}s.extra=15&g,s.mode=16201;case 16201:if(s.extra){for(k=s.extra;l<k;){if(0===o)break e;o--,c+=i[n++]<<l,l+=8}s.length+=c&(1<<s.extra)-1,c>>>=s.extra,l-=s.extra,s.back+=s.extra}s.was=s.length,s.mode=16202;case 16202:for(;T=s.distcode[c&(1<<s.distbits)-1],y=T>>>24,g=T>>>16&255,b=65535&T,!(y<=l);){if(0===o)break e;o--,c+=i[n++]<<l,l+=8}if(0==(240&g)){for(w=y,_=g,x=b;T=s.distcode[x+((c&(1<<w+_)-1)>>w)],y=T>>>24,g=T>>>16&255,b=65535&T,!(w+y<=l);){if(0===o)break e;o--,c+=i[n++]<<l,l+=8}c>>>=w,l-=w,s.back+=w}if(c>>>=y,l-=y,s.back+=y,64&g){e.msg="invalid distance code",s.mode=Ap;break}s.offset=b,s.extra=15&g,s.mode=16203;case 16203:if(s.extra){for(k=s.extra;l<k;){if(0===o)break e;o--,c+=i[n++]<<l,l+=8}s.offset+=c&(1<<s.extra)-1,c>>>=s.extra,l-=s.extra,s.back+=s.extra}if(s.offset>s.dmax){e.msg="invalid distance too far back",s.mode=Ap;break}s.mode=16204;case 16204:if(0===h)break e;if(d=u-h,s.offset>d){if(d=s.offset-d,d>s.whave&&s.sane){e.msg="invalid distance too far back",s.mode=Ap;break}d>s.wnext?(d-=s.wnext,f=s.wsize-d):f=s.wnext-d,d>s.length&&(d=s.length),m=s.window}else m=r,f=a-s.offset,d=s.length;d>h&&(d=h),h-=d,s.length-=d;do{r[a++]=m[f++]}while(--d);0===s.length&&(s.mode=Ep);break;case 16205:if(0===h)break e;r[a++]=s.length,h--,s.mode=Ep;break;case kp:if(s.wrap){for(;l<32;){if(0===o)break e;o--,c|=i[n++]<<l,l+=8}if(u-=h,e.total_out+=u,s.total+=u,4&s.wrap&&u&&(e.adler=s.check=s.flags?Fc(s.check,r,u,a-u):Mc(s.check,r,u,a-u)),u=h,4&s.wrap&&(s.flags?c:Sp(c))!==s.check){e.msg="incorrect data check",s.mode=Ap;break}c=0,l=0}s.mode=16207;case 16207:if(s.wrap&&s.flags){for(;l<32;){if(0===o)break e;o--,c+=i[n++]<<l,l+=8}if(4&s.wrap&&c!==(4294967295&s.total)){e.msg="incorrect length check",s.mode=Ap;break}c=0,l=0}s.mode=16208;case 16208:P=dp;break e;case Ap:P=yp;break e;case 16210:return gp;default:return mp}return e.next_out=a,e.avail_out=h,e.next_in=n,e.avail_in=o,s.hold=c,s.bits=l,(s.wsize||u!==e.avail_out&&s.mode<Ap&&(s.mode<kp||t!==cp))&&jp(e,e.output,e.next_out,u-e.avail_out),p-=e.avail_in,u-=e.avail_out,e.total_in+=p,e.total_out+=u,s.total+=u,4&s.wrap&&u&&(e.adler=s.check=s.flags?Fc(s.check,r,u,e.next_out-u):Mc(s.check,r,u,e.next_out-u)),e.data_type=s.bits+(s.last?64:0)+(s.mode===vp?128:0)+(s.mode===Cp||s.mode===Tp?256:0),(0===p&&0===u||t===cp)&&P===up&&(P=bp),P},inflateEnd:e=>{if(Np(e))return mp;let t=e.state;return t.window&&(t.window=null),e.state=null,up},inflateGetHeader:(e,t)=>{if(Np(e))return mp;const s=e.state;return 0==(2&s.wrap)?mp:(s.head=t,t.done=!1,up)},inflateSetDictionary:(e,t)=>{const s=t.length;let i,r,n;return Np(e)?mp:(i=e.state,0!==i.wrap&&i.mode!==xp?mp:i.mode===xp&&(r=1,r=Mc(r,t,s,0),r!==i.check)?yp:(n=jp(e,t,s,s),n?(i.mode=16210,gp):(i.havedict=1,up)))},inflateInfo:"pako inflate (from Nodeca project)"},qp=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const Hp=Object.prototype.toString,{Z_NO_FLUSH:Vp,Z_FINISH:Wp,Z_OK:$p,Z_STREAM_END:Kp,Z_NEED_DICT:Gp,Z_STREAM_ERROR:Yp,Z_DATA_ERROR:Jp,Z_MEM_ERROR:Zp}=Uc;function Xp(e){this.options=Bl.assign({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ql,this.strm.avail_out=0;let s=zp.inflateInit2(this.strm,t.windowBits);if(s!==$p)throw new Error(Bc[s]);if(this.header=new qp,zp.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=zl.string2buf(t.dictionary):"[object ArrayBuffer]"===Hp.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(s=zp.inflateSetDictionary(this.strm,t.dictionary),s!==$p)))throw new Error(Bc[s])}function Qp(e,t){const s=new Xp(t);if(s.push(e),s.err)throw s.msg||Bc[s.err];return s.result}Xp.prototype.push=function(e,t){const s=this.strm,i=this.options.chunkSize,r=this.options.dictionary;let n,a,o;if(this.ended)return!1;for(a=t===~~t?t:!0===t?Wp:Vp,"[object ArrayBuffer]"===Hp.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;;){for(0===s.avail_out&&(s.output=new Uint8Array(i),s.next_out=0,s.avail_out=i),n=zp.inflate(s,a),n===Gp&&r&&(n=zp.inflateSetDictionary(s,r),n===$p?n=zp.inflate(s,a):n===Jp&&(n=Gp));s.avail_in>0&&n===Kp&&s.state.wrap>0&&0!==e[s.next_in];)zp.inflateReset(s),n=zp.inflate(s,a);switch(n){case Yp:case Jp:case Gp:case Zp:return this.onEnd(n),this.ended=!0,!1}if(o=s.avail_out,s.next_out&&(0===s.avail_out||n===Kp))if("string"===this.options.to){let e=zl.utf8border(s.output,s.next_out),t=s.next_out-e,r=zl.buf2string(s.output,e);s.next_out=t,s.avail_out=i-t,t&&s.output.set(s.output.subarray(e,e+t),0),this.onData(r)}else this.onData(s.output.length===s.next_out?s.output:s.output.subarray(0,s.next_out));if(n!==$p||0!==o){if(n===Kp)return n=zp.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,!0;if(0===s.avail_in)break}}return!0},Xp.prototype.onData=function(e){this.chunks.push(e)},Xp.prototype.onEnd=function(e){e===$p&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Bl.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var eu={Inflate:Xp,inflate:Qp,inflateRaw:function(e,t){return(t=t||{}).raw=!0,Qp(e,t)},ungzip:Qp,constants:Uc};const{Deflate:tu,deflate:su,deflateRaw:iu,gzip:ru}=tp,{Inflate:nu,inflate:au,inflateRaw:ou,ungzip:hu}=eu;var cu=su,lu=au;const pu={encode:e=>{const t=Array.from(e).map((e=>e.codePointAt(0)||0)),s=[];for(const e of t)e<=127?s.push(e):e<=2047?(s.push(e>>6|192),s.push(63&e|128)):e<=65535?(s.push(e>>12|224),s.push(e>>6&63|128),s.push(63&e|128)):e<=1114111&&(s.push(e>>18|240),s.push(e>>12&63|128),s.push(e>>6&63|128),s.push(63&e|128));return Uint8Array.from(s).buffer},decode:e=>{const t=new Uint8Array(e);let s="",i=0;for(;i<t.length;){const e=t[i];if(0==(128&e))s+=String.fromCharCode(e),i+=1;else if(192==(224&e)){const r=t[i+1];s+=String.fromCharCode((31&e)<<6|63&r),i+=2}else if(224==(240&e)){const r=t[i+1],n=t[i+2];s+=String.fromCharCode((15&e)<<12|(63&r)<<6|63&n),i+=3}else if(240==(248&e)){const r=(7&e)<<18|(63&t[i+1])<<12|(63&t[i+2])<<6|63&t[i+3];s+=r<=1114111?String.fromCodePoint(r):"�",i+=4}else s+="�",i+=1}return s}},uu=pu;var du,fu,mu=function(e,t,s,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(e,s):r?r.value=s:t.set(e,s),s},yu=function(e,t,s,i){if("a"===s&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?i:"a"===s?i.call(e):i?i.value:t.get(e)};du=new WeakMap,fu=new WeakMap;const gu=class{constructor(e){du.set(this,void 0),fu.set(this,0),ArrayBuffer.isView(e)?mu(this,du,e.buffer,"f"):mu(this,du,new DataView(e,0,0).buffer,"f")}read(){var e,t;return new Uint8Array(yu(this,du,"f"))[(mu(this,fu,(t=yu(this,fu,"f"),e=t++,t),"f"),e)]}readNBytes(e){const t=yu(this,du,"f"),s=t.byteLength,i=yu(this,fu,"f");if(i>=s)return new ArrayBuffer(0);const r=mu(this,fu,yu(this,fu,"f")+e,"f");return r>s?t.slice(i,s):t.slice(i,r)}};var bu,wu=function(e,t,s,i){if("a"===s&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?i:"a"===s?i.call(e):i?i.value:t.get(e)};bu=new WeakMap;const _u=class{constructor(){bu.set(this,[])}write(e){const t=wu(this,bu,"f");switch(typeof e){case"number":t.push(e);break;case"object":Array.isArray(e)?t.push(Uint8Array.from(e).buffer):ArrayBuffer.isView(e)?t.push(e.buffer):t.push(new DataView(e,0,0).buffer);break;default:throw new Error("Invalid value: "+e)}}toArrayBuffer(e){const t=wu(this,bu,"f");if((e||(e=0))<=0)for(const s of t)e+="number"==typeof s?1:s.byteLength;const s=new Uint8Array(new ArrayBuffer(e),0,e);e=0;for(const i of t){if("number"==typeof i){s[e++]=i;continue}const t=i.byteLength;s.set(new Uint8Array(i,0,t),e),e+=t}return s.buffer}};function xu(e){try{return new DataView(e,0,0),!0}catch(e){return!1}}function vu(e){const t=e.buffer,s=e.byteOffset,i=e.byteLength;return 0===s&&i===t.byteLength?t:t.slice(s,s+i)}function Pu(e,t){const s=uu.encode(t),i=new DataView(new ArrayBuffer(4),0,4);i.setUint32(0,s.byteLength,!0),e.write(i),e.write(s)}function Tu(e,t){const s=new DataView(new ArrayBuffer(5),0,5);s.setUint8(0,102),s.setUint32(1,t.byteLength,!0),e.write(s),e.write(t)}function Cu(e,t){switch(typeof t){case"string":e.write(101),Pu(e,t);break;case"boolean":e.write([10,t?1:0]);break;case"undefined":e.write(0);break;case"number":{if(Number.isSafeInteger(t))if(t>=0){if(t<=255){const s=new DataView(new ArrayBuffer(2),0,2);return s.setUint8(0,10),s.setUint8(1,t),void e.write(s)}if(t<=65535){const s=new DataView(new ArrayBuffer(3),0,3);return s.setUint8(0,11),s.setUint16(1,t,!0),void e.write(s)}if(t<=4294967295){const s=new DataView(new ArrayBuffer(5),0,5);return s.setUint8(0,12),s.setUint32(1,t,!0),void e.write(s)}}else{if(t>=-128&&t<128){const s=new DataView(new ArrayBuffer(2),0,2);return s.setUint8(0,20),s.setInt8(1,t),void e.write(s)}if(t>=-32768&&t<32768){const s=new DataView(new ArrayBuffer(3),0,3);return s.setUint8(0,21),s.setInt16(1,t,!0),void e.write(s)}if(t>=-2147483648&&t<2147483648){const s=new DataView(new ArrayBuffer(5),0,5);return s.setUint8(0,22),s.setInt32(1,t,!0),void e.write(s)}}const s=new DataView(new ArrayBuffer(9),0,9);s.setUint8(0,33),s.setFloat64(1,t,!0),e.write(s)}break;case"bigint":{const s=new DataView(new ArrayBuffer(9),0,9);t>=0n?(s.setUint8(0,13),s.setBigUint64(1,t,!0)):(s.setUint8(0,23),s.setBigUint64(1,t,!0)),e.write(s)}break;case"object":null===t?e.write(255):Array.isArray(t)?function(e,t){const s=new DataView(new ArrayBuffer(5),0,5);s.setUint8(0,99),s.setUint32(1,t.length,!0),e.write(s);for(const s of t)Cu(e,s)}(e,t):xu(t)?Tu(e,t):ArrayBuffer.isView(t)?Tu(e,vu(t)):function(e,t){if("function"==typeof t.toJSON)return void Cu(e,t.toJSON());const s=Object.keys(t);{const t=new DataView(new ArrayBuffer(5),0,5);t.setUint8(0,100),t.setUint32(1,s.length,!0),e.write(t)}for(const i of s){const s=t[i];switch(typeof s){case"boolean":case"bigint":case"number":case"object":case"string":case"undefined":Pu(e,i),Cu(e,s)}}}(e,t)}}function Eu(e,t){if("object"!=typeof e||null==e)throw new Error("Data must be a non-null object or array.");if("object"!=typeof(t||(t={})))throw new Error("The options parameter must be an object.");{const t=new _u;Cu(t,e),e=t.toArrayBuffer()}const s=t.compressMethod||0,i=t.compressLevel||5;switch(s){case 0:break;case 1:e=cu(e,{raw:!0,level:i,memLevel:9,chunkSize:8192,windowBits:15});break;case 3:e=cu(e,{gzip:!0,level:i,memLevel:9,chunkSize:8192,windowBits:15});break;case 2:case 4:case 5:case 6:throw new Error("Not implemented");default:throw new Error("Unknown compress method: "+s)}const r=new Uint8Array(new ArrayBuffer(e.byteLength+7));return r[0]=128,r[1]=99,r[2]=98,r[3]=106,r[4]=102,r[5]=1,r[6]=s,r.set(new Uint8Array(e),7),r.buffer}function ku(e){const t=e.read();switch(t){case 0:return;case 255:return null;case 10:return e.read();case 11:return new DataView(e.readNBytes(2),0,2).getUint16(0,!0);case 12:return new DataView(e.readNBytes(4),0,4).getUint32(0,!0);case 13:return new DataView(e.readNBytes(8),0,8).getBigUint64(0,!0);case 20:return e.read()<<8>>8;case 21:return new DataView(e.readNBytes(2),0,2).getInt16(0,!0);case 22:return new DataView(e.readNBytes(4),0,4).getInt32(0,!0);case 23:return new DataView(e.readNBytes(8),0,8).getBigInt64(0,!0);case 32:return new DataView(e.readNBytes(4),0,4).getFloat32(0,!0);case 33:return new DataView(e.readNBytes(8),0,8).getFloat64(0,!0);case 99:return function(e){const t=new DataView(e.readNBytes(4),0,4).getUint32(0,!0),s=new Array(t);for(let i=0;i<t;i++)s[i]=ku(e);return s}(e);case 100:return function(e){const t=new DataView(e.readNBytes(4),0,4).getUint32(0,!0),s=Object.create(null);for(let i=0;i<t;i++)s[uu.decode(e.readNBytes(new DataView(e.readNBytes(4),0,4).getUint32(0,!0)))]=ku(e);return s}(e);case 101:return uu.decode(e.readNBytes(new DataView(e.readNBytes(4),0,4).getUint32(0,!0)));case 102:return e.readNBytes(new DataView(e.readNBytes(4),0,4).getUint32(0,!0));default:throw new Error("Parse Error: Invalid data ID: "+t)}}function Au(e,t){if("object"!=typeof(t||{}))throw new Error("The options parameter must be an object.");if(ArrayBuffer.isView(e)&&(e=vu(e)),!xu(e))throw new Error("The data parameter must be an ArrayBuffer.");{const t=new Uint8Array(e,0,e.byteLength);if(128!==t[0]||99!==t[1]||98!==t[2]||106!==t[3]||102!==t[4]||1!==t[5])throw new Error("Parse Error: Input data is not valid.");switch(t[6]){case 0:e=e.slice(7);break;case 1:e=lu(e.slice(7),{raw:!0,chunkSize:8192,windowBits:15}).buffer;break;case 3:e=lu(e.slice(7),{chunkSize:8192,windowBits:15}).buffer;break;case 2:case 4:case 5:case 6:throw new Error("Not implemented");default:throw new Error("Parse Error: Unknown compress method.")}}return ku(new gu(e))}Object.seal(Object.setPrototypeOf(t,null)),Object.freeze(Eu);const Su=Object.freeze(Au),Iu=Su(Gh.decode("gGNiamYBAZVW32/bNhAONmCY87C974lVsVZubclOmia142RtkmED0jVos3VDUwSURMmsaVGhKP9o6/99d6TkyE7SdQ+WSd7xeLz77jtG325sbGzCb7ybiSdXT4RU0TflUvhhdydLwtEVY4cwnXe6eqqz7GOwlVyFH5/u7SadbjeeTYruThjLvb0u392LxrtREuhkJ/4wn3ItxooXW8UM9qJFPtsabWXjp2LEfoSpV6QBl6HmxdgL5fg7WMoUi/mMfQ/DodZZ3vN9HF9eZkrGl5fspx82Nlw3aRHRIlGTDA7Ip82G/+jRZoM8Ir/oecbIp1MZUs1lusBFf7MRyjTXRMiQDIjo31A/lmExZqleVY+MetSv5oUSME/ZlPz5+tQV3hAcbS6lQwmfASp5OEzpmC1lUvGEp6XUTvqblZApJdUZTRjI3eo+jcR1fg7/ekmOGY3uOS3ihBIS07sfx3E/lqlu5/wj63WfZLNyqueC9VKpxlT0AxqOEiWLNIINnY7VmDKeDHXvKcwFT1l7aOfGhGBaM9XOMxryNOl1YMlpoovXoTABKu9//OrlGVU5U27Ty3Dwq5LjN1rBXvfh/uFsLMiEqRwSMHC6XschLA1lBNKBU+i4veeQw4OLdP/e8auj83/OTshQw46zP1+c/n5EnLbvv90+8v3j82Py92/nL09J1+v6/skfDnEQEICH6XTqTbchkol//tqf4fZuFzdUYy/SkYNHGMvgT5oPbtncffbsmd3iEEHRPZbitgu9P4S4mxGMx0xTEg7xonp5A39FiukeOBPOpplU2iEQNg3xGjhTHunhIGITHrK2mbR4yjWnop2HVLBBt2ZKQ7mwA4OFcxzu+3bFeOQvXdoPZDQv9xjlI3uaVSuFoA/3OngI0KFZJrgtCHvbxxARzG+jUSXWMwdBep0ThCPpuU4t/WgSS6FSxjnuxn+PpylTJk+wez/ik4PnJKaaCotsIsOwUIpFZDrkcETE80zQOYCB6CGrApUTGcOc5ySDC3n7PtqBS+DfmWA0Z0SrOSly3EfBSBwzhYAMlJwCEKHEAJl6KtWohWNUpgmFohMUkL00WL+VYqD1Qqf1m4WKgf6JYDhznaDQWqY2VJW6Byh4rgHsIGSuwyOszstLFegvKyLVoOpX2DTJQN3XKF9T1Wymy4RjxK3KigaNopMJiE95DlpQpU4I+R+BQcsvwIOeYpCFEM6qOBayo1me8QiiBXD1nWaLfIJs5DmfsB4EtGBk0VxmHTDF0ugIUhq51cGWMSCWXhXPMpDVaW+5HrrLWK8poe0FWjDU9xbdebN0B4ORyZwjhnuKQVLBq36JpV4ANxr1TXX1Yq7bJaj6JcXVlzIIDlLcDlDcmCpg4l4X6I7QQst+jWMD6IJM9bZBlEvBI3K/09mje7RGvlv/Tb6dzjbdpl/k360v8m8OHTQcEhcbB/Q/LcHFpmkQIdaE5TSnB/MGj4lrmtC9AcACIkIFTh2r3mjUTSBwbOINckoh1UPkMRT6tfWys+GfXazjxyiUjbBhMFio1IwX+Amgnkb9FXfz0t+lKGIxLYQ2i8tm6FqDS3uLWjDQk3oQ6tANY2P9pkCP7hBMWYBovkOKdJQbBN4uj7liAayCBXzA2KvVouas1ZWN6x3hvjuw13GtR6sK4WL5mEBXLJ952C68q4Kp+RsmWKgl8ACK36HVwYXjXzjvDbUgcOw+6O6FEOTzZ2PHS1ZJCaqFIZwMvi4DaJijElxrWVtJWgxs7JYvHSR5dG3Fq+dCuE4eKp6BcWuvSvQNF5BCm+ifU8HaZsSG3Y6RH/0PdEJLmzVRvRGua1zjcSXEDQYZGctJBcgbCK2lZnHdW3KFb8d1/2G1ch/1MfCw5AmWJnoI4R+QDkpZnePLe665cWed1J1YfbDiSTkkUeeGhh0fKJ4cLmuSPDZO9/DbKl+szcrL63eryX4ptZ5V8mtuGVyzS0U+1qEMT689kj2gbw5t1nPKWJbv9DIeVr8Mj1XAw8zqu1KpTbrv7YlYfdVxy2fruLJyrb/13poytkADHjARm72KXSeRMhEIsIMyESvSqtJLedMawZM0TwtmjS4s8/3PjJkd1p1wvWShV4zeQceDig1pKlPAr7gA+K9BC4saPKvF/paWDoc9eEBuOYRWpHDXVjwRUm/44eutJAC0IkBerBtsg8Hb7ZWPULxDrf+XWV1hlZVoLppu3iK0RYJm/18="));Object.setPrototypeOf(Iu,null),Object.freeze(Iu);const Nu=Iu,Lu=Jt({apiKey:"AIzaSyCPXTy7dt3fpcLd8kVTBtXy0xuBdeuhbFc",authDomain:"whitespider.firebaseapp.com",databaseURL:"https://whitespider-default-rtdb.firebaseio.com",projectId:"whitespider",storageBucket:"whitespider.appspot.com",messagingSenderId:"176227430389",appId:"1:176227430389:web:94270de43b7eb971c03abc",measurementId:"G-F72WBJT57S"}),Du=(function(e=Zt()){const t=Kt(e=at(e),Zs);t.isInitialized()?t.getImmediate():function(e,t={}){const s=Kt(e,Zs);if(s.isInitialized()){const e=s.getImmediate();if(Je(t,s.getOptions()))return e;throw ri.create("already-initialized")}s.initialize({options:t})}(e)}(Lu),function(e=Zt(),t){const s=Kt(e,"database").getImmediate({identifier:t});if(!s._instanceStarted){const e=(e=>{const t=(e=>{var t,s;return null===(s=null===(t=Oe())||void 0===t?void 0:t.emulatorHosts)||void 0===s?void 0:s[e]})(e);if(!t)return;const s=t.lastIndexOf(":");if(s<=0||s+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const i=parseInt(t.substring(s+1),10);return"["===t[0]?[t.substring(1,s-1),i]:[t.substring(0,s),i]})("database");e&&function(e,t,s,i={}){(e=at(e))._checkNotDeleted("useEmulator"),e._instanceStarted&&Vi("Cannot call useEmulator() after instance has already been initialized.");const r=e._repoInternal;let n;if(r.repoInfo_.nodeAdmin)i.mockUserToken&&Vi('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),n=new hr(hr.OWNER);else if(i.mockUserToken){const t="string"==typeof i.mockUserToken?i.mockUserToken:function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const s=t||"demo-project",i=e.iat||0,r=e.sub||e.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const n=Object.assign({iss:`https://securetoken.google.com/${s}`,aud:s,iat:i,exp:i+3600,auth_time:i,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Ie(JSON.stringify({alg:"none",type:"JWT"})),Ie(JSON.stringify(n)),""].join(".")}(i.mockUserToken,e.app.options.projectId);n=new hr(t)}!function(e,t,s,i){e.repoInfo_=new fr(`${t}:${s}`,!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams,!0),i&&(e.authTokenProvider_=i)}(r,t,s,n)}(s,...e)}return s}(Lu));(async({window:e,document:t})=>{var s;function i(e){const s=t.getElementById(e);if(null==s)throw new Error("Element does not exist: "+e);return s}function r(e){const s=t.querySelector(e);if(s instanceof HTMLElement)return s;throw new Error("Failed to query selector: "+e)}const n=e.location,a=e.history,o=i("error"),h=new DOMParser,c=new ec('"use strict";return(()=>[(...e)=>console.log(...e)])();').apply(void 0,[])[0];e.onerror=(e,t,s,i,r)=>{let n="Unhandled error at "+(t||"unknown source ");null!=s&&(n+=s),null!=i&&(n+=":"+i),null!=r&&(n+="\n\n"+r),o.textContent=n,o.style.display="block"},e.onkeydown=e=>{if(e.ctrlKey&&!e.altKey&&!e.metaKey&&!e.shiftKey)switch(e.key){case"q":e.preventDefault(),e.stopPropagation(),n.replace("https://www.google.com/webhp?igu=1");break;case"b":e.preventDefault(),e.stopPropagation();const{body:s}=t;s.hasAttribute("style")?s.removeAttribute("style"):s.setAttribute("style","filter: blur(15px);");break;case"h":e.preventDefault(),e.stopPropagation(),"WhiteSpider"===t.title?(t.title="Google",r("link[rel*='icon']").href="/res/google.ico"):(t.title="WhiteSpider",r("link[rel*='icon']").href="/favicon.ico")}},await new Promise((e=>{const s=setInterval((()=>{"complete"===t.readyState&&(clearInterval(s),e())}),50)}));{const M=new ec("s","a","b",'"use strict";return '+Nu.__prof__);try{if(void 0!==M.apply(void 0,[c,n,t]))return}catch(R){return void d("Internal Error")}}const l=i("frame"),p=i("frame-view"),u=i("status");function d(e){null!=e?(o.textContent=e,o.style.display="block"):o.style.display="none"}function f(e){l.appendChild(m(e)),p.style.display="block"}function m(s){if(e.crossOriginIsolated){const i=t.createElement("iframe");return i.setAttribute("width","1024"),i.setAttribute("height","768"),i.setAttribute("allowfullscreen","true"),i.setAttribute("allowpaymentrequest","true"),i.setAttribute("name","Frame"),i.setAttribute("allow","fullscreen payment"),i.setAttribute("loading","lazy"),i.setAttribute("frameborder","0"),i.setAttribute("credentialless","true"),i.setAttribute("referrerpolicy","no-referrer"),i.onload=()=>{i.onload=null,i.setAttribute("src","data:application/xhtml+xml;base64,"+Gh.encode(Jh.encode(`<?xml version="1.0" encoding="utf-8" ?>\n\t<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">\n\t<html xmlns="http://www.w3.org/1999/xhtml" lang="en">\n\t\t<head>\n\t\t\t<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />\n\t\t\t<meta http-equiv="Referrer-Policy" content="no-referrer" />\n\t\t\t<meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests" />\n\t\t\t<meta name="referrer" content="no-referrer" />\n\t\t\t<meta name="viewport" content="width=device-width,initial-scale=1" />\n\t\t\t<base href="${e.origin}" target="_blank" />\n\t\t\t<link rel="icon" type="image/x-icon" href="res/google.ico" />\n\t\t\t<link rel="stylesheet" type="text/css" href="data:text/css;base64,Ym9keSwgZW1iZWQsIGlmcmFtZSB7Cglwb3NpdGlvbjogYWJzb2x1dGU7CglkaXNwbGF5OiBibG9jazsKCXdpZHRoOiAxMDAlOwoJaGVpZ2h0OiAxMDAlOwoJbWFyZ2luOiAwcHg7CglwYWRkaW5nOiAwcHg7Cglib3JkZXI6IG5vbmU7CglvdmVyZmxvdzogaGlkZGVuOwp9Cg==" />\n\t\t\t<title>Google</title>\n\t\t</head>\n\t\t<body>\n\t\t\t<embed type="text/plain" width="1024" height="768" src="${s.replace(/\&/g,"&amp;")}" />\n\t\t</body>\n\t</html>`)))},i}const i=t.createElement("embed");return i.setAttribute("type","text/plain"),i.setAttribute("width","1024"),i.setAttribute("height","768"),i.setAttribute("src",s),i}function y(e){try{return new URL(e)}catch(e){return null}}function g(t){const s=e.open(void 0,"_blank","");if(null==s)return void d("Please allow popups in your browser settings and try again.");s.focus();const i=h.parseFromString(`<?xml version="1.0" encoding="utf-8" ?>\n<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">\n<html xmlns="http://www.w3.org/1999/xhtml" lang="en">\n\t<head>\n\t\t<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />\n\t\t<meta http-equiv="Referrer-Policy" content="no-referrer" />\n\t\t<meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests" />\n\t\t<meta name="referrer" content="no-referrer" />\n\t\t<meta name="viewport" content="width=device-width,initial-scale=1" />\n\t\t<base href="${e.origin}" target="_blank" />\n\t\t<link rel="icon" type="image/x-icon" href="res/google.ico" />\n\t\t<link rel="stylesheet" type="text/css" href="data:text/css;base64,Ym9keSwgZW1iZWQsIGlmcmFtZSB7Cglwb3NpdGlvbjogYWJzb2x1dGU7CglkaXNwbGF5OiBibG9jazsKCXdpZHRoOiAxMDAlOwoJaGVpZ2h0OiAxMDAlOwoJbWFyZ2luOiAwcHg7CglwYWRkaW5nOiAwcHg7Cglib3JkZXI6IG5vbmU7CglvdmVyZmxvdzogaGlkZGVuOwp9Cg==" />\n\t\t<title>Google</title>\n\t</head>\n\t<body>\n\t\t\x3c!-- dummy --\x3e\n\t</body>\n</html>`,"application/xml");t.remove(),i.body.appendChild(t),s.document.documentElement.replaceWith(i.documentElement)}async function b(t,s){try{const i=await e.fetch(t,{cache:s||"force-cache",method:"GET",signal:AbortSignal.timeout(1e4),window:null});return i.ok?await i.text():null}catch(e){return null}}function w(e,t){return new Promise(((s,i)=>{const r=Date.now().toString(36),n=(e,t,a)=>{e===r&&(E.off("res",n),null!=a?i(a):s(t))};E.on("res",n),E.emit("fetch",r,e,t)}))}if(e!==e.top){if("null"===(null===(s=n.ancestorOrigins)||void 0===s?void 0:s.item(0))){const F=t.createElement("div");return F.textContent="Click here to continue",F.onclick=()=>g(m("https://whitespider.dev/")),F.setAttribute("style","padding: 15px;"),t.body.innerHTML="",void t.body.appendChild(F)}if("https://whitespider.dev"!==n.origin)return void n.replace("https://whitespider.dev/")}a.scrollRestoration="manual",a.replaceState(void 0,"","/");const _=qh(e),x=Ah(Du,"gamelist_v2/data"),v=Ah(Du,"playcount"),P=e.navigator.serviceWorker,{localStorage:T}=_;let C,E,k=null,A=null;const S=[],I=[],N=[];if(null!=P&&_.storageEnabled)try{await P.register("/sw.js",{type:"classic",scope:"/",updateViaCache:"none"}),await P.ready;const B=await b("/manifest.json","no-cache");if(null!=B){const U=JSON.parse(B).version;if(U!==T.get("__mf_version")){e.stop(),t.body.innerHTML="Updating contents...";const j=e.caches;for(const z of await j.keys())await j.delete(z);return T.delete("__new_read"),T.set("__mf_version",U),void n.reload()}i("version").textContent="v"+U}C=T.get("__secrets_")||void 0}catch(q){}else d("Warning: Cookies are blocked by your browser. Some features might not work properly, and your game data will NOT be saved.");try{const H=await e.fetch("/d/index.json",{mode:"same-origin",cache:"no-cache",method:"GET",signal:AbortSignal.timeout(5e3)});if(!H.ok)throw new Error("Remote returned error status code: "+H.status);const V=Su(await H.arrayBuffer());for(const W of V)S.push(W);for(const $ of V.sort(((e,t)=>t.date-e.date)).slice(0,200))I.push($)}catch(K){return d("Error: Failed to initialize local game list."),void console.error(K)}try{{const G=await Nh(x);if(null!=G&&G.exists()){const Y=G.val();if(Qh.isArray(Y))for(const J of Y)null!=J&&"object"==typeof J&&S.push({name:J[0],path:J[2],type:"",tags:"",desc:"",date:0})}}{const Z=await Nh(v);if(null!=Z&&Z.exists()){const X=Z.val();if(null!=X&&"object"==typeof X)for(const Q of Zh.keys(X).map((e=>({k:Jh.decode(Gh.decode(e)),v:X[e]}))).sort(((e,t)=>t.v-e.v)).slice(0,100))for(const ee of S)if(ee.path===Q.k&&""!==ee.type){N.push(ee);break}}}Rh(Du)}catch(te){d("Warning: Failed to fetch remote game list."),console.error(te)}o.onclick=()=>{o.innerHTML="",o.style.display="none"},i("frame-close").onclick=()=>{l.innerHTML="",p.style.display="none",a.replaceState(void 0,"","/")},i("frame-newtab").onclick=()=>{const e=l.firstElementChild;null!=e&&(l.innerHTML="",p.style.display="none",g(e))};{const se=r("link[rel*='icon']"),ie=i("backend-url"),re=i("theme"),ne=i("tab-cloaking");let ae;function oe(e){if(null!=E&&(E.disconnect(),E.close()),0===e.length){const{ix2k2pm6lk:t,cj75pgckqe:s}=Nu.m7pl4q4lor;if("string"!=typeof t||"string"!=typeof s)throw new Error("Error: Key file corrupted.");e=Nu.prefix+s+t}E=Pe(e,{path:"/___api__/",secure:!0,upgrade:!0,timeout:1e4,forceNew:!0,multiplex:!1,protocols:[],transports:["polling","websocket"],autoConnect:!0,reconnection:!0,rememberUpgrade:!0,reconnectionDelay:5e3,reconnectionDelayMax:1e4}),u.innerHTML="Connecting...",u.style.color="#808000",E.io.on("reconnect_attempt",(()=>{u.innerHTML="Connecting...",u.style.color="#808000"})),E.io.on("reconnect_failed",(()=>{u.innerHTML="✕Disconnected",u.style.color="#ff0000"})),E.on("disconnect",(()=>{u.innerHTML="✕Disconnected",u.style.color="#ff0000"})),E.on("connect",(()=>{u.innerHTML="✓Connected",u.style.color="#008000",null!=k&&k()}))}function he(e){switch(null==ae&&(ae=t.createElement("link"),ae.rel="stylesheet",ae.type="text/css",ae.href="data:text/css;base64,",t.head.appendChild(ae)),e){case"light":ae.href="data:text/css;base64,",ae.removeAttribute("media");break;case"dark":ae.href="index.dark.css",ae.removeAttribute("media");break;default:ae.href="index.dark.css",ae.media="all and (prefers-color-scheme: dark)"}}function ce(e){switch(e){case"empty":t.title="⁠",se.type="image/x-icon",se.href="/res/empty.ico";break;case"google":t.title="Google",se.type="image/x-icon",se.href="/res/google.ico";break;case"classroom":t.title="Home",se.type="image/png",se.href="/res/classroom.png";break;default:t.title="WhiteSpider",se.type="image/x-icon",se.href="/favicon.ico"}}ie.onblur=()=>{const e=y(ie.value.trim());if(null!=e&&"https:"===e.protocol){const t=e.href;oe(t),T.set("__backendURL_",t)}else oe(""),T.delete("__backendURL_")},re.onchange=()=>{const e=re.value;he(e),T.set("__set_theme",e)},ne.onchange=()=>{const e=ne.value;ce(e),T.set("__set_tabc",e)};{const le=T.get("__backendURL_")||"";oe(le),ie.value=le}{const pe=T.get("__set_theme")||"default";he(pe),re.value=pe}{const ue=T.get("__set_tabc")||"disabled";ce(ue),ne.value=ue}}{const de=i("game-container"),fe=i("game-frame"),me=i("player"),ye=i("name"),ge=i("type"),be=i("tags"),we=i("date"),_e=i("user"),xe=i("desc"),ve=i("gnav-back"),Te=i("gnav-forward"),Ce=i("gnav-page-no"),Ee=i("gnav-page-count"),ke=[];let Ae=0,Se="all",Ie="";{const Oe=i("game-search"),Me=r("#game-search>input");let Re=0;function Fe(){Ie=Me.value.toLowerCase().trim(),Le()}Oe.onsubmit=e=>{e.preventDefault(),e.stopPropagation(),clearTimeout(Re),Fe()},Me.onblur=()=>{clearTimeout(Re),Fe()},Me.oninput=()=>{clearTimeout(Re),Re=setTimeout((()=>{Fe()}),1e3)}}{const Be=t.querySelectorAll("#game-category>button");for(const Ue of Be)Ue.onclick=()=>{for(const e of Be)e.removeAttribute("current");Ue.setAttribute("current","true"),Se=Ue.getAttribute("match")||"all",Le()}}{const je=r('#game-category>button[match="new"]');T.has("__new_read")||(je.setAttribute("unread","true"),je.addEventListener("click",(()=>{je.removeAttribute("unread"),T.set("__new_read","1")}),{once:!0,passive:!0}))}function Ne(){switch(Se){case"all":return Ie.length>0?S.filter((e=>e.name.toLowerCase().indexOf(Ie)>=0||e.tags.indexOf(Ie)>=0)):S;case"new":return Ie.length>0?I.filter((e=>e.name.toLowerCase().indexOf(Ie)>=0||e.tags.indexOf(Ie)>=0)):I;case"hot":return Ie.length>0?N.filter((e=>e.name.toLowerCase().indexOf(Ie)>=0||e.tags.indexOf(Ie)>=0)):N;case"html5":return S.filter((e=>"html5"===e.type&&(0===Ie.length||e.name.toLowerCase().indexOf(Ie)>=0||e.tags.indexOf(Ie)>=0)));case"flash":return S.filter((e=>"flash"===e.type&&(0===Ie.length||e.name.toLowerCase().indexOf(Ie)>=0||e.tags.indexOf(Ie)>=0)));case"dos":return S.filter((e=>"dos"===e.type&&(0===Ie.length||e.name.toLowerCase().indexOf(Ie)>=0||e.tags.indexOf(Ie)>=0)));default:return S.filter((e=>e.tags.split(",").indexOf(Se)>=0&&(0===Ie.length||e.name.toLowerCase().indexOf(Ie)>=0)))}}function Le(){Ae=0,ke.length=0;const e=Ne();if(0===e.length)ve.disabled=!0,Te.disabled=!0,de.innerHTML="No results found :(";else{for(let t=0;t<e.length;t+=100)ke.push(e.slice(t,t+100));De()}}function De(){de.innerHTML="",Ce.value=Xh(Ae+1),Ce.min="1",Ce.max=Ee.innerHTML=Xh(ke.length),ve.disabled=Ae<1,Ae>=ke.length-1?Te.disabled=!0:Te.disabled=!1;for(const e of ke[Ae]){const{name:s,type:i,path:r,prev:a}=e,o=t.createElement("div");o.onclick=async()=>{me.appendChild(m("/player.html?name="+s+"&type="+i+"&url="+encodeURIComponent(r))),_e.innerHTML="",ye.textContent=s,ge.textContent=i.toUpperCase(),be.textContent=e.tags.replace(/\,/g,", ")||"None",we.textContent=new Date(e.date).toLocaleDateString("POSIX",{month:"2-digit",day:"2-digit",year:"numeric"}),xe.textContent=e.desc||"No information provided by the uploader.",fe.style.display="block";{const s=await w(1,e.user||"anonymous");{const e=t.createElement("img");e.alt="Avatar",e.width=40,e.height=40,e.loading="eager",e.decoding="sync",e.draggable=!1,_e.appendChild(e);{const t=URL.createObjectURL(new Blob([s.avatar],{type:"image/jpeg",endings:"native"}));e.src=t,await e.decode(),URL.revokeObjectURL(t)}}{const e=t.createElement("div");e.textContent=s.id,_e.appendChild(e)}}if("localhost"!==n.hostname&&""!==i){(a=at(a=Du))._checkNotDeleted("goOnline"),(o=a._repo).persistentConnection_&&o.persistentConnection_.resume(Xo);const e=Sh(v,Gh.encode(Jh.encode(r)));await Ih(e,((await Nh(e)).val()||0)+1),Rh(Du)}var a,o},o.style.backgroundImage=null!=a?'url("'+a+'"), url("/res/preview.svg")':'url("/d/'+encodeURIComponent(s)+'.jpg"), url("/res/preview.svg")';{const e=t.createElement("div");e.textContent=s,o.appendChild(e)}switch(i){case"html5":{const e=t.createElement("span");e.textContent="HTML5",e.style.background="#ff9933",o.appendChild(e)}break;case"flash":{const e=t.createElement("span");e.textContent="Flash",e.style.background="#00cc99",o.appendChild(e)}break;case"dos":{const e=t.createElement("span");e.textContent="Dos",e.style.background="#80bfff",o.appendChild(e)}break;default:o.style.backgroundImage='url("/res/preview.svg")'}de.appendChild(o)}}ve.onclick=()=>{Ae--,De(),de.scrollIntoView({behavior:"instant",inline:"start",block:"start"})},Te.onclick=()=>{Ae++,De(),de.scrollIntoView({behavior:"instant",inline:"start",block:"start"})},Ce.onblur=()=>{const e=parseInt(Ce.value.trim(),10)||0;Ae+1!==e&&(e<1||e>ke.length?(Ce.value="1",Ae=0):Ae=e-1,De(),de.scrollIntoView({behavior:"instant",inline:"start",block:"start"}))},Ce.onchange=()=>{Ce.blur()},i("game-close").onclick=()=>{me.innerHTML="",fe.style.display="none",a.replaceState(void 0,"","/")},i("game-newtab").onclick=()=>{const e=me.firstElementChild;null!=e&&(me.innerHTML="",fe.style.display="none",g(e))},Le()}{const ze=i("tabs"),qe=i("mode-select"),He=i("u-frame"),Ve=i("address"),We=i("message"),$e=i("container"),Ke=[],Ge=["left","middle","right","back","forward"],Ye=He.getContext("bitmaprenderer",{alpha:!1}),Je={width:t.documentElement.clientWidth,height:t.documentElement.clientHeight-120,touch:e.navigator.maxTouchPoints>0},Ze=ze.children;let Xe=-1;{const lt=i("prox-btn"),pt=i("unbl-content");qe.value=T.get("__unbl_mode_")||"puppeteer",lt.onclick=()=>{null!=A&&A();for(const e of D)e.removeAttribute("current");if(O.checked=!1,lt.setAttribute("current","true"),pt.setAttribute("current","true"),"puppeteer"===qe.value){if(null==Ye)return void d("Error: Failed to initialize canvas context.");k=()=>{Qe("Restoring session..."),ct()},A=()=>{Qe(null),k=null,A=null,Xe=-1,Ke.length=0,ze.innerHTML="",E.emit("end_session"),E.offAny(ht)},Qe("Requesting new session..."),ct()}},qe.onchange=()=>{"puppeteer"===qe.value?(T.set("__unbl_mode_","puppeteer"),lt.click()):(null!=A&&A(),T.set("__unbl_mode_","raw-embed"))}}function Qe(e){null!=e?(We.textContent=e,We.style.display="block"):We.style.display="none"}function et(e){return e.preventDefault(),e.stopPropagation(),e.returnValue=!1,E.emit("event",{type:e.type,x:e.offsetX,y:e.offsetY,button:Ge[e.button]}),!1}function tt(e){e.preventDefault(),e.stopPropagation(),e.returnValue=!1;const{type:t,touches:s}=e;if(s.length>0){const e=He.getBoundingClientRect();for(const i of s)E.emit("event",{type:t,x:i.clientX-e.x,y:i.clientY-e.y})}else E.emit("event",{type:t});return!1}function st(e){return e.preventDefault(),e.stopPropagation(),e.returnValue=!1,E.emit("event",{type:e.type,deltaX:e.deltaX,deltaY:e.deltaY}),!1}function it(e){return e.preventDefault(),e.stopPropagation(),e.returnValue=!1,E.emit("event",{type:e.type,key:e.key}),!1}function rt(e){return e.preventDefault(),e.stopPropagation(),e.returnValue=!1,He.focus({preventScroll:!0}),!1}function nt(e){e=e.toLowerCase();for(let t=0;t<e.length;t++){const s=e.charCodeAt(t);if((s<48||s>57)&&(s<97||s>122)&&45!==s&&46!==s)return!1}return!0}function ot(e,t){const s=y(e=e.replace(/\s+/g," ").trim());if(null!=s)return s.href;if(e.includes(" "))return t+encodeURIComponent(e);const i=e.indexOf("/");if(0===i)return t+encodeURIComponent(e);if(i>0){if(nt(e.substring(0,i)))return"http://"+e}else if(nt(e)&&e.includes("."))return"http://"+e;return t+encodeURIComponent(e)}function ht(e,...s){switch(e){case"url":{const e=s[0];if("string"==typeof e){const s=Ke[Xe];null!=s&&(s.url=e),t.activeElement!==Ve&&(Ve.value=e)}}break;case"frame":createImageBitmap(new Blob(s,{type:"image/jpeg",endings:"native"}),0,0,He.width,He.height,{resizeQuality:"pixelated",imageOrientation:"none",premultiplyAlpha:"none",colorSpaceConversion:"none"}).then((e=>{Ye.transferFromImageBitmap(e),e.close()}));break;case"tabinfo":{const e=(s=s[0]).id,t=Ze[e],i=Ke[e];i.title=t.querySelector("div").textContent=s.title||"Untitled",i.favicon=t.querySelector("img").src=s.favicon||"/res/empty.ico"}break;case"tabopen":const e=t.createElement("div");e.innerHTML='<img src="res/empty.ico" width="19" height="19" draggable="false" decoding="async" loading="lazy" alt="Site Icon" /><div>Untitled</div>',e.onclick=()=>{for(const e of Ze)e.removeAttribute("current");e.setAttribute("current","true"),E.emit("focustab",Xe=Ke.indexOf(r))};const i=t.createElement("button");i.type="button",i.title="Close",i.onclick=()=>{E.emit("closetab",Ke.indexOf(r))},e.appendChild(i);for(const e of Ze)e.removeAttribute("current");e.setAttribute("current","true");const r={url:"",title:"",favicon:""};Zh.setPrototypeOf(r,null),Zh.preventExtensions(r),Xe=Ke.length,Ke.push(r),ze.appendChild(e);break;case"tabclose":const n=s[0];n>=0&&n<Ke.length&&(n===Xe&&(n>1?Ze[Xe=n-1].setAttribute("current","true"):Ze[Xe=0].setAttribute("current","true")),Ze[n].remove(),Ke.splice(n,1))}}async function ct(){E.offAny(ht),E.emit("ns",Je);{const{width:e,height:t}=await new Promise((e=>{E.once("session_ready",e)}));$e.style.width=e+"px",$e.style.height=t+"px",Je.width=e,Je.height=t,He.width=e,He.height=t}for(const e of Ke)E.emit("newtab"),await new Promise((e=>{E.once("tabopen",e)})),E.emit("navigate",e.url),await new Promise((t=>{E.once("tabinfo",(s=>{const i=ze.children[s.id];e.title=i.querySelector("div").textContent=s.title||"Untitled",e.favicon=i.querySelector("img").src=s.favicon||"/res/empty.ico",t()}))}));E.onAny(ht),-1===Xe?E.emit("newtab"):E.emit("focustab",Xe),Qe(null),He.autofocus=!0,He.focus({preventScroll:!0})}i("back").onclick=()=>E.emit("goback"),i("forward").onclick=()=>E.emit("goforward"),i("refresh").onclick=()=>E.emit("refresh"),i("new-tab").onclick=()=>E.emit("newtab"),Ve.onfocus=()=>{Ve.select()},Ve.onblur=()=>{const e=Ke[Xe];null!=e&&(Ve.value=e.url)},Ve.onkeydown=e=>{if("Enter"===e.key){e.preventDefault(),e.stopPropagation();const t=Ve.value.trim();t.length>0&&("puppeteer"===qe.value?(He.focus({preventScroll:!0}),E.emit("navigate",ot(t,"https://www.google.com/search?q="))):f(ot(t,"https://www.bing.com/search?q=")))}},Ve.ondragstart=e=>{e.preventDefault(),e.stopPropagation(),Ve.selectionEnd=Ve.selectionStart||(Ve.selectionStart=0)},He.addEventListener("mousedown",et,{passive:!1}),He.addEventListener("mouseup",et,{passive:!1}),He.addEventListener("mousemove",et,{passive:!1}),He.addEventListener("touchstart",tt,{passive:!1}),He.addEventListener("touchend",tt,{passive:!1}),He.addEventListener("touchmove",tt,{passive:!1}),He.addEventListener("wheel",st,{passive:!1}),He.addEventListener("keydown",it,{passive:!1}),He.addEventListener("keyup",it,{passive:!1}),He.addEventListener("click",rt,{passive:!1}),He.addEventListener("contextmenu",rt,{passive:!1})}{const ut=r("#history>div"),dt=i("cg-messages"),ft=r("#chatgpt>input"),mt=r("#chatgpt>button");{const _t=i("history"),xt=i("cg-chat"),vt=i("cg-menu");vt.onclick=()=>{vt.style.display="none",_t.removeAttribute("style"),xt.removeAttribute("style")},i("cg-close").onclick=()=>{vt.style.display="block",_t.style.display="none",xt.style.width="100%"}}let yt=null;const gt=JSON.parse(T.get("__chats")||"[]");function bt(e,s){const i=t.createElement("div");{const s=t.createElement("img");s.width=32,s.height=32,s.loading="lazy",s.decoding="async",s.draggable=!1,"u"===e?(s.src="/res/user.svg",s.alt="User"):(s.src="/res/bot.svg",s.alt="Assistant"),i.appendChild(s)}{const e=t.createElement("div");e.textContent=s,i.appendChild(e)}return dt.appendChild(i),i}function wt(e){const s=t.createElement("div");s.onclick=()=>{for(const e of ut.children)e.removeAttribute("current");s.setAttribute("current","true"),dt.innerHTML="",yt=e.msgs;for(const e of yt)bt(e.role,e.text);dt.scrollIntoView({behavior:"instant",block:"end",inline:"end"})};const i=t.createElement("div");i.textContent=e.title,s.appendChild(i);const r=t.createElement("button");r.type="button",r.title="Delete",r.onclick=t=>{t.preventDefault(),t.stopPropagation();const i=gt.indexOf(e);i>=0&&(yt=null,s.remove(),gt.splice(i,1),dt.innerHTML="",T.set("__chats",JSON.stringify(gt,void 0,0)))},s.appendChild(r),ut.prepend(s)}for(const Pt of gt)wt(Pt);i("chatgpt").onsubmit=async e=>{e.preventDefault(),e.stopPropagation();const t=ft.value.trim();if(t.length<2)return void d("The message must contain at least 2 characters.");if(!E.connected)return void d("Error: Disconnected from the backend server.");if(ft.value="",ft.disabled=!0,mt.disabled=!0,bt("u",t),null==yt){const e={title:t.slice(0,100),msgs:yt=[]};wt(e),gt.push(e)}yt.push({role:"u",text:t});const s=bt("a",""),i=s.lastElementChild;try{const e=await new Promise(((e,t)=>{let s;E.on("gptres",(e=>{i.textContent=s=e,i.scrollIntoView({behavior:"instant",block:"end",inline:"end"})})),E.on("gptend",(()=>e(s))),E.on("gpterr",(()=>t())),E.emit("gptreq",yt)}));yt.push({role:"a",text:i.textContent=e}),T.set("__chats",JSON.stringify(gt,void 0,0))}catch(e){console.error(e),d("Error: Failed to retrieve messages from the server."),s.remove(),yt.pop()}ft.disabled=!1,mt.disabled=!1,E.removeAllListeners("gptres"),E.removeAllListeners("gptend"),E.removeAllListeners("gpterr")},i("new-chat").onclick=()=>{for(const e of ut.children)e.removeAttribute("current");yt=null,dt.innerHTML=""}}{const Tt=i("yt-search"),Ct=r("#yt-search>input"),Et=r("#yt-search>button"),kt=i("yt-api-key"),At=i("yt-order"),St=i("yt-results"),It=i("yt-load-more"),Nt=i("yt-max-results");let Lt;function Dt(e){const s=t.createElement("iframe");s.setAttribute("width","1024"),s.setAttribute("height","768"),s.setAttribute("allowfullscreen","true"),s.setAttribute("allowpaymentrequest","true"),s.setAttribute("name","Frame"),s.setAttribute("allow","fullscreen payment"),s.setAttribute("loading","lazy"),s.setAttribute("scrolling","no"),s.setAttribute("frameborder","0"),s.setAttribute("credentialless","true"),s.setAttribute("referrerpolicy","no-referrer"),s.setAttribute("src","data:application/xhtml+xml;base64,"+Gh.encode(Jh.encode(`<?xml version="1.0" encoding="utf-8" ?>\n\t<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">\n\t<html xmlns="http://www.w3.org/1999/xhtml" lang="en">\n\t\t<head>\n\t\t\t<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />\n\t\t\t<meta http-equiv="Referrer-Policy" content="no-referrer" />\n\t\t\t<meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests" />\n\t\t\t<meta name="referrer" content="no-referrer" />\n\t\t\t<meta name="viewport" content="width=device-width,initial-scale=1" />\n\t\t\t<link rel="icon" type="image/x-icon" href="https://www.google.com/favicon.ico" />\n\t\t\t<link rel="stylesheet" type="text/css" href="data:text/css;base64,Ym9keSwgZW1iZWQsIGlmcmFtZSB7Cglwb3NpdGlvbjogYWJzb2x1dGU7CglkaXNwbGF5OiBibG9jazsKCXdpZHRoOiAxMDAlOwoJaGVpZ2h0OiAxMDAlOwoJbWFyZ2luOiAwcHg7CglwYWRkaW5nOiAwcHg7Cglib3JkZXI6IG5vbmU7CglvdmVyZmxvdzogaGlkZGVuOwp9Cg==" />\n\t\t\t<title>Google</title>\n\t\t</head>\n\t\t<body>\n\t\t\t<embed type="text/plain" width="1024" height="768" src="${e.replace(/\&/g,"&amp;")}" />\n\t\t</body>\n\t</html>`))),l.appendChild(s),p.style.display="block"}function Ot(e){switch(e.host){case"youtube.com":case"youtube-nocookie.com":case"www.youtube.com":case"www.youtube-nocookie.com":const t=e.pathname;return"/watch"===t?e.searchParams.get("v")||null:t.startsWith("/embed/")&&t.substring(7)||null;case"youtu.be":return e.pathname.substring(1)||null;default:return null}}async function Mt(){const t=new URL("https://youtube.googleapis.com/youtube/v3/search"),s=t.searchParams;s.set("q",Ct.value),s.set("key",kt.value||"AIzaSyARuwknsJhvP-ysM8-DwbqqJ5e-EaTL-UY"),s.set("type","video"),s.set("part","snippet"),s.set("order",At.value),s.set("maxResults",Nt.value),s.set("safeSearch","none"),s.set("videoEmbeddable","true"),null!=Lt&&s.set("pageToken",Lt);const i=await e.fetch(t,{cache:"no-cache",method:"GET",headers:{Accept:"application/json"}});return"application/json"===(i.headers.get("content-type")||"").split(";",2)[0].trim()?await i.json():null}async function Rt(){d(null),Et.disabled=!0,Ct.disabled=!0,It.style.display="none";const e=await Mt();if(null==e)return void d("API server returned invalid data.");if("error"in e){const{message:t,code:s}=e.error;return void d(t+" (Code: "+s+")")}const s=e.items;if(0==s.length)return void d("No results match your search.");for(const e of s){const s=e.id.videoId,i=e.snippet,r=t.createElement("div");r.onclick=()=>Dt("https://www.youtube-nocookie.com/embed/"+s+"?autoplay=1&controls=1&rel=0&color=white");const n=t.createElement("img");n.width=160,n.height=90,n.title="Video Preview",n.draggable=!1,n.src=i.thumbnails.medium.url,r.appendChild(n);const a=t.createElement("div");r.appendChild(a);const o=t.createElement("div");o.className="title",o.textContent=i.title,a.appendChild(o);const h=t.createElement("div");h.className="desc",h.textContent=i.description,a.appendChild(h);const c=t.createElement("div");c.className="time",c.textContent=i.publishTime,a.appendChild(c),St.appendChild(r)}const i=e.nextPageToken;null!=i&&(It.style.display="block",It.onclick=()=>{Lt=i,Rt().then((()=>{Et.disabled=!1,Ct.disabled=!1}))})}kt.value=T.get("__yt_apikey")||"",Tt.onsubmit=e=>{e.preventDefault(),e.stopPropagation(),Lt=null,St.innerHTML="";const t=y(Ct.value);if(null==t)return void Rt().then((()=>{Et.disabled=!1,Ct.disabled=!1}));d(null),It.style.display="none";const s=Ot(t);null!=s?Dt("https://www.youtube-nocookie.com/embed/"+s+"?autoplay=1&controls=1&rel=0&color=white"):d("Error: Failed to parse YouTube video ID from the provided URL.")},kt.onblur=()=>{const e=kt.value.trim();return 0===e.length?(T.delete("__yt_apikey"),void(kt.value="")):e.length<30?(d("Invalid API key."),void(kt.value="")):void T.set("__yt_apikey",kt.value=e)},Nt.onblur=()=>{const e=parseInt(Nt.value.trim(),10);isNaN(e)?Nt.value="10":e<1?Nt.value="1":e>30&&(Nt.value="30")}}{const Ft=i("emulator"),Bt=i("core"),Ut=i("bios"),jt=i("game-rom");Ft.onchange=()=>{switch(Ft.value){case"flash":Bt.disabled=!0,Ut.disabled=!0,jt.accept=".swf";break;case"dos":Bt.disabled=!0,Ut.disabled=!0,jt.accept=".jsdos, .zip";break;default:Ft.value="emu",Bt.disabled=!1,Ut.disabled=!1,jt.accept="*/*"}},i("startemu").onclick=()=>{var e,t;const s=null===(e=jt.files)||void 0===e?void 0:e.item(0);if(null==s)return void d("Please choose a valid game ROM file.");const i=Ft.value,r=new URLSearchParams("");if(r.set("name",s.name),r.set("type",i),r.set("url",URL.createObjectURL(s)),"emu"===i){r.set("core",Bt.value);const e=null===(t=Ut.files)||void 0===t?void 0:t.item(0);null!=e&&r.set("bios",URL.createObjectURL(e))}f("player.html?"+r.toString())}}{const zt=i("game-name"),qt=i("game-type"),Ht=i("game-file"),Vt=i("game-labels"),Wt=i("game-description"),$t=i("upload"),Kt=i("upload-message");qt.onchange=()=>{switch(qt.value){case"html5":Ht.accept=".zip";break;case"flash":Ht.accept=".swf";break;case"dos":Ht.accept=".jsdos";break;default:Ht.accept="*/*"}},Kt.onclick=()=>{Kt.innerHTML="",Kt.style.display="none"},$t.onclick=async()=>{var e;const t=zt.value.replace(/\s+/g," ").trim();if(0===t.length)return void d("Game name must not be empty.");if(t.length>256)return void d("Game name must be less than 256 characters.");const s=null===(e=Ht.files)||void 0===e?void 0:e.item(0);if(null==s)return void d("Please choose a valid game file.");if(0===s.size)return void d("Uploading empty game files is not allowed.");if(s.size>25e6)return void d("Uploading files larger than 25MB is not supported currently.");if(null==C)return void d("Invalid session. Please refresh this page and try again.");if(!E.connected)return void d("Error: Disconnected from the backend server.");Kt.innerHTML="Processing...",Kt.style.color="#808080",Kt.style.display="block",$t.disabled=!0;const i=Wt.value.replace(/\s+/g," ").trim(),r=Vt.value.trim().split(",").map((e=>e.replace(/\s+/g," ").trim())).join(",");if(r.length>1e3)d("The game tags list must be less than 1000 characters in total.");else if(i.length>8e3)d("Game description must be less than 8000 characters.");else{await new Promise((e=>setTimeout(e,1e3)));try{await w(5,[C,t,qt.value,r,i,await s.arrayBuffer()]),Kt.innerHTML="✓Success!",Kt.style.color="#008000",Kt.style.display="block"}catch(e){d("Failed to upload the game. Message: "+e),Kt.innerHTML="✕Error",Kt.style.color="#ff0000",Kt.style.display="block"}zt.value="",Ht.value="",Vt.value="",Wt.value="",$t.disabled=!1}}}{const Gt=i("messages"),Yt=t.querySelectorAll("#channels>div"),Jt=r("#sendmsg>input"),Zt=r("#sendmsg>button");let Xt="";{const ts=i("chat"),ss=i("menu"),is=i("sidemenu");ss.onclick=()=>{ts.removeAttribute("style"),ss.style.display="none",is.style.display="block"},i("close-sm").onclick=()=>{ss.style.display="block",is.style.display="none",ts.style.width="100%"}}{const rs=i("chat-btn"),ns=i("community-page");rs.onclick=()=>{null!=A&&A();for(const e of D)e.removeAttribute("current");O.checked=!1,rs.setAttribute("current","true"),ns.setAttribute("current","true"),E.on("msg",((e,t,s,i,r)=>{if(e===Xt){const e=Qt(t,s,i,r),n=Gt.scrollHeight-Gt.clientHeight;Gt.appendChild(e),n===Gt.scrollTop&&e.scrollIntoView({behavior:"instant",block:"end",inline:"end"})}})),E.on("msgdel",((e,t)=>{if(e===Xt)for(const e of Gt.children)if(e.getAttribute("_id")===t){e.remove();break}})),E.on("msgupd",((e,t,s)=>{if(c(e,t,s),e===Xt)for(const e of Gt.children)if(e.getAttribute("_id")===t){const i=e.querySelector("div>span");null!=i?i.textContent=s:d("Failed to update message: "+t);break}})),A=()=>{A=null,E.emit("end_session"),E.removeAllListeners("msg"),E.removeAllListeners("msgdel"),E.removeAllListeners("msgupd")},E.emit("ncs"),Yt[0].dispatchEvent(new Event("click"))}}function Qt(e,s,i,r){const n=t.createElement("div");n.setAttribute("_id",e);{const e=t.createElement("img");if(e.alt="Avatar",e.width=32,e.height=32,e.loading="lazy",e.decoding="async",e.draggable=!1,n.appendChild(e),"string"!=typeof r){const t=URL.createObjectURL(new Blob([r],{type:"image/jpeg",endings:"native"}));e.addEventListener("load",(()=>URL.revokeObjectURL(t)),{once:!0,passive:!0}),e.src=t}else e.src=r,e.crossOrigin="anonymous"}{const e=t.createElement("div"),r=t.createElement("div");r.textContent=i,e.appendChild(r);const a=t.createElement("span");a.textContent=s,e.appendChild(a),n.appendChild(e)}return n}async function es(e){const t=await w(7,[Xt=e]);let s=t[t.length-1].id,i=!1;Gt.innerHTML="",Gt.onscroll=async()=>{if(0===Gt.scrollTop&&!i){i=!0;try{const t=await w(7,[e,s]);if(t.length>0){const e=Gt.scrollHeight;for(const{id:e,msg:s,user:i,icon:r}of t)Gt.prepend(Qt(e,s,i,r));s=t[t.length-1].id,Gt.scrollTo({behavior:"instant",left:0,top:Gt.scrollHeight-e})}}catch(e){d("Error: Failed to fetch messages."),console.error(e)}i=!1}};for(const{id:e,msg:s,user:i,icon:r}of t)Gt.prepend(Qt(e,s,i,r));Gt.scrollTo({behavior:"instant",left:0,top:Gt.scrollHeight})}{const as=i("channel-name");let os=!1;for(const hs of Yt){const cs=hs.getAttribute("id")||"";hs.onclick=async()=>{if(!os){os=!0;try{await es(cs)}catch(e){console.error(e),d("Error: Failed to initialize channel.")}for(const e of Yt)e.removeAttribute("current");hs.setAttribute("current","true"),as.innerHTML=hs.innerHTML,os=!1}}}}Jt.onfocus=()=>{null==C&&(Jt.blur(),L.click())},i("sendmsg").onsubmit=e=>{e.preventDefault(),e.stopPropagation();const t=Jt.value.trim();t.length<2?d("The message must contain at least 2 characters."):t.length>1e3?d("The message should not be longer than 1000 characters."):null!=C?E.connected?(Jt.value="",Jt.disabled=!0,Zt.disabled=!0,w(8,[C,Xt,t]).then((()=>{Jt.disabled=!1,Zt.disabled=!1})).catch((e=>{console.error(e),d("Error: Failed to post message. (See console logs for details)"),Jt.disabled=!1,Zt.disabled=!1}))):d("Error: Disconnected from the backend server."):L.click()},i("discord").onclick=async()=>{const t=await b("https://discord.com/api/guilds/998658232207814667/widget.json","no-cache");null!=t?e.location.href=JSON.parse(t).instant_invite:d("Error: Failed to fetch invite link.")}}const L=i("accn-btn"),D=t.querySelectorAll("#nav-bar>button, #content>div:not(#footer), #unbl-content"),O=i("side-menu");i("loading").style.display="none",i("content").style.display="block";{const ls=i("home-btn"),ps=i("unbl-btn"),us=i("chai-btn"),ds=i("apps-btn"),fs=i("settings"),ms=i("home-page"),ys=i("site-blocked-page"),gs=i("chatgpt-page"),bs=i("services-page"),ws=i("accountinfo-page"),_s=i("settings-page"),xs=i("uploadgames-page");ls.onclick=()=>{null!=A&&A();for(const e of D)e.removeAttribute("current");O.checked=!1,ls.setAttribute("current","true"),ms.setAttribute("current","true")},us.onclick=()=>{null!=A&&A();for(const e of D)e.removeAttribute("current");O.checked=!1,us.setAttribute("current","true"),gs.setAttribute("current","true")},ds.onclick=()=>{null!=A&&A();for(const e of D)e.removeAttribute("current");O.checked=!1,ds.setAttribute("current","true"),bs.setAttribute("current","true")},ps.onclick=()=>{null!=A&&A();for(const e of D)e.removeAttribute("current");O.checked=!1,ps.setAttribute("current","true"),ys.setAttribute("current","true")},i("chat-login").onclick=L.onclick=()=>{null!=A&&A();for(const e of D)e.removeAttribute("current");O.checked=!1,L.setAttribute("current","true"),ws.setAttribute("current","true")},fs.onclick=e=>{if(e.preventDefault(),e.stopPropagation(),null!=A&&A(),_s.hasAttribute("current")){for(const e of D)e.removeAttribute("current");ls.setAttribute("current","true"),ms.setAttribute("current","true")}else{for(const e of D)e.removeAttribute("current");_s.setAttribute("current","true")}O.checked=!1},i("ug").onclick=()=>{null!=A&&A();for(const e of D)e.removeAttribute("current");O.checked=!1,xs.setAttribute("current","true")}}{const vs=await b("https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7505521340110301","no-cache");if(null!=vs&&vs.length>0)try{new ec("window","document","arguments",vs).apply(e,[e,t,void 0])}catch(Ts){console.error("#Google Adsense:\n",Ts)}else d("You are using an ad blocker. Please disable it to support this website's development.");const Ps=window.adsbygoogle||(window.adsbygoogle=[]);for(const Cs of t.querySelectorAll("ins.adsbygoogle")){Cs.setAttribute("data-ad-client","ca-pub-7505521340110301"),Cs.setAttribute("data-ad-format","auto"),Cs.setAttribute("data-full-width-responsive","true");try{Ps.push(0)}catch(Es){}}}{const ks=async()=>{i("accn-btn").innerHTML="My Account",i("chat-login").remove(),i("login-dialog").remove();const e=i("ac-prof");e.style.display="block";const s=t.createElement("img");s.alt="Avatar",s.title="Change avatar",s.width=50,s.height=50,s.loading="eager",s.decoding="sync",s.draggable=!1,e.appendChild(s);const r=t.createElement("div"),n=t.createElement("button");n.type="button",n.title="Change username";{const s=t.createElement("div");s.appendChild(r),s.appendChild(n),e.appendChild(s)}const a=i("chat-profile");a.style.display="block";const o=t.createElement("img");o.alt="Avatar",o.title="Change avatar",o.width=40,o.height=40,o.loading="eager",o.decoding="sync",o.draggable=!1,a.appendChild(o);const h=t.createElement("div");a.appendChild(h);const c=await w(2,C);r.textContent=h.textContent=c.id,i("ac-uid").textContent=c.uid,i("ac-name").textContent=c.name||"Not set",i("ac-email").textContent=c.email||"Not set",i("ac-membership").textContent=c.vip||"None",i("account-settings").style.display="block";{const e=URL.createObjectURL(new Blob([c.avatar],{type:"image/jpeg",endings:"native"}));s.src=o.src=e,await s.decode(),await o.decode(),URL.revokeObjectURL(e)}s.onclick=()=>{const e=t.createElement("input");e.type="file",e.accept="image/*",e.click(),e.onchange=async()=>{var t;const i=null===(t=e.files)||void 0===t?void 0:t.item(0);if(null!=i){const e=URL.createObjectURL(i),t=new Image(512,512);t.src=e,t.loading="eager",t.decoding="sync";try{await t.decode(),URL.revokeObjectURL(e)}catch(e){return void d("Error: Failed to decode the image file.")}const r=Math.min(t.naturalWidth,t.naturalHeight),n=Math.min(r,512),a=new OffscreenCanvas(n,n),h=a.getContext("2d",{alpha:!1});if(null==h)throw new Error("Internal Error: Canvas context is null before accessing.");h.imageSmoothingEnabled=!0,h.imageSmoothingQuality="high",h.fillStyle="#ffffff",h.fillRect(0,0,n,n),h.drawImage(t,0,0,r,r,0,0,n,n);try{const e=await a.convertToBlob({type:"image/jpeg",quality:100});await w(4,[C,await e.arrayBuffer()]);const t=URL.createObjectURL(e);s.src=o.src=t,await s.decode(),await o.decode(),URL.revokeObjectURL(t)}catch(e){d("Error: Failed to upload the image file. (See console logs for details)"),console.error(e)}}}},n.onclick=()=>{const e=t.createElement("div"),s=t.createElement("input");s.type="text",s.value=r.innerHTML,s.minLength=4,s.maxLength=20,s.placeholder="Username",e.appendChild(s);const i=t.createElement("button");i.type="button",i.title="Save",i.textContent="✓",e.appendChild(i);const a=t.createElement("button");a.type="button",a.title="Cancel",a.textContent="✕",e.appendChild(a),s.onblur=()=>{s.value=s.value.trim().toLowerCase()},i.onclick=()=>{const t=s.value.trim().toLowerCase();t.length<4||t.length>20?d("The username must have 4 to 20 characters."):/^[\-a-z0-9]+/.test(t)?w(3,[C,t]).then((()=>{e.replaceWith(r),r.textContent=t,h.textContent=t,n.style.removeProperty("display")})).catch((e=>{d("Error: Failed to change username. Message: "+e)})):d("The username must contain only hyphens, a-z, 0-9")},a.onclick=()=>{e.replaceWith(r),n.style.removeProperty("display")},n.style.display="none",r.replaceWith(e),s.select()}};{const As=i("cp");As.onclick=()=>{const e=t.createElement("div"),s=t.createElement("div");s.setAttribute("style","position:relative;display:block;width:fit-content;height:fit-content;margin:10px 0px;padding:5px;"),s.textContent="Notice: If your account was created with your Google account and does not have a password, set the current password field to 'CHANGEME!'.",e.appendChild(s);const i=t.createElement("input");i.type="password",i.minLength=8,i.maxLength=30,i.spellcheck=!1,i.placeholder="Current password",i.autocomplete="off",i.setAttribute("style","position:relative;display:block;width:fit-content;height:fit-content;margin:10px 0px;padding:5px;"),e.appendChild(i);const r=t.createElement("input");r.type="password",r.minLength=8,r.maxLength=30,r.spellcheck=!1,r.placeholder="New password",r.autocomplete="off",r.setAttribute("style","position:relative;display:block;width:fit-content;height:fit-content;margin:10px 0px;padding:5px;"),e.appendChild(r);const n=t.createElement("input");n.type="password",n.minLength=8,n.maxLength=30,n.spellcheck=!1,n.placeholder="Confirm password",n.autocomplete="off",n.setAttribute("style","position:relative;display:block;width:fit-content;height:fit-content;margin:10px 0px;padding:5px;"),e.appendChild(n);const a=t.createElement("button");a.type="button",a.title="Change",a.textContent="✓",e.appendChild(a);const o=t.createElement("button");o.type="button",o.title="Cancel",o.textContent="✕",e.appendChild(o),a.onclick=()=>{const t=i.value;if(t.length<8||t.length>30)return void d("The current password must have 8 to 30 characters.");const s=r.value;s.length<8||s.length>30?d("The new password must have 8 to 30 characters."):s===n.value?w(9,[C,t,s]).then((()=>{e.replaceWith(As)})).catch((e=>{d("Error: Failed to change password. Message: "+e)})):d("The new password does not match the confirm password.")},o.onclick=()=>{e.replaceWith(As)},As.replaceWith(e)}}if(i("fa").onclick=()=>{d("Function not yet implemented.")},i("so").onclick=()=>{T.delete("__secrets_"),setTimeout((()=>n.reload()),200)},i("da").onclick=()=>{d("Error: Operation not permitted.")},null==C){const Ss=r("#login-dialog>h2"),Is=i("login"),Ns=i("register"),Ls=i("username"),Ds=i("password"),Os=i("2fa-otp"),Ms=i("c-password");Os.style.display="none",Ms.style.display="none",Ns.onclick=()=>{"Register"===Ss.innerHTML?(Ss.innerHTML="Login",Is.innerHTML="Login",Ns.innerHTML="Register",Ms.style.display="none"):(Ss.innerHTML="Register",Is.innerHTML="Register",Ns.innerHTML="Login",Ms.style.display="block")},Ls.onblur=()=>{Ls.value=Ls.value.trim().toLowerCase()},Is.onclick=()=>{const e=Ls.value.trim().toLowerCase();if(e.length<4||e.length>20)return void d("The username must have 4 to 20 characters.");if(!/^[\-a-z0-9]+/.test(e))return void d("The username must contain only hyphens, a-z, 0-9");const t=Ds.value;if(t.length<8||t.length>30)d("The password must have 8 to 30 characters.");else if("Register"===Ss.innerHTML){if(t!==Ms.value)return void d("Confirm password does not match.");w(11,[e,t]).then((e=>{T.set("__secrets_",C=e),ks()})).catch((e=>{d("Error: Failed to register. Message: "+e)}))}else w(10,[e,t]).then((e=>{T.set("__secrets_",C=e),ks()})).catch((e=>{d("Error: Failed to login. Message: "+e)}))},i("login-google").onclick=()=>{const t=e.open(void 0,"_blank","width="+screen.availWidth+",height="+screen.availHeight+",left=0,top=0,popup");if(null==t)return void d("Please allow popups in your browser settings and try again.");t.stop(),t.focus();const s=new URLSearchParams;s.set("client_id","176227430389-qkdboctmfhe9jnvnk2vmarafc5p8amuf.apps.googleusercontent.com"),s.set("redirect_uri",e.origin+"/auth.xht"),s.set("response_type","token"),s.set("state","12"),s.set("scope","email profile"),s.set("include_granted_scopes","true"),s.set("enable_granular_consent","true"),t.location.replace("https://accounts.google.com/o/oauth2/v2/auth?"+s.toString())};{const Rs=e=>{(e=new URLSearchParams(e).get("access_token")||"").length>0&&w(0,e).then((e=>{T.set("__secrets_",C=e),ks()})).catch((e=>{console.error(e),d("Failed to retrieve login tokens. (See console logs for details)")}))},Fs=T.get("_cre_");null==Fs?e.addEventListener("message",(t=>{if(t.origin===e.origin){const e=t.data;"string"==typeof e&&e.length>0&&Rs(e)}}),{once:!1,passive:!0}):(Rs(Fs),T.delete("_cre_"))}}else await ks()}{const Bs=r("#console-input>input"),Us=i("console-output"),js=[];let zs=0;function qs(e,s,i){const r=t.createElement("span");return r.style.color=s||"",r.style.whiteSpace="pre-wrap",r.style.overflowWrap="break-word",r.textContent=e,(i||Us).appendChild(r),r.scrollIntoView({behavior:"instant",block:"start",inline:"start"}),r}function Hs(){const e=t.createElement("hr");Us.appendChild(e),e.scrollIntoView({behavior:"instant",block:"start",inline:"start"})}function Vs(e,s,i){const r=s?100:1e3,n=e.length;if(n>r){const s=qs('"'+Zs(e.slice(0,r))+"\n..."+(n-r)+" more characters","#008000",i),a=t.createElement("button");a.type="button",a.textContent="Expand",a.onclick=()=>{s.textContent='"'+Zs(e)+'"',a.remove()},Us.appendChild(a)}else qs('"'+Zs(e)+'"',"#008000",i)}function Ws(e,t,s){qs("[\n",void 0,t);for(const s of e)qs("\t",void 0,t),Ys(s,!0,t),qs(",\n",void 0,t);qs(s||"]",void 0,t)}function $s(e,s,i){const r=e.length;if(0!==r)if(s)qs("[...]",void 0,i);else if(r>20){const s=t.createElement("span");Ws(e.slice(0,20),s,"\t..."+(r-20)+" more items");const n=t.createElement("button");n.type="button",n.textContent="Expand",n.onclick=()=>{s.innerHTML="",Ws(e,s)},s.appendChild(n),(i||Us).appendChild(s)}else Ws(e,i);else qs("[]",void 0,i)}function Ks(e,t,s,i){var r,n,a,o,h,c;const l=Js(e);l.length>0?qs(l+" {\n",void 0,s):qs("{\n",void 0,s);const p=Zh.getPrototypeOf(e);null!=p&&(qs("\t[[prototype]]: ",void 0,s),Gs(p,!0,s),qs(",\n",void 0,s));for(const i of t){qs("\t",void 0,s);const t=Zh.getOwnPropertyDescriptor(e,i)||{value:void 0};"value"in t?(null===(r=t.writable)||void 0===r||r||qs("readonly ","#000080",s),null===(n=t.configurable)||void 0===n||n||qs("final ","#000080",s),qs("string"==typeof i?i:"["+i.toString()+"]",null===(a=t.enumerable)||void 0===a||a?"#008000":"#808080",s),qs(": ",void 0,s),Ys(t.value,!0,s),qs(",\n",void 0,s)):(null===(o=t.configurable)||void 0===o||o||qs("final ","#000080",s),"get"in t&&(qs("get ","#000080",s),qs("string"==typeof i?i:"["+i.toString()+"]",null===(h=t.enumerable)||void 0===h||h?"#008000":"#808080",s),qs("() { ... }, ",void 0,s)),"set"in t&&(qs("set ","#000080",s),qs("string"==typeof i?i:"["+i.toString()+"]",null===(c=t.enumerable)||void 0===c||c?"#008000":"#808080",s),qs("(v) { ... }, ",void 0,s)),qs("\n",void 0,s))}qs(i||"}",void 0,s)}function Gs(e,s,i){if(null==e)return void qs("null","#000080",i);if(Qh.isArray(e))return void $s(e,s);if(s){const t=Js(e);return void qs((t.length>0?t+" {":"{")+(Zh.keys(e).length>0?"...":"")+"}",void 0,i)}const r=Zh.getOwnPropertyNames(e).sort();if(r.push.apply(r,Zh.getOwnPropertySymbols(e)),r.length>20){const s=t.createElement("span");Ks(e,r.slice(0,20),s,"\t...\n}");const n=t.createElement("button");n.type="button",n.textContent="Expand",n.onclick=()=>{s.innerHTML="",Ks(e,r,s)},s.appendChild(n),(i||Us).appendChild(s)}else Ks(e,r,i)}function Ys(e,t,s){switch(typeof e){case"boolean":qs(e?"true":"false","#000080",s);break;case"number":qs(e.toString(10),"#0000ff",s);break;case"bigint":qs(Xh(e)+"n","#0000ff",s);break;case"symbol":qs(e.toString(),"#800080",s);break;case"function":qs(Xh(e),void 0,s);break;case"undefined":qs("undefined","#000080",s);break;case"string":Vs(e,t,s);break;default:Gs(e,t,s)}}function Js(e){try{const t=e[Symbol.toStringTag];if("string"==typeof t)return t;const s=e.constructor;if("function"==typeof s){const{name:e}=s;if("string"==typeof e)return e}}catch(e){}return""}function Zs(e){return e.replace(/[\"\'\n\r\\]/g,(e=>{switch(e){case"\n":return"\\n";case"\r":return"\\r";case'"':return'\\"';case"'":return"\\'";case"\\":return"\\\\";default:return""}}))}async function Xs(s){if(qs("->  ","#808080"),qs(s=s.trim(),"#303030"),Hs(),"/"===s[0]){const e=s.slice(1).replace(/\s+/g," ").split(" ");switch(s=e[0]){case"clear":if(e.length>1)return qs("Invalid arguments. Try '/help' for more information.\n","#ff0000"),void Hs();Us.innerHTML="";break;case"help":qs("Embedded JSConsole version 0.1.1 by WhiteSpider Dev\n\n","#0000ff"),qs("All inputs that starts with '/' will be treated as a built-in command.\n","#808000"),qs("All other inputs will be executed as JavaScript code with 'eval(code)'.\n\n","#808000"),qs("Built-in commands:\n","#008000"),qs("\t/clear\t\t\t\t- Clear the console.\n","#008000"),qs("\t/help\t\t\t\t- Show version info and built-in command list.\n\n","#008000"),Hs();break;default:qs(s+": command not found. \nTry '/help' for a list of built-in commands.\n","#ff0000"),Hs()}return}try{s=function(e){const{body:t}=(0,Hh.qg)(e,{ranges:!0,tokens:!1,strictMode:!0,sourceType:"script",attachComment:!1,allowAwaitOutsideFunction:!0,allowReturnOutsideFunction:!0}).program,s=t.pop();let i="";for(const s of t)i+=Vh(e,s);return null!=s&&("ExpressionStatement"===s.type?i+="return "+e.slice(s.start,s.end):i+=Vh(e,s)),i}(s)}catch(e){return qs(Xh(e)+"\n","#ff0000"),void Hs()}let i;try{i=await new tc("window","document",'"use strict;"\n'+s).apply(e,[e,t])}catch(e){return qs("Uncaught "+Xh(e)+"\n","#ff0000"),void Hs()}Ys(i,!1),Hs()}Bs.onkeydown=e=>{switch(e.key){case"Enter":e.preventDefault(),e.stopPropagation();const t=Bs.value.trim();t.length>0&&(js.push(t),zs=js.length,Bs.blur(),Bs.value="",Bs.disabled=!0,Xs(t).then((()=>{Bs.disabled=!1,Bs.focus({preventScroll:!0})})));break;case"ArrowUp":e.preventDefault(),e.stopPropagation(),zs>0&&(Bs.value=js[--zs]);break;case"ArrowDown":e.preventDefault(),e.stopPropagation(),zs<js.length&&(Bs.value=js[++zs]||"")}}}})(window)})()})();